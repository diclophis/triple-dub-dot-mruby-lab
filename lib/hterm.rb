def hterm
a=<<HTERM_EOF
Ly8gVGhpcyBmaWxlIHdhcyBnZW5lcmF0
ZWQgYnkgbGliZG90L2Jpbi9jb25jYXQu
c2guCi8vIEl0IGhhcyBiZWVuIG1hcmtl
ZCByZWFkLW9ubHkgZm9yIHlvdXIgc2Fm
ZXR5LiAgUmF0aGVyCi8vIHRoYW4gZWRp
dCBpdCBkaXJlY3RseSwgcGxlYXNlIG1v
ZGlmeSBvbmUgb2YgdGhlc2Ugc291cmNl
Ci8vIGZpbGVzLi4uCi8vCi8vIGxpYmRv
dC9qcy9saWIuanMKLy8gbGliZG90L2pz
L2xpYl9jb2xvcnMuanMKLy8gbGliZG90
L2pzL2xpYl9mLmpzCi8vIGxpYmRvdC9q
cy9saWJfbWVzc2FnZV9tYW5hZ2VyLmpz
Ci8vIGxpYmRvdC9qcy9saWJfcHJlZmVy
ZW5jZV9tYW5hZ2VyLmpzCi8vIGxpYmRv
dC9qcy9saWJfcmVzb3VyY2UuanMKLy8g
bGliZG90L2pzL2xpYl9zdG9yYWdlLmpz
Ci8vIGxpYmRvdC9qcy9saWJfc3RvcmFn
ZV9jaHJvbWUuanMKLy8gbGliZG90L2pz
L2xpYl9zdG9yYWdlX2xvY2FsLmpzCi8v
IGxpYmRvdC9qcy9saWJfc3RvcmFnZV9t
ZW1vcnkuanMKLy8gbGliZG90L2pzL2xp
Yl90ZXN0X21hbmFnZXIuanMKLy8gbGli
ZG90L2pzL2xpYl91dGY4LmpzCi8vIGxp
YmRvdC9qcy9saWJfd2MuanMKLy8gaHRl
cm0vanMvaHRlcm0uanMKLy8gaHRlcm0v
anMvaHRlcm1fZnJhbWUuanMKLy8gaHRl
cm0vanMvaHRlcm1fa2V5Ym9hcmQuanMK
Ly8gaHRlcm0vanMvaHRlcm1fa2V5Ym9h
cmRfa2V5bWFwLmpzCi8vIGh0ZXJtL2pz
L2h0ZXJtX29wdGlvbnMuanMKLy8gaHRl
cm0vanMvaHRlcm1fcHJlZmVyZW5jZV9t
YW5hZ2VyLmpzCi8vIGh0ZXJtL2pzL2h0
ZXJtX3B1YnN1Yi5qcwovLyBodGVybS9q
cy9odGVybV9zY3JlZW4uanMKLy8gaHRl
cm0vanMvaHRlcm1fc2Nyb2xscG9ydC5q
cwovLyBodGVybS9qcy9odGVybV90ZXJt
aW5hbC5qcwovLyBodGVybS9qcy9odGVy
bV90ZXJtaW5hbF9pby5qcwovLyBodGVy
bS9qcy9odGVybV90ZXh0X2F0dHJpYnV0
ZXMuanMKLy8gaHRlcm0vanMvaHRlcm1f
dnQuanMKLy8gaHRlcm0vanMvaHRlcm1f
dnRfY2hhcmFjdGVyX21hcC5qcwovLwoK
Ly8gU09VUkNFIEZJTEU6IGxpYmRvdC9q
cy9saWIuanMKLy8gQ29weXJpZ2h0IChj
KSAyMDEyIFRoZSBDaHJvbWl1bSBPUyBB
dXRob3JzLiBBbGwgcmlnaHRzIHJlc2Vy
dmVkLgovLyBVc2Ugb2YgdGhpcyBzb3Vy
Y2UgY29kZSBpcyBnb3Zlcm5lZCBieSBh
IEJTRC1zdHlsZSBsaWNlbnNlIHRoYXQg
Y2FuIGJlCi8vIGZvdW5kIGluIHRoZSBM
SUNFTlNFIGZpbGUuCgondXNlIHN0cmlj
dCc7CgppZiAodHlwZW9mIGxpYiAhPSAn
dW5kZWZpbmVkJykKICB0aHJvdyBuZXcg
RXJyb3IoJ0dsb2JhbCAibGliIiBvYmpl
Y3QgYWxyZWFkeSBleGlzdHMuJyk7Cgp2
YXIgbGliID0ge307CgovKioKICogTWFw
IG9mICJkZXBlbmRlbmN5IiB0byBbInNv
dXJjZSIsIC4uLl0uCiAqCiAqIEVhY2gg
ZGVwZW5kZW5jeSBpcyBhIG9iamVjdCBu
YW1lLCBsaWtlICJsaWIuZnMiLCAic291
cmNlIiBpcyB0aGUgdXJsIHRoYXQKICog
ZGVwZGVuZHMgb24gdGhlIG9iamVjdC4K
ICovCmxpYi5ydW50aW1lRGVwZW5kZW5j
aWVzXyA9IHt9OwoKLyoqCiAqIExpc3Qg
b2YgZnVuY3Rpb25zIHRoYXQgbmVlZCB0
byBiZSBpbnZva2VkIGR1cmluZyBsaWJy
YXJ5IGluaXRpYWxpemF0aW9uLgogKgog
KiBFYWNoIGVsZW1lbnQgaW4gdGhlIGlu
aXRDYWxsYmFja3NfIGFycmF5IGlzIGl0
c2VsZiBhIHR3by1lbGVtZW50IGFycmF5
LgogKiBFbGVtZW50IDAgaXMgYSBzaG9y
dCBzdHJpbmcgZGVzY3JpYmluZyB0aGUg
b3duZXIgb2YgdGhlIGluaXQgcm91dGlu
ZSwgdXNlZnVsCiAqIGZvciBkZWJ1Z2dp
bmcuICBFbGVtZW50IDEgaXMgdGhlIGNh
bGxiYWNrIGZ1bmN0aW9uLgogKi8KbGli
LmluaXRDYWxsYmFja3NfID0gW107Cgov
KioKICogUmVjb3JkcyBhIHJ1bnRpbWUg
ZGVwZW5kZW5jeS4KICoKICogVGhpcyBj
YW4gYmUgdXNlZnVsIHdoZW4geW91IHdh
bnQgdG8gZXhwcmVzcyBhIHJ1bi10aW1l
IGRlcGVuZGVuY3kgYXQKICogY29tcGls
ZSB0aW1lLiAgSXQgaXMgbm90IGludGVu
ZGVkIHRvIGJlIGEgZnVsbC1mbGVkZ2Vk
IGxpYnJhcnkgc3lzdGVtIG9yCiAqIGRl
cGVuZGVuY3kgdHJhY2tlci4gIEl0J3Mg
anVzdCB0aGVyZSB0byBtYWtlIGl0IHBv
c3NpYmxlIHRvIGRlYnVnIHRoZQogKiBk
ZXBzIHdpdGhvdXQgcnVubmluZyBhbGwg
dGhlIGNvZGUuCiAqCiAqIE9iamVjdCBu
YW1lcyBhcmUgc3BlY2lmaWVkIGFzIHN0
cmluZ3MuICBGb3IgZXhhbXBsZS4uLgog
KgogKiAgICAgbGliLnJ0ZGVwKCdsaWIu
Y29sb3JzJywgJ2xpYi5QcmVmZXJlbmNl
TWFuYWdlcicpOwogKgogKiBPYmplY3Qg
bmFtZXMgbmVlZCBub3QgYmUgcm9vdGVk
IGJ5ICdsaWInLiAgWW91IG1heSB1c2Ug
dGhpcyB0byBkZWNsYXJlIGEKICogZGVw
ZW5kZW5jeSBvbiBhbnkgb2JqZWN0Lgog
KgogKiBUaGUgY2xpZW50IHByb2dyYW0g
bWF5IGNhbGwgbGliLmVuc3VyZVJ1bnRp
bWVEZXBlbmRlbmNpZXMoKSBhdCBzdGFy
dHVwIGluCiAqIG9yZGVyIHRvIGVuc3Vy
ZSB0aGF0IGFsbCBydW50aW1lIGRlcGVu
ZGVuY2llcyBoYXZlIGJlZW4gbWV0Lgog
KgogKiBAcGFyYW0ge3N0cmluZ30gdmFy
X2FyZ3MgT25lIG9yIG1vcmUgb2JqZWN0
cyBzcGVjaWZpZWQgYXMgc3RyaW5ncy4K
ICovCmxpYi5ydGRlcCA9IGZ1bmN0aW9u
KHZhcl9hcmdzKSB7CiAgdmFyIHNvdXJj
ZTsKCiAgdHJ5IHsKICAgIHRocm93IG5l
dyBFcnJvcigpOwogIH0gY2F0Y2ggKGV4
KSB7CiAgICB2YXIgc3RhY2tBcnJheSA9
IGV4LnN0YWNrLnNwbGl0KCdcbicpOwog
ICAgLy8gSW4gU2FmYXJpLCB0aGUgcmVz
dWx0aW5nIHN0YWNrQXJyYXkgd2lsbCBv
bmx5IGhhdmUgMiBlbGVtZW50cyBhbmQg
dGhlCiAgICAvLyBpbmRpdmlkdWFsIHN0
cmluZ3MgYXJlIGZvcm1hdHRlZCBkaWZm
ZXJlbnRseS4KICAgIGlmIChzdGFja0Fy
cmF5Lmxlbmd0aCA+PSAzKSB7CiAgICAg
IHNvdXJjZSA9IHN0YWNrQXJyYXlbMl0u
cmVwbGFjZSgvXlxzKmF0XHMrLywgJycp
OwogICAgfSBlbHNlIHsKICAgICAgc291
cmNlID0gc3RhY2tBcnJheVsxXS5yZXBs
YWNlKC9eXHMqZ2xvYmFsIGNvZGVALywg
JycpOwogICAgfQogIH0KCiAgZm9yICh2
YXIgaSA9IDA7IGkgPCBhcmd1bWVudHMu
bGVuZ3RoOyBpKyspIHsKICAgIHZhciBw
YXRoID0gYXJndW1lbnRzW2ldOwogICAg
aWYgKHBhdGggaW5zdGFuY2VvZiBBcnJh
eSkgewogICAgICBsaWIucnRkZXAuYXBw
bHkobGliLCBwYXRoKTsKICAgIH0gZWxz
ZSB7CiAgICAgIHZhciBhcnkgPSB0aGlz
LnJ1bnRpbWVEZXBlbmRlbmNpZXNfW3Bh
dGhdOwogICAgICBpZiAoIWFyeSkKICAg
ICAgICBhcnkgPSB0aGlzLnJ1bnRpbWVE
ZXBlbmRlbmNpZXNfW3BhdGhdID0gW107
CiAgICAgIGFyeS5wdXNoKHNvdXJjZSk7
CiAgICB9CiAgfQp9OwoKLyoqCiAqIEVu
c3VyZXMgdGhhdCBhbGwgcnVudGltZSBk
ZXBlbmRlbmNpZXMgYXJlIG1ldCwgb3Ig
YW4gZXhjZXB0aW9uIGlzIHRocm93bi4K
ICoKICogRXZlcnkgdW5tZXQgcnVudGlt
ZSBkZXBlbmRlbmN5IHdpbGwgYmUgbG9n
Z2VkIHRvIHRoZSBKUyBjb25zb2xlLiAg
SWYgYXQKICogbGVhc3Qgb25lIGRlcGVu
ZGVuY3kgaXMgdW5tZXQgdGhpcyB3aWxs
IHJhaXNlIGFuIGV4Y2VwdGlvbi4KICov
CmxpYi5lbnN1cmVSdW50aW1lRGVwZW5k
ZW5jaWVzXyA9IGZ1bmN0aW9uKCkgewog
IHZhciBwYXNzZWQgPSB0cnVlOwoKICBm
b3IgKHZhciBwYXRoIGluIGxpYi5ydW50
aW1lRGVwZW5kZW5jaWVzXykgewogICAg
dmFyIHNvdXJjZUxpc3QgPSBsaWIucnVu
dGltZURlcGVuZGVuY2llc19bcGF0aF07
CiAgICB2YXIgbmFtZXMgPSBwYXRoLnNw
bGl0KCcuJyk7CgogICAgLy8gSW4gYSBk
b2N1bWVudCBjb250ZXh0ICd3aW5kb3cn
IGlzIHRoZSBnbG9iYWwgb2JqZWN0LiAg
SW4gYSB3b3JrZXIgaXQncwogICAgLy8g
Y2FsbGVkICdzZWxmJy4KICAgIHZhciBv
YmogPSAod2luZG93IHx8IHNlbGYpOwog
ICAgZm9yICh2YXIgaSA9IDA7IGkgPCBu
YW1lcy5sZW5ndGg7IGkrKykgewogICAg
ICBpZiAoIShuYW1lc1tpXSBpbiBvYmop
KSB7CiAgICAgICAgY29uc29sZS53YXJu
KCdNaXNzaW5nICInICsgcGF0aCArICci
IGlzIG5lZWRlZCBieScsIHNvdXJjZUxp
c3QpOwogICAgICAgIHBhc3NlZCA9IGZh
bHNlOwogICAgICAgIGJyZWFrOwogICAg
ICB9CgogICAgICBvYmogPSBvYmpbbmFt
ZXNbaV1dOwogICAgfQogIH0KCiAgaWYg
KCFwYXNzZWQpCiAgICB0aHJvdyBuZXcg
RXJyb3IoJ0ZhaWxlZCBydW50aW1lIGRl
cGVuZGVuY3kgY2hlY2snKTsKfTsKCi8q
KgogKiBSZWdpc3RlciBhbiBpbml0aWFs
aXphdGlvbiBmdW5jdGlvbi4KICoKICog
VGhlIGluaXRpYWxpemF0aW9uIGZ1bmN0
aW9ucyBhcmUgaW52b2tlZCBpbiByZWdp
c3RyYXRpb24gb3JkZXIgd2hlbgogKiBs
aWIuaW5pdCgpIGlzIGludm9rZWQuICBF
YWNoIGZ1bmN0aW9uIHdpbGwgcmVjZWl2
ZSBhIHNpbmdsZSBwYXJhbWV0ZXIsIHdo
aWNoCiAqIGlzIGEgZnVuY3Rpb24gdG8g
YmUgaW52b2tlZCB3aGVuIGl0IGNvbXBs
ZXRlcyBpdHMgcGFydCBvZiB0aGUgaW5p
dGlhbGl6YXRpb24uCiAqCiAqIEBwYXJh
bSB7c3RyaW5nfSBuYW1lIEEgc2hvcnQg
ZGVzY3JpcHRpdmUgbmFtZSBvZiB0aGUg
aW5pdCByb3V0aW5lIHVzZWZ1bCBmb3IK
ICogICAgIGRlYnVnZ2luZy4KICogQHBh
cmFtIHtmdW5jdGlvbihmdW5jdGlvbil9
IGNhbGxiYWNrIFRoZSBpbml0aWFsaXph
dGlvbiBmdW5jdGlvbiB0byByZWdpc3Rl
ci4KICogQHJldHVybiB7ZnVuY3Rpb259
IFRoZSBjYWxsYmFjayBwYXJhbWV0ZXIu
CiAqLwpsaWIucmVnaXN0ZXJJbml0ID0g
ZnVuY3Rpb24obmFtZSwgY2FsbGJhY2sp
IHsKICBsaWIuaW5pdENhbGxiYWNrc18u
cHVzaChbbmFtZSwgY2FsbGJhY2tdKTsK
ICByZXR1cm4gY2FsbGJhY2s7Cn07Cgov
KioKICogSW5pdGlhbGl6ZSB0aGUgbGli
cmFyeS4KICoKICogVGhpcyB3aWxsIGVu
c3VyZSB0aGF0IGFsbCByZWdpc3RlcmVk
IHJ1bnRpbWUgZGVwZW5kZW5jaWVzIGFy
ZSBtZXQsIGFuZAogKiBpbnZva2UgYW55
IHJlZ2lzdGVyZWQgaW5pdGlhbGl6YXRp
b24gZnVuY3Rpb25zLgogKgogKiBJbml0
aWFsaXphdGlvbiBpcyBhc3luY2hyb25v
dXMuICBUaGUgbGlicmFyeSBpcyBub3Qg
cmVhZHkgZm9yIHVzZSB1bnRpbAogKiB0
aGUgb25Jbml0IGZ1bmN0aW9uIGlzIGlu
dm9rZWQuCiAqCiAqIEBwYXJhbSB7ZnVu
Y3Rpb24oKX0gb25Jbml0IFRoZSBmdW5j
dGlvbiB0byBpbnZva2Ugd2hlbiBpbml0
aWFsaXphdGlvbiBpcwogKiAgICAgY29t
cGxldGUuCiAqIEBwYXJhbSB7ZnVuY3Rp
b24oKil9IG9wdF9sb2dGdW5jdGlvbiBB
biBvcHRpb25hbCBmdW5jdGlvbiB0byBz
ZW5kCiAqICAgICBpbml0aWFsaXphdGlv
biByZWxhdGVkIGxvZyBtZXNzYWdlcyB0
by4KICovCmxpYi5pbml0ID0gZnVuY3Rp
b24ob25Jbml0LCBvcHRfbG9nRnVuY3Rp
b24pIHsKICB2YXIgYXJ5ID0gbGliLmlu
aXRDYWxsYmFja3NfOwoKICB2YXIgaW5p
dE5leHQgPSBmdW5jdGlvbigpIHsKICAg
IGlmIChhcnkubGVuZ3RoKSB7CiAgICAg
IHZhciByZWMgPSBhcnkuc2hpZnQoKTsK
ICAgICAgaWYgKG9wdF9sb2dGdW5jdGlv
bikKICAgICAgICBvcHRfbG9nRnVuY3Rp
b24oJ2luaXQ6ICcgKyByZWNbMF0pOwog
ICAgICByZWNbMV0obGliLmYuYWxhcm0o
aW5pdE5leHQpKTsKICAgIH0gZWxzZSB7
CiAgICAgIG9uSW5pdCgpOwogICAgfQog
IH07CgogIGlmICh0eXBlb2Ygb25Jbml0
ICE9ICdmdW5jdGlvbicpCiAgICB0aHJv
dyBuZXcgRXJyb3IoJ01pc3Npbmcgb3Ig
aW52YWxpZCBhcmd1bWVudDogb25Jbml0
Jyk7CgogIGxpYi5lbnN1cmVSdW50aW1l
RGVwZW5kZW5jaWVzXygpOwoKICBzZXRU
aW1lb3V0KGluaXROZXh0LCAwKTsKfTsK
Ly8gU09VUkNFIEZJTEU6IGxpYmRvdC9q
cy9saWJfY29sb3JzLmpzCi8vIENvcHly
aWdodCAoYykgMjAxMiBUaGUgQ2hyb21p
dW0gT1MgQXV0aG9ycy4gQWxsIHJpZ2h0
cyByZXNlcnZlZC4KLy8gVXNlIG9mIHRo
aXMgc291cmNlIGNvZGUgaXMgZ292ZXJu
ZWQgYnkgYSBCU0Qtc3R5bGUgbGljZW5z
ZSB0aGF0IGNhbiBiZQovLyBmb3VuZCBp
biB0aGUgTElDRU5TRSBmaWxlLgoKJ3Vz
ZSBzdHJpY3QnOwoKLyoqCiAqIE5hbWVz
cGFjZSBmb3IgY29sb3IgdXRpbGl0aWVz
LgogKi8KbGliLmNvbG9ycyA9IHt9OwoK
LyoqCiAqIEZpcnN0LCBzb21lIGNhbm5l
ZCByZWd1bGFyIGV4cHJlc3Npb25zIHdl
J3JlIGdvaW5nIHRvIHVzZSBpbiB0aGlz
IGZpbGUuCiAqCiAqCiAqICAgICAgICAg
ICAgICAgICAgICAgICAgICAgICAgQlJB
Q0UgWU9VUlNFTEYKICoKICogICAgICAg
ICAgICAgICAgICAgICAgICAgICAgICAg
ICAsfn5+fi4KICogICAgICAgICAgICAg
ICAgICAgICAgICAgICAgICAgICB8Pl88
IH5+CiAqICAgICAgICAgICAgICAgICAg
ICAgICAgICAgICAgICAzYC0tLSctLy4K
ICogICAgICAgICAgICAgICAgICAgICAg
ICAgICAgICAgIDM6Ojo6Olx2XAogKiAg
ICAgICAgICAgICAgICAgICAgICAgICAg
ICAgICA9bz06Ojo6OlwsXAogKiAgICAg
ICAgICAgICAgICAgICAgICAgICAgICAg
ICAgfCA6Ojo6OlwsLFwKICoKICogICAg
ICAgICAgICAgICAgICAgICAgICBUSEUg
UkVHVUxBUiBFWFBSRVNTSU9OUwogKiAg
ICAgICAgICAgICAgICAgICAgICAgICAg
ICAgICBBUkUgQ09NSU5HLgogKgogKiBU
aGVyZSdzIG5vIHdheSB0byBicmVhayBs
b25nIFJFIGxpdGVyYWxzIGluIEphdmFT
Y3JpcHQuICBGaXggdGhhdCB3aHkgZG9u
J3QKICogeW91PyAgT2gsIGFuZCBhbHNv
IHRoZXJlJ3Mgbm8gd2F5IHRvIHdyaXRl
IGEgc3RyaW5nIHRoYXQgZG9lc24ndCBp
bnRlcnByZXQKICogZXNjYXBlcy4KICoK
ICogSW5zdGVhZCwgd2Ugc3Rvb3AgdG8g
dGhpcyAucmVwbGFjZSgpIHRyaWNrLgog
Ki8KbGliLmNvbG9ycy5yZV8gPSB7CiAg
Ly8gQ1NTIGhleCBjb2xvciwgI1JHQi4K
ICBoZXgxNjogLyMoW2EtZjAtOV0pKFth
LWYwLTldKShbYS1mMC05XSkvaSwKCiAg
Ly8gQ1NTIGhleCBjb2xvciwgI1JSR0dC
Qi4KICBoZXgyNDogLyMoW2EtZjAtOV17
Mn0pKFthLWYwLTldezJ9KShbYS1mMC05
XXsyfSkvaSwKCiAgLy8gQ1NTIHJnYiBj
b2xvciwgcmdiKHJycixnZ2csYmJiKS4K
ICByZ2I6IG5ldyBSZWdFeHAoCiAgICAg
ICgnXi9zKnJnYi9zKi8oL3MqKC9kezEs
M30pL3MqLC9zKigvZHsxLDN9KS9zKiwn
ICsKICAgICAgICcvcyooL2R7MSwzfSkv
cyovKS9zKiQnCiAgICAgICApLnJlcGxh
Y2UoL1wvL2csICdcXCcpLCAnaScpLAoK
ICAvLyBDU1MgcmdiIGNvbG9yLCByZ2Io
cnJyLGdnZyxiYmIsYWFhKS4KICByZ2Jh
OiBuZXcgUmVnRXhwKAogICAgICAoJ14v
cypyZ2JhL3MqJyArCiAgICAgICAnLygv
cyooL2R7MSwzfSkvcyosL3MqKC9kezEs
M30pL3MqLC9zKigvZHsxLDN9KS9zKicg
KwogICAgICAgJyg/OiwvcyooL2QrKD86
Ly4vZCspPykvcyopLykvcyokJwogICAg
ICAgKS5yZXBsYWNlKC9cLy9nLCAnXFwn
KSwgJ2knKSwKCiAgLy8gRWl0aGVyIFJH
QiBvciBSR0JBLgogIHJnYng6IG5ldyBS
ZWdFeHAoCiAgICAgICgnXi9zKnJnYmE/
L3MqJyArCiAgICAgICAnLygvcyooL2R7
MSwzfSkvcyosL3MqKC9kezEsM30pL3Mq
LC9zKigvZHsxLDN9KS9zKicgKwogICAg
ICAgJyg/OiwvcyooL2QrKD86Ly4vZCsp
PykvcyopPy8pL3MqJCcKICAgICAgICku
cmVwbGFjZSgvXC8vZywgJ1xcJyksICdp
JyksCgogIC8vIEFuIFgxMSAicmdiOmRk
ZC9kZGQvZGRkIiB2YWx1ZS4KICB4MTFy
Z2I6IC9eXHMqcmdiOihbYS1mMC05XXsx
LDR9KVwvKFthLWYwLTldezEsNH0pXC8o
W2EtZjAtOV17MSw0fSlccyokL2ksCgog
IC8vIEVuZ2xpc2ggY29sb3IgbmFtZS4K
ICBuYW1lOiAvW2Etel1bYS16MC05XHNd
Ky8sCn07CgovKioKICogQ29udmVydCBh
IENTUyByZ2IoZGRkLGRkZCxkZGQpIGNv
bG9yIHZhbHVlIGludG8gYW4gWDExIGNv
bG9yIHZhbHVlLgogKgogKiBPdGhlciBD
U1MgY29sb3IgdmFsdWVzIGFyZSBpZ25v
cmVkIHRvIGVuc3VyZSBzYW5pdGFyeSBk
YXRhIGhhbmRsaW5nLgogKgogKiBFYWNo
ICdkZGQnIGNvbXBvbmVudCBpcyBhIG9u
ZSBieXRlIHZhbHVlIHNwZWNpZmllZCBp
biBkZWNpbWFsLgogKgogKiBAcGFyYW0g
e3N0cmluZ30gdmFsdWUgVGhlIENTUyBj
b2xvciB2YWx1ZSB0byBjb252ZXJ0Lgog
KiBAcmV0dXJuIHtzdHJpbmd9IFRoZSBY
MTEgY29sb3IgdmFsdWUgb3IgbnVsbCBp
ZiB0aGUgdmFsdWUgY291bGQgbm90IGJl
CiAqICAgICBjb252ZXJ0ZWQuCiAqLwps
aWIuY29sb3JzLnJnYlRvWDExID0gZnVu
Y3Rpb24odmFsdWUpIHsKICBmdW5jdGlv
biBzY2FsZSh2KSB7CiAgICB2ID0gKE1h
dGgubWluKHYsIDI1NSkgKiAyNTcpLnRv
U3RyaW5nKDE2KTsKICAgIHdoaWxlICh2
Lmxlbmd0aCA8IDQpCiAgICAgIHYgPSAn
MCcgKyB2OwoKICAgIHJldHVybiB2Owog
IH0KCiAgdmFyIGFyeSA9IHZhbHVlLm1h
dGNoKGxpYi5jb2xvcnMucmVfLnJnYngp
OwogIGlmICghYXJ5KQogICAgcmV0dXJu
IG51bGw7CgogIHJldHVybiAncmdiOicg
KyBzY2FsZShhcnlbMV0pICsgJy8nICsg
c2NhbGUoYXJ5WzJdKSArICcvJyArIHNj
YWxlKGFyeVszXSk7Cn07CgovKioKICog
Q29udmVydCBhbiBYMTEgY29sb3IgdmFs
dWUgaW50byBhbiBDU1MgcmdiKC4uLikg
Y29sb3IgdmFsdWUuCiAqCiAqIFRoZSBY
MTEgdmFsdWUgbWF5IGJlIGFuIFgxMSBj
b2xvciBuYW1lLCBvciBhbiBSR0IgdmFs
dWUgb2YgdGhlIGZvcm0KICogcmdiOmho
aGgvaGhoaC9oaGhoLiAgSWYgYSBjb21w
b25lbnQgdmFsdWUgaXMgbGVzcyB0aGFu
IDQgZGlnaXRzIGl0IGlzCiAqIHBhZGRl
ZCBvdXQgdG8gNCwgdGhlbiBzY2FsZWQg
ZG93biB0byBmaXQgaW4gYSBzaW5nbGUg
Ynl0ZS4KICoKICogQHBhcmFtIHtzdHJp
bmd9IHZhbHVlIFRoZSBYMTEgY29sb3Ig
dmFsdWUgdG8gY29udmVydC4KICogQHJl
dHVybiB7c3RyaW5nfSBUaGUgQ1NTIGNv
bG9yIHZhbHVlIG9yIG51bGwgaWYgdGhl
IHZhbHVlIGNvdWxkIG5vdCBiZQogKiAg
ICAgY29udmVydGVkLgogKi8KbGliLmNv
bG9ycy54MTFUb0NTUyA9IGZ1bmN0aW9u
KHYpIHsKICBmdW5jdGlvbiBzY2FsZSh2
KSB7CiAgICAvLyBQYWQgb3V0IHZhbHVl
cyB3aXRoIGxlc3MgdGhhbiBmb3VyIGRp
Z2l0cy4gIFRoaXMgcGFkZGluZyAocHJv
YmFibHkpCiAgICAvLyBtYXRjaGVzIHh0
ZXJtLiAgSXQncyBkaWZmaWN1bHQgdG8g
c2F5IGZvciBzdXJlIHNpbmNlIHh0ZXJt
IHNlZW1zIHRvCiAgICAvLyBhcnJpdmUg
YXQgYSBwYWRkZWQgdmFsdWUgYW5kIHRo
ZW4gcGVyZm9ybSBzb21lIGNvbWJpbmF0
aW9uIG9mCiAgICAvLyBnYW1tYSBjb3Jy
ZWN0aW9uLCBjb2xvciBzcGFjZSB0cmFu
Zm9ybWF0aW9uLCBhbmQgcXVhbnRpemF0
aW9uLgoKICAgIGlmICh2Lmxlbmd0aCA9
PSAxKSB7CiAgICAgIC8vIFNpbmdsZSBk
aWdpdHMgcGFkIG91dCB0byBmb3VyIGJ5
IHJlcGVhdGluZyB0aGUgY2hhcmFjdGVy
LiAgImYiIGJlY29tZXMKICAgICAgLy8g
ImZmZmYiLiAgU2NhbGluZyBkb3duIGEg
aGV4IHZhbHVlIG9mIHRoaXMgcGF0dGVy
biBieSAyNTcgaXMgdGhlIHNhbWUKICAg
ICAgLy8gYXMgY3V0dGluZyBvZmYgb25l
IGJ5dGUuICBXZSBza2lwIHRoZSBtaWRk
bGUgc3RlcCBhbmQganVzdCBkb3VibGUK
ICAgICAgLy8gdGhlIGNoYXJhY3Rlci4K
ICAgICAgcmV0dXJuIHBhcnNlSW50KHYg
KyB2LCAxNik7CiAgICB9CgogICAgaWYg
KHYubGVuZ3RoID09IDIpIHsKICAgICAg
Ly8gU2ltaWxhciBkZWFsIGhlcmUuICBY
MTEgcGFkcyB0d28gZGlnaXQgdmFsdWVz
IGJ5IHJlcGVhdGluZyB0aGUKICAgICAg
Ly8gYnl0ZSAob3Igc2NhbGUgdXAgYnkg
MjU3KS4gIFNpbmNlIHdlJ3JlIGdvaW5n
IHRvIHNjYWxlIGl0IGJhY2sKICAgICAg
Ly8gZG93biBhbnl3YXksIHdlIGNhbiBq
dXN0IHJldHVybiB0aGUgb3JpZ2luYWwg
dmFsdWUuCiAgICAgIHJldHVybiBwYXJz
ZUludCh2LCAxNik7CiAgICB9CgogICAg
aWYgKHYubGVuZ3RoID09IDMpIHsKICAg
ICAgLy8gVGhyZWUgZGlnaXQgdmFsdWVz
IHNlZW0gdG8gYmUgcGFkZGVkIGJ5IHJl
cGVhdGluZyB0aGUgZmluYWwgZGlnaXQu
CiAgICAgIC8vIGUuZy4gMTBmIGJlY29t
ZXMgMTBmZi4KICAgICAgdiA9IHYgKyB2
LnN1YnN0cigyKTsKICAgIH0KCiAgICAv
LyBTY2FsZSBkb3duIHRoZSAyIGJ5dGUg
dmFsdWUuCiAgICByZXR1cm4gTWF0aC5y
b3VuZChwYXJzZUludCh2LCAxNikgLyAy
NTcpOwogIH0KCiAgdmFyIGFyeSA9IHYu
bWF0Y2gobGliLmNvbG9ycy5yZV8ueDEx
cmdiKTsKICBpZiAoIWFyeSkKICAgIHJl
dHVybiBsaWIuY29sb3JzLm5hbWVUb1JH
Qih2KTsKCiAgYXJ5LnNwbGljZSgwLCAx
KTsKICByZXR1cm4gbGliLmNvbG9ycy5h
cnJheVRvUkdCQShhcnkubWFwKHNjYWxl
KSk7Cn07CgovKioKICogQ29udmVydHMg
b25lIG9yIG1vcmUgQ1NTICcjUlJHR0JC
JyBjb2xvciB2YWx1ZXMgaW50byB0aGVp
ciByZ2IoLi4uKQogKiBmb3JtLgogKgog
KiBBcnJheXMgYXJlIGNvbnZlcnRlZCBp
biBwbGFjZS4gSWYgYSB2YWx1ZSBjYW5u
b3QgYmUgY29udmVydGVkLCBpdCBpcwog
KiByZXBsYWNlZCB3aXRoIG51bGwuCiAq
CiAqIEBwYXJhbSB7c3RyaW5nfEFycmF5
LjxzdHJpbmc+fSBBIHNpbmdsZSBSR0Ig
dmFsdWUgb3IgYXJyYXkgb2YgUkdCIHZh
bHVlcyB0bwogKiAgICAgY29udmVydC4K
ICogQHJldHVybiB7c3RyaW5nfEFycmF5
LjxzdHJpbmc+fSBUaGUgY29udmVydGVk
IHZhbHVlIG9yIHZhbHVlcy4KICovCmxp
Yi5jb2xvcnMuaGV4VG9SR0IgPSBmdW5j
dGlvbihhcmcpIHsKICBmdW5jdGlvbiBj
b252ZXJ0KGhleCkgewogICAgdmFyIHJl
ID0gKGhleC5sZW5ndGggPT0gNCkgPwog
ICAgICAgIGxpYi5jb2xvcnMucmVfLmhl
eDE2IDogbGliLmNvbG9ycy5yZV8uaGV4
MjQ7CiAgICB2YXIgYXJ5ID0gaGV4Lm1h
dGNoKHJlKQogICAgaWYgKCFhcnkpCiAg
ICAgIHJldHVybiBudWxsOwoKICAgIHJl
dHVybiAncmdiKCcgKyBwYXJzZUludChh
cnlbMV0sIDE2KSArICcsICcgKwogICAg
ICAgIHBhcnNlSW50KGFyeVsyXSwgMTYp
ICsgJywgJyArCiAgICAgICAgcGFyc2VJ
bnQoYXJ5WzNdLCAxNikgKyAnKSc7CiAg
fQoKICBpZiAoYXJnIGluc3RhbmNlb2Yg
QXJyYXkpIHsKICAgIGZvciAodmFyIGkg
PSAwOyBpIDwgYXJnLmxlbmd0aDsgaSsr
KSB7CiAgICAgIGFyZ1tpXSA9IGNvbnZl
cnQoYXJnW2ldKTsKICAgIH0KICB9IGVs
c2UgewogICAgYXJnID0gY29udmVydChh
cmcpOwogIH0KCiAgcmV0dXJuIGFyZzsK
fTsKCi8qKgogKiBDb252ZXJ0cyBvbmUg
b3IgbW9yZSBDU1MgcmdiKC4uLikgZm9y
bXMgaW50byB0aGVpciAnI1JSR0dCQicg
Y29sb3IgdmFsdWVzLgogKgogKiBJZiBn
aXZlbiBhbiByZ2JhKC4uLikgZm9ybSwg
dGhlIGFscGhhIGZpZWxkIGlzIHRocm93
biBhd2F5LgogKgogKiBBcnJheXMgYXJl
IGNvbnZlcnRlZCBpbiBwbGFjZS4gSWYg
YSB2YWx1ZSBjYW5ub3QgYmUgY29udmVy
dGVkLCBpdCBpcwogKiByZXBsYWNlZCB3
aXRoIG51bGwuCiAqCiAqIEBwYXJhbSB7
c3RyaW5nfEFycmF5LjxzdHJpbmc+fSBB
IHNpbmdsZSByZ2IoLi4uKSB2YWx1ZSBv
ciBhcnJheSBvZiByZ2IoLi4uKQogKiAg
ICAgdmFsdWVzIHRvIGNvbnZlcnQuCiAq
IEByZXR1cm4ge3N0cmluZ3xBcnJheS48
c3RyaW5nPn0gVGhlIGNvbnZlcnRlZCB2
YWx1ZSBvciB2YWx1ZXMuCiAqLwpsaWIu
Y29sb3JzLnJnYlRvSGV4ID0gZnVuY3Rp
b24oYXJnKSB7CiAgZnVuY3Rpb24gY29u
dmVydChyZ2IpIHsKICAgIHZhciBhcnkg
PSBsaWIuY29sb3JzLmNyYWNrUkdCKHJn
Yik7CiAgICByZXR1cm4gJyMnICsgbGli
LmYuenBhZCgoKHBhcnNlSW50KGFyeVsw
XSkgPDwgMTYpIHwKICAgICAgICAgICAg
ICAgICAgICAgICAgICAgICAocGFyc2VJ
bnQoYXJ5WzFdKSA8PCAgOCkgfAogICAg
ICAgICAgICAgICAgICAgICAgICAgICAg
IChwYXJzZUludChhcnlbMl0pIDw8ICAw
KSkudG9TdHJpbmcoMTYpLCA2KTsKICB9
CgogIGlmIChhcmcgaW5zdGFuY2VvZiBB
cnJheSkgewogICAgZm9yICh2YXIgaSA9
IDA7IGkgPCBhcmcubGVuZ3RoOyBpKysp
IHsKICAgICAgYXJnW2ldID0gY29udmVy
dChhcmdbaV0pOwogICAgfQogIH0gZWxz
ZSB7CiAgICBhcmcgPSBjb252ZXJ0KGFy
Zyk7CiAgfQoKICByZXR1cm4gYXJnOwp9
OwoKLyoqCiAqIFRha2UgYW55IHZhbGlk
IGNzcyBjb2xvciBkZWZpbml0aW9uIGFu
ZCB0dXJuIGl0IGludG8gYW4gcmdiIG9y
IHJnYmEgdmFsdWUuCiAqCiAqIFJldHVy
bnMgbnVsbCBpZiB0aGUgdmFsdWUgY291
bGQgbm90IGJlIG5vcm1hbGl6ZWQuCiAq
LwpsaWIuY29sb3JzLm5vcm1hbGl6ZUNT
UyA9IGZ1bmN0aW9uKGRlZikgewogIGlm
IChkZWYuc3Vic3RyKDAsIDEpID09ICcj
JykKICAgIHJldHVybiBsaWIuY29sb3Jz
LmhleFRvUkdCKGRlZik7CgogIGlmIChs
aWIuY29sb3JzLnJlXy5yZ2J4LnRlc3Qo
ZGVmKSkKICAgIHJldHVybiBkZWY7Cgog
IHJldHVybiBsaWIuY29sb3JzLm5hbWVU
b1JHQihkZWYpOwp9OwoKLyoqCiAqIENv
bnZlcnQgYSAzIG9yIDQgZWxlbWVudCBh
cnJheSBpbnRvIGFuIHJnYmEoLi4uKSBz
dHJpbmcuCiAqLwpsaWIuY29sb3JzLmFy
cmF5VG9SR0JBID0gZnVuY3Rpb24oYXJ5
KSB7CiAgdmFyIGFscGhhID0gKGFyeS5s
ZW5ndGggPiAzKSA/IGFyeVszXSA6IDE7
CiAgcmV0dXJuICdyZ2JhKCcgKyBhcnlb
MF0gKyAnLCAnICsgYXJ5WzFdICsgJywg
JyArIGFyeVsyXSArICcsICcgKyBhbHBo
YSArICcpJzsKfTsKCi8qKgogKiBPdmVy
d3JpdGUgdGhlIGFscGhhIGNoYW5uZWwg
b2YgYW4gcmdiL3JnYmEgY29sb3IuCiAq
LwpsaWIuY29sb3JzLnNldEFscGhhID0g
ZnVuY3Rpb24ocmdiLCBhbHBoYSkgewog
IHZhciBhcnkgPSBsaWIuY29sb3JzLmNy
YWNrUkdCKHJnYik7CiAgYXJ5WzNdID0g
YWxwaGE7CiAgcmV0dXJuIGxpYi5jb2xv
cnMuYXJyYXlUb1JHQkEoYXJ5KTsKfTsK
Ci8qKgogKiBNaXggYSBwZXJjZW50YWdl
IG9mIGEgdGludCBjb2xvciBpbnRvIGEg
YmFzZSBjb2xvci4KICovCmxpYi5jb2xv
cnMubWl4ID0gZnVuY3Rpb24oYmFzZSwg
dGludCwgcGVyY2VudCkgewogIHZhciBh
cnkxID0gbGliLmNvbG9ycy5jcmFja1JH
QihiYXNlKTsKICB2YXIgYXJ5MiA9IGxp
Yi5jb2xvcnMuY3JhY2tSR0IodGludCk7
CgogIGZvciAodmFyIGkgPSAwOyBpIDwg
NDsgKytpKSB7CiAgICB2YXIgZGlmZiA9
IGFyeTJbaV0gLSBhcnkxW2ldOwogICAg
YXJ5MVtpXSA9IE1hdGgucm91bmQocGFy
c2VJbnQoYXJ5MVtpXSkgKyBkaWZmICog
cGVyY2VudCk7CiAgfQoKICByZXR1cm4g
bGliLmNvbG9ycy5hcnJheVRvUkdCQShh
cnkxKTsKfTsKCi8qKgogKiBTcGxpdCBh
biByZ2IvcmdiYSBjb2xvciBpbnRvIGFu
IGFycmF5IG9mIGl0cyBjb21wb25lbnRz
LgogKgogKiBPbiBzdWNjZXNzLCBhIDQg
ZWxlbWVudCBhcnJheSB3aWxsIGJlIHJl
dHVybmVkLiAgRm9yIHJnYiB2YWx1ZXMs
IHRoZSBhbHBoYQogKiB3aWxsIGJlIHNl
dCB0byAxLgogKi8KbGliLmNvbG9ycy5j
cmFja1JHQiA9IGZ1bmN0aW9uKGNvbG9y
KSB7CiAgaWYgKGNvbG9yLnN1YnN0cigw
LCA0KSA9PSAncmdiYScpIHsKICAgIHZh
ciBhcnkgPSBjb2xvci5tYXRjaChsaWIu
Y29sb3JzLnJlXy5yZ2JhKTsKICAgIGlm
IChhcnkpIHsKICAgICAgYXJ5LnNoaWZ0
KCk7CiAgICAgIHJldHVybiBhcnk7CiAg
ICB9CiAgfSBlbHNlIHsKICAgIHZhciBh
cnkgPSBjb2xvci5tYXRjaChsaWIuY29s
b3JzLnJlXy5yZ2IpOwogICAgaWYgKGFy
eSkgewogICAgICBhcnkuc2hpZnQoKTsK
ICAgICAgYXJ5LnB1c2goMSk7CiAgICAg
IHJldHVybiBhcnk7CiAgICB9CiAgfQoK
ICBjb25zb2xlLmVycm9yKCdDb3VsZG5c
J3QgY3JhY2s6ICcgKyBjb2xvcik7CiAg
cmV0dXJuIG51bGw7Cn07CgovKioKICog
Q29udmVydCBhbiBYMTEgY29sb3IgbmFt
ZSBpbnRvIGEgQ1NTIHJnYiguLi4pIHZh
bHVlLgogKgogKiBOYW1lcyBhcmUgc3Ry
aXBwZWQgb2Ygc3BhY2VzIGFuZCBjb252
ZXJ0ZWQgdG8gbG93ZXJjYXNlLiAgSWYg
dGhlIG5hbWUgaXMKICogdW5rbm93biwg
bnVsbCBpcyByZXR1cm5lZC4KICoKICog
VGhpcyBsaXN0IG9mIGNvbG9yIG5hbWUg
dG8gUkdCIG1hcHBpbmcgaXMgZGVyaXZl
ZCBmcm9tIHRoZSBzdG9jayBYMTEKICog
cmdiLnR4dCBmaWxlLgogKgogKiBAcGFy
YW0ge3N0cmluZ30gbmFtZSBUaGUgY29s
b3IgbmFtZSB0byBjb252ZXJ0LgogKiBA
cmV0dXJuIHtzdHJpbmd9IFRoZSBjb3Jy
ZXNwb25kaW5nIENTUyByZ2IoLi4uKSB2
YWx1ZS4KICovCmxpYi5jb2xvcnMubmFt
ZVRvUkdCID0gZnVuY3Rpb24obmFtZSkg
ewogIGlmIChuYW1lIGluIGxpYi5jb2xv
cnMuY29sb3JOYW1lcykKICAgIHJldHVy
biBsaWIuY29sb3JzLmNvbG9yTmFtZXNb
bmFtZV07CgogIG5hbWUgPSBuYW1lLnRv
TG93ZXJDYXNlKCk7CiAgaWYgKG5hbWUg
aW4gbGliLmNvbG9ycy5jb2xvck5hbWVz
KQogICAgcmV0dXJuIGxpYi5jb2xvcnMu
Y29sb3JOYW1lc1tuYW1lXTsKCiAgbmFt
ZSA9IG5hbWUucmVwbGFjZSgvXHMrL2cs
ICcnKTsKICBpZiAobmFtZSBpbiBsaWIu
Y29sb3JzLmNvbG9yTmFtZXMpCiAgICBy
ZXR1cm4gbGliLmNvbG9ycy5jb2xvck5h
bWVzW25hbWVdOwoKICByZXR1cm4gbnVs
bDsKfTsKCi8qKgogKiBUaGUgc3RvY2sg
Y29sb3IgcGFsZXR0ZS4KICovCmxpYi5j
b2xvcnMuc3RvY2tDb2xvclBhbGV0dGUg
PSBsaWIuY29sb3JzLmhleFRvUkdCCiAg
KFsvLyBUaGUgIkFOU0kgMTYiLi4uCiAg
ICAnIzAwMDAwMCcsICcjQ0MwMDAwJywg
JyM0RTlBMDYnLCAnI0M0QTAwMCcsCiAg
ICAnIzM0NjVBNCcsICcjNzU1MDdCJywg
JyMwNjk4OUEnLCAnI0QzRDdDRicsCiAg
ICAnIzU1NTc1MycsICcjRUYyOTI5Jywg
JyMwMEJBMTMnLCAnI0ZDRTk0RicsCiAg
ICAnIzcyOUZDRicsICcjRjIwMENCJywg
JyMwMEI1QkQnLCAnI0VFRUVFQycsCgog
ICAgLy8gVGhlIDZ4NiBjb2xvciBjdWJl
cy4uLgogICAgJyMwMDAwMDAnLCAnIzAw
MDA1RicsICcjMDAwMDg3JywgJyMwMDAw
QUYnLCAnIzAwMDBENycsICcjMDAwMEZG
JywKICAgICcjMDA1RjAwJywgJyMwMDVG
NUYnLCAnIzAwNUY4NycsICcjMDA1RkFG
JywgJyMwMDVGRDcnLCAnIzAwNUZGRics
CiAgICAnIzAwODcwMCcsICcjMDA4NzVG
JywgJyMwMDg3ODcnLCAnIzAwODdBRics
ICcjMDA4N0Q3JywgJyMwMDg3RkYnLAog
ICAgJyMwMEFGMDAnLCAnIzAwQUY1Rics
ICcjMDBBRjg3JywgJyMwMEFGQUYnLCAn
IzAwQUZENycsICcjMDBBRkZGJywKICAg
ICcjMDBENzAwJywgJyMwMEQ3NUYnLCAn
IzAwRDc4NycsICcjMDBEN0FGJywgJyMw
MEQ3RDcnLCAnIzAwRDdGRicsCiAgICAn
IzAwRkYwMCcsICcjMDBGRjVGJywgJyMw
MEZGODcnLCAnIzAwRkZBRicsICcjMDBG
RkQ3JywgJyMwMEZGRkYnLAoKICAgICcj
NUYwMDAwJywgJyM1RjAwNUYnLCAnIzVG
MDA4NycsICcjNUYwMEFGJywgJyM1RjAw
RDcnLCAnIzVGMDBGRicsCiAgICAnIzVG
NUYwMCcsICcjNUY1RjVGJywgJyM1RjVG
ODcnLCAnIzVGNUZBRicsICcjNUY1RkQ3
JywgJyM1RjVGRkYnLAogICAgJyM1Rjg3
MDAnLCAnIzVGODc1RicsICcjNUY4Nzg3
JywgJyM1Rjg3QUYnLCAnIzVGODdENycs
ICcjNUY4N0ZGJywKICAgICcjNUZBRjAw
JywgJyM1RkFGNUYnLCAnIzVGQUY4Nycs
ICcjNUZBRkFGJywgJyM1RkFGRDcnLCAn
IzVGQUZGRicsCiAgICAnIzVGRDcwMCcs
ICcjNUZENzVGJywgJyM1RkQ3ODcnLCAn
IzVGRDdBRicsICcjNUZEN0Q3JywgJyM1
RkQ3RkYnLAogICAgJyM1RkZGMDAnLCAn
IzVGRkY1RicsICcjNUZGRjg3JywgJyM1
RkZGQUYnLCAnIzVGRkZENycsICcjNUZG
RkZGJywKCiAgICAnIzg3MDAwMCcsICcj
ODcwMDVGJywgJyM4NzAwODcnLCAnIzg3
MDBBRicsICcjODcwMEQ3JywgJyM4NzAw
RkYnLAogICAgJyM4NzVGMDAnLCAnIzg3
NUY1RicsICcjODc1Rjg3JywgJyM4NzVG
QUYnLCAnIzg3NUZENycsICcjODc1RkZG
JywKICAgICcjODc4NzAwJywgJyM4Nzg3
NUYnLCAnIzg3ODc4NycsICcjODc4N0FG
JywgJyM4Nzg3RDcnLCAnIzg3ODdGRics
CiAgICAnIzg3QUYwMCcsICcjODdBRjVG
JywgJyM4N0FGODcnLCAnIzg3QUZBRics
ICcjODdBRkQ3JywgJyM4N0FGRkYnLAog
ICAgJyM4N0Q3MDAnLCAnIzg3RDc1Rics
ICcjODdENzg3JywgJyM4N0Q3QUYnLCAn
Izg3RDdENycsICcjODdEN0ZGJywKICAg
ICcjODdGRjAwJywgJyM4N0ZGNUYnLCAn
Izg3RkY4NycsICcjODdGRkFGJywgJyM4
N0ZGRDcnLCAnIzg3RkZGRicsCgogICAg
JyNBRjAwMDAnLCAnI0FGMDA1RicsICcj
QUYwMDg3JywgJyNBRjAwQUYnLCAnI0FG
MDBENycsICcjQUYwMEZGJywKICAgICcj
QUY1RjAwJywgJyNBRjVGNUYnLCAnI0FG
NUY4NycsICcjQUY1RkFGJywgJyNBRjVG
RDcnLCAnI0FGNUZGRicsCiAgICAnI0FG
ODcwMCcsICcjQUY4NzVGJywgJyNBRjg3
ODcnLCAnI0FGODdBRicsICcjQUY4N0Q3
JywgJyNBRjg3RkYnLAogICAgJyNBRkFG
MDAnLCAnI0FGQUY1RicsICcjQUZBRjg3
JywgJyNBRkFGQUYnLCAnI0FGQUZENycs
ICcjQUZBRkZGJywKICAgICcjQUZENzAw
JywgJyNBRkQ3NUYnLCAnI0FGRDc4Nycs
ICcjQUZEN0FGJywgJyNBRkQ3RDcnLCAn
I0FGRDdGRicsCiAgICAnI0FGRkYwMCcs
ICcjQUZGRjVGJywgJyNBRkZGODcnLCAn
I0FGRkZBRicsICcjQUZGRkQ3JywgJyNB
RkZGRkYnLAoKICAgICcjRDcwMDAwJywg
JyNENzAwNUYnLCAnI0Q3MDA4NycsICcj
RDcwMEFGJywgJyNENzAwRDcnLCAnI0Q3
MDBGRicsCiAgICAnI0Q3NUYwMCcsICcj
RDc1RjVGJywgJyNENzVGODcnLCAnI0Q3
NUZBRicsICcjRDc1RkQ3JywgJyNENzVG
RkYnLAogICAgJyNENzg3MDAnLCAnI0Q3
ODc1RicsICcjRDc4Nzg3JywgJyNENzg3
QUYnLCAnI0Q3ODdENycsICcjRDc4N0ZG
JywKICAgICcjRDdBRjAwJywgJyNEN0FG
NUYnLCAnI0Q3QUY4NycsICcjRDdBRkFG
JywgJyNEN0FGRDcnLCAnI0Q3QUZGRics
CiAgICAnI0Q3RDcwMCcsICcjRDdENzVG
JywgJyNEN0Q3ODcnLCAnI0Q3RDdBRics
ICcjRDdEN0Q3JywgJyNEN0Q3RkYnLAog
ICAgJyNEN0ZGMDAnLCAnI0Q3RkY1Rics
ICcjRDdGRjg3JywgJyNEN0ZGQUYnLCAn
I0Q3RkZENycsICcjRDdGRkZGJywKCiAg
ICAnI0ZGMDAwMCcsICcjRkYwMDVGJywg
JyNGRjAwODcnLCAnI0ZGMDBBRicsICcj
RkYwMEQ3JywgJyNGRjAwRkYnLAogICAg
JyNGRjVGMDAnLCAnI0ZGNUY1RicsICcj
RkY1Rjg3JywgJyNGRjVGQUYnLCAnI0ZG
NUZENycsICcjRkY1RkZGJywKICAgICcj
RkY4NzAwJywgJyNGRjg3NUYnLCAnI0ZG
ODc4NycsICcjRkY4N0FGJywgJyNGRjg3
RDcnLCAnI0ZGODdGRicsCiAgICAnI0ZG
QUYwMCcsICcjRkZBRjVGJywgJyNGRkFG
ODcnLCAnI0ZGQUZBRicsICcjRkZBRkQ3
JywgJyNGRkFGRkYnLAogICAgJyNGRkQ3
MDAnLCAnI0ZGRDc1RicsICcjRkZENzg3
JywgJyNGRkQ3QUYnLCAnI0ZGRDdENycs
ICcjRkZEN0ZGJywKICAgICcjRkZGRjAw
JywgJyNGRkZGNUYnLCAnI0ZGRkY4Nycs
ICcjRkZGRkFGJywgJyNGRkZGRDcnLCAn
I0ZGRkZGRicsCgogICAgLy8gVGhlIGdy
ZXlzY2FsZSByYW1wLi4uCiAgICAnIzA4
MDgwOCcsICcjMTIxMjEyJywgJyMxQzFD
MUMnLCAnIzI2MjYyNicsICcjMzAzMDMw
JywgJyMzQTNBM0EnLAogICAgJyM0NDQ0
NDQnLCAnIzRFNEU0RScsICcjNTg1ODU4
JywgJyM2MjYyNjInLCAnIzZDNkM2Qycs
ICcjNzY3Njc2JywKICAgICcjODA4MDgw
JywgJyM4QThBOEEnLCAnIzk0OTQ5NCcs
ICcjOUU5RTlFJywgJyNBOEE4QTgnLCAn
I0IyQjJCMicsCiAgICAnI0JDQkNCQycs
ICcjQzZDNkM2JywgJyNEMEQwRDAnLCAn
I0RBREFEQScsICcjRTRFNEU0JywgJyNF
RUVFRUUnCiAgIF0pOwoKLyoqCiAqIFRo
ZSBjdXJyZW50IGNvbG9yIHBhbGV0dGUs
IHBvc3NpYmx5IHdpdGggdXNlciBjaGFu
Z2VzLgogKi8KbGliLmNvbG9ycy5jb2xv
clBhbGV0dGUgPSBsaWIuY29sb3JzLnN0
b2NrQ29sb3JQYWxldHRlOwoKLyoqCiAq
IE5hbWVkIGNvbG9ycyBhY2NvcmRpbmcg
dG8gdGhlIHN0b2NrIFgxMSByZ2IudHh0
IGZpbGUuCiAqLwpsaWIuY29sb3JzLmNv
bG9yTmFtZXMgPSB7CiAgImFsaWNlYmx1
ZSI6ICJyZ2IoMjQwLCAyNDgsIDI1NSki
LAogICJhbnRpcXVld2hpdGUiOiAicmdi
KDI1MCwgMjM1LCAyMTUpIiwKICAiYW50
aXF1ZXdoaXRlMSI6ICJyZ2IoMjU1LCAy
MzksIDIxOSkiLAogICJhbnRpcXVld2hp
dGUyIjogInJnYigyMzgsIDIyMywgMjA0
KSIsCiAgImFudGlxdWV3aGl0ZTMiOiAi
cmdiKDIwNSwgMTkyLCAxNzYpIiwKICAi
YW50aXF1ZXdoaXRlNCI6ICJyZ2IoMTM5
LCAxMzEsIDEyMCkiLAogICJhcXVhbWFy
aW5lIjogInJnYigxMjcsIDI1NSwgMjEy
KSIsCiAgImFxdWFtYXJpbmUxIjogInJn
YigxMjcsIDI1NSwgMjEyKSIsCiAgImFx
dWFtYXJpbmUyIjogInJnYigxMTgsIDIz
OCwgMTk4KSIsCiAgImFxdWFtYXJpbmUz
IjogInJnYigxMDIsIDIwNSwgMTcwKSIs
CiAgImFxdWFtYXJpbmU0IjogInJnYig2
OSwgMTM5LCAxMTYpIiwKICAiYXp1cmUi
OiAicmdiKDI0MCwgMjU1LCAyNTUpIiwK
ICAiYXp1cmUxIjogInJnYigyNDAsIDI1
NSwgMjU1KSIsCiAgImF6dXJlMiI6ICJy
Z2IoMjI0LCAyMzgsIDIzOCkiLAogICJh
enVyZTMiOiAicmdiKDE5MywgMjA1LCAy
MDUpIiwKICAiYXp1cmU0IjogInJnYigx
MzEsIDEzOSwgMTM5KSIsCiAgImJlaWdl
IjogInJnYigyNDUsIDI0NSwgMjIwKSIs
CiAgImJpc3F1ZSI6ICJyZ2IoMjU1LCAy
MjgsIDE5NikiLAogICJiaXNxdWUxIjog
InJnYigyNTUsIDIyOCwgMTk2KSIsCiAg
ImJpc3F1ZTIiOiAicmdiKDIzOCwgMjEz
LCAxODMpIiwKICAiYmlzcXVlMyI6ICJy
Z2IoMjA1LCAxODMsIDE1OCkiLAogICJi
aXNxdWU0IjogInJnYigxMzksIDEyNSwg
MTA3KSIsCiAgImJsYWNrIjogInJnYigw
LCAwLCAwKSIsCiAgImJsYW5jaGVkYWxt
b25kIjogInJnYigyNTUsIDIzNSwgMjA1
KSIsCiAgImJsdWUiOiAicmdiKDAsIDAs
IDI1NSkiLAogICJibHVlMSI6ICJyZ2Io
MCwgMCwgMjU1KSIsCiAgImJsdWUyIjog
InJnYigwLCAwLCAyMzgpIiwKICAiYmx1
ZTMiOiAicmdiKDAsIDAsIDIwNSkiLAog
ICJibHVlNCI6ICJyZ2IoMCwgMCwgMTM5
KSIsCiAgImJsdWV2aW9sZXQiOiAicmdi
KDEzOCwgNDMsIDIyNikiLAogICJicm93
biI6ICJyZ2IoMTY1LCA0MiwgNDIpIiwK
ICAiYnJvd24xIjogInJnYigyNTUsIDY0
LCA2NCkiLAogICJicm93bjIiOiAicmdi
KDIzOCwgNTksIDU5KSIsCiAgImJyb3du
MyI6ICJyZ2IoMjA1LCA1MSwgNTEpIiwK
ICAiYnJvd240IjogInJnYigxMzksIDM1
LCAzNSkiLAogICJidXJseXdvb2QiOiAi
cmdiKDIyMiwgMTg0LCAxMzUpIiwKICAi
YnVybHl3b29kMSI6ICJyZ2IoMjU1LCAy
MTEsIDE1NSkiLAogICJidXJseXdvb2Qy
IjogInJnYigyMzgsIDE5NywgMTQ1KSIs
CiAgImJ1cmx5d29vZDMiOiAicmdiKDIw
NSwgMTcwLCAxMjUpIiwKICAiYnVybHl3
b29kNCI6ICJyZ2IoMTM5LCAxMTUsIDg1
KSIsCiAgImNhZGV0Ymx1ZSI6ICJyZ2Io
OTUsIDE1OCwgMTYwKSIsCiAgImNhZGV0
Ymx1ZTEiOiAicmdiKDE1MiwgMjQ1LCAy
NTUpIiwKICAiY2FkZXRibHVlMiI6ICJy
Z2IoMTQyLCAyMjksIDIzOCkiLAogICJj
YWRldGJsdWUzIjogInJnYigxMjIsIDE5
NywgMjA1KSIsCiAgImNhZGV0Ymx1ZTQi
OiAicmdiKDgzLCAxMzQsIDEzOSkiLAog
ICJjaGFydHJldXNlIjogInJnYigxMjcs
IDI1NSwgMCkiLAogICJjaGFydHJldXNl
MSI6ICJyZ2IoMTI3LCAyNTUsIDApIiwK
ICAiY2hhcnRyZXVzZTIiOiAicmdiKDEx
OCwgMjM4LCAwKSIsCiAgImNoYXJ0cmV1
c2UzIjogInJnYigxMDIsIDIwNSwgMCki
LAogICJjaGFydHJldXNlNCI6ICJyZ2Io
NjksIDEzOSwgMCkiLAogICJjaG9jb2xh
dGUiOiAicmdiKDIxMCwgMTA1LCAzMCki
LAogICJjaG9jb2xhdGUxIjogInJnYigy
NTUsIDEyNywgMzYpIiwKICAiY2hvY29s
YXRlMiI6ICJyZ2IoMjM4LCAxMTgsIDMz
KSIsCiAgImNob2NvbGF0ZTMiOiAicmdi
KDIwNSwgMTAyLCAyOSkiLAogICJjaG9j
b2xhdGU0IjogInJnYigxMzksIDY5LCAx
OSkiLAogICJjb3JhbCI6ICJyZ2IoMjU1
LCAxMjcsIDgwKSIsCiAgImNvcmFsMSI6
ICJyZ2IoMjU1LCAxMTQsIDg2KSIsCiAg
ImNvcmFsMiI6ICJyZ2IoMjM4LCAxMDYs
IDgwKSIsCiAgImNvcmFsMyI6ICJyZ2Io
MjA1LCA5MSwgNjkpIiwKICAiY29yYWw0
IjogInJnYigxMzksIDYyLCA0NykiLAog
ICJjb3JuZmxvd2VyYmx1ZSI6ICJyZ2Io
MTAwLCAxNDksIDIzNykiLAogICJjb3Ju
c2lsayI6ICJyZ2IoMjU1LCAyNDgsIDIy
MCkiLAogICJjb3Juc2lsazEiOiAicmdi
KDI1NSwgMjQ4LCAyMjApIiwKICAiY29y
bnNpbGsyIjogInJnYigyMzgsIDIzMiwg
MjA1KSIsCiAgImNvcm5zaWxrMyI6ICJy
Z2IoMjA1LCAyMDAsIDE3NykiLAogICJj
b3Juc2lsazQiOiAicmdiKDEzOSwgMTM2
LCAxMjApIiwKICAiY3lhbiI6ICJyZ2Io
MCwgMjU1LCAyNTUpIiwKICAiY3lhbjEi
OiAicmdiKDAsIDI1NSwgMjU1KSIsCiAg
ImN5YW4yIjogInJnYigwLCAyMzgsIDIz
OCkiLAogICJjeWFuMyI6ICJyZ2IoMCwg
MjA1LCAyMDUpIiwKICAiY3lhbjQiOiAi
cmdiKDAsIDEzOSwgMTM5KSIsCiAgImRh
cmtibHVlIjogInJnYigwLCAwLCAxMzkp
IiwKICAiZGFya2N5YW4iOiAicmdiKDAs
IDEzOSwgMTM5KSIsCiAgImRhcmtnb2xk
ZW5yb2QiOiAicmdiKDE4NCwgMTM0LCAx
MSkiLAogICJkYXJrZ29sZGVucm9kMSI6
ICJyZ2IoMjU1LCAxODUsIDE1KSIsCiAg
ImRhcmtnb2xkZW5yb2QyIjogInJnYigy
MzgsIDE3MywgMTQpIiwKICAiZGFya2dv
bGRlbnJvZDMiOiAicmdiKDIwNSwgMTQ5
LCAxMikiLAogICJkYXJrZ29sZGVucm9k
NCI6ICJyZ2IoMTM5LCAxMDEsIDgpIiwK
ICAiZGFya2dyYXkiOiAicmdiKDE2OSwg
MTY5LCAxNjkpIiwKICAiZGFya2dyZWVu
IjogInJnYigwLCAxMDAsIDApIiwKICAi
ZGFya2dyZXkiOiAicmdiKDE2OSwgMTY5
LCAxNjkpIiwKICAiZGFya2toYWtpIjog
InJnYigxODksIDE4MywgMTA3KSIsCiAg
ImRhcmttYWdlbnRhIjogInJnYigxMzks
IDAsIDEzOSkiLAogICJkYXJrb2xpdmVn
cmVlbiI6ICJyZ2IoODUsIDEwNywgNDcp
IiwKICAiZGFya29saXZlZ3JlZW4xIjog
InJnYigyMDIsIDI1NSwgMTEyKSIsCiAg
ImRhcmtvbGl2ZWdyZWVuMiI6ICJyZ2Io
MTg4LCAyMzgsIDEwNCkiLAogICJkYXJr
b2xpdmVncmVlbjMiOiAicmdiKDE2Miwg
MjA1LCA5MCkiLAogICJkYXJrb2xpdmVn
cmVlbjQiOiAicmdiKDExMCwgMTM5LCA2
MSkiLAogICJkYXJrb3JhbmdlIjogInJn
YigyNTUsIDE0MCwgMCkiLAogICJkYXJr
b3JhbmdlMSI6ICJyZ2IoMjU1LCAxMjcs
IDApIiwKICAiZGFya29yYW5nZTIiOiAi
cmdiKDIzOCwgMTE4LCAwKSIsCiAgImRh
cmtvcmFuZ2UzIjogInJnYigyMDUsIDEw
MiwgMCkiLAogICJkYXJrb3JhbmdlNCI6
ICJyZ2IoMTM5LCA2OSwgMCkiLAogICJk
YXJrb3JjaGlkIjogInJnYigxNTMsIDUw
LCAyMDQpIiwKICAiZGFya29yY2hpZDEi
OiAicmdiKDE5MSwgNjIsIDI1NSkiLAog
ICJkYXJrb3JjaGlkMiI6ICJyZ2IoMTc4
LCA1OCwgMjM4KSIsCiAgImRhcmtvcmNo
aWQzIjogInJnYigxNTQsIDUwLCAyMDUp
IiwKICAiZGFya29yY2hpZDQiOiAicmdi
KDEwNCwgMzQsIDEzOSkiLAogICJkYXJr
cmVkIjogInJnYigxMzksIDAsIDApIiwK
ICAiZGFya3NhbG1vbiI6ICJyZ2IoMjMz
LCAxNTAsIDEyMikiLAogICJkYXJrc2Vh
Z3JlZW4iOiAicmdiKDE0MywgMTg4LCAx
NDMpIiwKICAiZGFya3NlYWdyZWVuMSI6
ICJyZ2IoMTkzLCAyNTUsIDE5MykiLAog
ICJkYXJrc2VhZ3JlZW4yIjogInJnYigx
ODAsIDIzOCwgMTgwKSIsCiAgImRhcmtz
ZWFncmVlbjMiOiAicmdiKDE1NSwgMjA1
LCAxNTUpIiwKICAiZGFya3NlYWdyZWVu
NCI6ICJyZ2IoMTA1LCAxMzksIDEwNSki
LAogICJkYXJrc2xhdGVibHVlIjogInJn
Yig3MiwgNjEsIDEzOSkiLAogICJkYXJr
c2xhdGVncmF5IjogInJnYig0NywgNzks
IDc5KSIsCiAgImRhcmtzbGF0ZWdyYXkx
IjogInJnYigxNTEsIDI1NSwgMjU1KSIs
CiAgImRhcmtzbGF0ZWdyYXkyIjogInJn
YigxNDEsIDIzOCwgMjM4KSIsCiAgImRh
cmtzbGF0ZWdyYXkzIjogInJnYigxMjEs
IDIwNSwgMjA1KSIsCiAgImRhcmtzbGF0
ZWdyYXk0IjogInJnYig4MiwgMTM5LCAx
MzkpIiwKICAiZGFya3NsYXRlZ3JleSI6
ICJyZ2IoNDcsIDc5LCA3OSkiLAogICJk
YXJrdHVycXVvaXNlIjogInJnYigwLCAy
MDYsIDIwOSkiLAogICJkYXJrdmlvbGV0
IjogInJnYigxNDgsIDAsIDIxMSkiLAog
ICJkZWJpYW5yZWQiOiAicmdiKDIxNSwg
NywgODEpIiwKICAiZGVlcHBpbmsiOiAi
cmdiKDI1NSwgMjAsIDE0NykiLAogICJk
ZWVwcGluazEiOiAicmdiKDI1NSwgMjAs
IDE0NykiLAogICJkZWVwcGluazIiOiAi
cmdiKDIzOCwgMTgsIDEzNykiLAogICJk
ZWVwcGluazMiOiAicmdiKDIwNSwgMTYs
IDExOCkiLAogICJkZWVwcGluazQiOiAi
cmdiKDEzOSwgMTAsIDgwKSIsCiAgImRl
ZXBza3libHVlIjogInJnYigwLCAxOTEs
IDI1NSkiLAogICJkZWVwc2t5Ymx1ZTEi
OiAicmdiKDAsIDE5MSwgMjU1KSIsCiAg
ImRlZXBza3libHVlMiI6ICJyZ2IoMCwg
MTc4LCAyMzgpIiwKICAiZGVlcHNreWJs
dWUzIjogInJnYigwLCAxNTQsIDIwNSki
LAogICJkZWVwc2t5Ymx1ZTQiOiAicmdi
KDAsIDEwNCwgMTM5KSIsCiAgImRpbWdy
YXkiOiAicmdiKDEwNSwgMTA1LCAxMDUp
IiwKICAiZGltZ3JleSI6ICJyZ2IoMTA1
LCAxMDUsIDEwNSkiLAogICJkb2RnZXJi
bHVlIjogInJnYigzMCwgMTQ0LCAyNTUp
IiwKICAiZG9kZ2VyYmx1ZTEiOiAicmdi
KDMwLCAxNDQsIDI1NSkiLAogICJkb2Rn
ZXJibHVlMiI6ICJyZ2IoMjgsIDEzNCwg
MjM4KSIsCiAgImRvZGdlcmJsdWUzIjog
InJnYigyNCwgMTE2LCAyMDUpIiwKICAi
ZG9kZ2VyYmx1ZTQiOiAicmdiKDE2LCA3
OCwgMTM5KSIsCiAgImZpcmVicmljayI6
ICJyZ2IoMTc4LCAzNCwgMzQpIiwKICAi
ZmlyZWJyaWNrMSI6ICJyZ2IoMjU1LCA0
OCwgNDgpIiwKICAiZmlyZWJyaWNrMiI6
ICJyZ2IoMjM4LCA0NCwgNDQpIiwKICAi
ZmlyZWJyaWNrMyI6ICJyZ2IoMjA1LCAz
OCwgMzgpIiwKICAiZmlyZWJyaWNrNCI6
ICJyZ2IoMTM5LCAyNiwgMjYpIiwKICAi
ZmxvcmFsd2hpdGUiOiAicmdiKDI1NSwg
MjUwLCAyNDApIiwKICAiZm9yZXN0Z3Jl
ZW4iOiAicmdiKDM0LCAxMzksIDM0KSIs
CiAgImdhaW5zYm9ybyI6ICJyZ2IoMjIw
LCAyMjAsIDIyMCkiLAogICJnaG9zdHdo
aXRlIjogInJnYigyNDgsIDI0OCwgMjU1
KSIsCiAgImdvbGQiOiAicmdiKDI1NSwg
MjE1LCAwKSIsCiAgImdvbGQxIjogInJn
YigyNTUsIDIxNSwgMCkiLAogICJnb2xk
MiI6ICJyZ2IoMjM4LCAyMDEsIDApIiwK
ICAiZ29sZDMiOiAicmdiKDIwNSwgMTcz
LCAwKSIsCiAgImdvbGQ0IjogInJnYigx
MzksIDExNywgMCkiLAogICJnb2xkZW5y
b2QiOiAicmdiKDIxOCwgMTY1LCAzMiki
LAogICJnb2xkZW5yb2QxIjogInJnYigy
NTUsIDE5MywgMzcpIiwKICAiZ29sZGVu
cm9kMiI6ICJyZ2IoMjM4LCAxODAsIDM0
KSIsCiAgImdvbGRlbnJvZDMiOiAicmdi
KDIwNSwgMTU1LCAyOSkiLAogICJnb2xk
ZW5yb2Q0IjogInJnYigxMzksIDEwNSwg
MjApIiwKICAiZ3JheSI6ICJyZ2IoMTkw
LCAxOTAsIDE5MCkiLAogICJncmF5MCI6
ICJyZ2IoMCwgMCwgMCkiLAogICJncmF5
MSI6ICJyZ2IoMywgMywgMykiLAogICJn
cmF5MTAiOiAicmdiKDI2LCAyNiwgMjYp
IiwKICAiZ3JheTEwMCI6ICJyZ2IoMjU1
LCAyNTUsIDI1NSkiLAogICJncmF5MTEi
OiAicmdiKDI4LCAyOCwgMjgpIiwKICAi
Z3JheTEyIjogInJnYigzMSwgMzEsIDMx
KSIsCiAgImdyYXkxMyI6ICJyZ2IoMzMs
IDMzLCAzMykiLAogICJncmF5MTQiOiAi
cmdiKDM2LCAzNiwgMzYpIiwKICAiZ3Jh
eTE1IjogInJnYigzOCwgMzgsIDM4KSIs
CiAgImdyYXkxNiI6ICJyZ2IoNDEsIDQx
LCA0MSkiLAogICJncmF5MTciOiAicmdi
KDQzLCA0MywgNDMpIiwKICAiZ3JheTE4
IjogInJnYig0NiwgNDYsIDQ2KSIsCiAg
ImdyYXkxOSI6ICJyZ2IoNDgsIDQ4LCA0
OCkiLAogICJncmF5MiI6ICJyZ2IoNSwg
NSwgNSkiLAogICJncmF5MjAiOiAicmdi
KDUxLCA1MSwgNTEpIiwKICAiZ3JheTIx
IjogInJnYig1NCwgNTQsIDU0KSIsCiAg
ImdyYXkyMiI6ICJyZ2IoNTYsIDU2LCA1
NikiLAogICJncmF5MjMiOiAicmdiKDU5
LCA1OSwgNTkpIiwKICAiZ3JheTI0Ijog
InJnYig2MSwgNjEsIDYxKSIsCiAgImdy
YXkyNSI6ICJyZ2IoNjQsIDY0LCA2NCki
LAogICJncmF5MjYiOiAicmdiKDY2LCA2
NiwgNjYpIiwKICAiZ3JheTI3IjogInJn
Yig2OSwgNjksIDY5KSIsCiAgImdyYXky
OCI6ICJyZ2IoNzEsIDcxLCA3MSkiLAog
ICJncmF5MjkiOiAicmdiKDc0LCA3NCwg
NzQpIiwKICAiZ3JheTMiOiAicmdiKDgs
IDgsIDgpIiwKICAiZ3JheTMwIjogInJn
Yig3NywgNzcsIDc3KSIsCiAgImdyYXkz
MSI6ICJyZ2IoNzksIDc5LCA3OSkiLAog
ICJncmF5MzIiOiAicmdiKDgyLCA4Miwg
ODIpIiwKICAiZ3JheTMzIjogInJnYig4
NCwgODQsIDg0KSIsCiAgImdyYXkzNCI6
ICJyZ2IoODcsIDg3LCA4NykiLAogICJn
cmF5MzUiOiAicmdiKDg5LCA4OSwgODkp
IiwKICAiZ3JheTM2IjogInJnYig5Miwg
OTIsIDkyKSIsCiAgImdyYXkzNyI6ICJy
Z2IoOTQsIDk0LCA5NCkiLAogICJncmF5
MzgiOiAicmdiKDk3LCA5NywgOTcpIiwK
ICAiZ3JheTM5IjogInJnYig5OSwgOTks
IDk5KSIsCiAgImdyYXk0IjogInJnYigx
MCwgMTAsIDEwKSIsCiAgImdyYXk0MCI6
ICJyZ2IoMTAyLCAxMDIsIDEwMikiLAog
ICJncmF5NDEiOiAicmdiKDEwNSwgMTA1
LCAxMDUpIiwKICAiZ3JheTQyIjogInJn
YigxMDcsIDEwNywgMTA3KSIsCiAgImdy
YXk0MyI6ICJyZ2IoMTEwLCAxMTAsIDEx
MCkiLAogICJncmF5NDQiOiAicmdiKDEx
MiwgMTEyLCAxMTIpIiwKICAiZ3JheTQ1
IjogInJnYigxMTUsIDExNSwgMTE1KSIs
CiAgImdyYXk0NiI6ICJyZ2IoMTE3LCAx
MTcsIDExNykiLAogICJncmF5NDciOiAi
cmdiKDEyMCwgMTIwLCAxMjApIiwKICAi
Z3JheTQ4IjogInJnYigxMjIsIDEyMiwg
MTIyKSIsCiAgImdyYXk0OSI6ICJyZ2Io
MTI1LCAxMjUsIDEyNSkiLAogICJncmF5
NSI6ICJyZ2IoMTMsIDEzLCAxMykiLAog
ICJncmF5NTAiOiAicmdiKDEyNywgMTI3
LCAxMjcpIiwKICAiZ3JheTUxIjogInJn
YigxMzAsIDEzMCwgMTMwKSIsCiAgImdy
YXk1MiI6ICJyZ2IoMTMzLCAxMzMsIDEz
MykiLAogICJncmF5NTMiOiAicmdiKDEz
NSwgMTM1LCAxMzUpIiwKICAiZ3JheTU0
IjogInJnYigxMzgsIDEzOCwgMTM4KSIs
CiAgImdyYXk1NSI6ICJyZ2IoMTQwLCAx
NDAsIDE0MCkiLAogICJncmF5NTYiOiAi
cmdiKDE0MywgMTQzLCAxNDMpIiwKICAi
Z3JheTU3IjogInJnYigxNDUsIDE0NSwg
MTQ1KSIsCiAgImdyYXk1OCI6ICJyZ2Io
MTQ4LCAxNDgsIDE0OCkiLAogICJncmF5
NTkiOiAicmdiKDE1MCwgMTUwLCAxNTAp
IiwKICAiZ3JheTYiOiAicmdiKDE1LCAx
NSwgMTUpIiwKICAiZ3JheTYwIjogInJn
YigxNTMsIDE1MywgMTUzKSIsCiAgImdy
YXk2MSI6ICJyZ2IoMTU2LCAxNTYsIDE1
NikiLAogICJncmF5NjIiOiAicmdiKDE1
OCwgMTU4LCAxNTgpIiwKICAiZ3JheTYz
IjogInJnYigxNjEsIDE2MSwgMTYxKSIs
CiAgImdyYXk2NCI6ICJyZ2IoMTYzLCAx
NjMsIDE2MykiLAogICJncmF5NjUiOiAi
cmdiKDE2NiwgMTY2LCAxNjYpIiwKICAi
Z3JheTY2IjogInJnYigxNjgsIDE2OCwg
MTY4KSIsCiAgImdyYXk2NyI6ICJyZ2Io
MTcxLCAxNzEsIDE3MSkiLAogICJncmF5
NjgiOiAicmdiKDE3MywgMTczLCAxNzMp
IiwKICAiZ3JheTY5IjogInJnYigxNzYs
IDE3NiwgMTc2KSIsCiAgImdyYXk3Ijog
InJnYigxOCwgMTgsIDE4KSIsCiAgImdy
YXk3MCI6ICJyZ2IoMTc5LCAxNzksIDE3
OSkiLAogICJncmF5NzEiOiAicmdiKDE4
MSwgMTgxLCAxODEpIiwKICAiZ3JheTcy
IjogInJnYigxODQsIDE4NCwgMTg0KSIs
CiAgImdyYXk3MyI6ICJyZ2IoMTg2LCAx
ODYsIDE4NikiLAogICJncmF5NzQiOiAi
cmdiKDE4OSwgMTg5LCAxODkpIiwKICAi
Z3JheTc1IjogInJnYigxOTEsIDE5MSwg
MTkxKSIsCiAgImdyYXk3NiI6ICJyZ2Io
MTk0LCAxOTQsIDE5NCkiLAogICJncmF5
NzciOiAicmdiKDE5NiwgMTk2LCAxOTYp
IiwKICAiZ3JheTc4IjogInJnYigxOTks
IDE5OSwgMTk5KSIsCiAgImdyYXk3OSI6
ICJyZ2IoMjAxLCAyMDEsIDIwMSkiLAog
ICJncmF5OCI6ICJyZ2IoMjAsIDIwLCAy
MCkiLAogICJncmF5ODAiOiAicmdiKDIw
NCwgMjA0LCAyMDQpIiwKICAiZ3JheTgx
IjogInJnYigyMDcsIDIwNywgMjA3KSIs
CiAgImdyYXk4MiI6ICJyZ2IoMjA5LCAy
MDksIDIwOSkiLAogICJncmF5ODMiOiAi
cmdiKDIxMiwgMjEyLCAyMTIpIiwKICAi
Z3JheTg0IjogInJnYigyMTQsIDIxNCwg
MjE0KSIsCiAgImdyYXk4NSI6ICJyZ2Io
MjE3LCAyMTcsIDIxNykiLAogICJncmF5
ODYiOiAicmdiKDIxOSwgMjE5LCAyMTkp
IiwKICAiZ3JheTg3IjogInJnYigyMjIs
IDIyMiwgMjIyKSIsCiAgImdyYXk4OCI6
ICJyZ2IoMjI0LCAyMjQsIDIyNCkiLAog
ICJncmF5ODkiOiAicmdiKDIyNywgMjI3
LCAyMjcpIiwKICAiZ3JheTkiOiAicmdi
KDIzLCAyMywgMjMpIiwKICAiZ3JheTkw
IjogInJnYigyMjksIDIyOSwgMjI5KSIs
CiAgImdyYXk5MSI6ICJyZ2IoMjMyLCAy
MzIsIDIzMikiLAogICJncmF5OTIiOiAi
cmdiKDIzNSwgMjM1LCAyMzUpIiwKICAi
Z3JheTkzIjogInJnYigyMzcsIDIzNywg
MjM3KSIsCiAgImdyYXk5NCI6ICJyZ2Io
MjQwLCAyNDAsIDI0MCkiLAogICJncmF5
OTUiOiAicmdiKDI0MiwgMjQyLCAyNDIp
IiwKICAiZ3JheTk2IjogInJnYigyNDUs
IDI0NSwgMjQ1KSIsCiAgImdyYXk5NyI6
ICJyZ2IoMjQ3LCAyNDcsIDI0NykiLAog
ICJncmF5OTgiOiAicmdiKDI1MCwgMjUw
LCAyNTApIiwKICAiZ3JheTk5IjogInJn
YigyNTIsIDI1MiwgMjUyKSIsCiAgImdy
ZWVuIjogInJnYigwLCAyNTUsIDApIiwK
ICAiZ3JlZW4xIjogInJnYigwLCAyNTUs
IDApIiwKICAiZ3JlZW4yIjogInJnYigw
LCAyMzgsIDApIiwKICAiZ3JlZW4zIjog
InJnYigwLCAyMDUsIDApIiwKICAiZ3Jl
ZW40IjogInJnYigwLCAxMzksIDApIiwK
ICAiZ3JlZW55ZWxsb3ciOiAicmdiKDE3
MywgMjU1LCA0NykiLAogICJncmV5Ijog
InJnYigxOTAsIDE5MCwgMTkwKSIsCiAg
ImdyZXkwIjogInJnYigwLCAwLCAwKSIs
CiAgImdyZXkxIjogInJnYigzLCAzLCAz
KSIsCiAgImdyZXkxMCI6ICJyZ2IoMjYs
IDI2LCAyNikiLAogICJncmV5MTAwIjog
InJnYigyNTUsIDI1NSwgMjU1KSIsCiAg
ImdyZXkxMSI6ICJyZ2IoMjgsIDI4LCAy
OCkiLAogICJncmV5MTIiOiAicmdiKDMx
LCAzMSwgMzEpIiwKICAiZ3JleTEzIjog
InJnYigzMywgMzMsIDMzKSIsCiAgImdy
ZXkxNCI6ICJyZ2IoMzYsIDM2LCAzNiki
LAogICJncmV5MTUiOiAicmdiKDM4LCAz
OCwgMzgpIiwKICAiZ3JleTE2IjogInJn
Yig0MSwgNDEsIDQxKSIsCiAgImdyZXkx
NyI6ICJyZ2IoNDMsIDQzLCA0MykiLAog
ICJncmV5MTgiOiAicmdiKDQ2LCA0Niwg
NDYpIiwKICAiZ3JleTE5IjogInJnYig0
OCwgNDgsIDQ4KSIsCiAgImdyZXkyIjog
InJnYig1LCA1LCA1KSIsCiAgImdyZXky
MCI6ICJyZ2IoNTEsIDUxLCA1MSkiLAog
ICJncmV5MjEiOiAicmdiKDU0LCA1NCwg
NTQpIiwKICAiZ3JleTIyIjogInJnYig1
NiwgNTYsIDU2KSIsCiAgImdyZXkyMyI6
ICJyZ2IoNTksIDU5LCA1OSkiLAogICJn
cmV5MjQiOiAicmdiKDYxLCA2MSwgNjEp
IiwKICAiZ3JleTI1IjogInJnYig2NCwg
NjQsIDY0KSIsCiAgImdyZXkyNiI6ICJy
Z2IoNjYsIDY2LCA2NikiLAogICJncmV5
MjciOiAicmdiKDY5LCA2OSwgNjkpIiwK
ICAiZ3JleTI4IjogInJnYig3MSwgNzEs
IDcxKSIsCiAgImdyZXkyOSI6ICJyZ2Io
NzQsIDc0LCA3NCkiLAogICJncmV5MyI6
ICJyZ2IoOCwgOCwgOCkiLAogICJncmV5
MzAiOiAicmdiKDc3LCA3NywgNzcpIiwK
ICAiZ3JleTMxIjogInJnYig3OSwgNzks
IDc5KSIsCiAgImdyZXkzMiI6ICJyZ2Io
ODIsIDgyLCA4MikiLAogICJncmV5MzMi
OiAicmdiKDg0LCA4NCwgODQpIiwKICAi
Z3JleTM0IjogInJnYig4NywgODcsIDg3
KSIsCiAgImdyZXkzNSI6ICJyZ2IoODks
IDg5LCA4OSkiLAogICJncmV5MzYiOiAi
cmdiKDkyLCA5MiwgOTIpIiwKICAiZ3Jl
eTM3IjogInJnYig5NCwgOTQsIDk0KSIs
CiAgImdyZXkzOCI6ICJyZ2IoOTcsIDk3
LCA5NykiLAogICJncmV5MzkiOiAicmdi
KDk5LCA5OSwgOTkpIiwKICAiZ3JleTQi
OiAicmdiKDEwLCAxMCwgMTApIiwKICAi
Z3JleTQwIjogInJnYigxMDIsIDEwMiwg
MTAyKSIsCiAgImdyZXk0MSI6ICJyZ2Io
MTA1LCAxMDUsIDEwNSkiLAogICJncmV5
NDIiOiAicmdiKDEwNywgMTA3LCAxMDcp
IiwKICAiZ3JleTQzIjogInJnYigxMTAs
IDExMCwgMTEwKSIsCiAgImdyZXk0NCI6
ICJyZ2IoMTEyLCAxMTIsIDExMikiLAog
ICJncmV5NDUiOiAicmdiKDExNSwgMTE1
LCAxMTUpIiwKICAiZ3JleTQ2IjogInJn
YigxMTcsIDExNywgMTE3KSIsCiAgImdy
ZXk0NyI6ICJyZ2IoMTIwLCAxMjAsIDEy
MCkiLAogICJncmV5NDgiOiAicmdiKDEy
MiwgMTIyLCAxMjIpIiwKICAiZ3JleTQ5
IjogInJnYigxMjUsIDEyNSwgMTI1KSIs
CiAgImdyZXk1IjogInJnYigxMywgMTMs
IDEzKSIsCiAgImdyZXk1MCI6ICJyZ2Io
MTI3LCAxMjcsIDEyNykiLAogICJncmV5
NTEiOiAicmdiKDEzMCwgMTMwLCAxMzAp
IiwKICAiZ3JleTUyIjogInJnYigxMzMs
IDEzMywgMTMzKSIsCiAgImdyZXk1MyI6
ICJyZ2IoMTM1LCAxMzUsIDEzNSkiLAog
ICJncmV5NTQiOiAicmdiKDEzOCwgMTM4
LCAxMzgpIiwKICAiZ3JleTU1IjogInJn
YigxNDAsIDE0MCwgMTQwKSIsCiAgImdy
ZXk1NiI6ICJyZ2IoMTQzLCAxNDMsIDE0
MykiLAogICJncmV5NTciOiAicmdiKDE0
NSwgMTQ1LCAxNDUpIiwKICAiZ3JleTU4
IjogInJnYigxNDgsIDE0OCwgMTQ4KSIs
CiAgImdyZXk1OSI6ICJyZ2IoMTUwLCAx
NTAsIDE1MCkiLAogICJncmV5NiI6ICJy
Z2IoMTUsIDE1LCAxNSkiLAogICJncmV5
NjAiOiAicmdiKDE1MywgMTUzLCAxNTMp
IiwKICAiZ3JleTYxIjogInJnYigxNTYs
IDE1NiwgMTU2KSIsCiAgImdyZXk2MiI6
ICJyZ2IoMTU4LCAxNTgsIDE1OCkiLAog
ICJncmV5NjMiOiAicmdiKDE2MSwgMTYx
LCAxNjEpIiwKICAiZ3JleTY0IjogInJn
YigxNjMsIDE2MywgMTYzKSIsCiAgImdy
ZXk2NSI6ICJyZ2IoMTY2LCAxNjYsIDE2
NikiLAogICJncmV5NjYiOiAicmdiKDE2
OCwgMTY4LCAxNjgpIiwKICAiZ3JleTY3
IjogInJnYigxNzEsIDE3MSwgMTcxKSIs
CiAgImdyZXk2OCI6ICJyZ2IoMTczLCAx
NzMsIDE3MykiLAogICJncmV5NjkiOiAi
cmdiKDE3NiwgMTc2LCAxNzYpIiwKICAi
Z3JleTciOiAicmdiKDE4LCAxOCwgMTgp
IiwKICAiZ3JleTcwIjogInJnYigxNzks
IDE3OSwgMTc5KSIsCiAgImdyZXk3MSI6
ICJyZ2IoMTgxLCAxODEsIDE4MSkiLAog
ICJncmV5NzIiOiAicmdiKDE4NCwgMTg0
LCAxODQpIiwKICAiZ3JleTczIjogInJn
YigxODYsIDE4NiwgMTg2KSIsCiAgImdy
ZXk3NCI6ICJyZ2IoMTg5LCAxODksIDE4
OSkiLAogICJncmV5NzUiOiAicmdiKDE5
MSwgMTkxLCAxOTEpIiwKICAiZ3JleTc2
IjogInJnYigxOTQsIDE5NCwgMTk0KSIs
CiAgImdyZXk3NyI6ICJyZ2IoMTk2LCAx
OTYsIDE5NikiLAogICJncmV5NzgiOiAi
cmdiKDE5OSwgMTk5LCAxOTkpIiwKICAi
Z3JleTc5IjogInJnYigyMDEsIDIwMSwg
MjAxKSIsCiAgImdyZXk4IjogInJnYigy
MCwgMjAsIDIwKSIsCiAgImdyZXk4MCI6
ICJyZ2IoMjA0LCAyMDQsIDIwNCkiLAog
ICJncmV5ODEiOiAicmdiKDIwNywgMjA3
LCAyMDcpIiwKICAiZ3JleTgyIjogInJn
YigyMDksIDIwOSwgMjA5KSIsCiAgImdy
ZXk4MyI6ICJyZ2IoMjEyLCAyMTIsIDIx
MikiLAogICJncmV5ODQiOiAicmdiKDIx
NCwgMjE0LCAyMTQpIiwKICAiZ3JleTg1
IjogInJnYigyMTcsIDIxNywgMjE3KSIs
CiAgImdyZXk4NiI6ICJyZ2IoMjE5LCAy
MTksIDIxOSkiLAogICJncmV5ODciOiAi
cmdiKDIyMiwgMjIyLCAyMjIpIiwKICAi
Z3JleTg4IjogInJnYigyMjQsIDIyNCwg
MjI0KSIsCiAgImdyZXk4OSI6ICJyZ2Io
MjI3LCAyMjcsIDIyNykiLAogICJncmV5
OSI6ICJyZ2IoMjMsIDIzLCAyMykiLAog
ICJncmV5OTAiOiAicmdiKDIyOSwgMjI5
LCAyMjkpIiwKICAiZ3JleTkxIjogInJn
YigyMzIsIDIzMiwgMjMyKSIsCiAgImdy
ZXk5MiI6ICJyZ2IoMjM1LCAyMzUsIDIz
NSkiLAogICJncmV5OTMiOiAicmdiKDIz
NywgMjM3LCAyMzcpIiwKICAiZ3JleTk0
IjogInJnYigyNDAsIDI0MCwgMjQwKSIs
CiAgImdyZXk5NSI6ICJyZ2IoMjQyLCAy
NDIsIDI0MikiLAogICJncmV5OTYiOiAi
cmdiKDI0NSwgMjQ1LCAyNDUpIiwKICAi
Z3JleTk3IjogInJnYigyNDcsIDI0Nywg
MjQ3KSIsCiAgImdyZXk5OCI6ICJyZ2Io
MjUwLCAyNTAsIDI1MCkiLAogICJncmV5
OTkiOiAicmdiKDI1MiwgMjUyLCAyNTIp
IiwKICAiaG9uZXlkZXciOiAicmdiKDI0
MCwgMjU1LCAyNDApIiwKICAiaG9uZXlk
ZXcxIjogInJnYigyNDAsIDI1NSwgMjQw
KSIsCiAgImhvbmV5ZGV3MiI6ICJyZ2Io
MjI0LCAyMzgsIDIyNCkiLAogICJob25l
eWRldzMiOiAicmdiKDE5MywgMjA1LCAx
OTMpIiwKICAiaG9uZXlkZXc0IjogInJn
YigxMzEsIDEzOSwgMTMxKSIsCiAgImhv
dHBpbmsiOiAicmdiKDI1NSwgMTA1LCAx
ODApIiwKICAiaG90cGluazEiOiAicmdi
KDI1NSwgMTEwLCAxODApIiwKICAiaG90
cGluazIiOiAicmdiKDIzOCwgMTA2LCAx
NjcpIiwKICAiaG90cGluazMiOiAicmdi
KDIwNSwgOTYsIDE0NCkiLAogICJob3Rw
aW5rNCI6ICJyZ2IoMTM5LCA1OCwgOTgp
IiwKICAiaW5kaWFucmVkIjogInJnYigy
MDUsIDkyLCA5MikiLAogICJpbmRpYW5y
ZWQxIjogInJnYigyNTUsIDEwNiwgMTA2
KSIsCiAgImluZGlhbnJlZDIiOiAicmdi
KDIzOCwgOTksIDk5KSIsCiAgImluZGlh
bnJlZDMiOiAicmdiKDIwNSwgODUsIDg1
KSIsCiAgImluZGlhbnJlZDQiOiAicmdi
KDEzOSwgNTgsIDU4KSIsCiAgIml2b3J5
IjogInJnYigyNTUsIDI1NSwgMjQwKSIs
CiAgIml2b3J5MSI6ICJyZ2IoMjU1LCAy
NTUsIDI0MCkiLAogICJpdm9yeTIiOiAi
cmdiKDIzOCwgMjM4LCAyMjQpIiwKICAi
aXZvcnkzIjogInJnYigyMDUsIDIwNSwg
MTkzKSIsCiAgIml2b3J5NCI6ICJyZ2Io
MTM5LCAxMzksIDEzMSkiLAogICJraGFr
aSI6ICJyZ2IoMjQwLCAyMzAsIDE0MCki
LAogICJraGFraTEiOiAicmdiKDI1NSwg
MjQ2LCAxNDMpIiwKICAia2hha2kyIjog
InJnYigyMzgsIDIzMCwgMTMzKSIsCiAg
ImtoYWtpMyI6ICJyZ2IoMjA1LCAxOTgs
IDExNSkiLAogICJraGFraTQiOiAicmdi
KDEzOSwgMTM0LCA3OCkiLAogICJsYXZl
bmRlciI6ICJyZ2IoMjMwLCAyMzAsIDI1
MCkiLAogICJsYXZlbmRlcmJsdXNoIjog
InJnYigyNTUsIDI0MCwgMjQ1KSIsCiAg
ImxhdmVuZGVyYmx1c2gxIjogInJnYigy
NTUsIDI0MCwgMjQ1KSIsCiAgImxhdmVu
ZGVyYmx1c2gyIjogInJnYigyMzgsIDIy
NCwgMjI5KSIsCiAgImxhdmVuZGVyYmx1
c2gzIjogInJnYigyMDUsIDE5MywgMTk3
KSIsCiAgImxhdmVuZGVyYmx1c2g0Ijog
InJnYigxMzksIDEzMSwgMTM0KSIsCiAg
Imxhd25ncmVlbiI6ICJyZ2IoMTI0LCAy
NTIsIDApIiwKICAibGVtb25jaGlmZm9u
IjogInJnYigyNTUsIDI1MCwgMjA1KSIs
CiAgImxlbW9uY2hpZmZvbjEiOiAicmdi
KDI1NSwgMjUwLCAyMDUpIiwKICAibGVt
b25jaGlmZm9uMiI6ICJyZ2IoMjM4LCAy
MzMsIDE5MSkiLAogICJsZW1vbmNoaWZm
b24zIjogInJnYigyMDUsIDIwMSwgMTY1
KSIsCiAgImxlbW9uY2hpZmZvbjQiOiAi
cmdiKDEzOSwgMTM3LCAxMTIpIiwKICAi
bGlnaHRibHVlIjogInJnYigxNzMsIDIx
NiwgMjMwKSIsCiAgImxpZ2h0Ymx1ZTEi
OiAicmdiKDE5MSwgMjM5LCAyNTUpIiwK
ICAibGlnaHRibHVlMiI6ICJyZ2IoMTc4
LCAyMjMsIDIzOCkiLAogICJsaWdodGJs
dWUzIjogInJnYigxNTQsIDE5MiwgMjA1
KSIsCiAgImxpZ2h0Ymx1ZTQiOiAicmdi
KDEwNCwgMTMxLCAxMzkpIiwKICAibGln
aHRjb3JhbCI6ICJyZ2IoMjQwLCAxMjgs
IDEyOCkiLAogICJsaWdodGN5YW4iOiAi
cmdiKDIyNCwgMjU1LCAyNTUpIiwKICAi
bGlnaHRjeWFuMSI6ICJyZ2IoMjI0LCAy
NTUsIDI1NSkiLAogICJsaWdodGN5YW4y
IjogInJnYigyMDksIDIzOCwgMjM4KSIs
CiAgImxpZ2h0Y3lhbjMiOiAicmdiKDE4
MCwgMjA1LCAyMDUpIiwKICAibGlnaHRj
eWFuNCI6ICJyZ2IoMTIyLCAxMzksIDEz
OSkiLAogICJsaWdodGdvbGRlbnJvZCI6
ICJyZ2IoMjM4LCAyMjEsIDEzMCkiLAog
ICJsaWdodGdvbGRlbnJvZDEiOiAicmdi
KDI1NSwgMjM2LCAxMzkpIiwKICAibGln
aHRnb2xkZW5yb2QyIjogInJnYigyMzgs
IDIyMCwgMTMwKSIsCiAgImxpZ2h0Z29s
ZGVucm9kMyI6ICJyZ2IoMjA1LCAxOTAs
IDExMikiLAogICJsaWdodGdvbGRlbnJv
ZDQiOiAicmdiKDEzOSwgMTI5LCA3Niki
LAogICJsaWdodGdvbGRlbnJvZHllbGxv
dyI6ICJyZ2IoMjUwLCAyNTAsIDIxMCki
LAogICJsaWdodGdyYXkiOiAicmdiKDIx
MSwgMjExLCAyMTEpIiwKICAibGlnaHRn
cmVlbiI6ICJyZ2IoMTQ0LCAyMzgsIDE0
NCkiLAogICJsaWdodGdyZXkiOiAicmdi
KDIxMSwgMjExLCAyMTEpIiwKICAibGln
aHRwaW5rIjogInJnYigyNTUsIDE4Miwg
MTkzKSIsCiAgImxpZ2h0cGluazEiOiAi
cmdiKDI1NSwgMTc0LCAxODUpIiwKICAi
bGlnaHRwaW5rMiI6ICJyZ2IoMjM4LCAx
NjIsIDE3MykiLAogICJsaWdodHBpbmsz
IjogInJnYigyMDUsIDE0MCwgMTQ5KSIs
CiAgImxpZ2h0cGluazQiOiAicmdiKDEz
OSwgOTUsIDEwMSkiLAogICJsaWdodHNh
bG1vbiI6ICJyZ2IoMjU1LCAxNjAsIDEy
MikiLAogICJsaWdodHNhbG1vbjEiOiAi
cmdiKDI1NSwgMTYwLCAxMjIpIiwKICAi
bGlnaHRzYWxtb24yIjogInJnYigyMzgs
IDE0OSwgMTE0KSIsCiAgImxpZ2h0c2Fs
bW9uMyI6ICJyZ2IoMjA1LCAxMjksIDk4
KSIsCiAgImxpZ2h0c2FsbW9uNCI6ICJy
Z2IoMTM5LCA4NywgNjYpIiwKICAibGln
aHRzZWFncmVlbiI6ICJyZ2IoMzIsIDE3
OCwgMTcwKSIsCiAgImxpZ2h0c2t5Ymx1
ZSI6ICJyZ2IoMTM1LCAyMDYsIDI1MCki
LAogICJsaWdodHNreWJsdWUxIjogInJn
YigxNzYsIDIyNiwgMjU1KSIsCiAgImxp
Z2h0c2t5Ymx1ZTIiOiAicmdiKDE2NCwg
MjExLCAyMzgpIiwKICAibGlnaHRza3li
bHVlMyI6ICJyZ2IoMTQxLCAxODIsIDIw
NSkiLAogICJsaWdodHNreWJsdWU0Ijog
InJnYig5NiwgMTIzLCAxMzkpIiwKICAi
bGlnaHRzbGF0ZWJsdWUiOiAicmdiKDEz
MiwgMTEyLCAyNTUpIiwKICAibGlnaHRz
bGF0ZWdyYXkiOiAicmdiKDExOSwgMTM2
LCAxNTMpIiwKICAibGlnaHRzbGF0ZWdy
ZXkiOiAicmdiKDExOSwgMTM2LCAxNTMp
IiwKICAibGlnaHRzdGVlbGJsdWUiOiAi
cmdiKDE3NiwgMTk2LCAyMjIpIiwKICAi
bGlnaHRzdGVlbGJsdWUxIjogInJnYigy
MDIsIDIyNSwgMjU1KSIsCiAgImxpZ2h0
c3RlZWxibHVlMiI6ICJyZ2IoMTg4LCAy
MTAsIDIzOCkiLAogICJsaWdodHN0ZWVs
Ymx1ZTMiOiAicmdiKDE2MiwgMTgxLCAy
MDUpIiwKICAibGlnaHRzdGVlbGJsdWU0
IjogInJnYigxMTAsIDEyMywgMTM5KSIs
CiAgImxpZ2h0eWVsbG93IjogInJnYigy
NTUsIDI1NSwgMjI0KSIsCiAgImxpZ2h0
eWVsbG93MSI6ICJyZ2IoMjU1LCAyNTUs
IDIyNCkiLAogICJsaWdodHllbGxvdzIi
OiAicmdiKDIzOCwgMjM4LCAyMDkpIiwK
ICAibGlnaHR5ZWxsb3czIjogInJnYigy
MDUsIDIwNSwgMTgwKSIsCiAgImxpZ2h0
eWVsbG93NCI6ICJyZ2IoMTM5LCAxMzks
IDEyMikiLAogICJsaW1lZ3JlZW4iOiAi
cmdiKDUwLCAyMDUsIDUwKSIsCiAgImxp
bmVuIjogInJnYigyNTAsIDI0MCwgMjMw
KSIsCiAgIm1hZ2VudGEiOiAicmdiKDI1
NSwgMCwgMjU1KSIsCiAgIm1hZ2VudGEx
IjogInJnYigyNTUsIDAsIDI1NSkiLAog
ICJtYWdlbnRhMiI6ICJyZ2IoMjM4LCAw
LCAyMzgpIiwKICAibWFnZW50YTMiOiAi
cmdiKDIwNSwgMCwgMjA1KSIsCiAgIm1h
Z2VudGE0IjogInJnYigxMzksIDAsIDEz
OSkiLAogICJtYXJvb24iOiAicmdiKDE3
NiwgNDgsIDk2KSIsCiAgIm1hcm9vbjEi
OiAicmdiKDI1NSwgNTIsIDE3OSkiLAog
ICJtYXJvb24yIjogInJnYigyMzgsIDQ4
LCAxNjcpIiwKICAibWFyb29uMyI6ICJy
Z2IoMjA1LCA0MSwgMTQ0KSIsCiAgIm1h
cm9vbjQiOiAicmdiKDEzOSwgMjgsIDk4
KSIsCiAgIm1lZGl1bWFxdWFtYXJpbmUi
OiAicmdiKDEwMiwgMjA1LCAxNzApIiwK
ICAibWVkaXVtYmx1ZSI6ICJyZ2IoMCwg
MCwgMjA1KSIsCiAgIm1lZGl1bW9yY2hp
ZCI6ICJyZ2IoMTg2LCA4NSwgMjExKSIs
CiAgIm1lZGl1bW9yY2hpZDEiOiAicmdi
KDIyNCwgMTAyLCAyNTUpIiwKICAibWVk
aXVtb3JjaGlkMiI6ICJyZ2IoMjA5LCA5
NSwgMjM4KSIsCiAgIm1lZGl1bW9yY2hp
ZDMiOiAicmdiKDE4MCwgODIsIDIwNSki
LAogICJtZWRpdW1vcmNoaWQ0IjogInJn
YigxMjIsIDU1LCAxMzkpIiwKICAibWVk
aXVtcHVycGxlIjogInJnYigxNDcsIDEx
MiwgMjE5KSIsCiAgIm1lZGl1bXB1cnBs
ZTEiOiAicmdiKDE3MSwgMTMwLCAyNTUp
IiwKICAibWVkaXVtcHVycGxlMiI6ICJy
Z2IoMTU5LCAxMjEsIDIzOCkiLAogICJt
ZWRpdW1wdXJwbGUzIjogInJnYigxMzcs
IDEwNCwgMjA1KSIsCiAgIm1lZGl1bXB1
cnBsZTQiOiAicmdiKDkzLCA3MSwgMTM5
KSIsCiAgIm1lZGl1bXNlYWdyZWVuIjog
InJnYig2MCwgMTc5LCAxMTMpIiwKICAi
bWVkaXVtc2xhdGVibHVlIjogInJnYigx
MjMsIDEwNCwgMjM4KSIsCiAgIm1lZGl1
bXNwcmluZ2dyZWVuIjogInJnYigwLCAy
NTAsIDE1NCkiLAogICJtZWRpdW10dXJx
dW9pc2UiOiAicmdiKDcyLCAyMDksIDIw
NCkiLAogICJtZWRpdW12aW9sZXRyZWQi
OiAicmdiKDE5OSwgMjEsIDEzMykiLAog
ICJtaWRuaWdodGJsdWUiOiAicmdiKDI1
LCAyNSwgMTEyKSIsCiAgIm1pbnRjcmVh
bSI6ICJyZ2IoMjQ1LCAyNTUsIDI1MCki
LAogICJtaXN0eXJvc2UiOiAicmdiKDI1
NSwgMjI4LCAyMjUpIiwKICAibWlzdHly
b3NlMSI6ICJyZ2IoMjU1LCAyMjgsIDIy
NSkiLAogICJtaXN0eXJvc2UyIjogInJn
YigyMzgsIDIxMywgMjEwKSIsCiAgIm1p
c3R5cm9zZTMiOiAicmdiKDIwNSwgMTgz
LCAxODEpIiwKICAibWlzdHlyb3NlNCI6
ICJyZ2IoMTM5LCAxMjUsIDEyMykiLAog
ICJtb2NjYXNpbiI6ICJyZ2IoMjU1LCAy
MjgsIDE4MSkiLAogICJuYXZham93aGl0
ZSI6ICJyZ2IoMjU1LCAyMjIsIDE3Myki
LAogICJuYXZham93aGl0ZTEiOiAicmdi
KDI1NSwgMjIyLCAxNzMpIiwKICAibmF2
YWpvd2hpdGUyIjogInJnYigyMzgsIDIw
NywgMTYxKSIsCiAgIm5hdmFqb3doaXRl
MyI6ICJyZ2IoMjA1LCAxNzksIDEzOSki
LAogICJuYXZham93aGl0ZTQiOiAicmdi
KDEzOSwgMTIxLCA5NCkiLAogICJuYXZ5
IjogInJnYigwLCAwLCAxMjgpIiwKICAi
bmF2eWJsdWUiOiAicmdiKDAsIDAsIDEy
OCkiLAogICJvbGRsYWNlIjogInJnYigy
NTMsIDI0NSwgMjMwKSIsCiAgIm9saXZl
ZHJhYiI6ICJyZ2IoMTA3LCAxNDIsIDM1
KSIsCiAgIm9saXZlZHJhYjEiOiAicmdi
KDE5MiwgMjU1LCA2MikiLAogICJvbGl2
ZWRyYWIyIjogInJnYigxNzksIDIzOCwg
NTgpIiwKICAib2xpdmVkcmFiMyI6ICJy
Z2IoMTU0LCAyMDUsIDUwKSIsCiAgIm9s
aXZlZHJhYjQiOiAicmdiKDEwNSwgMTM5
LCAzNCkiLAogICJvcmFuZ2UiOiAicmdi
KDI1NSwgMTY1LCAwKSIsCiAgIm9yYW5n
ZTEiOiAicmdiKDI1NSwgMTY1LCAwKSIs
CiAgIm9yYW5nZTIiOiAicmdiKDIzOCwg
MTU0LCAwKSIsCiAgIm9yYW5nZTMiOiAi
cmdiKDIwNSwgMTMzLCAwKSIsCiAgIm9y
YW5nZTQiOiAicmdiKDEzOSwgOTAsIDAp
IiwKICAib3JhbmdlcmVkIjogInJnYigy
NTUsIDY5LCAwKSIsCiAgIm9yYW5nZXJl
ZDEiOiAicmdiKDI1NSwgNjksIDApIiwK
ICAib3JhbmdlcmVkMiI6ICJyZ2IoMjM4
LCA2NCwgMCkiLAogICJvcmFuZ2VyZWQz
IjogInJnYigyMDUsIDU1LCAwKSIsCiAg
Im9yYW5nZXJlZDQiOiAicmdiKDEzOSwg
MzcsIDApIiwKICAib3JjaGlkIjogInJn
YigyMTgsIDExMiwgMjE0KSIsCiAgIm9y
Y2hpZDEiOiAicmdiKDI1NSwgMTMxLCAy
NTApIiwKICAib3JjaGlkMiI6ICJyZ2Io
MjM4LCAxMjIsIDIzMykiLAogICJvcmNo
aWQzIjogInJnYigyMDUsIDEwNSwgMjAx
KSIsCiAgIm9yY2hpZDQiOiAicmdiKDEz
OSwgNzEsIDEzNykiLAogICJwYWxlZ29s
ZGVucm9kIjogInJnYigyMzgsIDIzMiwg
MTcwKSIsCiAgInBhbGVncmVlbiI6ICJy
Z2IoMTUyLCAyNTEsIDE1MikiLAogICJw
YWxlZ3JlZW4xIjogInJnYigxNTQsIDI1
NSwgMTU0KSIsCiAgInBhbGVncmVlbjIi
OiAicmdiKDE0NCwgMjM4LCAxNDQpIiwK
ICAicGFsZWdyZWVuMyI6ICJyZ2IoMTI0
LCAyMDUsIDEyNCkiLAogICJwYWxlZ3Jl
ZW40IjogInJnYig4NCwgMTM5LCA4NCki
LAogICJwYWxldHVycXVvaXNlIjogInJn
YigxNzUsIDIzOCwgMjM4KSIsCiAgInBh
bGV0dXJxdW9pc2UxIjogInJnYigxODcs
IDI1NSwgMjU1KSIsCiAgInBhbGV0dXJx
dW9pc2UyIjogInJnYigxNzQsIDIzOCwg
MjM4KSIsCiAgInBhbGV0dXJxdW9pc2Uz
IjogInJnYigxNTAsIDIwNSwgMjA1KSIs
CiAgInBhbGV0dXJxdW9pc2U0IjogInJn
YigxMDIsIDEzOSwgMTM5KSIsCiAgInBh
bGV2aW9sZXRyZWQiOiAicmdiKDIxOSwg
MTEyLCAxNDcpIiwKICAicGFsZXZpb2xl
dHJlZDEiOiAicmdiKDI1NSwgMTMwLCAx
NzEpIiwKICAicGFsZXZpb2xldHJlZDIi
OiAicmdiKDIzOCwgMTIxLCAxNTkpIiwK
ICAicGFsZXZpb2xldHJlZDMiOiAicmdi
KDIwNSwgMTA0LCAxMzcpIiwKICAicGFs
ZXZpb2xldHJlZDQiOiAicmdiKDEzOSwg
NzEsIDkzKSIsCiAgInBhcGF5YXdoaXAi
OiAicmdiKDI1NSwgMjM5LCAyMTMpIiwK
ICAicGVhY2hwdWZmIjogInJnYigyNTUs
IDIxOCwgMTg1KSIsCiAgInBlYWNocHVm
ZjEiOiAicmdiKDI1NSwgMjE4LCAxODUp
IiwKICAicGVhY2hwdWZmMiI6ICJyZ2Io
MjM4LCAyMDMsIDE3MykiLAogICJwZWFj
aHB1ZmYzIjogInJnYigyMDUsIDE3NSwg
MTQ5KSIsCiAgInBlYWNocHVmZjQiOiAi
cmdiKDEzOSwgMTE5LCAxMDEpIiwKICAi
cGVydSI6ICJyZ2IoMjA1LCAxMzMsIDYz
KSIsCiAgInBpbmsiOiAicmdiKDI1NSwg
MTkyLCAyMDMpIiwKICAicGluazEiOiAi
cmdiKDI1NSwgMTgxLCAxOTcpIiwKICAi
cGluazIiOiAicmdiKDIzOCwgMTY5LCAx
ODQpIiwKICAicGluazMiOiAicmdiKDIw
NSwgMTQ1LCAxNTgpIiwKICAicGluazQi
OiAicmdiKDEzOSwgOTksIDEwOCkiLAog
ICJwbHVtIjogInJnYigyMjEsIDE2MCwg
MjIxKSIsCiAgInBsdW0xIjogInJnYigy
NTUsIDE4NywgMjU1KSIsCiAgInBsdW0y
IjogInJnYigyMzgsIDE3NCwgMjM4KSIs
CiAgInBsdW0zIjogInJnYigyMDUsIDE1
MCwgMjA1KSIsCiAgInBsdW00IjogInJn
YigxMzksIDEwMiwgMTM5KSIsCiAgInBv
d2RlcmJsdWUiOiAicmdiKDE3NiwgMjI0
LCAyMzApIiwKICAicHVycGxlIjogInJn
YigxNjAsIDMyLCAyNDApIiwKICAicHVy
cGxlMSI6ICJyZ2IoMTU1LCA0OCwgMjU1
KSIsCiAgInB1cnBsZTIiOiAicmdiKDE0
NSwgNDQsIDIzOCkiLAogICJwdXJwbGUz
IjogInJnYigxMjUsIDM4LCAyMDUpIiwK
ICAicHVycGxlNCI6ICJyZ2IoODUsIDI2
LCAxMzkpIiwKICAicmVkIjogInJnYigy
NTUsIDAsIDApIiwKICAicmVkMSI6ICJy
Z2IoMjU1LCAwLCAwKSIsCiAgInJlZDIi
OiAicmdiKDIzOCwgMCwgMCkiLAogICJy
ZWQzIjogInJnYigyMDUsIDAsIDApIiwK
ICAicmVkNCI6ICJyZ2IoMTM5LCAwLCAw
KSIsCiAgInJvc3licm93biI6ICJyZ2Io
MTg4LCAxNDMsIDE0MykiLAogICJyb3N5
YnJvd24xIjogInJnYigyNTUsIDE5Mywg
MTkzKSIsCiAgInJvc3licm93bjIiOiAi
cmdiKDIzOCwgMTgwLCAxODApIiwKICAi
cm9zeWJyb3duMyI6ICJyZ2IoMjA1LCAx
NTUsIDE1NSkiLAogICJyb3N5YnJvd240
IjogInJnYigxMzksIDEwNSwgMTA1KSIs
CiAgInJveWFsYmx1ZSI6ICJyZ2IoNjUs
IDEwNSwgMjI1KSIsCiAgInJveWFsYmx1
ZTEiOiAicmdiKDcyLCAxMTgsIDI1NSki
LAogICJyb3lhbGJsdWUyIjogInJnYig2
NywgMTEwLCAyMzgpIiwKICAicm95YWxi
bHVlMyI6ICJyZ2IoNTgsIDk1LCAyMDUp
IiwKICAicm95YWxibHVlNCI6ICJyZ2Io
MzksIDY0LCAxMzkpIiwKICAic2FkZGxl
YnJvd24iOiAicmdiKDEzOSwgNjksIDE5
KSIsCiAgInNhbG1vbiI6ICJyZ2IoMjUw
LCAxMjgsIDExNCkiLAogICJzYWxtb24x
IjogInJnYigyNTUsIDE0MCwgMTA1KSIs
CiAgInNhbG1vbjIiOiAicmdiKDIzOCwg
MTMwLCA5OCkiLAogICJzYWxtb24zIjog
InJnYigyMDUsIDExMiwgODQpIiwKICAi
c2FsbW9uNCI6ICJyZ2IoMTM5LCA3Niwg
NTcpIiwKICAic2FuZHlicm93biI6ICJy
Z2IoMjQ0LCAxNjQsIDk2KSIsCiAgInNl
YWdyZWVuIjogInJnYig0NiwgMTM5LCA4
NykiLAogICJzZWFncmVlbjEiOiAicmdi
KDg0LCAyNTUsIDE1OSkiLAogICJzZWFn
cmVlbjIiOiAicmdiKDc4LCAyMzgsIDE0
OCkiLAogICJzZWFncmVlbjMiOiAicmdi
KDY3LCAyMDUsIDEyOCkiLAogICJzZWFn
cmVlbjQiOiAicmdiKDQ2LCAxMzksIDg3
KSIsCiAgInNlYXNoZWxsIjogInJnYigy
NTUsIDI0NSwgMjM4KSIsCiAgInNlYXNo
ZWxsMSI6ICJyZ2IoMjU1LCAyNDUsIDIz
OCkiLAogICJzZWFzaGVsbDIiOiAicmdi
KDIzOCwgMjI5LCAyMjIpIiwKICAic2Vh
c2hlbGwzIjogInJnYigyMDUsIDE5Nywg
MTkxKSIsCiAgInNlYXNoZWxsNCI6ICJy
Z2IoMTM5LCAxMzQsIDEzMCkiLAogICJz
aWVubmEiOiAicmdiKDE2MCwgODIsIDQ1
KSIsCiAgInNpZW5uYTEiOiAicmdiKDI1
NSwgMTMwLCA3MSkiLAogICJzaWVubmEy
IjogInJnYigyMzgsIDEyMSwgNjYpIiwK
ICAic2llbm5hMyI6ICJyZ2IoMjA1LCAx
MDQsIDU3KSIsCiAgInNpZW5uYTQiOiAi
cmdiKDEzOSwgNzEsIDM4KSIsCiAgInNr
eWJsdWUiOiAicmdiKDEzNSwgMjA2LCAy
MzUpIiwKICAic2t5Ymx1ZTEiOiAicmdi
KDEzNSwgMjA2LCAyNTUpIiwKICAic2t5
Ymx1ZTIiOiAicmdiKDEyNiwgMTkyLCAy
MzgpIiwKICAic2t5Ymx1ZTMiOiAicmdi
KDEwOCwgMTY2LCAyMDUpIiwKICAic2t5
Ymx1ZTQiOiAicmdiKDc0LCAxMTIsIDEz
OSkiLAogICJzbGF0ZWJsdWUiOiAicmdi
KDEwNiwgOTAsIDIwNSkiLAogICJzbGF0
ZWJsdWUxIjogInJnYigxMzEsIDExMSwg
MjU1KSIsCiAgInNsYXRlYmx1ZTIiOiAi
cmdiKDEyMiwgMTAzLCAyMzgpIiwKICAi
c2xhdGVibHVlMyI6ICJyZ2IoMTA1LCA4
OSwgMjA1KSIsCiAgInNsYXRlYmx1ZTQi
OiAicmdiKDcxLCA2MCwgMTM5KSIsCiAg
InNsYXRlZ3JheSI6ICJyZ2IoMTEyLCAx
MjgsIDE0NCkiLAogICJzbGF0ZWdyYXkx
IjogInJnYigxOTgsIDIyNiwgMjU1KSIs
CiAgInNsYXRlZ3JheTIiOiAicmdiKDE4
NSwgMjExLCAyMzgpIiwKICAic2xhdGVn
cmF5MyI6ICJyZ2IoMTU5LCAxODIsIDIw
NSkiLAogICJzbGF0ZWdyYXk0IjogInJn
YigxMDgsIDEyMywgMTM5KSIsCiAgInNs
YXRlZ3JleSI6ICJyZ2IoMTEyLCAxMjgs
IDE0NCkiLAogICJzbm93IjogInJnYigy
NTUsIDI1MCwgMjUwKSIsCiAgInNub3cx
IjogInJnYigyNTUsIDI1MCwgMjUwKSIs
CiAgInNub3cyIjogInJnYigyMzgsIDIz
MywgMjMzKSIsCiAgInNub3czIjogInJn
YigyMDUsIDIwMSwgMjAxKSIsCiAgInNu
b3c0IjogInJnYigxMzksIDEzNywgMTM3
KSIsCiAgInNwcmluZ2dyZWVuIjogInJn
YigwLCAyNTUsIDEyNykiLAogICJzcHJp
bmdncmVlbjEiOiAicmdiKDAsIDI1NSwg
MTI3KSIsCiAgInNwcmluZ2dyZWVuMiI6
ICJyZ2IoMCwgMjM4LCAxMTgpIiwKICAi
c3ByaW5nZ3JlZW4zIjogInJnYigwLCAy
MDUsIDEwMikiLAogICJzcHJpbmdncmVl
bjQiOiAicmdiKDAsIDEzOSwgNjkpIiwK
ICAic3RlZWxibHVlIjogInJnYig3MCwg
MTMwLCAxODApIiwKICAic3RlZWxibHVl
MSI6ICJyZ2IoOTksIDE4NCwgMjU1KSIs
CiAgInN0ZWVsYmx1ZTIiOiAicmdiKDky
LCAxNzIsIDIzOCkiLAogICJzdGVlbGJs
dWUzIjogInJnYig3OSwgMTQ4LCAyMDUp
IiwKICAic3RlZWxibHVlNCI6ICJyZ2Io
NTQsIDEwMCwgMTM5KSIsCiAgInRhbiI6
ICJyZ2IoMjEwLCAxODAsIDE0MCkiLAog
ICJ0YW4xIjogInJnYigyNTUsIDE2NSwg
NzkpIiwKICAidGFuMiI6ICJyZ2IoMjM4
LCAxNTQsIDczKSIsCiAgInRhbjMiOiAi
cmdiKDIwNSwgMTMzLCA2MykiLAogICJ0
YW40IjogInJnYigxMzksIDkwLCA0Myki
LAogICJ0aGlzdGxlIjogInJnYigyMTYs
IDE5MSwgMjE2KSIsCiAgInRoaXN0bGUx
IjogInJnYigyNTUsIDIyNSwgMjU1KSIs
CiAgInRoaXN0bGUyIjogInJnYigyMzgs
IDIxMCwgMjM4KSIsCiAgInRoaXN0bGUz
IjogInJnYigyMDUsIDE4MSwgMjA1KSIs
CiAgInRoaXN0bGU0IjogInJnYigxMzks
IDEyMywgMTM5KSIsCiAgInRvbWF0byI6
ICJyZ2IoMjU1LCA5OSwgNzEpIiwKICAi
dG9tYXRvMSI6ICJyZ2IoMjU1LCA5OSwg
NzEpIiwKICAidG9tYXRvMiI6ICJyZ2Io
MjM4LCA5MiwgNjYpIiwKICAidG9tYXRv
MyI6ICJyZ2IoMjA1LCA3OSwgNTcpIiwK
ICAidG9tYXRvNCI6ICJyZ2IoMTM5LCA1
NCwgMzgpIiwKICAidHVycXVvaXNlIjog
InJnYig2NCwgMjI0LCAyMDgpIiwKICAi
dHVycXVvaXNlMSI6ICJyZ2IoMCwgMjQ1
LCAyNTUpIiwKICAidHVycXVvaXNlMiI6
ICJyZ2IoMCwgMjI5LCAyMzgpIiwKICAi
dHVycXVvaXNlMyI6ICJyZ2IoMCwgMTk3
LCAyMDUpIiwKICAidHVycXVvaXNlNCI6
ICJyZ2IoMCwgMTM0LCAxMzkpIiwKICAi
dmlvbGV0IjogInJnYigyMzgsIDEzMCwg
MjM4KSIsCiAgInZpb2xldHJlZCI6ICJy
Z2IoMjA4LCAzMiwgMTQ0KSIsCiAgInZp
b2xldHJlZDEiOiAicmdiKDI1NSwgNjIs
IDE1MCkiLAogICJ2aW9sZXRyZWQyIjog
InJnYigyMzgsIDU4LCAxNDApIiwKICAi
dmlvbGV0cmVkMyI6ICJyZ2IoMjA1LCA1
MCwgMTIwKSIsCiAgInZpb2xldHJlZDQi
OiAicmdiKDEzOSwgMzQsIDgyKSIsCiAg
IndoZWF0IjogInJnYigyNDUsIDIyMiwg
MTc5KSIsCiAgIndoZWF0MSI6ICJyZ2Io
MjU1LCAyMzEsIDE4NikiLAogICJ3aGVh
dDIiOiAicmdiKDIzOCwgMjE2LCAxNzQp
IiwKICAid2hlYXQzIjogInJnYigyMDUs
IDE4NiwgMTUwKSIsCiAgIndoZWF0NCI6
ICJyZ2IoMTM5LCAxMjYsIDEwMikiLAog
ICJ3aGl0ZSI6ICJyZ2IoMjU1LCAyNTUs
IDI1NSkiLAogICJ3aGl0ZXNtb2tlIjog
InJnYigyNDUsIDI0NSwgMjQ1KSIsCiAg
InllbGxvdyI6ICJyZ2IoMjU1LCAyNTUs
IDApIiwKICAieWVsbG93MSI6ICJyZ2Io
MjU1LCAyNTUsIDApIiwKICAieWVsbG93
MiI6ICJyZ2IoMjM4LCAyMzgsIDApIiwK
ICAieWVsbG93MyI6ICJyZ2IoMjA1LCAy
MDUsIDApIiwKICAieWVsbG93NCI6ICJy
Z2IoMTM5LCAxMzksIDApIiwKICAieWVs
bG93Z3JlZW4iOiAicmdiKDE1NCwgMjA1
LCA1MCkiCn07Ci8vIFNPVVJDRSBGSUxF
OiBsaWJkb3QvanMvbGliX2YuanMKLy8g
Q29weXJpZ2h0IChjKSAyMDEyIFRoZSBD
aHJvbWl1bSBPUyBBdXRob3JzLiBBbGwg
cmlnaHRzIHJlc2VydmVkLgovLyBVc2Ug
b2YgdGhpcyBzb3VyY2UgY29kZSBpcyBn
b3Zlcm5lZCBieSBhIEJTRC1zdHlsZSBs
aWNlbnNlIHRoYXQgY2FuIGJlCi8vIGZv
dW5kIGluIHRoZSBMSUNFTlNFIGZpbGUu
CgondXNlIHN0cmljdCc7CgovKioKICog
R3JhYiBiYWcgb2YgdXRpbGl0eSBmdW5j
dGlvbnMuCiAqLwpsaWIuZiA9IHt9OwoK
LyoqCiAqIFJlcGxhY2UgdmFyaWFibGUg
cmVmZXJlbmNlcyBpbiBhIHN0cmluZy4K
ICoKICogVmFyaWFibGVzIGFyZSBvZiB0
aGUgZm9ybSAlRlVOQ1RJT04oVkFSTkFN
RSkuICBGVU5DVElPTiBpcyBhbiBvcHRp
b25hbAogKiBlc2NhcGUgZnVuY3Rpb24g
dG8gYXBwbHkgdG8gdGhlIHZhbHVlLgog
KgogKiBGb3IgZXhhbXBsZQogKiAgIGxp
Yi5mLnJlcGxhY2VWYXJzKCIlKGdyZWV0
aW5nKSwgJWVuY29kZVVSSUNvbXBvbmVu
dChuYW1lKSIsCiAqICAgICAgICAgICAg
ICAgICAgICAgeyBncmVldGluZzogIkhl
bGxvIiwKICogICAgICAgICAgICAgICAg
ICAgICAgIG5hbWU6ICJHb29nbGUrIiB9
KTsKICoKICogV2lsbCByZXN1bHQgaW4g
IkhlbGxvLCBHb29nbGUlMkIiLgogKi8K
bGliLmYucmVwbGFjZVZhcnMgPSBmdW5j
dGlvbihzdHIsIHZhcnMpIHsKICByZXR1
cm4gc3RyLnJlcGxhY2UoLyUoW2Etel0q
KVwoKFteXCldKylcKS9naSwgZnVuY3Rp
b24obWF0Y2gsIGZuLCB2YXJuYW1lKSB7
CiAgICAgIGlmICh0eXBlb2YgdmFyc1t2
YXJuYW1lXSA9PSAndW5kZWZpbmVkJykK
ICAgICAgICB0aHJvdyAnVW5rbm93biB2
YXJpYWJsZTogJyArIHZhcm5hbWU7Cgog
ICAgICB2YXIgcnYgPSB2YXJzW3Zhcm5h
bWVdOwoKICAgICAgaWYgKGZuIGluIGxp
Yi5mLnJlcGxhY2VWYXJzLmZ1bmN0aW9u
cykgewogICAgICAgIHJ2ID0gbGliLmYu
cmVwbGFjZVZhcnMuZnVuY3Rpb25zW2Zu
XShydik7CiAgICAgIH0gZWxzZSBpZiAo
Zm4pIHsKICAgICAgICB0aHJvdyAnVW5r
bm93biBlc2NhcGUgZnVuY3Rpb246ICcg
KyBmbjsKICAgICAgfQoKICAgICAgcmV0
dXJuIHJ2OwogICAgfSk7Cn07CgovKioK
ICogRnVuY3Rpb25zIHRoYXQgY2FuIGJl
IHVzZWQgd2l0aCByZXBsYWNlVmFycy4K
ICoKICogQ2xpZW50cyBjYW4gYWRkIHRv
IHRoaXMgbGlzdCB0byBleHRlbmQgbGli
LmYucmVwbGFjZVZhcnMoKS4KICovCmxp
Yi5mLnJlcGxhY2VWYXJzLmZ1bmN0aW9u
cyA9IHsKICBlbmNvZGVVUkk6IGVuY29k
ZVVSSSwKICBlbmNvZGVVUklDb21wb25l
bnQ6IGVuY29kZVVSSUNvbXBvbmVudCwK
ICBlc2NhcGVIVE1MOiBmdW5jdGlvbihz
dHIpIHsKICAgIHZhciBtYXAgPSB7CiAg
ICAgICc8JzogJyZsdDsnLAogICAgICAn
Pic6ICcmZ3Q7JywKICAgICAgJyYnOiAn
JmFtcDsnLAogICAgICAnIic6ICcmcXVv
dDsnLAogICAgICAiJyI6ICcmIzM5OycK
ICAgIH07CgogICAgcmV0dXJuIHN0ci5y
ZXBsYWNlKC9bPD4mXCJcJ10vZywgZnVu
Y3Rpb24obSkgeyByZXR1cm4gbWFwW21d
IH0pOwogIH0KfTsKCi8qKgogKiBHZXQg
dGhlIGxpc3Qgb2YgYWNjZXB0ZWQgVUkg
bGFuZ3VhZ2VzLgogKgogKiBAcGFyYW0g
e2Z1bmN0aW9uKEFycmF5KX0gY2FsbGJh
Y2sgRnVuY3Rpb24gdG8gaW52b2tlIHdp
dGggdGhlIHJlc3VsdHMuICBUaGUKICog
ICAgIHBhcmFtZXRlciBpcyBhIGxpc3Qg
b2YgbG9jYWxlIG5hbWVzLgogKi8KbGli
LmYuZ2V0QWNjZXB0TGFuZ3VhZ2VzID0g
ZnVuY3Rpb24oY2FsbGJhY2spIHsKICBp
ZiAod2luZG93LmNocm9tZSAmJiBjaHJv
bWUuaTE4bikgewogICAgY2hyb21lLmkx
OG4uZ2V0QWNjZXB0TGFuZ3VhZ2VzKGNh
bGxiYWNrKTsKICB9IGVsc2UgewogICAg
c2V0VGltZW91dChmdW5jdGlvbigpIHsK
ICAgICAgICBjYWxsYmFjayhbbmF2aWdh
dG9yLmxhbmd1YWdlLnJlcGxhY2UoLy0v
ZywgJ18nKV0pOwogICAgICB9LCAwKTsK
ICB9Cn07CgovKioKICogUGFyc2UgYSBx
dWVyeSBzdHJpbmcgaW50byBhIGhhc2gu
CiAqCiAqIFRoaXMgdGFrZXMgYSB1cmwg
cXVlcnkgc3RyaW5nIGluIHRoZSBmb3Jt
ICduYW1lMT12YWx1ZSZuYW1lMj12YWx1
ZScgYW5kCiAqIGNvbnZlcnRzIGl0IGlu
dG8gYW4gb2JqZWN0IG9mIHRoZSBmb3Jt
IHsgbmFtZTE6ICd2YWx1ZScsIG5hbWUy
OiAndmFsdWUnIH0uCiAqIElmIGEgZ2l2
ZW4gbmFtZSBhcHBlYXJzIG11bHRpcGxl
IHRpbWVzIGluIHRoZSBxdWVyeSBzdHJp
bmcsIG9ubHkgdGhlCiAqIGxhc3QgdmFs
dWUgd2lsbCBhcHBlYXIgaW4gdGhlIHJl
c3VsdC4KICoKICogTmFtZXMgYW5kIHZh
bHVlcyBhcmUgcGFzc2VkIHRocm91Z2gg
ZGVjb2RlVVJJQ29tcG9uZW50IGJlZm9y
ZSBiZWluZyBhZGRlZAogKiB0byB0aGUg
cmVzdWx0IG9iamVjdC4KICoKICogQHBh
cmFtIHtzdHJpbmd9IHF1ZXJ5U3RyaW5n
IFRoZSBzdHJpbmcgdG8gcGFyc2UuICBJ
ZiBpdCBzdGFydHMgd2l0aCBhCiAqICAg
ICBsZWFkaW5nICc/JywgdGhlICc/JyB3
aWxsIGJlIGlnbm9yZWQuCiAqLwpsaWIu
Zi5wYXJzZVF1ZXJ5ID0gZnVuY3Rpb24o
cXVlcnlTdHJpbmcpIHsKICBpZiAocXVl
cnlTdHJpbmcuc3Vic3RyKDAsIDEpID09
ICc/JykKICAgIHF1ZXJ5U3RyaW5nID0g
cXVlcnlTdHJpbmcuc3Vic3RyKDEpOwoK
ICB2YXIgcnYgPSB7fTsKCiAgdmFyIHBh
aXJzID0gcXVlcnlTdHJpbmcuc3BsaXQo
JyYnKTsKICBmb3IgKHZhciBpID0gMDsg
aSA8IHBhaXJzLmxlbmd0aDsgaSsrKSB7
CiAgICB2YXIgcGFpciA9IHBhaXJzW2ld
LnNwbGl0KCc9Jyk7CiAgICBydltkZWNv
ZGVVUklDb21wb25lbnQocGFpclswXSld
ID0gZGVjb2RlVVJJQ29tcG9uZW50KHBh
aXJbMV0pOwogIH0KCiAgcmV0dXJuIHJ2
Owp9OwoKbGliLmYuZ2V0VVJMID0gZnVu
Y3Rpb24ocGF0aCkgewogIGlmICh3aW5k
b3cuY2hyb21lICYmIGNocm9tZS5ydW50
aW1lICYmIGNocm9tZS5ydW50aW1lLmdl
dFVSTCkKICAgIHJldHVybiBjaHJvbWUu
cnVudGltZS5nZXRVUkwocGF0aCk7Cgog
IHJldHVybiBwYXRoOwp9OwoKLyoqCiAq
IENsYW1wIGEgZ2l2ZW4gaW50ZWdlciB0
byBhIHNwZWNpZmllZCByYW5nZS4KICoK
ICogQHBhcmFtIHtpbnRlZ2VyfSB2IFRo
ZSB2YWx1ZSB0byBiZSBjbGFtcGVkLgog
KiBAcGFyYW0ge2ludGVnZXJ9IG1pbiBU
aGUgbWluaW11bSBhY2NlcHRhYmxlIHZh
bHVlLgogKiBAcGFyYW0ge2ludGVnZXJ9
IG1heCBUaGUgbWF4aW11bSBhY2NlcHRh
YmxlIHZhbHVlLgogKi8KbGliLmYuY2xh
bXAgPSBmdW5jdGlvbih2LCBtaW4sIG1h
eCkgewogIGlmICh2IDwgbWluKQogICAg
cmV0dXJuIG1pbjsKICBpZiAodiA+IG1h
eCkKICAgIHJldHVybiBtYXg7CiAgcmV0
dXJuIHY7Cn07CgovKioKICogTGVmdCBw
YWQgYSBzdHJpbmcgdG8gYSBnaXZlbiBs
ZW5ndGggdXNpbmcgYSBnaXZlbiBjaGFy
YWN0ZXIuCiAqCiAqIEBwYXJhbSB7c3Ry
aW5nfSBzdHIgVGhlIHN0cmluZyB0byBw
YWQuCiAqIEBwYXJhbSB7aW50ZWdlcn0g
bGVuZ3RoIFRoZSBkZXNpcmVkIGxlbmd0
aC4KICogQHBhcmFtIHtzdHJpbmd9IG9w
dF9jaCBUaGUgb3B0aW9uYWwgcGFkZGlu
ZyBjaGFyYWN0ZXIsIGRlZmF1bHRzIHRv
ICcgJy4KICogQHJldHVybiB7c3RyaW5n
fSBUaGUgcGFkZGVkIHN0cmluZy4KICov
CmxpYi5mLmxwYWQgPSBmdW5jdGlvbihz
dHIsIGxlbmd0aCwgb3B0X2NoKSB7CiAg
c3RyID0gU3RyaW5nKHN0cik7CiAgb3B0
X2NoID0gb3B0X2NoIHx8ICcgJzsKCiAg
d2hpbGUgKHN0ci5sZW5ndGggPCBsZW5n
dGgpCiAgICBzdHIgPSBvcHRfY2ggKyBz
dHI7CgogIHJldHVybiBzdHI7Cn07Cgov
KioKICogTGVmdCBwYWQgYSBudW1iZXIg
dG8gYSBnaXZlbiBsZW5ndGggd2l0aCBs
ZWFkaW5nIHplcm9zLgogKgogKiBAcGFy
YW0ge3N0cmluZ3xpbnRlZ2VyfSBudW1i
ZXIgVGhlIG51bWJlciB0byBwYWQuCiAq
IEBwYXJhbSB7aW50ZWdlcn0gbGVuZ3Ro
IFRoZSBkZXNpcmVkIGxlbmd0aC4KICog
QHJldHVybiB7c3RyaW5nfSBUaGUgcGFk
ZGVkIG51bWJlciBhcyBhIHN0cmluZy4K
ICovCmxpYi5mLnpwYWQgPSBmdW5jdGlv
bihudW1iZXIsIGxlbmd0aCkgewogIHJl
dHVybiBsaWIuZi5scGFkKG51bWJlciwg
bGVuZ3RoLCAnMCcpOwp9OwoKLyoqCiAq
IFJldHVybiBhIHN0cmluZyBjb250YWlu
aW5nIGEgZ2l2ZW4gbnVtYmVyIG9mIHNw
YWNlIGNoYXJhY3RlcnMuCiAqCiAqIFRo
aXMgbWV0aG9kIG1haW50YWlucyBhIHN0
YXRpYyBjYWNoZSBvZiB0aGUgbGFyZ2Vz
dCBhbW91bnQgb2Ygd2hpdGVzcGFjZQog
KiBldmVyIHJlcXVlc3RlZC4gIEl0IHNo
b3VsZG4ndCBiZSB1c2VkIHRvIGdlbmVy
YXRlIGFuIGluc2FuZWx5IGh1Z2UgYW1v
dW50IG9mCiAqIHdoaXRlc3BhY2UuCiAq
CiAqIEBwYXJhbSB7aW50ZWdlcn0gbGVu
Z3RoIFRoZSBkZXNpcmVkIGFtb3VudCBv
ZiB3aGl0ZXNwYWNlLgogKiBAcGFyYW0g
e3N0cmluZ30gQSBzdHJpbmcgb2Ygc3Bh
Y2VzIG9mIHRoZSByZXF1ZXN0ZWQgbGVu
Z3RoLgogKi8KbGliLmYuZ2V0V2hpdGVz
cGFjZSA9IGZ1bmN0aW9uKGxlbmd0aCkg
ewogIGlmIChsZW5ndGggPT0gMCkKICAg
IHJldHVybiAnJzsKCiAgdmFyIGYgPSB0
aGlzLmdldFdoaXRlc3BhY2U7CiAgaWYg
KCFmLndoaXRlc3BhY2UpCiAgICBmLndo
aXRlc3BhY2UgPSAnICAgICAgICAgICc7
CgogIHdoaWxlIChsZW5ndGggPiBmLndo
aXRlc3BhY2UubGVuZ3RoKSB7CiAgICBm
LndoaXRlc3BhY2UgKz0gZi53aGl0ZXNw
YWNlOwogIH0KCiAgcmV0dXJuIGYud2hp
dGVzcGFjZS5zdWJzdHIoMCwgbGVuZ3Ro
KTsKfTsKCiAvKioKICogRW5zdXJlIHRo
YXQgYSBmdW5jdGlvbiBpcyBjYWxsZWQg
d2l0aGluIGEgY2VydGFpbiB0aW1lIGxp
bWl0LgogKgogKiBTaW1wbGUgdXNhZ2Ug
bG9va3MgbGlrZSB0aGlzLi4uCiAqCiAq
ICBsaWIucmVnaXN0ZXJJbml0KGxpYi5m
LmFsYXJtKG9uSW5pdCkpOwogKgogKiBU
aGlzIHdpbGwgbG9nIGEgd2FybmluZyB0
byB0aGUgY29uc29sZSBpZiBvbkluaXQo
KSBpcyBub3QgaW52b2tlZCB3aXRoaW4K
ICogNSBzZWNvbmRzLgogKgogKiBJZiB5
b3UncmUgcGVyZm9ybWluZyBzb21lIG9w
ZXJhdGlvbiB0aGF0IG1heSB0YWtlIGxv
bmdlciB0aGFuIDUgc2Vjb25kcyB5b3UK
ICogY2FuIHBhc3MgYSBkdXJhdGlvbiBp
biBtaWxsaXNlY29uZHMgYXMgdGhlIG9w
dGlvbmFsIHNlY29uZCBwYXJhbWV0ZXIu
CiAqCiAqIElmIHlvdSBwYXNzIGEgc3Ry
aW5nIGlkZW50aWZpZXIgaW5zdGVhZCBv
ZiBhIGNhbGxiYWNrIGZ1bmN0aW9uLCB5
b3UnbGwgZ2V0IGEKICogd3JhcHBlciBn
ZW5lcmF0b3IgcmF0aGVyIHRoYW4gYSBz
aW5nbGUgd3JhcHBlci4gIEVhY2ggY2Fs
bCB0byB0aGUKICogZ2VuZXJhdG9yIHdp
bGwgcmV0dXJuIGEgd3JhcHBlZCB2ZXJz
aW9uIG9mIHRoZSBjYWxsYmFjayB3aXJl
ZCB0bwogKiBhIHNoYXJlZCB0aW1lb3V0
LiAgVGhpcyBpcyBmb3IgY2FzZXMgd2hl
cmUgeW91IHdhbnQgdG8gZW5zdXJlIHRo
YXQgYXQgbGVhc3QKICogb25lIG9mIGEg
c2V0IG9mIGNhbGxiYWNrcyBpcyBpbnZv
a2VkIGJlZm9yZSBhIHRpbWVvdXQgZXhw
aXJlcy4KICoKICogICB2YXIgYWxhcm0g
PSBsaWIuZi5hbGFybSgnZmV0Y2ggb2Jq
ZWN0Jyk7CiAqICAgbGliLmZvby5mZXRj
aE9iamVjdChhbGFybShvblN1Y2Nlc3Mp
LCBhbGFybShvbkZhaWx1cmUpKTsKICoK
ICogQHBhcmFtIHtmdW5jdGlvbigqKX0g
Y2FsbGJhY2sgVGhlIGZ1bmN0aW9uIHRv
IHdyYXAgaW4gYW4gYWxhcm0uCiAqIEBw
YXJhbSB7aW50fSBvcHRfbXMgT3B0aW9u
YWwgbnVtYmVyIG9mIG1pbGxpc2Vjb25k
cyB0byB3YWl0IGJlZm9yZSByYWlzaW5n
CiAqICAgICBhbiBhbGFybS4gIERlZmF1
bHQgaXMgNTAwMCAoNSBzZWNvbmRzKS4K
ICogQHJldHVybiB7ZnVuY3Rpb259IElm
IGNhbGxiYWNrIGlzIGEgZnVuY3Rpb24g
dGhlbiB0aGUgcmV0dXJuIHZhbHVlIHdp
bGwgYmUKICogICAgIHRoZSB3cmFwcGVk
IGNhbGxiYWNrLiAgSWYgY2FsbGJhY2sg
aXMgYSBzdHJpbmcgdGhlbiB0aGUgcmV0
dXJuIHZhbHVlIHdpbGwKICogICAgIGJl
IGEgZnVuY3Rpb24gdGhhdCBnZW5lcmF0
ZXMgbmV3IHdyYXBwZWQgY2FsbGJhY2tz
LgogKi8KbGliLmYuYWxhcm0gPSBmdW5j
dGlvbihjYWxsYmFjaywgb3B0X21zKSB7
CiAgdmFyIG1zID0gb3B0X21zIHx8IDUg
KiAxMDAwOwogIHZhciBzdGFjayA9IGxp
Yi5mLmdldFN0YWNrKDEpOwoKICByZXR1
cm4gKGZ1bmN0aW9uKCkgewogICAgLy8g
VGhpcyBvdXRlciBmdW5jdGlvbiBpcyBj
YWxsZWQgaW1tZWRpYXRlbHkuICBJdCdz
IGhlcmUgdG8gY2FwdHVyZSBhIG5ldwog
ICAgLy8gc2NvcGUgZm9yIHRoZSB0aW1l
b3V0IHZhcmlhYmxlLgoKICAgIC8vIFRo
ZSAndGltZW91dCcgdmFyaWFibGUgaXMg
c2hhcmVkIGJ5IHRoaXMgdGltZW91dCBm
dW5jdGlvbiwgYW5kIHRoZQogICAgLy8g
Y2FsbGJhY2sgd3JhcHBlci4KICAgIHZh
ciB0aW1lb3V0ID0gc2V0VGltZW91dChm
dW5jdGlvbigpIHsKICAgICAgdmFyIG5h
bWUgPSAodHlwZW9mIGNhbGxiYWNrID09
ICdzdHJpbmcnKSA/IG5hbWUgOiBjYWxs
YmFjay5uYW1lOwogICAgICBuYW1lID0g
bmFtZSA/ICgnOiAnICsgbmFtZSkgOiAn
JzsKICAgICAgY29uc29sZS53YXJuKCds
aWIuZi5hbGFybTogdGltZW91dCBleHBp
cmVkOiAnICsgKG1zIC8gMTAwMCkgKyAn
cycgKyBuYW1lKTsKICAgICAgY29uc29s
ZS5sb2coc3RhY2spOwogICAgICB0aW1l
b3V0ID0gbnVsbDsKICAgIH0sIG1zKTsK
CiAgICB2YXIgd3JhcHBlckdlbmVyYXRv
ciA9IGZ1bmN0aW9uKGNhbGxiYWNrKSB7
CiAgICAgIHJldHVybiBmdW5jdGlvbigp
IHsKICAgICAgICBpZiAodGltZW91dCkg
ewogICAgICAgICAgY2xlYXJUaW1lb3V0
KHRpbWVvdXQpOwogICAgICAgICAgdGlt
ZW91dCA9IG51bGw7CiAgICAgICAgfQoK
ICAgICAgICByZXR1cm4gY2FsbGJhY2su
YXBwbHkobnVsbCwgYXJndW1lbnRzKTsK
ICAgICAgfQogICAgfTsKCiAgICBpZiAo
dHlwZW9mIGNhbGxiYWNrID09ICdzdHJp
bmcnKQogICAgICByZXR1cm4gd3JhcHBl
ckdlbmVyYXRvcjsKCiAgICByZXR1cm4g
d3JhcHBlckdlbmVyYXRvcihjYWxsYmFj
ayk7CiAgfSkoKTsKfTsKCi8qKgogKiBS
ZXR1cm4gdGhlIGN1cnJlbnQgY2FsbCBz
dGFjayBhZnRlciBza2lwcGluZyBhIGdp
dmVuIG51bWJlciBvZiBmcmFtZXMuCiAq
CiAqIFRoaXMgbWV0aG9kIGlzIGludGVu
ZGVkIHRvIGJlIHVzZWQgZm9yIGRlYnVn
Z2luZyBvbmx5LiAgSXQgcmV0dXJucyBh
bgogKiBPYmplY3QgaW5zdGVhZCBvZiBh
biBBcnJheSwgYmVjYXVzZSB0aGUgY29u
c29sZSBzdHJpbmdpZmllcyBhcnJheXMg
YnkKICogZGVmYXVsdCBhbmQgdGhhdCdz
IG5vdCB3aGF0IHdlIHdhbnQuCiAqCiAq
IEEgdHlwaWNhbCBjYWxsIG1pZ2h0IGxv
b2sgbGlrZS4uLgogKgogKiAgICBjb25z
b2xlLmxvZygnU29tZXRoaW5nIHdpY2tl
ZCB0aGlzIHdheSBjYW1lJywgbGliLmYu
Z2V0U3RhY2soKSk7CiAqICAgIC8vICAg
ICAgICAgICAgICAgICAgICAgICAgIE5v
dGljZSB0aGUgY29tbWEgXgogKgogKiBU
aGlzIHdvdWxkIHByaW50IHRoZSBtZXNz
YWdlIHRvIHRoZSBqcyBjb25zb2xlLCBm
b2xsb3dlZCBieSBhbiBvYmplY3QKICog
d2hpY2ggY2FuIGJlIGNsaWNrZWQgdG8g
cmV2ZWFsIHRoZSBzdGFjay4KICoKICog
QHBhcmFtIHtudW1iZXJ9IG9wdF9pZ25v
cmVGcmFtZXMgVGhlIG9wdGlvbmFsIG51
bWJlciBvZiBzdGFjayBmcmFtZXMgdG8K
ICogICAgIGlnbm9yZS4gIFRoZSBhY3R1
YWwgJ2dldFN0YWNrJyBjYWxsIGlzIGFs
d2F5cyBpZ25vcmVkLgogKi8KbGliLmYu
Z2V0U3RhY2sgPSBmdW5jdGlvbihvcHRf
aWdub3JlRnJhbWVzKSB7CiAgdmFyIGln
bm9yZUZyYW1lcyA9IG9wdF9pZ25vcmVG
cmFtZXMgPyBvcHRfaWdub3JlRnJhbWVz
ICsgMiA6IDI7CgogIHZhciBzdGFja0Fy
cmF5OwoKICB0cnkgewogICAgdGhyb3cg
bmV3IEVycm9yKCk7CiAgfSBjYXRjaCAo
ZXgpIHsKICAgIHN0YWNrQXJyYXkgPSBl
eC5zdGFjay5zcGxpdCgnXG4nKTsKICB9
CgogIHZhciBzdGFja09iamVjdCA9IHt9
OwogIGZvciAodmFyIGkgPSBpZ25vcmVG
cmFtZXM7IGkgPCBzdGFja0FycmF5Lmxl
bmd0aDsgaSsrKSB7CiAgICBzdGFja09i
amVjdFtpIC0gaWdub3JlRnJhbWVzXSA9
IHN0YWNrQXJyYXlbaV0ucmVwbGFjZSgv
XlxzKmF0XHMrLywgJycpOwogIH0KCiAg
cmV0dXJuIHN0YWNrT2JqZWN0Owp9OwoK
LyoqCiAqIERpdmlkZXMgdGhlIHR3byBu
dW1iZXJzIGFuZCBmbG9vcnMgdGhlIHJl
c3VsdHMsIHVubGVzcyB0aGUgcmVtYWlu
ZGVyIGlzIGxlc3MKICogdGhhbiBhbiBp
bmNyZWRpYmx5IHNtYWxsIHZhbHVlLCBp
biB3aGljaCBjYXNlIGl0IHJldHVybnMg
dGhlIGNlaWxpbmcuCiAqIFRoaXMgaXMg
dXNlZnVsIHdoZW4gdGhlIG51bWJlciBh
cmUgdHJ1bmNhdGVkIGFwcHJveGltYXRp
b25zIG9mIGxvbmdlcgogKiB2YWx1ZXMs
IGFuZCBzbyBkb2luZyBkaXZpc2lvbiB3
aXRoIHRoZXNlIG51bWJlcnMgeWllbGRz
IGEgcmVzdWx0IGluY3JlZGlibHkKICog
Y2xvc2UgdG8gYSB3aG9sZSBudW1iZXIu
CiAqCiAqIEBwYXJhbSB7bnVtYmVyfSBu
dW1lcmF0b3IKICogQHBhcmFtIHtudW1i
ZXJ9IGRlbm9taW5hdG9yCiAqIEByZXR1
cm4ge251bWJlcn0KICovCmxpYi5mLnNt
YXJ0Rmxvb3JEaXZpZGUgPSBmdW5jdGlv
bihudW1lcmF0b3IsICBkZW5vbWluYXRv
cikgewogIHZhciB2YWwgPSBudW1lcmF0
b3IgLyBkZW5vbWluYXRvcjsKICB2YXIg
Y2VpbGluZyA9IE1hdGguY2VpbCh2YWwp
OwogIGlmIChjZWlsaW5nIC0gdmFsIDwg
LjAwMDEpIHsKICAgIHJldHVybiBjZWls
aW5nOwogIH0gZWxzZSB7CiAgICByZXR1
cm4gTWF0aC5mbG9vcih2YWwpOwogIH0K
fTsKLy8gU09VUkNFIEZJTEU6IGxpYmRv
dC9qcy9saWJfbWVzc2FnZV9tYW5hZ2Vy
LmpzCi8vIENvcHlyaWdodCAoYykgMjAx
MiBUaGUgQ2hyb21pdW0gT1MgQXV0aG9y
cy4gQWxsIHJpZ2h0cyByZXNlcnZlZC4K
Ly8gVXNlIG9mIHRoaXMgc291cmNlIGNv
ZGUgaXMgZ292ZXJuZWQgYnkgYSBCU0Qt
c3R5bGUgbGljZW5zZSB0aGF0IGNhbiBi
ZQovLyBmb3VuZCBpbiB0aGUgTElDRU5T
RSBmaWxlLgoKJ3VzZSBzdHJpY3QnOwoK
LyoqCiAqIE1lc3NhZ2VNYW5hZ2VyIGNs
YXNzIGhhbmRsZXMgaW50ZXJuYXRpb25h
bGl6ZWQgc3RyaW5ncy4KICoKICogTm90
ZTogY2hyb21lLmkxOG4gaXNuJ3Qgc3Vm
ZmljaWVudCBiZWNhdXNlLi4uCiAqICAg
ICAxLiBUaGVyZSdzIGEgYnVnIGluIGNo
cm9tZSB0aGF0IG1ha2VzIGl0IHVuYXZh
aWxhYmxlIGluIGlmcmFtZXM6CiAqICAg
ICAgICBodHRwOi8vY3JidWcuY29tLzEz
MDIwMAogKiAgICAgMi4gVGhlIGNsaWVu
dCBjb2RlIG1heSBub3QgYmUgcGFja2Fn
ZWQgaW4gYSBDaHJvbWUgZXh0ZW5zaW9u
LgogKiAgICAgMy4gVGhlIGNsaWVudCBj
b2RlIG1heSBiZSBwYXJ0IG9mIGEgbGli
cmFyeSBwYWNrYWdlZCBpbiBhIHRoaXJk
LXBhcnR5CiAqICAgICAgICBDaHJvbWUg
ZXh0ZW5zaW9uLgogKgogKiBAcGFyYW0g
e0FycmF5fSBsYW5ndWFnZXMgTGlzdCBv
ZiBsYW5ndWFnZXMgdG8gbG9hZCwgaW4g
dGhlIG9yZGVyIHRoZXkKICogICAgIHNo
b3VsZCBiZSBsb2FkZWQuICBOZXdlciBt
ZXNzYWdlcyByZXBsYWNlIG9sZGVyIG9u
ZXMuICAnZW4nIGlzCiAqICAgICBhdXRv
bWF0aWNhbGx5IGFkZGVkIGFzIHRoZSBm
aXJzdCBsYW5ndWFnZSBpZiBpdCBpcyBu
b3QgYWxyZWFkeSBwcmVzZW50LgogKi8K
bGliLk1lc3NhZ2VNYW5hZ2VyID0gZnVu
Y3Rpb24obGFuZ3VhZ2VzKSB7CiAgdGhp
cy5sYW5ndWFnZXNfID0gbGFuZ3VhZ2Vz
Lm1hcCgKICAgICAgZnVuY3Rpb24oZWwp
IHsgcmV0dXJuIGVsLnJlcGxhY2UoLy0v
ZywgJ18nKSB9KTsKCiAgaWYgKHRoaXMu
bGFuZ3VhZ2VzXy5pbmRleE9mKCdlbicp
ID09IC0xKQogICAgdGhpcy5sYW5ndWFn
ZXNfLnVuc2hpZnQoJ2VuJyk7CgogIHRo
aXMubWVzc2FnZXMgPSB7fTsKfTsKCi8q
KgogKiBBZGQgbWVzc2FnZSBkZWZpbml0
aW9ucyB0byB0aGUgbWVzc2FnZSBtYW5h
Z2VyLgogKgogKiBUaGlzIHRha2VzIGFu
IG9iamVjdCBvZiB0aGUgc2FtZSBmb3Jt
YXQgb2YgYSBDaHJvbWUgbWVzc2FnZXMu
anNvbiBmaWxlLiAgU2VlCiAqIDxodHRw
Oi8vY29kZS5nb29nbGUuY29tL2Nocm9t
ZS9leHRlbnNpb25zL2kxOG4tbWVzc2Fn
ZXMuaHRtbD4uCiAqLwpsaWIuTWVzc2Fn
ZU1hbmFnZXIucHJvdG90eXBlLmFkZE1l
c3NhZ2VzID0gZnVuY3Rpb24oZGVmcykg
ewogIGZvciAodmFyIGtleSBpbiBkZWZz
KSB7CiAgICB2YXIgZGVmID0gZGVmc1tr
ZXldOwoKICAgIGlmICghZGVmLnBsYWNl
aG9sZGVycykgewogICAgICB0aGlzLm1l
c3NhZ2VzW2tleV0gPSBkZWYubWVzc2Fn
ZTsKICAgIH0gZWxzZSB7CiAgICAgIC8v
IFJlcGxhY2UgIiROQU1FJCIgcGxhY2Vo
b2xkZXJzIHdpdGggIiQxIiwgZXRjLgog
ICAgICB0aGlzLm1lc3NhZ2VzW2tleV0g
PSBkZWYubWVzc2FnZS5yZXBsYWNlKAog
ICAgICAgICAgL1wkKFthLXpdW15cc1wk
XSspXCQvaWcsCiAgICAgICAgICBmdW5j
dGlvbihtLCBuYW1lKSB7CiAgICAgICAg
ICAgIHJldHVybiBkZWZzW2tleV0ucGxh
Y2Vob2xkZXJzW25hbWUudG9Mb3dlckNh
c2UoKV0uY29udGVudDsKICAgICAgICAg
IH0pOwogICAgfQogIH0KfTsKCi8qKgog
KiBMb2FkIHRoZSBmaXJzdCBhdmFpbGFi
bGUgbGFuZ3VhZ2UgbWVzc2FnZSBidW5k
bGUuCiAqCiAqIEBwYXJhbSB7c3RyaW5n
fSBwYXR0ZXJuIEEgdXJsIHBhdHRlcm4g
Y29udGFpbmluZyBhICIkMSIgd2hlcmUg
dGhlIGxvY2FsZQogKiAgICAgbmFtZSBz
aG91bGQgZ28uCiAqIEBwYXJhbSB7ZnVu
Y3Rpb24oQXJyYXksQXJyYXkpfSBvbkNv
bXBsZXRlIEZ1bmN0aW9uIHRvIGJlIGNh
bGxlZCB3aGVuIGxvYWRpbmcKICogICAg
IGlzIGNvbXBsZXRlLiAgVGhlIHR3byBh
cnJheXMgYXJlIHRoZSBsaXN0IG9mIHN1
Y2Nlc3NmdWwgYW5kIGZhaWxlZAogKiAg
ICAgbG9jYWxlIG5hbWVzLiAgSWYgdGhl
IGZpcnN0IHBhcmFtZXRlciBpcyBsZW5n
dGggMCwgbm8gbG9jYWxlcyB3ZXJlCiAq
ICAgICBsb2FkZWQuCiAqLwpsaWIuTWVz
c2FnZU1hbmFnZXIucHJvdG90eXBlLmZp
bmRBbmRMb2FkTWVzc2FnZXMgPSBmdW5j
dGlvbigKICAgIHBhdHRlcm4sIG9uQ29t
cGxldGUpIHsKICB2YXIgbGFuZ3VhZ2Vz
ID0gdGhpcy5sYW5ndWFnZXNfLmNvbmNh
dCgpOwogIHZhciBsb2FkZWQgPSBbXTsK
ICB2YXIgZmFpbGVkID0gW107CgogIGZ1
bmN0aW9uIG9uTGFuZ3VhZ2VDb21wbGV0
ZShzdGF0ZSkgewogICAgaWYgKHN0YXRl
KSB7CiAgICAgIGxvYWRlZCA9IGxhbmd1
YWdlcy5zaGlmdCgpOwogICAgfSBlbHNl
IHsKICAgICAgZmFpbGVkID0gbGFuZ3Vh
Z2VzLnNoaWZ0KCk7CiAgICB9CgogICAg
aWYgKGxhbmd1YWdlcy5sZW5ndGgpIHsK
ICAgICAgdHJ5TmV4dExhbmd1YWdlKCk7
CiAgICB9IGVsc2UgewogICAgICBvbkNv
bXBsZXRlKGxvYWRlZCwgZmFpbGVkKTsK
ICAgIH0KICB9CgogIHZhciB0cnlOZXh0
TGFuZ3VhZ2UgPSBmdW5jdGlvbigpIHsK
ICAgIHRoaXMubG9hZE1lc3NhZ2VzKHRo
aXMucmVwbGFjZVJlZmVyZW5jZXMocGF0
dGVybiwgbGFuZ3VhZ2VzKSwKICAgICAg
ICAgICAgICAgICAgICAgIG9uTGFuZ3Vh
Z2VDb21wbGV0ZS5iaW5kKHRoaXMsIHRy
dWUpLAogICAgICAgICAgICAgICAgICAg
ICAgb25MYW5ndWFnZUNvbXBsZXRlLmJp
bmQodGhpcywgZmFsc2UpKTsKICB9LmJp
bmQodGhpcyk7CgogIHRyeU5leHRMYW5n
dWFnZSgpOwp9OwoKLyoqCiAqIExvYWQg
bWVzc2FnZXMgZnJvbSBhIG1lc3NhZ2Vz
Lmpzb24gZmlsZS4KICovCmxpYi5NZXNz
YWdlTWFuYWdlci5wcm90b3R5cGUubG9h
ZE1lc3NhZ2VzID0gZnVuY3Rpb24oCiAg
ICB1cmwsIG9uU3VjY2Vzcywgb3B0X29u
RXJyb3IpIHsKICB2YXIgeGhyID0gbmV3
IFhNTEh0dHBSZXF1ZXN0KCk7CgogIHho
ci5vbmxvYWRlbmQgPSBmdW5jdGlvbigp
IHsKICAgIGlmICh4aHIuc3RhdHVzICE9
IDIwMCkgewogICAgICBpZiAob3B0X29u
RXJyb3IpCiAgICAgICAgb3B0X29uRXJy
b3IoeGhyLnN0YXR1cyk7CgogICAgICBy
ZXR1cm47CiAgICB9CgogICAgdGhpcy5h
ZGRNZXNzYWdlcyhKU09OLnBhcnNlKHho
ci5yZXNwb25zZVRleHQpKTsKICAgIG9u
U3VjY2VzcygpOwogIH0uYmluZCh0aGlz
KTsKCiAgeGhyLm9wZW4oJ0dFVCcsIHVy
bCk7CiAgeGhyLnNlbmQoKTsKfTsKCi8q
KgogKiBSZXBsYWNlICQxLi4uJG4gcmVm
ZXJlbmNlcyB3aXRoIHRoZSBlbGVtZW50
cyBvZiB0aGUgYXJncyBhcnJheS4KICoK
ICogQHBhcmFtIHtzdHJpbmd9IG1zZyBT
dHJpbmcgY29udGFpbmluZyB0aGUgbWVz
c2FnZSBhbmQgYXJndW1lbnQgcmVmZXJl
bmNlcy4KICogQHBhcmFtIHtBcnJheX0g
YXJncyBBcnJheSBjb250YWluaW5nIHRo
ZSBhcmd1bWVudCB2YWx1ZXMuCiAqLwps
aWIuTWVzc2FnZU1hbmFnZXIucmVwbGFj
ZVJlZmVyZW5jZXMgPSBmdW5jdGlvbiht
c2csIGFyZ3MpIHsKICByZXR1cm4gbXNn
LnJlcGxhY2UoL1wkKFxkKykvZywgZnVu
Y3Rpb24gKG0sIGluZGV4KSB7CiAgICAg
IHJldHVybiBhcmdzW2luZGV4IC0gMV07
CiAgICB9KTsKfTsKCi8qKgogKiBQZXIt
aW5zdGFuY2UgY29weSBvZiByZXBsYWNl
UmVmZXJlbmNlcy4KICovCmxpYi5NZXNz
YWdlTWFuYWdlci5wcm90b3R5cGUucmVw
bGFjZVJlZmVyZW5jZXMgPQogICAgbGli
Lk1lc3NhZ2VNYW5hZ2VyLnJlcGxhY2VS
ZWZlcmVuY2VzOwoKLyoqCiAqIEdldCBh
IG1lc3NhZ2UgYnkgbmFtZSwgb3B0aW9u
YWxseSByZXBsYWNpbmcgYXJndW1lbnRz
IHRvby4KICoKICogQHBhcmFtIHtzdHJp
bmd9IG1zZ25hbWUgU3RyaW5nIGNvbnRh
aW5pbmcgdGhlIG5hbWUgb2YgdGhlIG1l
c3NhZ2UgdG8gZ2V0LgogKiBAcGFyYW0g
e0FycmF5fSBvcHRfYXJncyBPcHRpb25h
bCBhcnJheSBjb250YWluaW5nIHRoZSBh
cmd1bWVudCB2YWx1ZXMuCiAqIEBwYXJh
bSB7c3RyaW5nfSBvcHRfZGVmYXVsdCBP
cHRpb25hbCB2YWx1ZSB0byByZXR1cm4g
aWYgdGhlIG1zZ25hbWUgaXMgbm90CiAq
ICAgICBmb3VuZC4gIFJldHVybnMgdGhl
IG1lc3NhZ2UgbmFtZSBieSBkZWZhdWx0
LgogKi8KbGliLk1lc3NhZ2VNYW5hZ2Vy
LnByb3RvdHlwZS5nZXQgPSBmdW5jdGlv
bihtc2duYW1lLCBvcHRfYXJncywgb3B0
X2RlZmF1bHQpIHsKICB2YXIgbWVzc2Fn
ZTsKCiAgaWYgKG1zZ25hbWUgaW4gdGhp
cy5tZXNzYWdlcykgewogICAgbWVzc2Fn
ZSA9IHRoaXMubWVzc2FnZXNbbXNnbmFt
ZV07CgogIH0gZWxzZSB7CiAgICBpZiAo
d2luZG93LmNocm9tZS5pMThuKQogICAg
ICBtZXNzYWdlID0gY2hyb21lLmkxOG4u
Z2V0TWVzc2FnZShtc2duYW1lKTsKCiAg
ICBpZiAoIW1lc3NhZ2UpIHsKICAgICAg
Y29uc29sZS53YXJuKCdVbmtub3duIG1l
c3NhZ2U6ICcgKyBtc2duYW1lKTsKICAg
ICAgcmV0dXJuICh0eXBlb2Ygb3B0X2Rl
ZmF1bHQgPT0gJ3VuZGVmaW5lZCcpID8g
bXNnbmFtZSA6IG9wdF9kZWZhdWx0Owog
ICAgfQogIH0KCiAgaWYgKCFvcHRfYXJn
cykKICAgIHJldHVybiBtZXNzYWdlOwoK
ICBpZiAoIShvcHRfYXJncyBpbnN0YW5j
ZW9mIEFycmF5KSkKICAgIG9wdF9hcmdz
ID0gW29wdF9hcmdzXTsKCiAgcmV0dXJu
IHRoaXMucmVwbGFjZVJlZmVyZW5jZXMo
bWVzc2FnZSwgb3B0X2FyZ3MpOwp9OwoK
LyoqCiAqIFByb2Nlc3MgYWxsIG9mIHRo
ZSAiaTE4biIgaHRtbCBhdHRyaWJ1dGVz
IGZvdW5kIGluIGEgZ2l2ZW4gZG9tIGZy
YWdtZW50LgogKgogKiBFYWNoIGkxOG4g
YXR0cmlidXRlIHNob3VsZCBjb250YWlu
IGEgSlNPTiBvYmplY3QuICBUaGUga2V5
cyBhcmUgdGFrZW4gdG8KICogYmUgYXR0
cmlidXRlIG5hbWVzLCBhbmQgdGhlIHZh
bHVlcyBhcmUgbWVzc2FnZSBuYW1lcy4K
ICoKICogSWYgdGhlIEpTT04gb2JqZWN0
IGhhcyBhICJfIiAodW5kZXJzY29yZSkg
a2V5LCBpdCdzIHZhbHVlIGlzIHVzZWQg
YXMgdGhlCiAqIHRleHRDb250ZW50IG9m
IHRoZSBlbGVtZW50LgogKgogKiBNZXNz
YWdlIG5hbWVzIGNhbiByZWZlciB0byBv
dGhlciBhdHRyaWJ1dGVzIG9uIHRoZSBz
YW1lIGVsZW1lbnQgd2l0aCBieQogKiBw
cmVmaXhpbmcgd2l0aCBhIGRvbGxhciBz
aWduLiAgRm9yIGV4YW1wbGUuLi4KICoK
ICogICA8YnV0dG9uIGlkPSdzZW5kLWJ1
dHRvbicKICogICAgICAgICAgIGkxOG49
J3siYXJpYS1sYWJlbCI6ICIkaWQiLCAi
XyI6ICJTRU5EX0JVVFRPTl9MQUJFTCJ9
JwogKiAgICAgICAgICAgPjwvYnV0dG9u
PgogKgogKiBUaGUgYXJpYS1sYWJlbCBt
ZXNzYWdlIG5hbWUgd2lsbCBiZSBjb21w
dXRlZCBhcyAiU0VORF9CVVRUT05fQVJJ
QV9MQUJFTCIuCiAqIE5vdGljZSB0aGF0
IHRoZSAiaWQiIGF0dHJpYnV0ZSB3YXMg
YXBwZW5kZWQgdG8gdGhlIHRhcmdldCBh
dHRyaWJ1dGUsIGFuZAogKiB0aGUgcmVz
dWx0IGNvbnZlcnRlZCB0byBVUFBFUl9B
TkRfVU5ERVIgc3R5bGUuCiAqLwpsaWIu
TWVzc2FnZU1hbmFnZXIucHJvdG90eXBl
LnByb2Nlc3NJMThuQXR0cmlidXRlcyA9
IGZ1bmN0aW9uKGRvbSkgewogIC8vIENv
bnZlcnQgdGhlICJsb3dlci1hbmQtZGFz
aGVzIiBhdHRyaWJ1dGUgbmFtZXMgaW50
bwogIC8vICJVUFBFUl9BTkRfVU5ERVIi
IHN0eWxlLgogIGZ1bmN0aW9uIHRodW5r
KHN0cikgeyByZXR1cm4gc3RyLnJlcGxh
Y2UoLy0vZywgJ18nKS50b1VwcGVyQ2Fz
ZSgpIH0KCiAgdmFyIG5vZGVzID0gZG9t
LnF1ZXJ5U2VsZWN0b3JBbGwoJ1tpMThu
XScpOwoKICBmb3IgKHZhciBpID0gMDsg
aSA8IG5vZGVzLmxlbmd0aDsgaSsrKSB7
CiAgICB2YXIgbm9kZSA9IG5vZGVzW2ld
OwogICAgdmFyIGkxOG4gPSBub2RlLmdl
dEF0dHJpYnV0ZSgnaTE4bicpOwoKICAg
IGlmICghaTE4bikKICAgICAgY29udGlu
dWU7CgogICAgdHJ5IHsKICAgICAgaTE4
biA9IEpTT04ucGFyc2UoaTE4bik7CiAg
ICB9IGNhdGNoIChleCkgewogICAgICBj
b25zb2xlLmVycm9yKCdDYW5cJ3QgcGFy
c2UgJyArIG5vZGUudGFnTmFtZSArICcj
JyArIG5vZGUuaWQgKyAnOiAnICsKICAg
ICAgICAgICAgICAgICAgICBpMThuKTsK
ICAgICAgdGhyb3cgZXg7CiAgICB9Cgog
ICAgZm9yICh2YXIga2V5IGluIGkxOG4p
IHsKICAgICAgdmFyIG1zZ25hbWUgPSBp
MThuW2tleV07CiAgICAgIGlmIChtc2du
YW1lLnN1YnN0cigwLCAxKSA9PSAnJCcp
CiAgICAgICAgbXNnbmFtZSA9IHRodW5r
KG5vZGUuZ2V0QXR0cmlidXRlKG1zZ25h
bWUuc3Vic3RyKDEpKSArICdfJyArIGtl
eSk7CgogICAgICB2YXIgbXNnID0gdGhp
cy5nZXQobXNnbmFtZSk7CiAgICAgIGlm
IChrZXkgPT0gJ18nKSB7CiAgICAgICAg
bm9kZS50ZXh0Q29udGVudCA9IG1zZzsK
ICAgICAgfSBlbHNlIHsKICAgICAgICBu
b2RlLnNldEF0dHJpYnV0ZShrZXksIG1z
Zyk7CiAgICAgIH0KICAgIH0KICB9Cn07
Ci8vIFNPVVJDRSBGSUxFOiBsaWJkb3Qv
anMvbGliX3ByZWZlcmVuY2VfbWFuYWdl
ci5qcwovLyBDb3B5cmlnaHQgKGMpIDIw
MTIgVGhlIENocm9taXVtIE9TIEF1dGhv
cnMuIEFsbCByaWdodHMgcmVzZXJ2ZWQu
Ci8vIFVzZSBvZiB0aGlzIHNvdXJjZSBj
b2RlIGlzIGdvdmVybmVkIGJ5IGEgQlNE
LXN0eWxlIGxpY2Vuc2UgdGhhdCBjYW4g
YmUKLy8gZm91bmQgaW4gdGhlIExJQ0VO
U0UgZmlsZS4KCid1c2Ugc3RyaWN0JzsK
Ci8qKgogKiBDb25zdHJ1Y3RvciBmb3Ig
bGliLlByZWZlcmVuY2VNYW5hZ2VyIG9i
amVjdHMuCiAqCiAqIFRoZXNlIG9iamVj
dHMgZGVhbCB3aXRoIHBlcnNpc3Rpbmcg
Y2hhbmdlcyB0byBzdGFibGUgc3RvcmFn
ZSBhbmQgbm90aWZ5aW5nCiAqIGNvbnN1
bWVycyB3aGVuIHByZWZlcmVuY2VzIGNo
YW5nZS4KICoKICogSXQgaXMgaW50ZW5k
ZWQgdGhhdCB0aGUgYmFja2luZyBzdG9y
ZSBjb3VsZCBiZSBzb21ldGhpbmcgb3Ro
ZXIgdGhhbiBIVE1MNQogKiBzdG9yYWdl
LCBidXQgdGhlcmUgYXJlbid0IGFueSB1
c2UgY2FzZXMgYXQgdGhlIG1vbWVudC4g
IEluIHRoZSBmdXR1cmUgdGhlcmUKICog
bWF5IGJlIGEgY2hyb21lIGFwaSB0byBz
dG9yZSBzeW5jLWFibGUgbmFtZS92YWx1
ZSBwYWlycywgYW5kIHdlJ2Qgd2FudAog
KiB0aGF0LgogKgogKiBAcGFyYW0ge2xp
Yi5TdG9yYWdlLip9IHN0b3JhZ2UgVGhl
IHN0b3JhZ2Ugb2JqZWN0IHRvIHVzZSBh
cyBhIGJhY2tpbmcKICogICAgIHN0b3Jl
LgogKiBAcGFyYW0ge3N0cmluZ30gb3B0
X3ByZWZpeCBUaGUgb3B0aW9uYWwgcHJl
Zml4IHRvIGJlIHVzZWQgZm9yIGFsbCBw
cmVmZXJlbmNlCiAqICAgICBuYW1lcy4g
IFRoZSAnLycgY2hhcmFjdGVyIHNob3Vs
ZCBiZSB1c2VkIHRvIHNlcGFyYXRlIGxl
dmVscyBvZiBoZWlyYXJjaHksCiAqICAg
ICBpZiB5b3UncmUgZ29pbmcgdG8gaGF2
ZSB0aGF0IGtpbmQgb2YgdGhpbmcuICBJ
ZiBwcm92aWRlZCwgdGhlIHByZWZpeAog
KiAgICAgc2hvdWxkIHN0YXJ0IHdpdGgg
YSAnLycuICBJZiBub3QgcHJvdmlkZWQs
IGl0IGRlZmF1bHRzIHRvICcvJy4KICov
CmxpYi5QcmVmZXJlbmNlTWFuYWdlciA9
IGZ1bmN0aW9uKHN0b3JhZ2UsIG9wdF9w
cmVmaXgpIHsKICB0aGlzLnN0b3JhZ2Ug
PSBzdG9yYWdlOwogIHRoaXMuc3RvcmFn
ZU9ic2VydmVyXyA9IHRoaXMub25TdG9y
YWdlQ2hhbmdlXy5iaW5kKHRoaXMpOwoK
ICB0aGlzLmlzQWN0aXZlXyA9IGZhbHNl
OwogIHRoaXMuYWN0aXZhdGUoKTsKCiAg
dGhpcy50cmFjZSA9IGZhbHNlOwoKICB2
YXIgcHJlZml4ID0gb3B0X3ByZWZpeCB8
fCAnLyc7CiAgaWYgKHByZWZpeC5zdWJz
dHIocHJlZml4Lmxlbmd0aCAtIDEpICE9
ICcvJykKICAgIHByZWZpeCArPSAnLyc7
CgogIHRoaXMucHJlZml4ID0gcHJlZml4
OwoKICB0aGlzLnByZWZSZWNvcmRzXyA9
IHt9OwogIHRoaXMuZ2xvYmFsT2JzZXJ2
ZXJzXyA9IFtdOwoKICB0aGlzLmNoaWxk
RmFjdG9yaWVzXyA9IHt9OwoKICAvLyBN
YXAgb2YgbGlzdC1uYW1lIHRvIHttYXAg
b2YgY2hpbGQgcHJlZiBtYW5hZ2Vyc30K
ICAvLyBBcyBpbi4uLgogIC8vCiAgLy8g
IHRoaXMuY2hpbGRMaXN0c18gPSB7CiAg
Ly8gICAgJ3Byb2ZpbGUtaWRzJzogewog
IC8vICAgICAgJ29uZSc6IFByZWZlcmVu
Y2VNYW5hZ2VyLAogIC8vICAgICAgJ3R3
byc6IFByZWZlcmVuY2VNYW5hZ2VyLAog
IC8vICAgICAgLi4uCiAgLy8gICAgfSwK
ICAvLwogIC8vICAgICdmcm9iLWlkcyc6
IHsKICAvLyAgICAgIC4uLgogIC8vICAg
IH0KICAvLyAgfQogIHRoaXMuY2hpbGRM
aXN0c18gPSB7fTsKfTsKCi8qKgogKiBV
c2VkIGludGVybmFsbHkgdG8gaW5kaWNh
dGUgdGhhdCB0aGUgY3VycmVudCB2YWx1
ZSBvZiB0aGUgcHJlZmVyZW5jZSBzaG91
bGQKICogYmUgdGFrZW4gZnJvbSB0aGUg
ZGVmYXVsdCB2YWx1ZSBkZWZpbmVkIHdp
dGggdGhlIHByZWZlcmVuY2UuCiAqCiAq
IEVxdWFsaXR5IHRlc3RzIGFnYWluc3Qg
dGhpcyB2YWx1ZSBNVVNUIHVzZSAnPT09
JyBvciAnIT09JyB0byBiZSBhY2N1cmF0
ZS4KICovCmxpYi5QcmVmZXJlbmNlTWFu
YWdlci5wcm90b3R5cGUuREVGQVVMVF9W
QUxVRSA9IG5ldyBTdHJpbmcoJ0RFRkFV
TFQnKTsKCi8qKgogKiBBbiBpbmRpdmlk
dWFsIHByZWZlcmVuY2UuCiAqCiAqIFRo
ZXNlIG9iamVjdHMgYXJlIG1hbmFnZWQg
YnkgdGhlIFByZWZlcmVuY2VNYW5hZ2Vy
LCB5b3Ugc2hvdWRuJ3QgbmVlZCB0bwog
KiBoYW5kbGUgdGhlbSBkaXJlY3RseS4K
ICovCmxpYi5QcmVmZXJlbmNlTWFuYWdl
ci5SZWNvcmQgPSBmdW5jdGlvbihuYW1l
LCBkZWZhdWx0VmFsdWUpIHsKICB0aGlz
Lm5hbWUgPSBuYW1lOwogIHRoaXMuZGVm
YXVsdFZhbHVlID0gZGVmYXVsdFZhbHVl
OwogIHRoaXMuY3VycmVudFZhbHVlID0g
dGhpcy5ERUZBVUxUX1ZBTFVFOwogIHRo
aXMub2JzZXJ2ZXJzID0gW107Cn07Cgov
KioKICogQSBsb2NhbCBjb3B5IG9mIHRo
ZSBERUZBVUxUX1ZBTFVFIGNvbnN0YW50
IHRvIG1ha2UgaXQgbGVzcyB2ZXJib3Nl
LgogKi8KbGliLlByZWZlcmVuY2VNYW5h
Z2VyLlJlY29yZC5wcm90b3R5cGUuREVG
QVVMVF9WQUxVRSA9CiAgICBsaWIuUHJl
ZmVyZW5jZU1hbmFnZXIucHJvdG90eXBl
LkRFRkFVTFRfVkFMVUU7CgovKioKICog
UmVnaXN0ZXIgYSBjYWxsYmFjayB0byBi
ZSBpbnZva2VkIHdoZW4gdGhpcyBwcmVm
ZXJlbmNlIGNoYW5nZXMuCiAqCiAqIEBw
YXJhbSB7ZnVuY3Rpb24odmFsdWUsIHN0
cmluZywgbGliLlByZWZlcmVuY2VNYW5h
Z2VyfSBvYnNlcnZlciBUaGUgZnVuY3Rp
b24KICogICAgIHRvIGludm9rZS4gIEl0
IHdpbGwgcmVjZWl2ZSB0aGUgbmV3IHZh
bHVlLCB0aGUgbmFtZSBvZiB0aGUgcHJl
ZmVyZW5jZSwKICogICAgIGFuZCBhIHJl
ZmVyZW5jZSB0byB0aGUgUHJlZmVyZW5j
ZU1hbmFnZXIgYXMgcGFyYW1ldGVycy4K
ICovCmxpYi5QcmVmZXJlbmNlTWFuYWdl
ci5SZWNvcmQucHJvdG90eXBlLmFkZE9i
c2VydmVyID0gZnVuY3Rpb24ob2JzZXJ2
ZXIpIHsKICB0aGlzLm9ic2VydmVycy5w
dXNoKG9ic2VydmVyKTsKfTsKCi8qKgog
KiBVbnJlZ2lzdGVyIGFuIG9ic2VydmVy
IGNhbGxiYWNrLgogKgogKiBAcGFyYW0g
e2Z1bmN0aW9ufSBvYnNlcnZlciBBIHBy
ZXZpb3VzbHkgcmVnaXN0ZXJlZCBjYWxs
YmFjay4KICovCmxpYi5QcmVmZXJlbmNl
TWFuYWdlci5SZWNvcmQucHJvdG90eXBl
LnJlbW92ZU9ic2VydmVyID0gZnVuY3Rp
b24ob2JzZXJ2ZXIpIHsKICB2YXIgaSA9
IHRoaXMub2JzZXJ2ZXJzLmluZGV4T2Yo
b2JzZXJ2ZXIpOwogIGlmIChpID49IDAp
CiAgICB0aGlzLm9ic2VydmVycy5zcGxp
Y2UoaSwgMSk7Cn07CgovKioKICogRmV0
Y2ggdGhlIHZhbHVlIG9mIHRoaXMgcHJl
ZmVyZW5jZS4KICovCmxpYi5QcmVmZXJl
bmNlTWFuYWdlci5SZWNvcmQucHJvdG90
eXBlLmdldCA9IGZ1bmN0aW9uKCkgewog
IGlmICh0aGlzLmN1cnJlbnRWYWx1ZSA9
PT0gdGhpcy5ERUZBVUxUX1ZBTFVFKSB7
CiAgICBpZiAoL14oc3RyaW5nfG51bWJl
cikkLy50ZXN0KHR5cGVvZiB0aGlzLmRl
ZmF1bHRWYWx1ZSkpCiAgICAgIHJldHVy
biB0aGlzLmRlZmF1bHRWYWx1ZTsKCiAg
ICBpZiAodHlwZW9mIHRoaXMuZGVmYXVs
dFZhbHVlID09ICdvYmplY3QnKSB7CiAg
ICAgIC8vIFdlIHdhbnQgdG8gcmV0dXJu
IGEgQ09QWSBvZiB0aGUgZGVmYXVsdCB2
YWx1ZSBzbyB0aGF0IHVzZXJzIGNhbgog
ICAgICAvLyBtb2RpZnkgdGhlIGFycmF5
IG9yIG9iamVjdCB3aXRob3V0IGNoYW5n
aW5nIHRoZSBkZWZhdWx0IHZhbHVlLgog
ICAgICByZXR1cm4gSlNPTi5wYXJzZShK
U09OLnN0cmluZ2lmeSh0aGlzLmRlZmF1
bHRWYWx1ZSkpOwogICAgfQoKICAgIHJl
dHVybiB0aGlzLmRlZmF1bHRWYWx1ZTsK
ICB9CgogIHJldHVybiB0aGlzLmN1cnJl
bnRWYWx1ZTsKfTsKCi8qKgogKiBTdG9w
IHRoaXMgcHJlZmVyZW5jZSBtYW5hZ2Vy
IGZyb20gdHJhY2tpbmcgc3RvcmFnZSBj
aGFuZ2VzLgogKgogKiBDYWxsIHRoaXMg
aWYgeW91J3JlIGdvaW5nIHRvIHN3YXAg
b3V0IG9uZSBwcmVmZXJlbmNlIG1hbmFn
ZXIgZm9yIGFub3RoZXIgc28KICogdGhh
dCB5b3UgZG9uJ3QgZ2V0IG5vdGlmaWVk
IGFib3V0IGlycmVsZXZhbnQgY2hhbmdl
cy4KICovCmxpYi5QcmVmZXJlbmNlTWFu
YWdlci5wcm90b3R5cGUuZGVhY3RpdmF0
ZSA9IGZ1bmN0aW9uKCkgewogIGlmICgh
dGhpcy5pc0FjdGl2ZV8pCiAgICB0aHJv
dyBuZXcgRXJyb3IoJ05vdCBhY3RpdmF0
ZWQnKTsKCiAgdGhpcy5pc0FjdGl2ZV8g
PSBmYWxzZTsKICB0aGlzLnN0b3JhZ2Uu
cmVtb3ZlT2JzZXJ2ZXIodGhpcy5zdG9y
YWdlT2JzZXJ2ZXJfKTsKfTsKCi8qKgog
KiBTdGFydCB0cmFja2luZyBzdG9yYWdl
IGNoYW5nZXMuCiAqCiAqIElmIHlvdSBw
cmV2aW91c2x5IGRlYWN0aXZhdGVkIHRo
aXMgcHJlZmVyZW5jZSBtYW5hZ2VyLCB5
b3UgY2FuIHJlYWN0aXZhdGUgaXQKICog
d2l0aCB0aGlzIG1ldGhvZC4gIFlvdSBk
b24ndCBuZWVkIHRvIGNhbGwgdGhpcyBh
dCBpbml0aWFsaXphdGlvbiB0aW1lLCBh
cwogKiBpdCdzIGF1dG9tYXRpY2FsbHkg
Y2FsbGVkIGFzIHBhcnQgb2YgdGhlIGNv
bnN0cnVjdG9yLgogKi8KbGliLlByZWZl
cmVuY2VNYW5hZ2VyLnByb3RvdHlwZS5h
Y3RpdmF0ZSA9IGZ1bmN0aW9uKCkgewog
IGlmICh0aGlzLmlzQWN0aXZlXykKICAg
IHRocm93IG5ldyBFcnJvcignQWxyZWFk
eSBhY3RpdmF0ZWQnKTsKCiAgdGhpcy5p
c0FjdGl2ZV8gPSB0cnVlOwogIHRoaXMu
c3RvcmFnZS5hZGRPYnNlcnZlcih0aGlz
LnN0b3JhZ2VPYnNlcnZlcl8pOwp9OwoK
LyoqCiAqIFJlYWQgdGhlIGJhY2tpbmcg
c3RvcmFnZSBmb3IgdGhlc2UgcHJlZmVy
ZW5jZXMuCiAqCiAqIFlvdSBzaG91bGQg
ZG8gdGhpcyBvbmNlIGF0IGluaXRpYWxp
emF0aW9uIHRpbWUgdG8gcHJpbWUgdGhl
IGxvY2FsIGNhY2hlCiAqIG9mIHByZWZl
cmVuY2UgdmFsdWVzLiAgVGhlIHByZWZl
cmVuY2UgbWFuYWdlciB3aWxsIG1vbml0
b3IgdGhlIGJhY2tpbmcKICogc3RvcmFn
ZSBmb3IgY2hhbmdlcywgc28geW91IHNo
b3VsZCBub3QgbmVlZCB0byBjYWxsIHRo
aXMgbW9yZSB0aGFuIG9uY2UuCiAqCiAq
IFRoaXMgZnVuY3Rpb24gcmVjdXJzaXZl
bHkgcmVhZHMgc3RvcmFnZSBmb3IgYWxs
IGNoaWxkIHByZWZlcmVuY2UgbWFuYWdl
cnMgYXMKICogd2VsbC4KICoKICogVGhp
cyBmdW5jdGlvbiBpcyBhc3luY2hyb25v
dXMsIGlmIHlvdSBuZWVkIHRvIHJlYWQg
cHJlZmVyZW5jZSB2YWx1ZXMsIHlvdQog
KiAqbXVzdCogd2FpdCBmb3IgdGhlIGNh
bGxiYWNrLgogKgogKiBAcGFyYW0ge2Z1
bmN0aW9uKCl9IG9wdF9jYWxsYmFjayBP
cHRpb25hbCBmdW5jdGlvbiB0byBpbnZv
a2Ugd2hlbiB0aGUgcmVhZAogKiAgICAg
aGFzIGNvbXBsZXRlZC4KICovCmxpYi5Q
cmVmZXJlbmNlTWFuYWdlci5wcm90b3R5
cGUucmVhZFN0b3JhZ2UgPSBmdW5jdGlv
bihvcHRfY2FsbGJhY2spIHsKICB2YXIg
cGVuZGluZ0NoaWxkcmVuID0gMDsKCiAg
ZnVuY3Rpb24gb25DaGlsZENvbXBsZXRl
KCkgewogICAgaWYgKC0tcGVuZGluZ0No
aWxkcmVuID09IDAgJiYgb3B0X2NhbGxi
YWNrKQogICAgICBvcHRfY2FsbGJhY2so
KTsKICB9CgogIHZhciBrZXlzID0gT2Jq
ZWN0LmtleXModGhpcy5wcmVmUmVjb3Jk
c18pLm1hcCgKICAgICAgZnVuY3Rpb24o
ZWwpIHsgcmV0dXJuIHRoaXMucHJlZml4
ICsgZWwgfS5iaW5kKHRoaXMpKTsKCiAg
aWYgKHRoaXMudHJhY2UpCiAgICBjb25z
b2xlLmxvZygnUHJlZmVyZW5jZXMgcmVh
ZDogJyArIHRoaXMucHJlZml4KTsKCiAg
dGhpcy5zdG9yYWdlLmdldEl0ZW1zKGtl
eXMsIGZ1bmN0aW9uKGl0ZW1zKSB7CiAg
ICAgIHZhciBwcmVmaXhMZW5ndGggPSB0
aGlzLnByZWZpeC5sZW5ndGg7CgogICAg
ICBmb3IgKHZhciBrZXkgaW4gaXRlbXMp
IHsKICAgICAgICB2YXIgdmFsdWUgPSBp
dGVtc1trZXldOwogICAgICAgIHZhciBu
YW1lID0ga2V5LnN1YnN0cihwcmVmaXhM
ZW5ndGgpOwogICAgICAgIHZhciBuZWVk
U3luYyA9IChuYW1lIGluIHRoaXMuY2hp
bGRMaXN0c18gJiYKICAgICAgICAgICAg
ICAgICAgICAgICAgKEpTT04uc3RyaW5n
aWZ5KHZhbHVlKSAhPQogICAgICAgICAg
ICAgICAgICAgICAgICAgSlNPTi5zdHJp
bmdpZnkodGhpcy5wcmVmUmVjb3Jkc19b
bmFtZV0uY3VycmVudFZhbHVlKSkpOwoK
ICAgICAgICB0aGlzLnByZWZSZWNvcmRz
X1tuYW1lXS5jdXJyZW50VmFsdWUgPSB2
YWx1ZTsKCiAgICAgICAgaWYgKG5lZWRT
eW5jKSB7CiAgICAgICAgICBwZW5kaW5n
Q2hpbGRyZW4rKzsKICAgICAgICAgIHRo
aXMuc3luY0NoaWxkTGlzdChuYW1lLCBv
bkNoaWxkQ29tcGxldGUpOwogICAgICAg
IH0KICAgICAgfQoKICAgICAgaWYgKHBl
bmRpbmdDaGlsZHJlbiA9PSAwICYmIG9w
dF9jYWxsYmFjaykKICAgICAgICBzZXRU
aW1lb3V0KG9wdF9jYWxsYmFjayk7CiAg
ICB9LmJpbmQodGhpcykpOwp9OwoKLyoq
CiAqIERlZmluZSBhIHByZWZlcmVuY2Uu
CiAqCiAqIFRoaXMgcmVnaXN0ZXJzIGEg
bmFtZSwgZGVmYXVsdCB2YWx1ZSwgYW5k
IG9uQ2hhbmdlIGhhbmRsZXIgZm9yIGEg
cHJlZmVyZW5jZS4KICoKICogQHBhcmFt
IHtzdHJpbmd9IG5hbWUgVGhlIG5hbWUg
b2YgdGhlIHByZWZlcmVuY2UuICBUaGlz
IHdpbGwgYmUgcHJlZml4ZWQgYnkKICog
ICAgIHRoZSBwcmVmaXggb2YgdGhpcyBQ
cmVmZXJlbmNlTWFuYWdlciBiZWZvcmUg
d3JpdHRlbiB0byBsb2NhbCBzdG9yYWdl
LgogKiBAcGFyYW0ge3N0cmluZ3xudW1i
ZXJ8Ym9vbGVhbnxPYmplY3R8QXJyYXl8
bnVsbH0gdmFsdWUgVGhlIGRlZmF1bHQg
dmFsdWUgb2YKICogICAgIHRoaXMgcHJl
ZmVyZW5jZS4gIEFueXRoaW5nIHRoYXQg
Y2FuIGJlIHJlcHJlc2VudGVkIGluIEpT
T04gaXMgYSB2YWxpZAogKiAgICAgZGVm
YXVsdCB2YWx1ZS4KICogQHBhcmFtIHtm
dW5jdGlvbih2YWx1ZSwgc3RyaW5nLCBs
aWIuUHJlZmVyZW5jZU1hbmFnZXJ9IG9w
dF9vYnNlcnZlciBBCiAqICAgICBmdW5j
dGlvbiB0byBpbnZva2Ugd2hlbiB0aGUg
cHJlZmVyZW5jZSBjaGFuZ2VzLiAgSXQg
d2lsbCByZWNlaXZlIHRoZSBuZXcKICog
ICAgIHZhbHVlLCB0aGUgbmFtZSBvZiB0
aGUgcHJlZmVyZW5jZSwgYW5kIGEgcmVm
ZXJlbmNlIHRvIHRoZQogKiAgICAgUHJl
ZmVyZW5jZU1hbmFnZXIgYXMgcGFyYW1l
dGVycy4KICovCmxpYi5QcmVmZXJlbmNl
TWFuYWdlci5wcm90b3R5cGUuZGVmaW5l
UHJlZmVyZW5jZSA9IGZ1bmN0aW9uKAog
ICAgbmFtZSwgdmFsdWUsIG9wdF9vbkNo
YW5nZSkgewoKICB2YXIgcmVjb3JkID0g
dGhpcy5wcmVmUmVjb3Jkc19bbmFtZV07
CiAgaWYgKHJlY29yZCkgewogICAgdGhp
cy5jaGFuZ2VEZWZhdWx0KG5hbWUsIHZh
bHVlKTsKICB9IGVsc2UgewogICAgcmVj
b3JkID0gdGhpcy5wcmVmUmVjb3Jkc19b
bmFtZV0gPQogICAgICAgIG5ldyBsaWIu
UHJlZmVyZW5jZU1hbmFnZXIuUmVjb3Jk
KG5hbWUsIHZhbHVlKTsKICB9CgogIGlm
IChvcHRfb25DaGFuZ2UpCiAgICByZWNv
cmQuYWRkT2JzZXJ2ZXIob3B0X29uQ2hh
bmdlKTsKfTsKCi8qKgogKiBEZWZpbmUg
bXVsdGlwbGUgcHJlZmVyZW5jZXMgd2l0
aCBhIHNpbmdsZSBmdW5jdGlvbiBjYWxs
LgogKgogKiBAcGFyYW0ge0FycmF5fSBk
ZWZhdWx0cyBBbiBhcnJheSBvZiAzLWVs
ZW1lbnQgYXJyYXlzLiAgRWFjaCB0aHJl
ZSBlbGVtZW50CiAqICAgICBhcnJheSBz
aG91bGQgY29udGFpbiB0aGUgW2tleSwg
dmFsdWUsIG9uQ2hhbmdlXSBwYXJhbWV0
ZXJzIGZvciBhCiAqICAgICBwcmVmZXJl
bmNlLgogKi8KbGliLlByZWZlcmVuY2VN
YW5hZ2VyLnByb3RvdHlwZS5kZWZpbmVQ
cmVmZXJlbmNlcyA9IGZ1bmN0aW9uKGRl
ZmF1bHRzKSB7CiAgZm9yICh2YXIgaSA9
IDA7IGkgPCBkZWZhdWx0cy5sZW5ndGg7
IGkrKykgewogICAgdGhpcy5kZWZpbmVQ
cmVmZXJlbmNlKGRlZmF1bHRzW2ldWzBd
LCBkZWZhdWx0c1tpXVsxXSwgZGVmYXVs
dHNbaV1bMl0pOwogIH0KfTsKCi8qKgog
KiBEZWZpbmUgYW4gb3JkZXJlZCBsaXN0
IG9mIGNoaWxkIHByZWZlcmVuY2VzLgog
KgogKiBDaGlsZCBwcmVmZXJlbmNlcyBh
cmUgZGlmZmVyZW50IGZyb20ganVzdCBz
dG9yaW5nIGFuIGFycmF5IG9mIEpTT04g
b2JqZWN0cwogKiBpbiB0aGF0IGVhY2gg
Y2hpbGQgaXMgYW4gaW5zdGFuY2Ugb2Yg
YSBwcmVmZXJlbmNlIG1hbmFnZXIuICBU
aGlzIG1lYW5zIHlvdQogKiBjYW4gb2Jz
ZXJ2ZSBjaGFuZ2VzIHRvIGluZGl2aWR1
YWwgY2hpbGQgcHJlZmVyZW5jZXMsIGFu
ZCBnZXQgc29tZSB2YWxpZGF0aW9uCiAq
IHRoYXQgeW91J3JlIG5vdCByZWFkaW5n
IG9yIHdyaXRpbmcgdG8gYW4gdW5kZWZp
bmVkIGNoaWxkIHByZWZlcmVuY2UgdmFs
dWUuCiAqCiAqIEBwYXJhbSB7c3RyaW5n
fSBsaXN0TmFtZSBBIG5hbWUgZm9yIHRo
ZSBsaXN0IG9mIGNoaWxkcmVuLiAgVGhp
cyBtdXN0IGJlCiAqICAgICB1bmlxdWUg
aW4gdGhpcyBwcmVmZXJlbmNlIG1hbmFn
ZXIuICBUaGUgbGlzdE5hbWUgd2lsbCBi
ZWNvbWUgYQogKiAgICAgcHJlZmVyZW5j
ZSBvbiB0aGlzIFByZWZlcmVuY2VNYW5h
Z2VyIHVzZWQgdG8gc3RvcmUgdGhlIG9y
ZGVyZWQgbGlzdCBvZgogKiAgICAgY2hp
bGQgaWRzLiAgSXQgaXMgYWxzbyB1c2Vk
IGluIGdldC9hZGQvcmVtb3ZlIG9wZXJh
dGlvbnMgdG8gaWRlbnRpZnkgdGhlCiAq
ICAgICBsaXN0IG9mIGNoaWxkcmVuIHRv
IG9wZXJhdGUgb24uCiAqIEBwYXJhbSB7
ZnVuY3Rpb259IGNoaWxkRmFjdG9yeSBB
IGZ1bmN0aW9uIHRoYXQgd2lsbCBiZSB1
c2VkIHRvIGdlbmVyYXRlCiAqICAgICBp
bnN0YW5jZXMgb2YgdGhlc2UgY2hpbGRy
ZWQuICBUaGUgZmFjdG9yeSBmdW5jdGlv
biB3aWxsIHJlY2VpdmUgdGhlCiAqICAg
ICBwYXJlbnQgbGliLlByZWZlcmVuY2VN
YW5hZ2VyIG9iamVjdCBhbmQgYSB1bmlx
dWUgaWQgZm9yIHRoZSBuZXcgY2hpbGQK
ICogICAgIHByZWZlcmVuY2VzLgogKi8K
bGliLlByZWZlcmVuY2VNYW5hZ2VyLnBy
b3RvdHlwZS5kZWZpbmVDaGlsZHJlbiA9
IGZ1bmN0aW9uKAogICAgbGlzdE5hbWUs
IGNoaWxkRmFjdG9yeSkgewoKICAvLyBE
ZWZpbmUgYSBwcmVmZXJlbmNlIHRvIGhv
bGQgdGhlIG9yZGVyZWQgbGlzdCBvZiBj
aGlsZCBpZHMuCiAgdGhpcy5kZWZpbmVQ
cmVmZXJlbmNlKGxpc3ROYW1lLCBbXSwK
ICAgICAgICAgICAgICAgICAgICAgICAg
dGhpcy5vbkNoaWxkTGlzdENoYW5nZV8u
YmluZCh0aGlzLCBsaXN0TmFtZSkpOwog
IHRoaXMuY2hpbGRGYWN0b3JpZXNfW2xp
c3ROYW1lXSA9IGNoaWxkRmFjdG9yeTsK
ICB0aGlzLmNoaWxkTGlzdHNfW2xpc3RO
YW1lXSA9IHt9Owp9OwoKLyoqCiAqIFJl
Z2lzdGVyIHRvIG9ic2VydmUgcHJlZmVy
ZW5jZSBjaGFuZ2VzLgogKgogKiBAcGFy
YW0ge0Z1bmN0aW9ufSBnbG9iYWwgQSBj
YWxsYmFjayB0aGF0IHdpbGwgaGFwcGVu
IGZvciBldmVyeSBwcmVmZXJlbmNlLgog
KiAgICAgUGFzcyBudWxsIGlmIHlvdSBk
b24ndCBuZWVkIG9uZS4KICogQHBhcmFt
IHtPYmplY3R9IG1hcCBBIG1hcCBvZiBw
cmVmZXJlbmNlIHNwZWNpZmljIGNhbGxi
YWNrcy4gIFBhc3MgbnVsbCBpZgogKiAg
ICAgeW91IGRvbid0IG5lZWQgYW55Lgog
Ki8KbGliLlByZWZlcmVuY2VNYW5hZ2Vy
LnByb3RvdHlwZS5hZGRPYnNlcnZlcnMg
PSBmdW5jdGlvbihnbG9iYWwsIG1hcCkg
ewogIGlmIChnbG9iYWwgJiYgdHlwZW9m
IGdsb2JhbCAhPSAnZnVuY3Rpb24nKQog
ICAgdGhyb3cgbmV3IEVycm9yKCdJbnZh
bGlkIHBhcmFtOiBnbG9iYWxzJyk7Cgog
IGlmIChnbG9iYWwpCiAgICB0aGlzLmds
b2JhbE9ic2VydmVyc18ucHVzaChnbG9i
YWwpOwoKICBpZiAoIW1hcCkKICAgIHJl
dHVybjsKCiAgZm9yICh2YXIgbmFtZSBp
biBtYXApIHsKICAgIGlmICghKG5hbWUg
aW4gdGhpcy5wcmVmUmVjb3Jkc18pKQog
ICAgICB0aHJvdyBuZXcgRXJyb3IoJ1Vu
a25vd24gcHJlZmVyZW5jZTogJyArIG5h
bWUpOwoKICAgIHRoaXMucHJlZlJlY29y
ZHNfW25hbWVdLmFkZE9ic2VydmVyKG1h
cFtuYW1lXSk7CiAgfQp9OwoKLyoqCiAq
IERpc3BhdGNoIHRoZSBjaGFuZ2Ugb2Jz
ZXJ2ZXJzIGZvciBhbGwga25vd24gcHJl
ZmVyZW5jZXMuCiAqCiAqIEl0IG1heSBi
ZSB1c2VmdWwgdG8gY2FsbCB0aGlzIGFm
dGVyIHJlYWRTdG9yYWdlIGNvbXBsZXRl
cywgaW4gb3JkZXIgdG8KICogZ2V0IGFw
cGxpY2F0aW9uIHN0YXRlIGluIHN5bmMg
d2l0aCB1c2VyIHByZWZlcmVuY2VzLgog
KgogKiBUaGlzIGNhbiBiZSB1c2VkIGlm
IHlvdSd2ZSBjaGFuZ2VkIGEgcHJlZmVy
ZW5jZSBtYW5hZ2VyIG91dCBmcm9tIHVu
ZGVyCiAqIGEgbGl2ZSBvYmplY3QsIGZv
ciBleGFtcGxlIHdoZW4gc3dpdGNoaW5n
IHRvIGEgZGlmZmVyZW50IHByZWZpeC4K
ICovCmxpYi5QcmVmZXJlbmNlTWFuYWdl
ci5wcm90b3R5cGUubm90aWZ5QWxsID0g
ZnVuY3Rpb24oKSB7CiAgZm9yICh2YXIg
bmFtZSBpbiB0aGlzLnByZWZSZWNvcmRz
XykgewogICAgdGhpcy5ub3RpZnlDaGFu
Z2VfKG5hbWUpOwogIH0KfTsKCi8qKgog
KiBOb3RpZnkgdGhlIGNoYW5nZSBvYnNl
cnZlcnMgZm9yIGEgZ2l2ZW4gcHJlZmVy
ZW5jZS4KICoKICogQHBhcmFtIHtzdHJp
bmd9IG5hbWUgVGhlIG5hbWUgb2YgdGhl
IHByZWZlcmVuY2UgdGhhdCBjaGFuZ2Vk
LgogKi8KbGliLlByZWZlcmVuY2VNYW5h
Z2VyLnByb3RvdHlwZS5ub3RpZnlDaGFu
Z2VfID0gZnVuY3Rpb24obmFtZSkgewog
IHZhciByZWNvcmQgPSB0aGlzLnByZWZS
ZWNvcmRzX1tuYW1lXTsKICBpZiAoIXJl
Y29yZCkKICAgIHRocm93IG5ldyBFcnJv
cignVW5rbm93biBwcmVmZXJlbmNlOiAn
ICsgbmFtZSk7CgogIHZhciBjdXJyZW50
VmFsdWUgPSByZWNvcmQuZ2V0KCk7Cgog
IGZvciAodmFyIGkgPSAwOyBpIDwgdGhp
cy5nbG9iYWxPYnNlcnZlcnNfLmxlbmd0
aDsgaSsrKQogICAgdGhpcy5nbG9iYWxP
YnNlcnZlcnNfW2ldKG5hbWUsIGN1cnJl
bnRWYWx1ZSk7CgogIGZvciAodmFyIGkg
PSAwOyBpIDwgcmVjb3JkLm9ic2VydmVy
cy5sZW5ndGg7IGkrKykgewogICAgcmVj
b3JkLm9ic2VydmVyc1tpXShjdXJyZW50
VmFsdWUsIG5hbWUsIHRoaXMpOwogIH0K
fTsKCi8qKgogKiBDcmVhdGUgYSBuZXcg
Y2hpbGQgUHJlZmVyZW5jZU1hbmFnZXIg
Zm9yIHRoZSBnaXZlbiBjaGlsZCBsaXN0
LgogKgogKiBUaGUgb3B0aW9uYWwgaGlu
dCBwYXJhbWV0ZXIgaXMgYW4gb3BhcXVl
IHByZWZpeCBhZGRlZCB0byB0aGUgYXV0
by1nZW5lcmF0ZWQKICogdW5pcXVlIGlk
IGZvciB0aGlzIGNoaWxkLiAgWW91ciBj
aGlsZCBmYWN0b3J5IGNhbiBwYXJzZSBv
dXQgdGhlIHByZWZpeAogKiBhbmQgdXNl
IGl0LgogKgogKiBAcGFyYW0ge3N0cmlu
Z30gbGlzdE5hbWUgVGhlIGNoaWxkIGxp
c3QgdG8gY3JlYXRlIHRoZSBuZXcgaW5z
dGFuY2UgZnJvbS4KICogQHBhcmFtIHtz
dHJpbmd9IG9wdF9oaW50IE9wdGlvbmFs
IGhpbnQgdG8gaW5jbHVkZSBpbiB0aGUg
Y2hpbGQgaWQuCiAqIEBwYXJhbSB7c3Ry
aW5nfSBvcHRfaWQgT3B0aW9uYWwgaWQg
dG8gb3ZlcnJpZGUgdGhlIGdlbmVyYXRl
ZCBpZC4KICovCmxpYi5QcmVmZXJlbmNl
TWFuYWdlci5wcm90b3R5cGUuY3JlYXRl
Q2hpbGQgPSBmdW5jdGlvbihsaXN0TmFt
ZSwgb3B0X2hpbnQsCiAgICAgICAgICAg
ICAgICAgICAgICAgICAgICAgICAgICAg
ICAgICAgICAgICAgICAgICAgICBvcHRf
aWQpIHsKICB2YXIgaWRzID0gdGhpcy5n
ZXQobGlzdE5hbWUpOwogIHZhciBpZDsK
CiAgaWYgKG9wdF9pZCkgewogICAgaWQg
PSBvcHRfaWQ7CiAgICBpZiAoaWRzLmlu
ZGV4T2YoaWQpICE9IC0xKQogICAgICB0
aHJvdyBuZXcgRXJyb3IoJ0R1cGxpY2F0
ZSBjaGlsZDogJyArIGxpc3ROYW1lICsg
JzogJyArIGlkKTsKCiAgfSBlbHNlIHsK
ICAgIC8vIFBpY2sgYSByYW5kb20sIHVu
aXF1ZSA0LWRpZ2l0IGhleCBpZGVudGlm
aWVyIGZvciB0aGUgbmV3IHByb2ZpbGUu
CiAgICB3aGlsZSAoIWlkIHx8IGlkcy5p
bmRleE9mKGlkKSAhPSAtMSkgewogICAg
ICBpZCA9IE1hdGguZmxvb3IoTWF0aC5y
YW5kb20oKSAqIDB4ZmZmZiArIDEpLnRv
U3RyaW5nKDE2KTsKICAgICAgaWQgPSBs
aWIuZi56cGFkKGlkLCA0KTsKICAgICAg
aWYgKG9wdF9oaW50KQogICAgICAgIGlk
ID0gb3B0X2hpbnQgKyAnOicgKyBpZDsK
ICAgIH0KICB9CgogIHZhciBjaGlsZE1h
bmFnZXIgPSB0aGlzLmNoaWxkRmFjdG9y
aWVzX1tsaXN0TmFtZV0odGhpcywgaWQp
OwogIGNoaWxkTWFuYWdlci50cmFjZSA9
IHRoaXMudHJhY2U7CiAgY2hpbGRNYW5h
Z2VyLnJlc2V0QWxsKCk7CgogIHRoaXMu
Y2hpbGRMaXN0c19bbGlzdE5hbWVdW2lk
XSA9IGNoaWxkTWFuYWdlcjsKCiAgaWRz
LnB1c2goaWQpOwogIHRoaXMuc2V0KGxp
c3ROYW1lLCBpZHMpOwoKICByZXR1cm4g
Y2hpbGRNYW5hZ2VyOwp9OwoKLyoqCiAq
IFJlbW92ZSBhIGNoaWxkIHByZWZlcmVu
Y2VzIGluc3RhbmNlLgogKgogKiBSZW1v
dmVzIGEgY2hpbGQgcHJlZmVyZW5jZSBt
YW5hZ2VyIGFuZCBjbGVhcnMgYW55IHBy
ZWZlcmVuY2VzIHN0b3JlZCBpbiBpdC4K
ICoKICogQHBhcmFtIHtzdHJpbmd9IGxp
c3ROYW1lIFRoZSBuYW1lIG9mIHRoZSBj
aGlsZCBsaXN0IGNvbnRhaW5pbmcgdGhl
IGNoaWxkIHRvCiAqICAgICByZW1vdmUu
CiAqIEBwYXJhbSB7c3RyaW5nfSBpZCBU
aGUgY2hpbGQgSUQuCiAqLwpsaWIuUHJl
ZmVyZW5jZU1hbmFnZXIucHJvdG90eXBl
LnJlbW92ZUNoaWxkID0gZnVuY3Rpb24o
bGlzdE5hbWUsIGlkKSB7CiAgdmFyIHBy
ZWZzID0gdGhpcy5nZXRDaGlsZChsaXN0
TmFtZSwgaWQpOwogIHByZWZzLnJlc2V0
QWxsKCk7CgogIHZhciBpZHMgPSB0aGlz
LmdldChsaXN0TmFtZSk7CiAgdmFyIGkg
PSBpZHMuaW5kZXhPZihpZCk7CiAgaWYg
KGkgIT0gLTEpIHsKICAgIGlkcy5zcGxp
Y2UoaSwgMSk7CiAgICB0aGlzLnNldChs
aXN0TmFtZSwgaWRzKTsKICB9CgogIGRl
bGV0ZSB0aGlzLmNoaWxkTGlzdHNfW2xp
c3ROYW1lXVtpZF07Cn07CgovKioKICog
UmV0dXJuIGEgY2hpbGQgUHJlZmVyZW5j
ZU1hbmFnZXIgaW5zdGFuY2UgZm9yIGEg
Z2l2ZW4gaWQuCiAqCiAqIElmIHRoZSBj
aGlsZCBsaXN0IG9yIGNoaWxkIGlkIGlz
IG5vdCBrbm93biB0aGlzIHdpbGwgcmV0
dXJuIHRoZSBzcGVjaWZpZWQKICogZGVm
YXVsdCB2YWx1ZSBvciB0aHJvdyBhbiBl
eGNlcHRpb24gaWYgbm8gZGVmYXVsdCB2
YWx1ZSBpcyBwcm92aWRlZC4KICoKICog
QHBhcmFtIHtzdHJpbmd9IGxpc3ROYW1l
IFRoZSBjaGlsZCBsaXN0IHRvIGxvb2sg
aW4uCiAqIEBwYXJhbSB7c3RyaW5nfSBp
ZCBUaGUgY2hpbGQgSUQuCiAqIEBwYXJh
bSB7Kn0gb3B0X2RlZmF1bHQgVGhlIG9w
dGlvbmFsIGRlZmF1bHQgdmFsdWUgdG8g
cmV0dXJuIGlmIHRoZSBjaGlsZAogKiAg
ICAgaXMgbm90IGZvdW5kLgogKi8KbGli
LlByZWZlcmVuY2VNYW5hZ2VyLnByb3Rv
dHlwZS5nZXRDaGlsZCA9IGZ1bmN0aW9u
KGxpc3ROYW1lLCBpZCwgb3B0X2RlZmF1
bHQpIHsKICBpZiAoIShsaXN0TmFtZSBp
biB0aGlzLmNoaWxkTGlzdHNfKSkKICAg
IHRocm93IG5ldyBFcnJvcignVW5rbm93
biBjaGlsZCBsaXN0OiAnICsgbGlzdE5h
bWUpOwoKICB2YXIgY2hpbGRMaXN0ID0g
dGhpcy5jaGlsZExpc3RzX1tsaXN0TmFt
ZV07CiAgaWYgKCEoaWQgaW4gY2hpbGRM
aXN0KSkgewogICAgaWYgKHR5cGVvZiBv
cHRfZGVmYXVsdCA9PSAndW5kZWZpbmVk
JykKICAgICAgdGhyb3cgbmV3IEVycm9y
KCdVbmtub3duICInICsgbGlzdE5hbWUg
KyAnIiBjaGlsZDogJyArIGlkKTsKCiAg
ICByZXR1cm4gb3B0X2RlZmF1bHQ7CiAg
fQoKICByZXR1cm4gY2hpbGRMaXN0W2lk
XTsKfTsKCi8qKgogKiBDYWxjdWxhdGUg
dGhlIGRpZmZlcmVuY2UgYmV0d2VlbiB0
d28gbGlzdHMgb2YgY2hpbGQgaWRzLgog
KgogKiBHaXZlbiB0d28gYXJyYXlzIG9m
IGNoaWxkIGlkcywgdGhpcyBmdW5jdGlv
biB3aWxsIHJldHVybiBhbiBvYmplY3QK
ICogd2l0aCAiYWRkZWQiLCAicmVtb3Zl
ZCIsIGFuZCAiY29tbW9uIiBwcm9wZXJ0
aWVzLiAgRWFjaCBwcm9wZXJ0eSBpcwog
KiBhIG1hcCBvZiBjaGlsZC1pZCB0byBg
dHJ1ZWAuICBGb3IgZXhhbXBsZSwgZ2l2
ZW4uLi4KICoKICogICAgYSA9IFsnY2hp
bGQteCcsICdjaGlsZC15J10KICogICAg
YiA9IFsnY2hpbGQteSddCiAqCiAqICAg
IGRpZmZDaGlsZExpc3RzKGEsIGIpID0+
CiAqICAgICAgeyBhZGRlZDogeyAnY2hp
bGQteCc6IHRydWUgfSwgcmVtb3ZlZDog
e30sIGNvbW1vbjogeyAnY2hpbGQteSc6
IHRydWUgfSB9CiAqCiAqIFRoZSBhZGRl
ZC9yZW1vdmVkIHByb3BlcnRpZXMgYXNz
dW1lIHRoYXQgYGFgIGlzIHRoZSBjdXJy
ZW50IGxpc3QuCiAqCiAqIEBwYXJhbSB7
QXJyYXlbc3RyaW5nXX0gYSBUaGUgbW9z
dCByZWNlbnQgbGlzdCBvZiBjaGlsZCBp
ZHMuCiAqIEBwYXJhbSB7QXJyYXlbc3Ry
aW5nXX0gYiBBbiBvbGRlciBsaXN0IG9m
IGNoaWxkIGlkcy4KICogQHJldHVybiB7
T2JqZWN0fSBBbiBvYmplY3Qgd2l0aCBh
ZGRlZC9yZW1vdmVkL2NvbW1vbiBwcm9w
ZXJ0aWVzLgogKi8KbGliLlByZWZlcmVu
Y2VNYW5hZ2VyLmRpZmZDaGlsZExpc3Rz
ID0gZnVuY3Rpb24oYSwgYikgewogIHZh
ciBydiA9IHsKICAgIGFkZGVkOiB7fSwK
ICAgIHJlbW92ZWQ6IHt9LAogICAgY29t
bW9uOiB7fSwKICB9OwoKICBmb3IgKHZh
ciBpID0gMDsgaSA8IGEubGVuZ3RoOyBp
KyspIHsKICAgIGlmIChiLmluZGV4T2Yo
YVtpXSkgIT0gLTEpIHsKICAgICAgcnYu
Y29tbW9uW2FbaV1dID0gdHJ1ZTsKICAg
IH0gZWxzZSB7CiAgICAgIHJ2LmFkZGVk
W2FbaV1dID0gdHJ1ZTsKICAgIH0KICB9
CgogIGZvciAodmFyIGkgPSAwOyBpIDwg
Yi5sZW5ndGg7IGkrKykgewogICAgaWYg
KChiW2ldIGluIHJ2LmFkZGVkKSB8fCAo
YltpXSBpbiBydi5jb21tb24pKQogICAg
ICBjb250aW51ZTsKCiAgICBydi5yZW1v
dmVkW2JbaV1dID0gdHJ1ZTsKICB9Cgog
IHJldHVybiBydjsKfTsKCi8qKgogKiBT
eW5jaHJvbml6ZSBhIGxpc3Qgb2YgY2hp
bGQgUHJlZmVyZW5jZU1hbmFnZXJzIGlu
c3RhbmNlcyB3aXRoIHRoZSBjdXJyZW50
CiAqIGxpc3Qgc3RvcmVkIGluIHByZWZz
LgogKgogKiBUaGlzIHdpbGwgaW5zdGFu
dGlhdGUgYW55IG1pc3NpbmcgbWFuYWdl
cnMgYW5kIHJlYWQgY3VycmVudCBwcmVm
ZXJlbmNlIHZhbHVlcwogKiBmcm9tIHN0
b3JhZ2UuICBBbnkgYWN0aXZlIG1hbmFn
ZXJzIHRoYXQgbm8gbG9uZ2VyIGFwcGVh
ciBpbiBwcmVmZXJlbmNlcyB3aWxsCiAq
IGJlIGRlbGV0ZWQuCiAqCiAqIEBwYXJh
bSB7c3RyaW5nfSBsaXN0TmFtZSBUaGUg
Y2hpbGQgbGlzdCB0byBzeW5jaHJvbml6
ZS4KICogQHBhcmFtIHtmdW5jdGlvbigp
fSBvcHRfY2FsbGJhY2sgT3B0aW9uYWwg
ZnVuY3Rpb24gdG8gaW52b2tlIHdoZW4g
dGhlIHN5bmMKICogICAgIGlzIGNvbXBs
ZXRlLgogKi8KbGliLlByZWZlcmVuY2VN
YW5hZ2VyLnByb3RvdHlwZS5zeW5jQ2hp
bGRMaXN0ID0gZnVuY3Rpb24oCiAgICBs
aXN0TmFtZSwgb3B0X2NhbGxiYWNrKSB7
CgogIHZhciBwZW5kaW5nQ2hpbGRyZW4g
PSAwOwogIGZ1bmN0aW9uIG9uQ2hpbGRT
dG9yYWdlKCkgewogICAgaWYgKC0tcGVu
ZGluZ0NoaWxkcmVuID09IDAgJiYgb3B0
X2NhbGxiYWNrKQogICAgICBvcHRfY2Fs
bGJhY2soKTsKICB9CgogIC8vIFRoZSBs
aXN0IG9mIGNoaWxkIGlkcyB0aGF0IHdl
ICpzaG91bGQqIGhhdmUgYSBtYW5hZ2Vy
IGZvci4KICB2YXIgY3VycmVudElkcyA9
IHRoaXMuZ2V0KGxpc3ROYW1lKTsKCiAg
Ly8gVGhlIGtub3duIG1hbmFnZXJzIGF0
IHRoZSBzdGFydCBvZiB0aGUgc3luYy4g
IEFueSBtYW5hZ2VyIHN0aWxsIGluIHRo
aXMKICAvLyBsaXN0IGF0IHRoZSBlbmQg
c2hvdWxkIGJlIGRpc2NhcmRlZC4KICB2
YXIgb2xkSWRzID0gT2JqZWN0LmtleXMo
dGhpcy5jaGlsZExpc3RzX1tsaXN0TmFt
ZV0pOwoKICB2YXIgcnYgPSBsaWIuUHJl
ZmVyZW5jZU1hbmFnZXIuZGlmZkNoaWxk
TGlzdHMoY3VycmVudElkcywgb2xkSWRz
KTsKCiAgZm9yICh2YXIgaSA9IDA7IGkg
PCBjdXJyZW50SWRzLmxlbmd0aDsgaSsr
KSB7CiAgICB2YXIgaWQgPSBjdXJyZW50
SWRzW2ldOwoKICAgIHZhciBtYW5hZ2Vy
SW5kZXggPSBvbGRJZHMuaW5kZXhPZihp
ZCk7CiAgICBpZiAobWFuYWdlckluZGV4
ID49IDApCiAgICAgIG9sZElkcy5zcGxp
Y2UobWFuYWdlckluZGV4LCAxKTsKCiAg
ICBpZiAoIXRoaXMuY2hpbGRMaXN0c19b
bGlzdE5hbWVdW2lkXSkgewogICAgICB2
YXIgY2hpbGRNYW5hZ2VyID0gdGhpcy5j
aGlsZEZhY3Rvcmllc19bbGlzdE5hbWVd
KHRoaXMsIGlkKTsKICAgICAgaWYgKCFj
aGlsZE1hbmFnZXIpIHsKICAgICAgICBj
b25zb2xlLndhcm4oJ1VuYWJsZSB0byBy
ZXN0b3JlIGNoaWxkOiAnICsgbGlzdE5h
bWUgKyAnOiAnICsgaWQpOwogICAgICAg
IGNvbnRpbnVlOwogICAgICB9CgogICAg
ICBjaGlsZE1hbmFnZXIudHJhY2UgPSB0
aGlzLnRyYWNlOwogICAgICB0aGlzLmNo
aWxkTGlzdHNfW2xpc3ROYW1lXVtpZF0g
PSBjaGlsZE1hbmFnZXI7CiAgICAgIHBl
bmRpbmdDaGlsZHJlbisrOwogICAgICBj
aGlsZE1hbmFnZXIucmVhZFN0b3JhZ2Uo
b25DaGlsZFN0b3JhZ2UpOwogICAgfQog
IH0KCiAgZm9yICh2YXIgaSA9IDA7IGkg
PCBvbGRJZHMubGVuZ3RoOyBpKyspIHsK
ICAgIGRlbGV0ZSB0aGlzLmNoaWxkTGlz
dHNfW2xpc3ROYW1lXVtvbGRJZHNbaV1d
OwogIH0KCiAgaWYgKCFwZW5kaW5nQ2hp
bGRyZW4gJiYgb3B0X2NhbGxiYWNrKQog
ICAgc2V0VGltZW91dChvcHRfY2FsbGJh
Y2spOwp9OwoKLyoqCiAqIFJlc2V0IGEg
cHJlZmVyZW5jZSB0byBpdHMgZGVmYXVs
dCBzdGF0ZS4KICoKICogVGhpcyB3aWxs
IGRpc3BhdGNoIHRoZSBvbkNoYW5nZSBo
YW5kbGVyIGlmIHRoZSBwcmVmZXJlbmNl
IHZhbHVlIGFjdHVhbGx5CiAqIGNoYW5n
ZXMuCiAqCiAqIEBwYXJhbSB7c3RyaW5n
fSBuYW1lIFRoZSBwcmVmZXJlbmNlIHRv
IHJlc2V0LgogKi8KbGliLlByZWZlcmVu
Y2VNYW5hZ2VyLnByb3RvdHlwZS5yZXNl
dCA9IGZ1bmN0aW9uKG5hbWUpIHsKICB2
YXIgcmVjb3JkID0gdGhpcy5wcmVmUmVj
b3Jkc19bbmFtZV07CiAgaWYgKCFyZWNv
cmQpCiAgICB0aHJvdyBuZXcgRXJyb3Io
J1Vua25vd24gcHJlZmVyZW5jZTogJyAr
IG5hbWUpOwoKICB0aGlzLnN0b3JhZ2Uu
cmVtb3ZlSXRlbSh0aGlzLnByZWZpeCAr
IG5hbWUpOwoKICBpZiAocmVjb3JkLmN1
cnJlbnRWYWx1ZSAhPT0gdGhpcy5ERUZB
VUxUX1ZBTFVFKSB7CiAgICByZWNvcmQu
Y3VycmVudFZhbHVlID0gdGhpcy5ERUZB
VUxUX1ZBTFVFOwogICAgdGhpcy5ub3Rp
ZnlDaGFuZ2VfKG5hbWUpOwogIH0KfTsK
Ci8qKgogKiBSZXNldCBhbGwgcHJlZmVy
ZW5jZXMgYmFjayB0byB0aGVpciBkZWZh
dWx0IHN0YXRlLgogKi8KbGliLlByZWZl
cmVuY2VNYW5hZ2VyLnByb3RvdHlwZS5y
ZXNldEFsbCA9IGZ1bmN0aW9uKCkgewog
IHZhciBjaGFuZ2VkID0gW107CgogIGZv
ciAodmFyIGxpc3ROYW1lIGluIHRoaXMu
Y2hpbGRMaXN0c18pIHsKICAgIHZhciBj
aGlsZExpc3QgPSB0aGlzLmNoaWxkTGlz
dHNfW2xpc3ROYW1lXTsKICAgIGZvciAo
dmFyIGlkIGluIGNoaWxkTGlzdCkgewog
ICAgICBjaGlsZExpc3RbaWRdLnJlc2V0
QWxsKCk7CiAgICB9CiAgfQoKICBmb3Ig
KHZhciBuYW1lIGluIHRoaXMucHJlZlJl
Y29yZHNfKSB7CiAgICBpZiAodGhpcy5w
cmVmUmVjb3Jkc19bbmFtZV0uY3VycmVu
dFZhbHVlICE9PSB0aGlzLkRFRkFVTFRf
VkFMVUUpIHsKICAgICAgdGhpcy5wcmVm
UmVjb3Jkc19bbmFtZV0uY3VycmVudFZh
bHVlID0gdGhpcy5ERUZBVUxUX1ZBTFVF
OwogICAgICBjaGFuZ2VkLnB1c2gobmFt
ZSk7CiAgICB9CiAgfQoKICB2YXIga2V5
cyA9IE9iamVjdC5rZXlzKHRoaXMucHJl
ZlJlY29yZHNfKS5tYXAoZnVuY3Rpb24o
ZWwpIHsKICAgICAgcmV0dXJuIHRoaXMu
cHJlZml4ICsgZWw7CiAgfS5iaW5kKHRo
aXMpKTsKCiAgdGhpcy5zdG9yYWdlLnJl
bW92ZUl0ZW1zKGtleXMpOwoKICBjaGFu
Z2VkLmZvckVhY2godGhpcy5ub3RpZnlD
aGFuZ2VfLmJpbmQodGhpcykpOwp9OwoK
LyoqCiAqIFJldHVybiB0cnVlIGlmIHR3
byB2YWx1ZXMgc2hvdWxkIGJlIGNvbnNp
ZGVyZWQgbm90LWVxdWFsLgogKgogKiBJ
ZiBib3RoIHZhbHVlcyBhcmUgdGhlIHNh
bWUgc2NhbGFyIHR5cGUgYW5kIGNvbXBh
cmUgZXF1YWwgdGhpcyBmdW5jdGlvbgog
KiByZXR1cm5zIGZhbHNlIChubyBkaWZm
ZXJlbmNlKSwgb3RoZXJ3aXNlIHJldHVy
biB0cnVlLgogKgogKiBUaGlzIGlzIHVz
ZWQgaW4gcGxhY2VzIHdoZXJlIHdlIHdh
bnQgdG8gY2hlY2sgaWYgYSBwcmVmZXJl
bmNlIGhhcyBjaGFuZ2VkLgogKiBSYXRo
ZXIgdGhhbiB0YWtlIHRoZSB0aW1lIHRv
IGNvbXBhcmUgY29tcGxleCB2YWx1ZXMg
d2UganVzdCBjb25zaWRlciB0aGVtCiAq
IHRvIGFsd2F5cyBiZSBkaWZmZXJlbnQu
CiAqCiAqIEBwYXJhbSB7Kn0gYSBBIHZh
bHVlIHRvIGNvbXBhcmUuCiAqIEBwYXJh
bSB7Kn0gYiBBIHZhbHVlIHRvIGNvbXBh
cmUuCiAqLwpsaWIuUHJlZmVyZW5jZU1h
bmFnZXIucHJvdG90eXBlLmRpZmYgPSBm
dW5jdGlvbihhLCBiKSB7CiAgLy8gSWYg
dGhlIHR5cGVzIGFyZSBkaWZmZXJlbnQs
IG9yIHRoZSB0eXBlIGlzIG5vdCBhIHNp
bXBsZSBwcmltaXRpdmUgb25lLgogIGlm
ICgodHlwZW9mIGEpICE9PSAodHlwZW9m
IGIpIHx8CiAgICAgICEoL14odW5kZWZp
bmVkfGJvb2xlYW58bnVtYmVyfHN0cmlu
ZykkLy50ZXN0KHR5cGVvZiBhKSkpIHsK
ICAgIHJldHVybiB0cnVlOwogIH0KCiAg
cmV0dXJuIGEgIT09IGI7Cn07CgovKioK
ICogQ2hhbmdlIHRoZSBkZWZhdWx0IHZh
bHVlIG9mIGEgcHJlZmVyZW5jZS4KICoK
ICogVGhpcyBpcyB1c2VmdWwgd2hlbiBz
dWJjbGFzc2luZyBwcmVmZXJlbmNlIG1h
bmFnZXJzLgogKgogKiBUaGUgZnVuY3Rp
b24gZG9lcyBub3QgYWx0ZXIgdGhlIGN1
cnJlbnQgdmFsdWUgb2YgdGhlIHByZWZl
cmVuY2UsIHVubGVzcwogKiBpdCBoYXMg
dGhlIG9sZCBkZWZhdWx0IHZhbHVlLiAg
V2hlbiB0aGF0IGhhcHBlbnMsIHRoZSBj
aGFuZ2Ugb2JzZXJ2ZXJzCiAqIHdpbGwg
YmUgbm90aWZpZWQuCiAqCiAqIEBwYXJh
bSB7c3RyaW5nfSBuYW1lIFRoZSBuYW1l
IG9mIHRoZSBwYXJhbWV0ZXIgdG8gY2hh
bmdlLgogKiBAcGFyYW0geyp9IG5ld1Zh
bHVlIFRoZSBuZXcgZGVmYXVsdCB2YWx1
ZSBmb3IgdGhlIHByZWZlcmVuY2UuCiAq
LwpsaWIuUHJlZmVyZW5jZU1hbmFnZXIu
cHJvdG90eXBlLmNoYW5nZURlZmF1bHQg
PSBmdW5jdGlvbihuYW1lLCBuZXdWYWx1
ZSkgewogIHZhciByZWNvcmQgPSB0aGlz
LnByZWZSZWNvcmRzX1tuYW1lXTsKICBp
ZiAoIXJlY29yZCkKICAgIHRocm93IG5l
dyBFcnJvcignVW5rbm93biBwcmVmZXJl
bmNlOiAnICsgbmFtZSk7CgogIGlmICgh
dGhpcy5kaWZmKHJlY29yZC5kZWZhdWx0
VmFsdWUsIG5ld1ZhbHVlKSkgewogICAg
Ly8gRGVmYXVsdCB2YWx1ZSBoYXNuJ3Qg
Y2hhbmdlZC4KICAgIHJldHVybjsKICB9
CgogIGlmIChyZWNvcmQuY3VycmVudFZh
bHVlICE9PSB0aGlzLkRFRkFVTFRfVkFM
VUUpIHsKICAgIC8vIFRoaXMgcHJlZiBo
YXMgYSBzcGVjaWZpYyB2YWx1ZSwganVz
dCBjaGFuZ2UgdGhlIGRlZmF1bHQgYW5k
IHdlJ3JlIGRvbmUuCiAgICByZWNvcmQu
ZGVmYXVsdFZhbHVlID0gbmV3VmFsdWU7
CiAgICByZXR1cm47CiAgfQoKICByZWNv
cmQuZGVmYXVsdFZhbHVlID0gbmV3VmFs
dWU7CgogIHRoaXMubm90aWZ5Q2hhbmdl
XyhuYW1lKTsKfTsKCi8qKgogKiBDaGFu
Z2UgdGhlIGRlZmF1bHQgdmFsdWUgb2Yg
bXVsdGlwbGUgcHJlZmVyZW5jZXMuCiAq
CiAqIEBwYXJhbSB7T2JqZWN0fSBtYXAg
QSBtYXAgb2YgbmFtZSAtPiB2YWx1ZSBw
YWlycyBzcGVjaWZ5aW5nIHRoZSBuZXcg
ZGVmYXVsdAogKiAgICAgdmFsdWVzLgog
Ki8KbGliLlByZWZlcmVuY2VNYW5hZ2Vy
LnByb3RvdHlwZS5jaGFuZ2VEZWZhdWx0
cyA9IGZ1bmN0aW9uKG1hcCkgewogIGZv
ciAodmFyIGtleSBpbiBtYXApIHsKICAg
IHRoaXMuY2hhbmdlRGVmYXVsdChrZXks
IG1hcFtrZXldKTsKICB9Cn07CgovKioK
ICogU2V0IGEgcHJlZmVyZW5jZSB0byBh
IHNwZWNpZmljIHZhbHVlLgogKgogKiBU
aGlzIHdpbGwgZGlzcGF0Y2ggdGhlIG9u
Q2hhbmdlIGhhbmRsZXIgaWYgdGhlIHBy
ZWZlcmVuY2UgdmFsdWUgYWN0dWFsbHkK
ICogY2hhbmdlcy4KICoKICogQHBhcmFt
IHtzdHJpbmd9IGtleSBUaGUgcHJlZmVy
ZW5jZSB0byBzZXQuCiAqIEBwYXJhbSB7
Kn0gdmFsdWUgVGhlIHZhbHVlIHRvIHNl
dC4gIEFueXRoaW5nIHRoYXQgY2FuIGJl
IHJlcHJlc2VudGVkIGluCiAqICAgICBK
U09OIGlzIGEgdmFsaWQgdmFsdWUuCiAq
LwpsaWIuUHJlZmVyZW5jZU1hbmFnZXIu
cHJvdG90eXBlLnNldCA9IGZ1bmN0aW9u
KG5hbWUsIG5ld1ZhbHVlKSB7CiAgdmFy
IHJlY29yZCA9IHRoaXMucHJlZlJlY29y
ZHNfW25hbWVdOwogIGlmICghcmVjb3Jk
KQogICAgdGhyb3cgbmV3IEVycm9yKCdV
bmtub3duIHByZWZlcmVuY2U6ICcgKyBu
YW1lKTsKCiAgdmFyIG9sZFZhbHVlID0g
cmVjb3JkLmdldCgpOwoKICBpZiAoIXRo
aXMuZGlmZihvbGRWYWx1ZSwgbmV3VmFs
dWUpKQogICAgcmV0dXJuOwoKICBpZiAo
dGhpcy5kaWZmKHJlY29yZC5kZWZhdWx0
VmFsdWUsIG5ld1ZhbHVlKSkgewogICAg
cmVjb3JkLmN1cnJlbnRWYWx1ZSA9IG5l
d1ZhbHVlOwogICAgdGhpcy5zdG9yYWdl
LnNldEl0ZW0odGhpcy5wcmVmaXggKyBu
YW1lLCBuZXdWYWx1ZSk7CiAgfSBlbHNl
IHsKICAgIHJlY29yZC5jdXJyZW50VmFs
dWUgPSB0aGlzLkRFRkFVTFRfVkFMVUU7
CiAgICB0aGlzLnN0b3JhZ2UucmVtb3Zl
SXRlbSh0aGlzLnByZWZpeCArIG5hbWUp
OwogIH0KCiAgLy8gV2UgbmVlZCB0byBt
YW51YWxseSBzZW5kIG91dCB0aGUgbm90
aWZpY2F0aW9uIG9uIHRoaXMgaW5zdGFu
Y2UuICBJZiB3ZQogIC8vIFRoZSBzdG9y
YWdlIGV2ZW50IHdvbid0IGZpcmUgYSBu
b3RpZmljYXRpb24gYmVjYXVzZSB3ZSd2
ZSBhbHJlYWR5IGNoYW5nZWQKICAvLyB0
aGUgY3VycmVudFZhbHVlLCBzbyBpdCB3
b24ndCBzZWUgYSBkaWZmZXJlbmNlLiAg
SWYgd2UgZGVsYXllZCBjaGFuZ2luZwog
IC8vIGN1cnJlbnRWYWx1ZSB1bnRpbCB0
aGUgc3RvcmFnZSBldmVudCwgYSBwcmVm
IHJlYWQgaW1tZWRpYXRlbHkgYWZ0ZXIg
YSB3cml0ZQogIC8vIHdvdWxkIHJldHVy
biB0aGUgcHJldmlvdXMgdmFsdWUuCiAg
Ly8KICAvLyBUaGUgbm90aWZpY2F0aW9u
IGlzIGluIGEgdGltZW91dCBzbyBjbGll
bnRzIGRvbid0IGFjY2lkZW50YWxseSBk
ZXBlbmQgb24KICAvLyBhIHN5bmNocm9u
b3VzIG5vdGlmaWNhdGlvbi4KICBzZXRU
aW1lb3V0KHRoaXMubm90aWZ5Q2hhbmdl
Xy5iaW5kKHRoaXMsIG5hbWUpLCAwKTsK
fTsKCi8qKgogKiBHZXQgdGhlIHZhbHVl
IG9mIGEgcHJlZmVyZW5jZS4KICoKICog
QHBhcmFtIHtzdHJpbmd9IGtleSBUaGUg
cHJlZmVyZW5jZSB0byBnZXQuCiAqLwps
aWIuUHJlZmVyZW5jZU1hbmFnZXIucHJv
dG90eXBlLmdldCA9IGZ1bmN0aW9uKG5h
bWUpIHsKICB2YXIgcmVjb3JkID0gdGhp
cy5wcmVmUmVjb3Jkc19bbmFtZV07CiAg
aWYgKCFyZWNvcmQpCiAgICB0aHJvdyBu
ZXcgRXJyb3IoJ1Vua25vd24gcHJlZmVy
ZW5jZTogJyArIG5hbWUpOwoKICByZXR1
cm4gcmVjb3JkLmdldCgpOwp9OwoKLyoq
CiAqIFJldHVybiBhbGwgbm9uLWRlZmF1
bHQgcHJlZmVyZW5jZXMgYXMgYSBKU09O
IG9uamVjdC4KICoKICogVGhpcyBpbmNs
dWRlcyBhbnkgbmVzdGVkIHByZWZlcmVu
Y2UgbWFuYWdlcnMgYXMgd2VsbC4KICov
CmxpYi5QcmVmZXJlbmNlTWFuYWdlci5w
cm90b3R5cGUuZXhwb3J0QXNKc29uID0g
ZnVuY3Rpb24oKSB7CiAgdmFyIHJ2ID0g
e307CgogIGZvciAodmFyIG5hbWUgaW4g
dGhpcy5wcmVmUmVjb3Jkc18pIHsKICAg
IGlmIChuYW1lIGluIHRoaXMuY2hpbGRM
aXN0c18pIHsKICAgICAgcnZbbmFtZV0g
PSBbXTsKICAgICAgdmFyIGNoaWxkSWRz
ID0gdGhpcy5nZXQobmFtZSk7CiAgICAg
IGZvciAodmFyIGkgPSAwOyBpIDwgY2hp
bGRJZHMubGVuZ3RoOyBpKyspIHsKICAg
ICAgICB2YXIgaWQgPSBjaGlsZElkc1tp
XTsKICAgICAgICBydltuYW1lXS5wdXNo
KHtpZDogaWQsIGpzb246IHRoaXMuZ2V0
Q2hpbGQobmFtZSwgaWQpLmV4cG9ydEFz
SnNvbigpfSk7CiAgICAgIH0KCiAgICB9
IGVsc2UgewogICAgICB2YXIgcmVjb3Jk
ID0gdGhpcy5wcmVmUmVjb3Jkc19bbmFt
ZV07CiAgICAgIGlmIChyZWNvcmQuY3Vy
cmVudFZhbHVlICE9IHRoaXMuREVGQVVM
VF9WQUxVRSkKICAgICAgICBydltuYW1l
XSA9IHJlY29yZC5jdXJyZW50VmFsdWU7
CiAgICB9CiAgfQoKICByZXR1cm4gcnY7
Cn07CgovKioKICogSW1wb3J0IGEgSlNP
TiBibG9iIG9mIHByZWZlcmVuY2VzIHBy
ZXZpb3VzbHkgZ2VuZXJhdGVkIHdpdGgg
ZXhwb3J0QXNKc29uLgogKgogKiBUaGlz
IHdpbGwgY3JlYXRlIG5lc3RlZCBwcmVm
ZXJlbmNlIG1hbmFnZXJzIGFzIHdlbGwu
CiAqLwpsaWIuUHJlZmVyZW5jZU1hbmFn
ZXIucHJvdG90eXBlLmltcG9ydEZyb21K
c29uID0gZnVuY3Rpb24oanNvbikgewog
IGZvciAodmFyIG5hbWUgaW4ganNvbikg
ewogICAgaWYgKG5hbWUgaW4gdGhpcy5j
aGlsZExpc3RzXykgewogICAgICB2YXIg
Y2hpbGRMaXN0ID0ganNvbltuYW1lXTsK
ICAgICAgZm9yICh2YXIgaSA9IDA7IGkg
PCBjaGlsZExpc3QubGVuZ3RoOyBpKysp
IHsKICAgICAgICB2YXIgaWQgPSBjaGls
ZExpc3RbaV0uaWQ7CgogICAgICAgIHZh
ciBjaGlsZFByZWZNYW5hZ2VyID0gdGhp
cy5jaGlsZExpc3RzX1tuYW1lXVtpZF07
CiAgICAgICAgaWYgKCFjaGlsZFByZWZN
YW5hZ2VyKQogICAgICAgICAgY2hpbGRQ
cmVmTWFuYWdlciA9IHRoaXMuY3JlYXRl
Q2hpbGQobmFtZSwgbnVsbCwgaWQpOwoK
ICAgICAgICBjaGlsZFByZWZNYW5hZ2Vy
LmltcG9ydEZyb21Kc29uKGNoaWxkTGlz
dFtpXS5qc29uKTsKICAgICAgfQoKICAg
IH0gZWxzZSB7CiAgICAgIHRoaXMuc2V0
KG5hbWUsIGpzb25bbmFtZV0pOwogICAg
fQogIH0KfTsKCi8qKgogKiBDYWxsZWQg
d2hlbiBvbmUgb2YgdGhlIGNoaWxkIGxp
c3QgcHJlZmVyZW5jZXMgY2hhbmdlcy4K
ICovCmxpYi5QcmVmZXJlbmNlTWFuYWdl
ci5wcm90b3R5cGUub25DaGlsZExpc3RD
aGFuZ2VfID0gZnVuY3Rpb24obGlzdE5h
bWUpIHsKICB0aGlzLnN5bmNDaGlsZExp
c3QobGlzdE5hbWUpOwp9OwoKLyoqCiAq
IENhbGxlZCB3aGVuIGEga2V5IGluIHRo
ZSBzdG9yYWdlIGNoYW5nZXMuCiAqLwps
aWIuUHJlZmVyZW5jZU1hbmFnZXIucHJv
dG90eXBlLm9uU3RvcmFnZUNoYW5nZV8g
PSBmdW5jdGlvbihtYXApIHsKICBmb3Ig
KHZhciBrZXkgaW4gbWFwKSB7CiAgICBp
ZiAodGhpcy5wcmVmaXgpIHsKICAgICAg
aWYgKGtleS5sYXN0SW5kZXhPZih0aGlz
LnByZWZpeCwgMCkgIT0gMCkKICAgICAg
ICBjb250aW51ZTsKICAgIH0KCiAgICB2
YXIgbmFtZSA9IGtleS5zdWJzdHIodGhp
cy5wcmVmaXgubGVuZ3RoKTsKCiAgICBp
ZiAoIShuYW1lIGluIHRoaXMucHJlZlJl
Y29yZHNfKSkgewogICAgICAvLyBTb21l
dGltZXMgd2UnbGwgZ2V0IG5vdGlmaWVk
IGFib3V0IHByZWZzIHRoYXQgYXJlIG5v
IGxvbmdlciBkZWZpbmVkLgogICAgICBj
b250aW51ZTsKICAgIH0KCiAgICB2YXIg
cmVjb3JkID0gdGhpcy5wcmVmUmVjb3Jk
c19bbmFtZV07CgogICAgdmFyIG5ld1Zh
bHVlID0gbWFwW2tleV0ubmV3VmFsdWU7
CiAgICB2YXIgY3VycmVudFZhbHVlID0g
cmVjb3JkLmN1cnJlbnRWYWx1ZTsKICAg
IGlmIChjdXJyZW50VmFsdWUgPT09IHJl
Y29yZC5ERUZBVUxUX1ZBTFVFKQogICAg
ICBjdXJyZW50VmFsdWUgPSAodm9pZCAw
KTsKCiAgICBpZiAodGhpcy5kaWZmKGN1
cnJlbnRWYWx1ZSwgbmV3VmFsdWUpKSB7
CiAgICAgIGlmICh0eXBlb2YgbmV3VmFs
dWUgPT0gJ3VuZGVmaW5lZCcpIHsKICAg
ICAgICByZWNvcmQuY3VycmVudFZhbHVl
ID0gcmVjb3JkLkRFRkFVTFRfVkFMVUU7
CiAgICAgIH0gZWxzZSB7CiAgICAgICAg
cmVjb3JkLmN1cnJlbnRWYWx1ZSA9IG5l
d1ZhbHVlOwogICAgICB9CgogICAgICB0
aGlzLm5vdGlmeUNoYW5nZV8obmFtZSk7
CiAgICB9CiAgfQp9OwovLyBTT1VSQ0Ug
RklMRTogbGliZG90L2pzL2xpYl9yZXNv
dXJjZS5qcwovLyBDb3B5cmlnaHQgKGMp
IDIwMTIgVGhlIENocm9taXVtIE9TIEF1
dGhvcnMuIEFsbCByaWdodHMgcmVzZXJ2
ZWQuCi8vIFVzZSBvZiB0aGlzIHNvdXJj
ZSBjb2RlIGlzIGdvdmVybmVkIGJ5IGEg
QlNELXN0eWxlIGxpY2Vuc2UgdGhhdCBj
YW4gYmUKLy8gZm91bmQgaW4gdGhlIExJ
Q0VOU0UgZmlsZS4KCid1c2Ugc3RyaWN0
JzsKCi8qKgogKiBTdG9yYWdlIGZvciBj
YW5uZWQgcmVzb3VyY2VzLgogKgogKiBU
aGVzZSBhcmUgdXN1YWxseSBub24tSmF2
YVNjcmlwdCB0aGluZ3MgdGhhdCBhcmUg
Y29sbGVjdGVkIGR1cmluZyBhIGJ1aWxk
CiAqIHN0ZXAgYW5kIGNvbnZlcnRlZCBp
bnRvIGEgc2VyaWVzIG9mICdsaWIucmVz
b3VyY2UuYWRkKC4uLiknIGNhbGxzLiAg
U2VlCiAqIHRoZSAiQHJlc291cmNlIiBk
aXJlY3RpdmUgZnJvbSBsaWJkb3QvYmlu
L2NvbmNhdC5zaCBmb3IgdGhlIGNhbm9u
aWNhbCB1c2UKICogY2FzZS4KICoKICog
VGhpcyBpcyBnbG9iYWwgc3RvcmFnZSwg
c28geW91IHNob3VsZCBwcmVmaXggeW91
ciByZXNvdXJjZSBuYW1lcyB0byBhdm9p
ZAogKiBjb2xsaXNpb25zLgogKi8KbGli
LnJlc291cmNlID0gewogIHJlc291cmNl
c186IHt9Cn07CgovKioKICogQWRkIGEg
cmVzb3VyY2UuCiAqCiAqIEBwYXJhbSB7
c3RyaW5nfSBuYW1lIEEgbmFtZSBmb3Ig
dGhlIHJlc291cmNlLiAgWW91IHNob3Vs
ZCBwcmVmaXggdGhpcyB0bwogKiAgIGF2
b2lkIGNvbGxpc2lvbnMgd2l0aCByZXNv
dXJjZXMgZnJvbSBhIHNoYXJlZCBsaWJy
YXJ5LgogKiBAcGFyYW0ge3N0cmluZ30g
dHlwZSBBIG1pbWUgdHlwZSBmb3IgdGhl
IHJlc291cmNlLCBvciAicmF3IiBpZiBu
b3QKICogICBhcHBsaWNhYmxlLgogKiBA
cGFyYW0geyp9IGRhdGEgVGhlIHZhbHVl
IG9mIHRoZSByZXNvdXJjZS4KICovCmxp
Yi5yZXNvdXJjZS5hZGQgPSBmdW5jdGlv
bihuYW1lLCB0eXBlLCBkYXRhKSB7CiAg
bGliLnJlc291cmNlLnJlc291cmNlc19b
bmFtZV0gPSB7CiAgICB0eXBlOiB0eXBl
LAogICAgbmFtZTogbmFtZSwKICAgIGRh
dGE6IGRhdGEKICB9Owp9OwoKLyoqCiAq
IFJldHJpZXZlIGEgcmVzb3VyY2UgcmVj
b3JkLgogKgogKiBUaGUgcmVzb3VyY2Ug
ZGF0YSBpcyBzdG9yZWQgb24gdGhlICJk
YXRhIiBwcm9wZXJ0eSBvZiB0aGUgcmV0
dXJuZWQgb2JqZWN0LgogKgogKiBAcGFy
YW0ge3N0cmluZ30gbmFtZSBUaGUgbmFt
ZSBvZiB0aGUgcmVzb3VyY2UgdG8gZ2V0
LgogKiBAcGFyYW0geyp9IG9wdF9kZWZh
dWx0VmFsdWUgVGhlIG9wdGlvbmFsIHZh
bHVlIHRvIHJldHVybiBpZiB0aGUgcmVz
b3VyY2UgaXMKICogICBub3QgZGVmaW5l
ZC4KICogQHJldHVybiB7b2JqZWN0fSBB
biBvYmplY3Qgd2l0aCAidHlwZSIsICJu
YW1lIiwgYW5kICJkYXRhIiBwcm9wZXJ0
aWVzLgogKi8KbGliLnJlc291cmNlLmdl
dCA9IGZ1bmN0aW9uKG5hbWUsIG9wdF9k
ZWZhdWx0VmFsdWUpIHsKICBpZiAoIShu
YW1lIGluIGxpYi5yZXNvdXJjZS5yZXNv
dXJjZXNfKSkgewogICAgaWYgKHR5cGVv
ZiBvcHRfZGVmYXVsdFZhbHVlID09ICd1
bmRlZmluZWQnKQogICAgICB0aHJvdyAn
VW5rbm93biByZXNvdXJjZTogJyArIG5h
bWU7CgogICAgcmV0dXJuIG9wdF9kZWZh
dWx0VmFsdWU7CiAgfQoKICByZXR1cm4g
bGliLnJlc291cmNlLnJlc291cmNlc19b
bmFtZV07Cn07CgovKioKICogUmV0cmll
dmUgcmVzb3VyY2UgZGF0YS4KICoKICog
QHBhcmFtIHtzdHJpbmd9IG5hbWUgVGhl
IG5hbWUgb2YgdGhlIHJlc291cmNlIHRv
IGdldC4KICogQHBhcmFtIHsqfSBvcHRf
ZGVmYXVsdFZhbHVlIFRoZSBvcHRpb25h
bCB2YWx1ZSB0byByZXR1cm4gaWYgdGhl
IHJlc291cmNlIGlzCiAqICAgbm90IGRl
ZmluZWQuCiAqIEByZXR1cm4geyp9IFRo
ZSByZXNvdXJjZSBkYXRhLgogKi8KbGli
LnJlc291cmNlLmdldERhdGEgPSBmdW5j
dGlvbihuYW1lLCBvcHRfZGVmYXVsdFZh
bHVlKSB7CiAgaWYgKCEobmFtZSBpbiBs
aWIucmVzb3VyY2UucmVzb3VyY2VzXykp
IHsKICAgIGlmICh0eXBlb2Ygb3B0X2Rl
ZmF1bHRWYWx1ZSA9PSAndW5kZWZpbmVk
JykKICAgICAgdGhyb3cgJ1Vua25vd24g
cmVzb3VyY2U6ICcgKyBuYW1lOwoKICAg
IHJldHVybiBvcHRfZGVmYXVsdFZhbHVl
OwogIH0KCiAgcmV0dXJuIGxpYi5yZXNv
dXJjZS5yZXNvdXJjZXNfW25hbWVdLmRh
dGE7Cn07CgovKioKICogUmV0cmlldmUg
cmVzb3VyY2UgYXMgYSBkYXRhOiB1cmwu
CiAqCiAqIEBwYXJhbSB7c3RyaW5nfSBu
YW1lIFRoZSBuYW1lIG9mIHRoZSByZXNv
dXJjZSB0byBnZXQuCiAqIEBwYXJhbSB7
Kn0gb3B0X2RlZmF1bHRWYWx1ZSBUaGUg
b3B0aW9uYWwgdmFsdWUgdG8gcmV0dXJu
IGlmIHRoZSByZXNvdXJjZSBpcwogKiAg
IG5vdCBkZWZpbmVkLgogKiBAcmV0dXJu
IHsqfSBBIGRhdGE6IHVybCBlbmNvZGVk
IHZlcnNpb24gb2YgdGhlIHJlc291cmNl
LgogKi8KbGliLnJlc291cmNlLmdldERh
dGFVcmwgPSBmdW5jdGlvbihuYW1lLCBv
cHRfZGVmYXVsdFZhbHVlKSB7CiAgdmFy
IHJlc291cmNlID0gbGliLnJlc291cmNl
LmdldChuYW1lLCBvcHRfZGVmYXVsdFZh
bHVlKTsKICByZXR1cm4gJ2RhdGE6JyAr
IHJlc291cmNlLnR5cGUgKyAnLCcgKyBy
ZXNvdXJjZS5kYXRhOwp9OwovLyBTT1VS
Q0UgRklMRTogbGliZG90L2pzL2xpYl9z
dG9yYWdlLmpzCi8vIENvcHlyaWdodCAo
YykgMjAxMiBUaGUgQ2hyb21pdW0gT1Mg
QXV0aG9ycy4gQWxsIHJpZ2h0cyByZXNl
cnZlZC4KLy8gVXNlIG9mIHRoaXMgc291
cmNlIGNvZGUgaXMgZ292ZXJuZWQgYnkg
YSBCU0Qtc3R5bGUgbGljZW5zZSB0aGF0
IGNhbiBiZQovLyBmb3VuZCBpbiB0aGUg
TElDRU5TRSBmaWxlLgoKJ3VzZSBzdHJp
Y3QnOwoKLyoqCiAqIE5hbWVzcGFjZSBm
b3IgaW1wbGVtZW50YXRpb25zIG9mIHBl
cnNpc3RlbnQsIHBvc3NpYmx5IGNsb3Vk
LWJhY2tlZAogKiBzdG9yYWdlLgogKi8K
bGliLlN0b3JhZ2UgPSBuZXcgT2JqZWN0
KCk7Ci8vIFNPVVJDRSBGSUxFOiBsaWJk
b3QvanMvbGliX3N0b3JhZ2VfY2hyb21l
LmpzCi8vIENvcHlyaWdodCAoYykgMjAx
MiBUaGUgQ2hyb21pdW0gT1MgQXV0aG9y
cy4gQWxsIHJpZ2h0cyByZXNlcnZlZC4K
Ly8gVXNlIG9mIHRoaXMgc291cmNlIGNv
ZGUgaXMgZ292ZXJuZWQgYnkgYSBCU0Qt
c3R5bGUgbGljZW5zZSB0aGF0IGNhbiBi
ZQovLyBmb3VuZCBpbiB0aGUgTElDRU5T
RSBmaWxlLgoKJ3VzZSBzdHJpY3QnOwoK
LyoqCiAqIGNocm9tZS5zdG9yYWdlIGJh
c2VkIGNsYXNzIHdpdGggYW4gYXN5bmMg
aW50ZXJmYWNlIHRoYXQgaXMgaW50ZXJj
aGFuZ2VhYmxlCiAqIHdpdGggb3RoZXIg
bGliLlN0b3JhZ2UuKiBpbXBsZW1lbnRh
dGlvbnMuCiAqLwpsaWIuU3RvcmFnZS5D
aHJvbWUgPSBmdW5jdGlvbihzdG9yYWdl
KSB7CiAgdGhpcy5zdG9yYWdlXyA9IHN0
b3JhZ2U7CiAgdGhpcy5vYnNlcnZlcnNf
ID0gW107CgogIGNocm9tZS5zdG9yYWdl
Lm9uQ2hhbmdlZC5hZGRMaXN0ZW5lcih0
aGlzLm9uQ2hhbmdlZF8uYmluZCh0aGlz
KSk7Cn07CgovKioKICogQ2FsbGVkIGJ5
IHRoZSBzdG9yYWdlIGltcGxlbWVudGF0
aW9uIHdoZW4gdGhlIHN0b3JhZ2UgaXMg
bW9kaWZpZWQuCiAqLwpsaWIuU3RvcmFn
ZS5DaHJvbWUucHJvdG90eXBlLm9uQ2hh
bmdlZF8gPSBmdW5jdGlvbihjaGFuZ2Vz
LCBhcmVhbmFtZSkgewogIGlmIChjaHJv
bWUuc3RvcmFnZVthcmVhbmFtZV0gIT0g
dGhpcy5zdG9yYWdlXykKICAgIHJldHVy
bjsKCiAgZm9yICh2YXIgaSA9IDA7IGkg
PCB0aGlzLm9ic2VydmVyc18ubGVuZ3Ro
OyBpKyspIHsKICAgIHRoaXMub2JzZXJ2
ZXJzX1tpXShjaGFuZ2VzKTsKICB9Cn07
CgovKioKICogUmVnaXN0ZXIgYSBmdW5j
dGlvbiB0byBvYnNlcnZlIHN0b3JhZ2Ug
Y2hhbmdlcy4KICoKICogQHBhcmFtIHtm
dW5jdGlvbihtYXApfSBjYWxsYmFjayBU
aGUgZnVuY3Rpb24gdG8gaW52b2tlIHdo
ZW4gdGhlIHN0b3JhZ2UKICogICAgIGNo
YW5nZXMuCiAqLwpsaWIuU3RvcmFnZS5D
aHJvbWUucHJvdG90eXBlLmFkZE9ic2Vy
dmVyID0gZnVuY3Rpb24oY2FsbGJhY2sp
IHsKICB0aGlzLm9ic2VydmVyc18ucHVz
aChjYWxsYmFjayk7Cn07CgovKioKICog
VW5yZWdpc3RlciBhIGNoYW5nZSBvYnNl
cnZlci4KICoKICogQHBhcmFtIHtmdW5j
dGlvbn0gb2JzZXJ2ZXIgQSBwcmV2aW91
c2x5IHJlZ2lzdGVyZWQgY2FsbGJhY2su
CiAqLwpsaWIuU3RvcmFnZS5DaHJvbWUu
cHJvdG90eXBlLnJlbW92ZU9ic2VydmVy
ID0gZnVuY3Rpb24oY2FsbGJhY2spIHsK
ICB2YXIgaSA9IHRoaXMub2JzZXJ2ZXJz
Xy5pbmRleE9mKGNhbGxiYWNrKTsKICBp
ZiAoaSAhPSAtMSkKICAgIHRoaXMub2Jz
ZXJ2ZXJzXy5zcGxpY2UoaSwgMSk7Cn07
CgovKioKICogRGVsZXRlIGV2ZXJ5dGhp
bmcgaW4gdGhpcyBzdG9yYWdlLgogKgog
KiBAcGFyYW0ge2Z1bmN0aW9uKG1hcCl9
IGNhbGxiYWNrIFRoZSBmdW5jdGlvbiB0
byBpbnZva2Ugd2hlbiB0aGUgZGVsZXRl
CiAqICAgICBoYXMgY29tcGxldGVkLgog
Ki8KbGliLlN0b3JhZ2UuQ2hyb21lLnBy
b3RvdHlwZS5jbGVhciA9IGZ1bmN0aW9u
KG9wdF9jYWxsYmFjaykgewogIHRoaXMu
c3RvcmFnZV8uY2xlYXIoKTsKCiAgaWYg
KG9wdF9jYWxsYmFjaykKICAgIHNldFRp
bWVvdXQob3B0X2NhbGxiYWNrLCAwKTsK
fTsKCi8qKgogKiBSZXR1cm4gdGhlIGN1
cnJlbnQgdmFsdWUgb2YgYSBzdG9yYWdl
IGl0ZW0uCiAqCiAqIEBwYXJhbSB7c3Ry
aW5nfSBrZXkgVGhlIGtleSB0byBsb29r
IHVwLgogKiBAcGFyYW0ge2Z1bmN0aW9u
KHZhbHVlKSBjYWxsYmFjayBUaGUgZnVu
Y3Rpb24gdG8gaW52b2tlIHdoZW4gdGhl
IHZhbHVlIGhhcwogKiAgICAgYmVlbiBy
ZXRyaWV2ZWQuCiAqLwpsaWIuU3RvcmFn
ZS5DaHJvbWUucHJvdG90eXBlLmdldEl0
ZW0gPSBmdW5jdGlvbihrZXksIGNhbGxi
YWNrKSB7CiAgdGhpcy5zdG9yYWdlXy5n
ZXQoa2V5LCBjYWxsYmFjayk7Cn07Ci8q
KgogKiBGZXRjaCB0aGUgdmFsdWVzIG9m
IG11bHRpcGxlIHN0b3JhZ2UgaXRlbXMu
CiAqCiAqIEBwYXJhbSB7QXJyYXl9IGtl
eXMgVGhlIGtleXMgdG8gbG9vayB1cC4K
ICogQHBhcmFtIHtmdW5jdGlvbihtYXAp
IGNhbGxiYWNrIFRoZSBmdW5jdGlvbiB0
byBpbnZva2Ugd2hlbiB0aGUgdmFsdWVz
IGhhdmUKICogICAgIGJlZW4gcmV0cmll
dmVkLgogKi8KCmxpYi5TdG9yYWdlLkNo
cm9tZS5wcm90b3R5cGUuZ2V0SXRlbXMg
PSBmdW5jdGlvbihrZXlzLCBjYWxsYmFj
aykgewogIHRoaXMuc3RvcmFnZV8uZ2V0
KGtleXMsIGNhbGxiYWNrKTsKfTsKCi8q
KgogKiBTZXQgYSB2YWx1ZSBpbiBzdG9y
YWdlLgogKgogKiBAcGFyYW0ge3N0cmlu
Z30ga2V5IFRoZSBrZXkgZm9yIHRoZSB2
YWx1ZSB0byBiZSBzdG9yZWQuCiAqIEBw
YXJhbSB7Kn0gdmFsdWUgVGhlIHZhbHVl
IHRvIGJlIHN0b3JlZC4gIEFueXRoaW5n
IHRoYXQgY2FuIGJlIHNlcmlhbGl6ZWQK
ICogICAgIHdpdGggSlNPTiBpcyBhY2Nl
cHRhYmxlLgogKiBAcGFyYW0ge2Z1bmN0
aW9uKCl9IG9wdF9jYWxsYmFjayBPcHRp
b25hbCBmdW5jdGlvbiB0byBpbnZva2Ug
d2hlbiB0aGUKICogICAgIHNldCBpcyBj
b21wbGV0ZS4gIFlvdSBkb24ndCBoYXZl
IHRvIHdhaXQgZm9yIHRoZSBzZXQgdG8g
Y29tcGxldGUgaW4gb3JkZXIKICogICAg
IHRvIHJlYWQgdGhlIHZhbHVlLCBzaW5j
ZSB0aGUgbG9jYWwgY2FjaGUgaXMgdXBk
YXRlZCBzeW5jaHJvbm91c2x5LgogKi8K
bGliLlN0b3JhZ2UuQ2hyb21lLnByb3Rv
dHlwZS5zZXRJdGVtID0gZnVuY3Rpb24o
a2V5LCB2YWx1ZSwgb3B0X2NhbGxiYWNr
KSB7CiAgdmFyIG9iaiA9IHt9OwogIG9i
altrZXldID0gdmFsdWU7CiAgdGhpcy5z
dG9yYWdlXy5zZXQob2JqLCBvcHRfY2Fs
bGJhY2spOwp9OwoKLyoqCiAqIFNldCBt
dWx0aXBsZSB2YWx1ZXMgaW4gc3RvcmFn
ZS4KICoKICogQHBhcmFtIHtPYmplY3R9
IG1hcCBBIG1hcCBvZiBrZXkvdmFsdWVz
IHRvIHNldCBpbiBzdG9yYWdlLgogKiBA
cGFyYW0ge2Z1bmN0aW9uKCl9IG9wdF9j
YWxsYmFjayBPcHRpb25hbCBmdW5jdGlv
biB0byBpbnZva2Ugd2hlbiB0aGUKICog
ICAgIHNldCBpcyBjb21wbGV0ZS4gIFlv
dSBkb24ndCBoYXZlIHRvIHdhaXQgZm9y
IHRoZSBzZXQgdG8gY29tcGxldGUgaW4g
b3JkZXIKICogICAgIHRvIHJlYWQgdGhl
IHZhbHVlLCBzaW5jZSB0aGUgbG9jYWwg
Y2FjaGUgaXMgdXBkYXRlZCBzeW5jaHJv
bm91c2x5LgogKi8KbGliLlN0b3JhZ2Uu
Q2hyb21lLnByb3RvdHlwZS5zZXRJdGVt
cyA9IGZ1bmN0aW9uKG9iaiwgb3B0X2Nh
bGxiYWNrKSB7CiAgdGhpcy5zdG9yYWdl
Xy5zZXQob2JqLCBvcHRfY2FsbGJhY2sp
Owp9OwoKLyoqCiAqIFJlbW92ZSBhbiBp
dGVtIGZyb20gc3RvcmFnZS4KICoKICog
QHBhcmFtIHtzdHJpbmd9IGtleSBUaGUg
a2V5IHRvIGJlIHJlbW92ZWQuCiAqIEBw
YXJhbSB7ZnVuY3Rpb24oKX0gb3B0X2Nh
bGxiYWNrIE9wdGlvbmFsIGZ1bmN0aW9u
IHRvIGludm9rZSB3aGVuIHRoZQogKiAg
ICAgcmVtb3ZlIGlzIGNvbXBsZXRlLiAg
WW91IGRvbid0IGhhdmUgdG8gd2FpdCBm
b3IgdGhlIHNldCB0byBjb21wbGV0ZSBp
bgogKiAgICAgb3JkZXIgdG8gcmVhZCB0
aGUgdmFsdWUsIHNpbmNlIHRoZSBsb2Nh
bCBjYWNoZSBpcyB1cGRhdGVkIHN5bmNo
cm9ub3VzbHkuCiAqLwpsaWIuU3RvcmFn
ZS5DaHJvbWUucHJvdG90eXBlLnJlbW92
ZUl0ZW0gPSBmdW5jdGlvbihrZXksIG9w
dF9jYWxsYmFjaykgewogIHRoaXMuc3Rv
cmFnZV8ucmVtb3ZlKGtleSwgb3B0X2Nh
bGxiYWNrKTsKfTsKCi8qKgogKiBSZW1v
dmUgbXVsdGlwbGUgaXRlbXMgZnJvbSBz
dG9yYWdlLgogKgogKiBAcGFyYW0ge0Fy
cmF5fSBrZXlzIFRoZSBrZXlzIHRvIGJl
IHJlbW92ZWQuCiAqIEBwYXJhbSB7ZnVu
Y3Rpb24oKX0gb3B0X2NhbGxiYWNrIE9w
dGlvbmFsIGZ1bmN0aW9uIHRvIGludm9r
ZSB3aGVuIHRoZQogKiAgICAgcmVtb3Zl
IGlzIGNvbXBsZXRlLiAgWW91IGRvbid0
IGhhdmUgdG8gd2FpdCBmb3IgdGhlIHNl
dCB0byBjb21wbGV0ZSBpbgogKiAgICAg
b3JkZXIgdG8gcmVhZCB0aGUgdmFsdWUs
IHNpbmNlIHRoZSBsb2NhbCBjYWNoZSBp
cyB1cGRhdGVkIHN5bmNocm9ub3VzbHku
CiAqLwpsaWIuU3RvcmFnZS5DaHJvbWUu
cHJvdG90eXBlLnJlbW92ZUl0ZW1zID0g
ZnVuY3Rpb24oa2V5cywgb3B0X2NhbGxi
YWNrKSB7CiAgdGhpcy5zdG9yYWdlXy5y
ZW1vdmUoa2V5cywgb3B0X2NhbGxiYWNr
KTsKfTsKLy8gU09VUkNFIEZJTEU6IGxp
YmRvdC9qcy9saWJfc3RvcmFnZV9sb2Nh
bC5qcwovLyBDb3B5cmlnaHQgKGMpIDIw
MTIgVGhlIENocm9taXVtIE9TIEF1dGhv
cnMuIEFsbCByaWdodHMgcmVzZXJ2ZWQu
Ci8vIFVzZSBvZiB0aGlzIHNvdXJjZSBj
b2RlIGlzIGdvdmVybmVkIGJ5IGEgQlNE
LXN0eWxlIGxpY2Vuc2UgdGhhdCBjYW4g
YmUKLy8gZm91bmQgaW4gdGhlIExJQ0VO
U0UgZmlsZS4KCid1c2Ugc3RyaWN0JzsK
Ci8qKgogKiB3aW5kb3cubG9jYWxTdG9y
YWdlIGJhc2VkIGNsYXNzIHdpdGggYW4g
YXN5bmMgaW50ZXJmYWNlIHRoYXQgaXMK
ICogaW50ZXJjaGFuZ2VhYmxlIHdpdGgg
b3RoZXIgbGliLlN0b3JhZ2UuKiBpbXBs
ZW1lbnRhdGlvbnMuCiAqLwpsaWIuU3Rv
cmFnZS5Mb2NhbCA9IGZ1bmN0aW9uKCkg
ewogIHRoaXMub2JzZXJ2ZXJzXyA9IFtd
OwogIHRoaXMuc3RvcmFnZV8gPSB3aW5k
b3cubG9jYWxTdG9yYWdlOwogIHdpbmRv
dy5hZGRFdmVudExpc3RlbmVyKCdzdG9y
YWdlJywgdGhpcy5vblN0b3JhZ2VfLmJp
bmQodGhpcykpOwp9OwoKLyoqCiAqIENh
bGxlZCBieSB0aGUgc3RvcmFnZSBpbXBs
ZW1lbnRhdGlvbiB3aGVuIHRoZSBzdG9y
YWdlIGlzIG1vZGlmaWVkLgogKi8KbGli
LlN0b3JhZ2UuTG9jYWwucHJvdG90eXBl
Lm9uU3RvcmFnZV8gPSBmdW5jdGlvbihl
KSB7CiAgaWYgKGUuc3RvcmFnZUFyZWEg
IT0gdGhpcy5zdG9yYWdlXykKICAgIHJl
dHVybjsKCiAgLy8gSUUgdGhyb3dzIGFu
IGV4Y2VwdGlvbiBpZiBKU09OLnBhcnNl
IGlzIGdpdmVuIGFuIGVtcHR5IHN0cmlu
Zy4KICB2YXIgcHJldlZhbHVlID0gZS5v
bGRWYWx1ZSA/IEpTT04ucGFyc2UoZS5v
bGRWYWx1ZSkgOiAiIjsKICB2YXIgY3Vy
VmFsdWUgPSBlLm5ld1ZhbHVlID8gSlNP
Ti5wYXJzZShlLm5ld1ZhbHVlKSA6ICIi
OwogIHZhciBvID0ge307CiAgb1tlLmtl
eV0gPSB7CiAgICBvbGRWYWx1ZTogcHJl
dlZhbHVlLAogICAgbmV3VmFsdWU6IGN1
clZhbHVlCiAgfTsKCiAgZm9yICh2YXIg
aSA9IDA7IGkgPCB0aGlzLm9ic2VydmVy
c18ubGVuZ3RoOyBpKyspIHsKICAgIHRo
aXMub2JzZXJ2ZXJzX1tpXShvKTsKICB9
Cn07CgovKioKICogUmVnaXN0ZXIgYSBm
dW5jdGlvbiB0byBvYnNlcnZlIHN0b3Jh
Z2UgY2hhbmdlcy4KICoKICogQHBhcmFt
IHtmdW5jdGlvbihtYXApfSBjYWxsYmFj
ayBUaGUgZnVuY3Rpb24gdG8gaW52b2tl
IHdoZW4gdGhlIHN0b3JhZ2UKICogICAg
IGNoYW5nZXMuCiAqLwpsaWIuU3RvcmFn
ZS5Mb2NhbC5wcm90b3R5cGUuYWRkT2Jz
ZXJ2ZXIgPSBmdW5jdGlvbihjYWxsYmFj
aykgewogIHRoaXMub2JzZXJ2ZXJzXy5w
dXNoKGNhbGxiYWNrKTsKfTsKCi8qKgog
KiBVbnJlZ2lzdGVyIGEgY2hhbmdlIG9i
c2VydmVyLgogKgogKiBAcGFyYW0ge2Z1
bmN0aW9ufSBvYnNlcnZlciBBIHByZXZp
b3VzbHkgcmVnaXN0ZXJlZCBjYWxsYmFj
ay4KICovCmxpYi5TdG9yYWdlLkxvY2Fs
LnByb3RvdHlwZS5yZW1vdmVPYnNlcnZl
ciA9IGZ1bmN0aW9uKGNhbGxiYWNrKSB7
CiAgdmFyIGkgPSB0aGlzLm9ic2VydmVy
c18uaW5kZXhPZihjYWxsYmFjayk7CiAg
aWYgKGkgIT0gLTEpCiAgICB0aGlzLm9i
c2VydmVyc18uc3BsaWNlKGksIDEpOwp9
OwoKLyoqCiAqIERlbGV0ZSBldmVyeXRo
aW5nIGluIHRoaXMgc3RvcmFnZS4KICoK
ICogQHBhcmFtIHtmdW5jdGlvbihtYXAp
fSBjYWxsYmFjayBUaGUgZnVuY3Rpb24g
dG8gaW52b2tlIHdoZW4gdGhlIGRlbGV0
ZQogKiAgICAgaGFzIGNvbXBsZXRlZC4K
ICovCmxpYi5TdG9yYWdlLkxvY2FsLnBy
b3RvdHlwZS5jbGVhciA9IGZ1bmN0aW9u
KG9wdF9jYWxsYmFjaykgewogIHRoaXMu
c3RvcmFnZV8uY2xlYXIoKTsKCiAgaWYg
KG9wdF9jYWxsYmFjaykKICAgIHNldFRp
bWVvdXQob3B0X2NhbGxiYWNrLCAwKTsK
fTsKCi8qKgogKiBSZXR1cm4gdGhlIGN1
cnJlbnQgdmFsdWUgb2YgYSBzdG9yYWdl
IGl0ZW0uCiAqCiAqIEBwYXJhbSB7c3Ry
aW5nfSBrZXkgVGhlIGtleSB0byBsb29r
IHVwLgogKiBAcGFyYW0ge2Z1bmN0aW9u
KHZhbHVlKSBjYWxsYmFjayBUaGUgZnVu
Y3Rpb24gdG8gaW52b2tlIHdoZW4gdGhl
IHZhbHVlIGhhcwogKiAgICAgYmVlbiBy
ZXRyaWV2ZWQuCiAqLwpsaWIuU3RvcmFn
ZS5Mb2NhbC5wcm90b3R5cGUuZ2V0SXRl
bSA9IGZ1bmN0aW9uKGtleSwgY2FsbGJh
Y2spIHsKICB2YXIgdmFsdWUgPSB0aGlz
LnN0b3JhZ2VfLmdldEl0ZW0oa2V5KTsK
CiAgaWYgKHR5cGVvZiB2YWx1ZSA9PSAn
c3RyaW5nJykgewogICAgdHJ5IHsKICAg
ICAgdmFsdWUgPSBKU09OLnBhcnNlKHZh
bHVlKTsKICAgIH0gY2F0Y2ggKGUpIHsK
ICAgICAgLy8gSWYgd2UgY2FuJ3QgcGFy
c2UgdGhlIHZhbHVlLCBqdXN0IHJldHVy
biBpdCB1bnBhcnNlZC4KICAgIH0KICB9
CgogIHNldFRpbWVvdXQoY2FsbGJhY2su
YmluZChudWxsLCB2YWx1ZSksIDApOwp9
OwoKLyoqCiAqIEZldGNoIHRoZSB2YWx1
ZXMgb2YgbXVsdGlwbGUgc3RvcmFnZSBp
dGVtcy4KICoKICogQHBhcmFtIHtBcnJh
eX0ga2V5cyBUaGUga2V5cyB0byBsb29r
IHVwLgogKiBAcGFyYW0ge2Z1bmN0aW9u
KG1hcCkgY2FsbGJhY2sgVGhlIGZ1bmN0
aW9uIHRvIGludm9rZSB3aGVuIHRoZSB2
YWx1ZXMgaGF2ZQogKiAgICAgYmVlbiBy
ZXRyaWV2ZWQuCiAqLwpsaWIuU3RvcmFn
ZS5Mb2NhbC5wcm90b3R5cGUuZ2V0SXRl
bXMgPSBmdW5jdGlvbihrZXlzLCBjYWxs
YmFjaykgewogIHZhciBydiA9IHt9OwoK
ICBmb3IgKHZhciBpID0ga2V5cy5sZW5n
dGggLSAxOyBpID49IDA7IGktLSkgewog
ICAgdmFyIGtleSA9IGtleXNbaV07CiAg
ICB2YXIgdmFsdWUgPSB0aGlzLnN0b3Jh
Z2VfLmdldEl0ZW0oa2V5KTsKICAgIGlm
ICh0eXBlb2YgdmFsdWUgPT0gJ3N0cmlu
ZycpIHsKICAgICAgdHJ5IHsKICAgICAg
ICBydltrZXldID0gSlNPTi5wYXJzZSh2
YWx1ZSk7CiAgICAgIH0gY2F0Y2ggKGUp
IHsKICAgICAgICAvLyBJZiB3ZSBjYW4n
dCBwYXJzZSB0aGUgdmFsdWUsIGp1c3Qg
cmV0dXJuIGl0IHVucGFyc2VkLgogICAg
ICAgIHJ2W2tleV0gPSB2YWx1ZTsKICAg
ICAgfQogICAgfSBlbHNlIHsKICAgICAg
a2V5cy5zcGxpY2UoaSwgMSk7CiAgICB9
CiAgfQoKICBzZXRUaW1lb3V0KGNhbGxi
YWNrLmJpbmQobnVsbCwgcnYpLCAwKTsK
fTsKCi8qKgogKiBTZXQgYSB2YWx1ZSBp
biBzdG9yYWdlLgogKgogKiBAcGFyYW0g
e3N0cmluZ30ga2V5IFRoZSBrZXkgZm9y
IHRoZSB2YWx1ZSB0byBiZSBzdG9yZWQu
CiAqIEBwYXJhbSB7Kn0gdmFsdWUgVGhl
IHZhbHVlIHRvIGJlIHN0b3JlZC4gIEFu
eXRoaW5nIHRoYXQgY2FuIGJlIHNlcmlh
bGl6ZWQKICogICAgIHdpdGggSlNPTiBp
cyBhY2NlcHRhYmxlLgogKiBAcGFyYW0g
e2Z1bmN0aW9uKCl9IG9wdF9jYWxsYmFj
ayBPcHRpb25hbCBmdW5jdGlvbiB0byBp
bnZva2Ugd2hlbiB0aGUKICogICAgIHNl
dCBpcyBjb21wbGV0ZS4gIFlvdSBkb24n
dCBoYXZlIHRvIHdhaXQgZm9yIHRoZSBz
ZXQgdG8gY29tcGxldGUgaW4gb3JkZXIK
ICogICAgIHRvIHJlYWQgdGhlIHZhbHVl
LCBzaW5jZSB0aGUgbG9jYWwgY2FjaGUg
aXMgdXBkYXRlZCBzeW5jaHJvbm91c2x5
LgogKi8KbGliLlN0b3JhZ2UuTG9jYWwu
cHJvdG90eXBlLnNldEl0ZW0gPSBmdW5j
dGlvbihrZXksIHZhbHVlLCBvcHRfY2Fs
bGJhY2spIHsKICB0aGlzLnN0b3JhZ2Vf
LnNldEl0ZW0oa2V5LCBKU09OLnN0cmlu
Z2lmeSh2YWx1ZSkpOwoKICBpZiAob3B0
X2NhbGxiYWNrKQogIHNldFRpbWVvdXQo
b3B0X2NhbGxiYWNrLCAwKTsKfTsKCi8q
KgogKiBTZXQgbXVsdGlwbGUgdmFsdWVz
IGluIHN0b3JhZ2UuCiAqCiAqIEBwYXJh
bSB7T2JqZWN0fSBtYXAgQSBtYXAgb2Yg
a2V5L3ZhbHVlcyB0byBzZXQgaW4gc3Rv
cmFnZS4KICogQHBhcmFtIHtmdW5jdGlv
bigpfSBvcHRfY2FsbGJhY2sgT3B0aW9u
YWwgZnVuY3Rpb24gdG8gaW52b2tlIHdo
ZW4gdGhlCiAqICAgICBzZXQgaXMgY29t
cGxldGUuICBZb3UgZG9uJ3QgaGF2ZSB0
byB3YWl0IGZvciB0aGUgc2V0IHRvIGNv
bXBsZXRlIGluIG9yZGVyCiAqICAgICB0
byByZWFkIHRoZSB2YWx1ZSwgc2luY2Ug
dGhlIGxvY2FsIGNhY2hlIGlzIHVwZGF0
ZWQgc3luY2hyb25vdXNseS4KICovCmxp
Yi5TdG9yYWdlLkxvY2FsLnByb3RvdHlw
ZS5zZXRJdGVtcyA9IGZ1bmN0aW9uKG9i
aiwgb3B0X2NhbGxiYWNrKSB7CiAgZm9y
ICh2YXIga2V5IGluIG9iaikgewogICAg
dGhpcy5zdG9yYWdlXy5zZXRJdGVtKGtl
eSwgSlNPTi5zdHJpbmdpZnkob2JqW2tl
eV0pKTsKICB9CgogIGlmIChvcHRfY2Fs
bGJhY2spCiAgc2V0VGltZW91dChvcHRf
Y2FsbGJhY2ssIDApOwp9OwoKLyoqCiAq
IFJlbW92ZSBhbiBpdGVtIGZyb20gc3Rv
cmFnZS4KICoKICogQHBhcmFtIHtzdHJp
bmd9IGtleSBUaGUga2V5IHRvIGJlIHJl
bW92ZWQuCiAqIEBwYXJhbSB7ZnVuY3Rp
b24oKX0gb3B0X2NhbGxiYWNrIE9wdGlv
bmFsIGZ1bmN0aW9uIHRvIGludm9rZSB3
aGVuIHRoZQogKiAgICAgcmVtb3ZlIGlz
IGNvbXBsZXRlLiAgWW91IGRvbid0IGhh
dmUgdG8gd2FpdCBmb3IgdGhlIHNldCB0
byBjb21wbGV0ZSBpbgogKiAgICAgb3Jk
ZXIgdG8gcmVhZCB0aGUgdmFsdWUsIHNp
bmNlIHRoZSBsb2NhbCBjYWNoZSBpcyB1
cGRhdGVkIHN5bmNocm9ub3VzbHkuCiAq
LwpsaWIuU3RvcmFnZS5Mb2NhbC5wcm90
b3R5cGUucmVtb3ZlSXRlbSA9IGZ1bmN0
aW9uKGtleSwgb3B0X2NhbGxiYWNrKSB7
CiAgdGhpcy5zdG9yYWdlXy5yZW1vdmVJ
dGVtKGtleSk7CgogIGlmIChvcHRfY2Fs
bGJhY2spCiAgc2V0VGltZW91dChvcHRf
Y2FsbGJhY2ssIDApOwp9OwoKLyoqCiAq
IFJlbW92ZSBtdWx0aXBsZSBpdGVtcyBm
cm9tIHN0b3JhZ2UuCiAqCiAqIEBwYXJh
bSB7QXJyYXl9IGtleXMgVGhlIGtleXMg
dG8gYmUgcmVtb3ZlZC4KICogQHBhcmFt
IHtmdW5jdGlvbigpfSBvcHRfY2FsbGJh
Y2sgT3B0aW9uYWwgZnVuY3Rpb24gdG8g
aW52b2tlIHdoZW4gdGhlCiAqICAgICBy
ZW1vdmUgaXMgY29tcGxldGUuICBZb3Ug
ZG9uJ3QgaGF2ZSB0byB3YWl0IGZvciB0
aGUgc2V0IHRvIGNvbXBsZXRlIGluCiAq
ICAgICBvcmRlciB0byByZWFkIHRoZSB2
YWx1ZSwgc2luY2UgdGhlIGxvY2FsIGNh
Y2hlIGlzIHVwZGF0ZWQgc3luY2hyb25v
dXNseS4KICovCmxpYi5TdG9yYWdlLkxv
Y2FsLnByb3RvdHlwZS5yZW1vdmVJdGVt
cyA9IGZ1bmN0aW9uKGFyeSwgb3B0X2Nh
bGxiYWNrKSB7CiAgZm9yICh2YXIgaSA9
IDA7IGkgPCBhcnkubGVuZ3RoOyBpKysp
IHsKICAgIHRoaXMuc3RvcmFnZV8ucmVt
b3ZlSXRlbShhcnlbaV0pOwogIH0KCiAg
aWYgKG9wdF9jYWxsYmFjaykKICBzZXRU
aW1lb3V0KG9wdF9jYWxsYmFjaywgMCk7
Cn07Ci8vIFNPVVJDRSBGSUxFOiBsaWJk
b3QvanMvbGliX3N0b3JhZ2VfbWVtb3J5
LmpzCi8vIENvcHlyaWdodCAoYykgMjAx
MiBUaGUgQ2hyb21pdW0gT1MgQXV0aG9y
cy4gQWxsIHJpZ2h0cyByZXNlcnZlZC4K
Ly8gVXNlIG9mIHRoaXMgc291cmNlIGNv
ZGUgaXMgZ292ZXJuZWQgYnkgYSBCU0Qt
c3R5bGUgbGljZW5zZSB0aGF0IGNhbiBi
ZQovLyBmb3VuZCBpbiB0aGUgTElDRU5T
RSBmaWxlLgoKJ3VzZSBzdHJpY3QnOwoK
LyoqCiAqIEluLW1lbW9yeSBzdG9yYWdl
IGNsYXNzIHdpdGggYW4gYXN5bmMgaW50
ZXJmYWNlIHRoYXQgaXMgaW50ZXJjaGFu
Z2VhYmxlIHdpdGgKICogb3RoZXIgbGli
LlN0b3JhZ2UuKiBpbXBsZW1lbnRhdGlv
bnMuCiAqLwpsaWIuU3RvcmFnZS5NZW1v
cnkgPSBmdW5jdGlvbigpIHsKICB0aGlz
Lm9ic2VydmVyc18gPSBbXTsKICB0aGlz
LnN0b3JhZ2VfID0ge307Cn07CgovKioK
ICogUmVnaXN0ZXIgYSBmdW5jdGlvbiB0
byBvYnNlcnZlIHN0b3JhZ2UgY2hhbmdl
cy4KICoKICogQHBhcmFtIHtmdW5jdGlv
bihtYXApfSBjYWxsYmFjayBUaGUgZnVu
Y3Rpb24gdG8gaW52b2tlIHdoZW4gdGhl
IHN0b3JhZ2UKICogICAgIGNoYW5nZXMu
CiAqLwpsaWIuU3RvcmFnZS5NZW1vcnku
cHJvdG90eXBlLmFkZE9ic2VydmVyID0g
ZnVuY3Rpb24oY2FsbGJhY2spIHsKICB0
aGlzLm9ic2VydmVyc18ucHVzaChjYWxs
YmFjayk7Cn07CgovKioKICogVW5yZWdp
c3RlciBhIGNoYW5nZSBvYnNlcnZlci4K
ICoKICogQHBhcmFtIHtmdW5jdGlvbn0g
b2JzZXJ2ZXIgQSBwcmV2aW91c2x5IHJl
Z2lzdGVyZWQgY2FsbGJhY2suCiAqLwps
aWIuU3RvcmFnZS5NZW1vcnkucHJvdG90
eXBlLnJlbW92ZU9ic2VydmVyID0gZnVu
Y3Rpb24oY2FsbGJhY2spIHsKICB2YXIg
aSA9IHRoaXMub2JzZXJ2ZXJzXy5pbmRl
eE9mKGNhbGxiYWNrKTsKICBpZiAoaSAh
PSAtMSkKICAgIHRoaXMub2JzZXJ2ZXJz
Xy5zcGxpY2UoaSwgMSk7Cn07CgovKioK
ICogRGVsZXRlIGV2ZXJ5dGhpbmcgaW4g
dGhpcyBzdG9yYWdlLgogKgogKiBAcGFy
YW0ge2Z1bmN0aW9uKG1hcCl9IGNhbGxi
YWNrIFRoZSBmdW5jdGlvbiB0byBpbnZv
a2Ugd2hlbiB0aGUgZGVsZXRlCiAqICAg
ICBoYXMgY29tcGxldGVkLgogKi8KbGli
LlN0b3JhZ2UuTWVtb3J5LnByb3RvdHlw
ZS5jbGVhciA9IGZ1bmN0aW9uKG9wdF9j
YWxsYmFjaykgewogIHZhciBlID0ge307
CiAgZm9yICh2YXIga2V5IGluIHRoaXMu
c3RvcmFnZV8pIHsKICAgIGVba2V5XSA9
IHtvbGRWYWx1ZTogdGhpcy5zdG9yYWdl
X1trZXldLCBuZXdWYWx1ZTogKHZvaWQg
MCl9OwogIH0KCiAgdGhpcy5zdG9yYWdl
XyA9IHt9OwoKICBzZXRUaW1lb3V0KGZ1
bmN0aW9uKCkgewogICAgZm9yICh2YXIg
aSA9IDA7IGkgPCB0aGlzLm9ic2VydmVy
c18ubGVuZ3RoOyBpKyspIHsKICAgICAg
dGhpcy5vYnNlcnZlcnNfW2ldKGUpOwog
ICAgfQogIH0uYmluZCh0aGlzKSwgMCk7
CgogIGlmIChvcHRfY2FsbGJhY2spCiAg
ICBzZXRUaW1lb3V0KG9wdF9jYWxsYmFj
aywgMCk7Cn07CgovKioKICogUmV0dXJu
IHRoZSBjdXJyZW50IHZhbHVlIG9mIGEg
c3RvcmFnZSBpdGVtLgogKgogKiBAcGFy
YW0ge3N0cmluZ30ga2V5IFRoZSBrZXkg
dG8gbG9vayB1cC4KICogQHBhcmFtIHtm
dW5jdGlvbih2YWx1ZSkgY2FsbGJhY2sg
VGhlIGZ1bmN0aW9uIHRvIGludm9rZSB3
aGVuIHRoZSB2YWx1ZSBoYXMKICogICAg
IGJlZW4gcmV0cmlldmVkLgogKi8KbGli
LlN0b3JhZ2UuTWVtb3J5LnByb3RvdHlw
ZS5nZXRJdGVtID0gZnVuY3Rpb24oa2V5
LCBjYWxsYmFjaykgewogIHZhciB2YWx1
ZSA9IHRoaXMuc3RvcmFnZV9ba2V5XTsK
CiAgaWYgKHR5cGVvZiB2YWx1ZSA9PSAn
c3RyaW5nJykgewogICAgdHJ5IHsKICAg
ICAgdmFsdWUgPSBKU09OLnBhcnNlKHZh
bHVlKTsKICAgIH0gY2F0Y2ggKGUpIHsK
ICAgICAgLy8gSWYgd2UgY2FuJ3QgcGFy
c2UgdGhlIHZhbHVlLCBqdXN0IHJldHVy
biBpdCB1bnBhcnNlZC4KICAgIH0KICB9
CgogIHNldFRpbWVvdXQoY2FsbGJhY2su
YmluZChudWxsLCB2YWx1ZSksIDApOwp9
OwoKLyoqCiAqIEZldGNoIHRoZSB2YWx1
ZXMgb2YgbXVsdGlwbGUgc3RvcmFnZSBp
dGVtcy4KICoKICogQHBhcmFtIHtBcnJh
eX0ga2V5cyBUaGUga2V5cyB0byBsb29r
IHVwLgogKiBAcGFyYW0ge2Z1bmN0aW9u
KG1hcCkgY2FsbGJhY2sgVGhlIGZ1bmN0
aW9uIHRvIGludm9rZSB3aGVuIHRoZSB2
YWx1ZXMgaGF2ZQogKiAgICAgYmVlbiBy
ZXRyaWV2ZWQuCiAqLwpsaWIuU3RvcmFn
ZS5NZW1vcnkucHJvdG90eXBlLmdldEl0
ZW1zID0gZnVuY3Rpb24oa2V5cywgY2Fs
bGJhY2spIHsKICB2YXIgcnYgPSB7fTsK
CiAgZm9yICh2YXIgaSA9IGtleXMubGVu
Z3RoIC0gMTsgaSA+PSAwOyBpLS0pIHsK
ICAgIHZhciBrZXkgPSBrZXlzW2ldOwog
ICAgdmFyIHZhbHVlID0gdGhpcy5zdG9y
YWdlX1trZXldOwogICAgaWYgKHR5cGVv
ZiB2YWx1ZSA9PSAnc3RyaW5nJykgewog
ICAgICB0cnkgewogICAgICAgIHJ2W2tl
eV0gPSBKU09OLnBhcnNlKHZhbHVlKTsK
ICAgICAgfSBjYXRjaCAoZSkgewogICAg
ICAgIC8vIElmIHdlIGNhbid0IHBhcnNl
IHRoZSB2YWx1ZSwganVzdCByZXR1cm4g
aXQgdW5wYXJzZWQuCiAgICAgICAgcnZb
a2V5XSA9IHZhbHVlOwogICAgICB9CiAg
ICB9IGVsc2UgewogICAgICBrZXlzLnNw
bGljZShpLCAxKTsKICAgIH0KICB9Cgog
IHNldFRpbWVvdXQoY2FsbGJhY2suYmlu
ZChudWxsLCBydiksIDApOwp9OwoKLyoq
CiAqIFNldCBhIHZhbHVlIGluIHN0b3Jh
Z2UuCiAqCiAqIEBwYXJhbSB7c3RyaW5n
fSBrZXkgVGhlIGtleSBmb3IgdGhlIHZh
bHVlIHRvIGJlIHN0b3JlZC4KICogQHBh
cmFtIHsqfSB2YWx1ZSBUaGUgdmFsdWUg
dG8gYmUgc3RvcmVkLiAgQW55dGhpbmcg
dGhhdCBjYW4gYmUgc2VyaWFsaXplZAog
KiAgICAgd2l0aCBKU09OIGlzIGFjY2Vw
dGFibGUuCiAqIEBwYXJhbSB7ZnVuY3Rp
b24oKX0gb3B0X2NhbGxiYWNrIE9wdGlv
bmFsIGZ1bmN0aW9uIHRvIGludm9rZSB3
aGVuIHRoZQogKiAgICAgc2V0IGlzIGNv
bXBsZXRlLiAgWW91IGRvbid0IGhhdmUg
dG8gd2FpdCBmb3IgdGhlIHNldCB0byBj
b21wbGV0ZSBpbiBvcmRlcgogKiAgICAg
dG8gcmVhZCB0aGUgdmFsdWUsIHNpbmNl
IHRoZSBsb2NhbCBjYWNoZSBpcyB1cGRh
dGVkIHN5bmNocm9ub3VzbHkuCiAqLwps
aWIuU3RvcmFnZS5NZW1vcnkucHJvdG90
eXBlLnNldEl0ZW0gPSBmdW5jdGlvbihr
ZXksIHZhbHVlLCBvcHRfY2FsbGJhY2sp
IHsKICB2YXIgb2xkVmFsdWUgPSB0aGlz
LnN0b3JhZ2VfW2tleV07CiAgdGhpcy5z
dG9yYWdlX1trZXldID0gSlNPTi5zdHJp
bmdpZnkodmFsdWUpOwoKICB2YXIgZSA9
IHt9OwogIGVba2V5XSA9IHtvbGRWYWx1
ZTogb2xkVmFsdWUsIG5ld1ZhbHVlOiB2
YWx1ZX07CgogIHNldFRpbWVvdXQoZnVu
Y3Rpb24oKSB7CiAgICBmb3IgKHZhciBp
ID0gMDsgaSA8IHRoaXMub2JzZXJ2ZXJz
Xy5sZW5ndGg7IGkrKykgewogICAgICB0
aGlzLm9ic2VydmVyc19baV0oZSk7CiAg
ICB9CiAgfS5iaW5kKHRoaXMpLCAwKTsK
CiAgaWYgKG9wdF9jYWxsYmFjaykKICBz
ZXRUaW1lb3V0KG9wdF9jYWxsYmFjaywg
MCk7Cn07CgovKioKICogU2V0IG11bHRp
cGxlIHZhbHVlcyBpbiBzdG9yYWdlLgog
KgogKiBAcGFyYW0ge09iamVjdH0gbWFw
IEEgbWFwIG9mIGtleS92YWx1ZXMgdG8g
c2V0IGluIHN0b3JhZ2UuCiAqIEBwYXJh
bSB7ZnVuY3Rpb24oKX0gb3B0X2NhbGxi
YWNrIE9wdGlvbmFsIGZ1bmN0aW9uIHRv
IGludm9rZSB3aGVuIHRoZQogKiAgICAg
c2V0IGlzIGNvbXBsZXRlLiAgWW91IGRv
bid0IGhhdmUgdG8gd2FpdCBmb3IgdGhl
IHNldCB0byBjb21wbGV0ZSBpbiBvcmRl
cgogKiAgICAgdG8gcmVhZCB0aGUgdmFs
dWUsIHNpbmNlIHRoZSBsb2NhbCBjYWNo
ZSBpcyB1cGRhdGVkIHN5bmNocm9ub3Vz
bHkuCiAqLwpsaWIuU3RvcmFnZS5NZW1v
cnkucHJvdG90eXBlLnNldEl0ZW1zID0g
ZnVuY3Rpb24ob2JqLCBvcHRfY2FsbGJh
Y2spIHsKICB2YXIgZSA9IHt9OwoKICBm
b3IgKHZhciBrZXkgaW4gb2JqKSB7CiAg
ICBlW2tleV0gPSB7b2xkVmFsdWU6IHRo
aXMuc3RvcmFnZV9ba2V5XSwgbmV3VmFs
dWU6IG9ialtrZXldfTsKICAgIHRoaXMu
c3RvcmFnZV9ba2V5XSA9IEpTT04uc3Ry
aW5naWZ5KG9ialtrZXldKTsKICB9Cgog
IHNldFRpbWVvdXQoZnVuY3Rpb24oKSB7
CiAgICBmb3IgKHZhciBpID0gMDsgaSA8
IHRoaXMub2JzZXJ2ZXJzXy5sZW5ndGg7
IGkrKykgewogICAgICB0aGlzLm9ic2Vy
dmVyc19baV0oZSk7CiAgICB9CiAgfS5i
aW5kKHRoaXMpKTsKCiAgaWYgKG9wdF9j
YWxsYmFjaykKICBzZXRUaW1lb3V0KG9w
dF9jYWxsYmFjaywgMCk7Cn07CgovKioK
ICogUmVtb3ZlIGFuIGl0ZW0gZnJvbSBz
dG9yYWdlLgogKgogKiBAcGFyYW0ge3N0
cmluZ30ga2V5IFRoZSBrZXkgdG8gYmUg
cmVtb3ZlZC4KICogQHBhcmFtIHtmdW5j
dGlvbigpfSBvcHRfY2FsbGJhY2sgT3B0
aW9uYWwgZnVuY3Rpb24gdG8gaW52b2tl
IHdoZW4gdGhlCiAqICAgICByZW1vdmUg
aXMgY29tcGxldGUuICBZb3UgZG9uJ3Qg
aGF2ZSB0byB3YWl0IGZvciB0aGUgc2V0
IHRvIGNvbXBsZXRlIGluCiAqICAgICBv
cmRlciB0byByZWFkIHRoZSB2YWx1ZSwg
c2luY2UgdGhlIGxvY2FsIGNhY2hlIGlz
IHVwZGF0ZWQgc3luY2hyb25vdXNseS4K
ICovCmxpYi5TdG9yYWdlLk1lbW9yeS5w
cm90b3R5cGUucmVtb3ZlSXRlbSA9IGZ1
bmN0aW9uKGtleSwgb3B0X2NhbGxiYWNr
KSB7CiAgZGVsZXRlIHRoaXMuc3RvcmFn
ZV9ba2V5XTsKCiAgaWYgKG9wdF9jYWxs
YmFjaykKICBzZXRUaW1lb3V0KG9wdF9j
YWxsYmFjaywgMCk7Cn07CgovKioKICog
UmVtb3ZlIG11bHRpcGxlIGl0ZW1zIGZy
b20gc3RvcmFnZS4KICoKICogQHBhcmFt
IHtBcnJheX0ga2V5cyBUaGUga2V5cyB0
byBiZSByZW1vdmVkLgogKiBAcGFyYW0g
e2Z1bmN0aW9uKCl9IG9wdF9jYWxsYmFj
ayBPcHRpb25hbCBmdW5jdGlvbiB0byBp
bnZva2Ugd2hlbiB0aGUKICogICAgIHJl
bW92ZSBpcyBjb21wbGV0ZS4gIFlvdSBk
b24ndCBoYXZlIHRvIHdhaXQgZm9yIHRo
ZSBzZXQgdG8gY29tcGxldGUgaW4KICog
ICAgIG9yZGVyIHRvIHJlYWQgdGhlIHZh
bHVlLCBzaW5jZSB0aGUgbG9jYWwgY2Fj
aGUgaXMgdXBkYXRlZCBzeW5jaHJvbm91
c2x5LgogKi8KbGliLlN0b3JhZ2UuTWVt
b3J5LnByb3RvdHlwZS5yZW1vdmVJdGVt
cyA9IGZ1bmN0aW9uKGFyeSwgb3B0X2Nh
bGxiYWNrKSB7CiAgZm9yICh2YXIgaSA9
IDA7IGkgPCBhcnkubGVuZ3RoOyBpKysp
IHsKICAgIGRlbGV0ZSB0aGlzLnN0b3Jh
Z2VfW2FyeVtpXV07CiAgfQoKICBpZiAo
b3B0X2NhbGxiYWNrKQogIHNldFRpbWVv
dXQob3B0X2NhbGxiYWNrLCAwKTsKfTsK
Ly8gU09VUkNFIEZJTEU6IGxpYmRvdC9q
cy9saWJfdGVzdF9tYW5hZ2VyLmpzCi8v
IENvcHlyaWdodCAoYykgMjAxMiBUaGUg
Q2hyb21pdW0gT1MgQXV0aG9ycy4gQWxs
IHJpZ2h0cyByZXNlcnZlZC4KLy8gVXNl
IG9mIHRoaXMgc291cmNlIGNvZGUgaXMg
Z292ZXJuZWQgYnkgYSBCU0Qtc3R5bGUg
bGljZW5zZSB0aGF0IGNhbiBiZQovLyBm
b3VuZCBpbiB0aGUgTElDRU5TRSBmaWxl
LgoKJ3VzZSBzdHJpY3QnOwoKLyoqCiAq
IEBmaWxlb3ZlcnZpZXcgSmF2YVNjcmlw
dCB1bml0IHRlc3RpbmcgZnJhbWV3b3Jr
IGZvciBzeW5jaHJvbm91cyBhbmQKICog
ICAgIGFzeW5jaHJvbm91cyB0ZXN0cy4K
ICoKICogVGhpcyBmaWxlIGNvbnRhaW5z
IHRoZSBsaWIuVGVzdE1hbmFnZXIgYW5k
IHJlbGF0ZWQgY2xhc3Nlcy4gIEF0IHRo
ZSBtb21lbnQKICogaXQncyBhbGwgY29s
bGVjdGVkIGluIGEgc2luZ2xlIGZpbGUg
c2luY2UgaXQncyByZWFzb25hYmx5IHNt
YWxsCiAqICg9fjFrIGxpbmVzKSwgYW5k
IGl0J3MgYSBsb3QgZWFzaWVyIHRvIGlu
Y2x1ZGUgb25lIGZpbGUgaW50byB5b3Vy
IHRlc3QKICogaGFybmVzcyB0aGFuIGl0
IGlzIHRvIGluY2x1ZGUgc2V2ZW4uCiAq
CiAqIFRoZSBmb2xsb3dpbmcgY2xhc3Nl
cyBhcmUgZGVmaW5lZC4uLgogKgogKiAg
IGxpYi5UZXN0TWFuYWdlciAtIFRoZSBy
b290IGNsYXNzIGFuZCBlbnRyeXBvaW50
IGZvciBjcmVhdGluZyB0ZXN0IHJ1bnMu
CiAqICAgbGliLlRlc3RNYW5hZ2VyLkxv
ZyAtIExvZ2dpbmcgc2VydmljZS4KICog
ICBsaWIuVGVzdE1hbmFnZXIuU3VpdGUg
LSBBIGNvbGxlY3Rpb24gb2YgdGVzdHMu
CiAqICAgbGliLlRlc3RNYW5hZ2VyLlRl
c3QgLSBBIHNpbmdsZSB0ZXN0LgogKiAg
IGxpYi5UZXN0TWFuYWdlci5UZXN0UnVu
IC0gTWFuYWdlcyB0aGUgZXhlY3V0aW9u
IG9mIGEgc2V0IG9mIHRlc3RzLgogKiAg
IGxpYi5UZXN0TWFuYWdlci5SZXN1bHQg
LSBBIHNpbmdsZSB0ZXN0IHJlc3VsdC4K
ICovCgovKioKICogUm9vdCBvYmplY3Qg
aW4gdGhlIHVuaXQgdGVzdCBoZWlyYXJj
aHksIGFuZCBrZWVwZXIgb2YgdGhlIGxv
ZyBvYmplY3QuCiAqCiAqIEBwYXJhbSB7
bGliLlRlc3RNYW5hZ2VyLkxvZ30gb3B0
X2xvZyBPcHRpb25hbCBsaWIuVGVzdE1h
bmFnZXIuTG9nIG9iamVjdC4KICogICAg
IExvZ3MgdG8gdGhlIEphdmFTY3JpcHQg
Y29uc29sZSBpZiBvbW1pdHRlZC4KICov
CmxpYi5UZXN0TWFuYWdlciA9IGZ1bmN0
aW9uKG9wdF9sb2cpIHsKICB0aGlzLmxv
ZyA9IG9wdF9sb2cgfHwgbmV3IGxpYi5U
ZXN0TWFuYWdlci5Mb2coKTsKfQoKLyoq
CiAqIENyZWF0ZSBhIG5ldyB0ZXN0IHJ1
biBvYmplY3QgZm9yIHRoaXMgdGVzdCBt
YW5hZ2VyLgogKgogKiBAcGFyYW0ge09i
amVjdH0gb3B0X2N4IEFuIG9iamVjdCB0
byBiZSBwYXNzZWQgdG8gdGVzdCBzdWl0
ZSBzZXR1cCgpLAogKiAgICAgcHJlYW1i
bGUoKSwgYW5kIHRlc3QgY2FzZXMgZHVy
aW5nIHRoaXMgdGVzdCBydW4uICBUaGlz
IG9iamVjdCBpcyBvcGFxdWUKICogICAg
IHRvIGxpYi5UZXN0TWFuYWdlci4qIGNv
ZGUuICBJdCdzIGVudGlyZWx5IHVwIHRv
IHRoZSB0ZXN0IHN1aXRlIHdoYXQgaXQn
cwogKiAgICAgdXNlZCBmb3IuCiAqLwps
aWIuVGVzdE1hbmFnZXIucHJvdG90eXBl
LmNyZWF0ZVRlc3RSdW4gPSBmdW5jdGlv
bihvcHRfY3gpIHsKICByZXR1cm4gbmV3
IGxpYi5UZXN0TWFuYWdlci5UZXN0UnVu
KHRoaXMsIG9wdF9jeCk7Cn07CgovKioK
ICogQ2FsbGVkIHdoZW4gYSB0ZXN0IHJ1
biBhc3NvY2lhdGVkIHdpdGggdGhpcyB0
ZXN0IG1hbmFnZXIgY29tcGxldGVzLgog
KgogKiBDbGllbnRzIG1heSBvdmVycmlk
ZSB0aGlzIHRvIGNhbGwgYW4gYXBwcm9w
cmlhdGUgZnVuY3Rpb24uCiAqLwpsaWIu
VGVzdE1hbmFnZXIucHJvdG90eXBlLm9u
VGVzdFJ1bkNvbXBsZXRlID0gZnVuY3Rp
b24odGVzdFJ1bikge307CgovKioKICog
RGVzdGluYXRpb24gZm9yIHRlc3QgY2Fz
ZSBvdXRwdXQuCiAqCiAqIEBwYXJhbSB7
ZnVuY3Rpb24oc3RyaW5nKX0gb3B0X2xv
Z0Z1bmN0aW9uIE9wdGlvbmFsIGZ1bmN0
aW9uIHRvIGNhbGwgdG8KICogICAgIHdy
aXRlIGEgc3RyaW5nIHRvIHRoZSBsb2cu
ICBJZiBvbW1pdHRlZCwgY29uc29sZS5s
b2cgaXMgdXNlZC4KICovCmxpYi5UZXN0
TWFuYWdlci5Mb2cgPSBmdW5jdGlvbihv
cHRfbG9nRnVuY3Rpb24pIHsKICB0aGlz
LmxvZ0Z1bmN0aW9uXyA9IG9wdF9sb2dG
dW5jdGlvbiB8fCBmdW5jdGlvbihzKSB7
IGNvbnNvbGUubG9nKHMpIH07CiAgdGhp
cy5wZW5kaW5nXyA9ICcnOwogIHRoaXMu
cHJlZml4XyA9ICcnOwogIHRoaXMucHJl
Zml4U3RhY2tfID0gW107Cn07CgovKioK
ICogQWRkIGEgcHJlZml4IHRvIGxvZyBt
ZXNzYWdlcy4KICoKICogVGhpcyBvbmx5
IGFmZmVjdHMgbG9nIG1lc3NhZ2VzIHRo
YXQgYXJlIGFkZGVkIGFmdGVyIHRoZSBw
cmVmaXggaXMgcHVzaGVkLgogKgogKiBA
cGFyYW0ge3N0cmluZ30gc3RyIFRoZSBw
cmVmaXggdG8gcHJlcGVuZCB0byBmdXR1
cmUgbG9nIG1lc3NhZ2VzLgogKi8KbGli
LlRlc3RNYW5hZ2VyLkxvZy5wcm90b3R5
cGUucHVzaFByZWZpeCA9IGZ1bmN0aW9u
KHN0cikgewogIHRoaXMucHJlZml4U3Rh
Y2tfLnB1c2goc3RyKTsKICB0aGlzLnBy
ZWZpeF8gPSB0aGlzLnByZWZpeFN0YWNr
Xy5qb2luKCcnKTsKfTsKCi8qKgogKiBS
ZW1vdmUgdGhlIG1vc3QgcmVjZW50bHkg
YWRkZWQgbWVzc2FnZSBwcmVmaXguCiAq
LwpsaWIuVGVzdE1hbmFnZXIuTG9nLnBy
b3RvdHlwZS5wb3BQcmVmaXggPSBmdW5j
dGlvbigpIHsKICB0aGlzLnByZWZpeFN0
YWNrXy5wb3AoKTsKICB0aGlzLnByZWZp
eF8gPSB0aGlzLnByZWZpeFN0YWNrXy5q
b2luKCcnKTsKfTsKCi8qKgogKiBRdWV1
ZSB1cCBhIHN0cmluZyB0byBwcmludCB0
byB0aGUgbG9nLgogKgogKiBJZiBhIGxp
bmUgaXMgYWxyZWFkeSBwZW5kaW5nLCB0
aGlzIHN0cmluZyBpcyBhZGRlZCB0byBp
dC4KICoKICogVGhlIHN0cmluZyBpcyBu
b3QgYWN0dWFsbHkgcHJpbnRlZCB0byB0
aGUgbG9nIHVudGlsIGZsdXNoKCkgb3Ig
cHJpbnRsbigpCiAqIGlzIGNhbGxlZC4g
IFRoZSBmb2xsb3dpbmcgY2FsbCBzZXF1
ZW5jZSB3aWxsIHJlc3VsdCBpbiBUV08g
bGluZXMgaW4gdGhlCiAqIGxvZy4uLgog
KgogKiAgIGxvZy5wcmludCgnaGVsbG8n
KTsKICogICBsb2cucHJpbnQoJyAnKTsK
ICogICBsb2cucHJpbnRsbignd29ybGQn
KTsKICoKICogV2hpbGUgYSB0eXBpY2Fs
IHN0cmVhbS1saWtlIHRoaW5nIHdvdWxk
IHJlc3VsdCBpbiAnaGVsbG8gd29ybGRc
bicsIHRoaXMgb25lCiAqIHJlc3VsdHMg
aW4gJ2hlbGxvIFxud29ybGRcbicuCiAq
CiAqIEBwYXJhbSB7c3RyaW5nfSBzdHIg
VGhlIHN0cmluZyB0byBhZGQgdG8gdGhl
IGxvZy4KICovCmxpYi5UZXN0TWFuYWdl
ci5Mb2cucHJvdG90eXBlLnByaW50ID0g
ZnVuY3Rpb24oc3RyKSB7CiAgaWYgKHRo
aXMucGVuZGluZ18pIHsKICAgIHRoaXMu
cGVuZGluZ18gKz0gc3RyOwogIH0gZWxz
ZSB7CiAgICB0aGlzLnBlbmRpbmdfID0g
dGhpcy5wcmVmaXhfICsgc3RyOwogIH0K
fTsKCi8qKgogKiBQcmludCBhIGxpbmUg
dG8gdGhlIGxvZyBhbmQgZmx1c2ggaXQg
aW1tZWRpYXRlbHkuCiAqCiAqIEBwYXJh
bSB7c3RyaW5nfSBzdHIgVGhlIHN0cmlu
ZyB0byBhZGQgdG8gdGhlIGxvZy4KICov
CmxpYi5UZXN0TWFuYWdlci5Mb2cucHJv
dG90eXBlLnByaW50bG4gPSBmdW5jdGlv
bihzdHIpIHsKICBpZiAodGhpcy5wZW5k
aW5nXykKICAgIHRoaXMuZmx1c2goKTsK
CiAgdGhpcy5sb2dGdW5jdGlvbl8odGhp
cy5wcmVmaXhfICsgc3RyKTsKfTsKCi8q
KgogKiBGbHVzaCBhbnkgcGVuZGluZyBs
b2cgbWVzc2FnZS4KICovCmxpYi5UZXN0
TWFuYWdlci5Mb2cucHJvdG90eXBlLmZs
dXNoID0gZnVuY3Rpb24oKSB7CiAgaWYg
KCF0aGlzLnBlbmRpbmdfKQogICAgcmV0
dXJuOwoKICB0aGlzLmxvZ0Z1bmN0aW9u
Xyh0aGlzLnBlbmRpbmdfKTsKICB0aGlz
LnBlbmRpbmdfID0gJyc7Cn07CgovKioK
ICogUmV0dXJucyBhIG5ldyBjb25zdHJ1
Y3RvciBmdW5jdGlvbiB0aGF0IHdpbGwg
aW5oZXJpdCBmcm9tCiAqIGxpYi5UZXN0
TWFuYWdlci5TdWl0ZS4KICoKICogVXNl
IHRoaXMgZnVuY3Rpb24gdG8gY3JlYXRl
IGEgbmV3IHRlc3Qgc3VpdGUgc3ViY2xh
c3MuICBJdCB3aWxsIHJldHVybiBhCiAq
IHByb3Blcmx5IGluaXRpYWxpemVkIGNv
bnN0cnVjdG9yIGZ1bmN0aW9uIGZvciB0
aGUgc3ViY2xhc3MuICBZb3UgY2FuIHRo
ZW4KICogb3ZlcnJpZGUgdGhlIHNldHVw
KCkgYW5kIHByZWFtYmxlKCkgbWV0aG9k
cyBpZiBuZWNlc3NhcnkgYW5kIGFkZCB0
ZXN0IGNhc2VzCiAqIHRvIHRoZSBzdWJj
bGFzcy4KICoKICogICB2YXIgTXlUZXN0
cyA9IG5ldyBsaWIuVGVzdE1hbmFnZXIu
U3VpdGUoJ015VGVzdHMnKTsKICoKICog
ICBNeVRlc3RzLnByb3RvdHlwZS5zZXR1
cCA9IGZ1bmN0aW9uKGN4KSB7CiAqICAg
ICAvLyBTZXRzIHRoaXMuc2l6ZSB0byBj
eC5zaXplIGlmIGl0IGV4aXN0cywgb3Ig
dGhlIGRlZmF1bHQgdmFsdWUgb2YgMTAK
ICogICAgIC8vIGlmIG5vdC4KICogICAg
IHRoaXMuc2V0RGVmYXVsdChjeCwge3Np
emU6IDEwfSk7CiAqICAgfTsKICoKICog
ICBNeVRlc3RzLnByb3RvdHlwZS5wcmVh
bWJsZSA9IGZ1bmN0aW9uKHJlc3VsdCwg
Y3gpIHsKICogICAgIC8vIFNvbWUgdGVz
dHMgKGV2ZW4gc3VjY2Vzc2Z1bCBvbmVz
KSBtYXkgc2lkZS1lZmZlY3QgdGhpcyBs
aXN0LCBzbwogKiAgICAgLy8gcmVjcmVh
dGUgaXQgYmVmb3JlIGV2ZXJ5IHRlc3Qu
CiAqICAgICB0aGlzLmxpc3QgPSBbXTsK
ICogICAgIGZvciAodmFyIGkgPSAwOyBp
IDwgdGhpcy5zaXplOyBpKyspIHsKICog
ICAgICAgdGhpcy5saXN0W2ldID0gaTsK
ICogICAgIH0KICogICB9OwogKgogKiAg
IC8vIEJhc2ljIHN5bmNocm9ub3VzIHRl
c3QgY2FzZS4KICogICBNeVRlc3RzLmFk
ZFRlc3QoJ3BvcC1sZW5ndGgnLCBmdW5j
dGlvbihyZXN1bHQsIGN4KSB7CiAqICAg
ICAgIHRoaXMubGlzdC5wb3AoKTsKICoK
ICogICAgICAgLy8gSWYgdGhpcyBhc3Nl
cnRpb24gZmFpbHMsIHRoZSB0ZXN0Y2Fz
ZSB3aWxsIHN0b3AgaGVyZS4KICogICAg
ICAgcmVzdWx0LmFzc2VydEVRKHRoaXMu
bGlzdC5sZW5ndGgsIHRoaXMuc2l6ZSAt
IDEpOwogKgogKiAgICAgICAvLyBBIHRl
c3QgbXVzdCBpbmRpY2F0ZSBpdCBoYXMg
cGFzc2VkIGJ5IGNhbGxpbmcgdGhpcyBt
ZXRob2QuCiAqICAgICAgIHJlc3VsdC5w
YXNzKCk7CiAqICAgICB9KTsKICoKICog
ICAvLyBTYW1wbGUgYXN5bmNocm9ub3Vz
IHRlc3QgY2FzZS4KICogICBNeVRlc3Rz
LmFkZFRlc3QoJ2FzeW5jLXBvcC1sZW5n
dGgnLCBmdW5jdGlvbihyZXN1bHQsIGN4
KSB7CiAqICAgICAgIHZhciBzZWxmID0g
dGhpczsKICoKICogICAgICAgdmFyIGNh
bGxiYWNrID0gZnVuY3Rpb24oKSB7CiAq
ICAgICAgICAgICByZXN1bHQuYXNzZXJ0
RVEoc2VsZi5saXN0Lmxlbmd0aCwgc2Vs
Zi5zaXplIC0gMSk7CiAqICAgICAgICAg
ICByZXN1bHQucGFzcygpOwogKiAgICAg
ICB9OwogKgogKiAgICAgICAvLyBXYWl0
IDEwMG1zIHRvIGNoZWNrIHRoZSBhcnJh
eSBsZW5ndGggZm9yIHRoZSBzYWtlIG9m
IHRoaXMgZXhhbXBsZS4KICogICAgICAg
c2V0VGltZW91dChjYWxsYmFjaywgMTAw
KTsKICoKICogICAgICAgdGhpcy5saXN0
LnBvcCgpOwogKgogKiAgICAgICAvLyBJ
bmRpY2F0ZSB0aGF0IHRoaXMgdGVzdCBu
ZWVkcyBhbm90aGVyIDIwMG1zIHRvIGNv
bXBsZXRlLgogKiAgICAgICAvLyBJZiB0
aGUgdGVzdCBkb2VzIG5vdCByZXBvcnQg
cGFzcy9mYWlsIGJ5IHRoZW4sIGl0IGlz
IGNvbnNpZGVyZWQgdG8KICogICAgICAg
Ly8gaGF2ZSB0aW1lZCBvdXQuCiAqICAg
ICAgIHJlc3VsdC5yZXF1ZXN0VGltZSgy
MDApOwogKiAgICAgfSk7CiAqCiAqICAg
Li4uCiAqCiAqIEBwYXJhbSB7c3RyaW5n
fSBzdWl0ZU5hbWUgVGhlIG5hbWUgb2Yg
dGhlIHRlc3Qgc3VpdGUuCiAqLwpsaWIu
VGVzdE1hbmFnZXIuU3VpdGUgPSBmdW5j
dGlvbihzdWl0ZU5hbWUpIHsKICBmdW5j
dGlvbiBjdG9yKHRlc3RNYW5hZ2VyLCBj
eCkgewogICAgdGhpcy50ZXN0TWFuYWdl
cl8gPSB0ZXN0TWFuYWdlcjsKICAgIHRo
aXMuc3VpdGVOYW1lID0gc3VpdGVOYW1l
OwoKICAgIHRoaXMuc2V0dXAoY3gpOwog
IH0KCiAgY3Rvci5zdWl0ZU5hbWUgPSBz
dWl0ZU5hbWU7CiAgY3Rvci5hZGRUZXN0
ID0gbGliLlRlc3RNYW5hZ2VyLlN1aXRl
LmFkZFRlc3Q7CiAgY3Rvci5kaXNhYmxl
VGVzdCA9IGxpYi5UZXN0TWFuYWdlci5T
dWl0ZS5kaXNhYmxlVGVzdDsKICBjdG9y
LmdldFRlc3QgPSBsaWIuVGVzdE1hbmFn
ZXIuU3VpdGUuZ2V0VGVzdDsKICBjdG9y
LmdldFRlc3RMaXN0ID0gbGliLlRlc3RN
YW5hZ2VyLlN1aXRlLmdldFRlc3RMaXN0
OwogIGN0b3IudGVzdExpc3RfID0gW107
CiAgY3Rvci50ZXN0TWFwXyA9IHt9Owog
IGN0b3IucHJvdG90eXBlID0geyBfX3By
b3RvX186IGxpYi5UZXN0TWFuYWdlci5T
dWl0ZS5wcm90b3R5cGUgfTsKCiAgbGli
LlRlc3RNYW5hZ2VyLlN1aXRlLnN1YmNs
YXNzZXMucHVzaChjdG9yKTsKCiAgcmV0
dXJuIGN0b3I7Cn07CgovKioKICogTGlz
dCBvZiBsaWIuVGVzdE1hbmFnZXIuU3Vp
dGUgc3ViY2xhc3NlcywgaW4gdGhlIG9y
ZGVyIHRoZXkgd2VyZSBkZWZpbmVkLgog
Ki8KbGliLlRlc3RNYW5hZ2VyLlN1aXRl
LnN1YmNsYXNzZXMgPSBbXTsKCi8qKgog
KiBBZGQgYSB0ZXN0IHRvIGEgbGliLlRl
c3RNYW5hZ2VyLlN1aXRlLgogKgogKiBU
aGlzIG1ldGhvZCBpcyBjb3BpZWQgdG8g
bmV3IHN1YmNsYXNzZXMgd2hlbiB0aGV5
IGFyZSBjcmVhdGVkLgogKi8KbGliLlRl
c3RNYW5hZ2VyLlN1aXRlLmFkZFRlc3Qg
PSBmdW5jdGlvbih0ZXN0TmFtZSwgdGVz
dEZ1bmN0aW9uKSB7CiAgaWYgKHRlc3RO
YW1lIGluIHRoaXMudGVzdE1hcF8pCiAg
ICB0aHJvdyAnRHVwbGljYXRlIHRlc3Qg
bmFtZTogJyArIHRlc3ROYW1lOwoKICB2
YXIgdGVzdCA9IG5ldyBsaWIuVGVzdE1h
bmFnZXIuVGVzdCh0aGlzLCB0ZXN0TmFt
ZSwgdGVzdEZ1bmN0aW9uKTsKICB0aGlz
LnRlc3RNYXBfW3Rlc3ROYW1lXSA9IHRl
c3Q7CiAgdGhpcy50ZXN0TGlzdF8ucHVz
aCh0ZXN0KTsKfTsKCi8qKgogKiBEZWZp
bmVzIGEgZGlzYWJsZWQgdGVzdC4KICov
CmxpYi5UZXN0TWFuYWdlci5TdWl0ZS5k
aXNhYmxlVGVzdCA9IGZ1bmN0aW9uKHRl
c3ROYW1lLCB0ZXN0RnVuY3Rpb24pIHsK
ICBpZiAodGVzdE5hbWUgaW4gdGhpcy50
ZXN0TWFwXykKICAgIHRocm93ICdEdXBs
aWNhdGUgdGVzdCBuYW1lOiAnICsgdGVz
dE5hbWU7CgogIHZhciB0ZXN0ID0gbmV3
IGxpYi5UZXN0TWFuYWdlci5UZXN0KHRo
aXMsIHRlc3ROYW1lLCB0ZXN0RnVuY3Rp
b24pOwogIGNvbnNvbGUubG9nKCdEaXNh
YmxlZCB0ZXN0OiAnICsgdGVzdC5mdWxs
TmFtZSk7Cn07CgovKioKICogR2V0IGEg
bGliLlRlc3RNYW5hZ2VyLlRlc3QgaW5z
dGFuY2UgYnkgbmFtZS4KICoKICogVGhp
cyBtZXRob2QgaXMgY29waWVkIHRvIG5l
dyBzdWJjbGFzc2VzIHdoZW4gdGhleSBh
cmUgY3JlYXRlZC4KICoKICogQHBhcmFt
IHtzdHJpbmd9IHRlc3ROYW1lIFRoZSBu
YW1lIG9mIHRoZSBkZXNpcmVkIHRlc3Qu
CiAqIEByZXR1cm4ge2xpYi5UZXN0TWFu
YWdlci5UZXN0fSBUaGUgcmVxdWVzdGVk
IHRlc3QsIG9yIHVuZGVmaW5lZCBpZiBp
dCB3YXMgbm90CiAqICAgICBmb3VuZC4K
ICovCmxpYi5UZXN0TWFuYWdlci5TdWl0
ZS5nZXRUZXN0ID0gZnVuY3Rpb24odGVz
dE5hbWUpIHsKICByZXR1cm4gdGhpcy50
ZXN0TWFwX1t0ZXN0TmFtZV07Cn07Cgov
KioKICogR2V0IGFuIGFycmF5IG9mIGxp
Yi5UZXN0TWFuYWdlci5UZXN0cyBhc3Nv
Y2lhdGVkIHdpdGggdGhpcyBTdWl0ZS4K
ICoKICogVGhpcyBtZXRob2QgaXMgY29w
aWVkIHRvIG5ldyBzdWJjbGFzc2VzIHdo
ZW4gdGhleSBhcmUgY3JlYXRlZC4KICov
CmxpYi5UZXN0TWFuYWdlci5TdWl0ZS5n
ZXRUZXN0TGlzdCA9IGZ1bmN0aW9uKCkg
ewogIHJldHVybiB0aGlzLnRlc3RMaXN0
XzsKfTsKCi8qKgogKiBTZXQgcHJvcGVy
dGllcyBvbiBhIHRlc3Qgc3VpdGUgaW5z
dGFuY2UsIHB1bGxpbmcgdGhlIHByb3Bl
cnR5IHZhbHVlIGZyb20KICogdGhlIGNv
bnRleHQgaWYgaXQgZXhpc3RzIGFuZCBm
cm9tIHRoZSBkZWZhdWx0cyBkaWN0aW9u
YXJ5IGlmIG5vdC4KICoKICogVGhpcyBp
cyBpbnRlbmRlZCB0byBiZSB1c2VkIGlu
IHlvdXIgdGVzdCBzdWl0ZSdzIHNldHVw
KCkgbWV0aG9kIHRvCiAqIGRlZmluZSBw
YXJhbWV0ZXJzIGZvciB0aGUgdGVzdCBz
dWl0ZSB3aGljaCBtYXkgYmUgb3ZlcnJp
ZGRlbiB0aHJvdWdoIHRoZQogKiBjb250
ZXh0IG9iamVjdC4gIEZvciBleGFtcGxl
Li4uCiAqCiAqICAgTXlTdWl0ZS5wcm90
b3R5cGUuc2V0dXAgPSBmdW5jdGlvbihj
eCkgewogKiAgICAgdGhpcy5zZXREZWZh
dWx0cyhjeCwge3NpemU6IDEwfSk7CiAq
ICAgfTsKICoKICogSWYgdGhlIGNvbnRl
eHQgb2JqZWN0IGhhcyBhICdzaXplJyBw
cm9wZXJ0eSB0aGVuIHRoaXMuc2l6ZSB3
aWxsIGJlIHNldCB0bwogKiB0aGUgdmFs
dWUgb2YgY3guc2l6ZSwgb3RoZXJ3aXNl
IHRoaXMuc2l6ZSB3aWxsIGdldCBhIGRl
ZmF1bHQgdmFsdWUgb2YgMTAuCiAqCiAq
IEBwYXJhbSB7T2JqZWN0fSBjeCBUaGUg
Y29udGV4dCBvYmplY3QgZm9yIGEgdGVz
dCBydW4uCiAqIEBwYXJhbSB7T2JqZWN0
fSBkZWZhdWx0cyBBbiBvYmplY3QgY29u
dGFpbmluZyBuYW1lL3ZhbHVlIHBhaXJz
IHRvIHNldCBvbgogKiAgICAgdGhpcyB0
ZXN0IHN1aXRlIGluc3RhbmNlLiAgVGhl
IHZhbHVlIGxpc3RlZCBoZXJlIHdpbGwg
YmUgdXNlZCBpZiB0aGUKICogICAgIG5h
bWUgaXMgbm90IGRlZmluZWQgb24gdGhl
IGNvbnRleHQgb2JqZWN0LgogKi8KbGli
LlRlc3RNYW5hZ2VyLlN1aXRlLnByb3Rv
dHlwZS5zZXREZWZhdWx0cyA9IGZ1bmN0
aW9uKGN4LCBkZWZhdWx0cykgewogIGZv
ciAodmFyIGsgaW4gZGVmYXVsdHMpIHsK
ICAgIHRoaXNba10gPSAoayBpbiBjeCkg
PyBjeFtrXSA6IGRlZmF1bHRzW2tdOwog
IH0KfTsKCi8qKgogKiBTdWJjbGFzc2Fi
bGUgbWV0aG9kIGNhbGxlZCB0byBzZXQg
dXAgdGhlIHRlc3Qgc3VpdGUuCiAqCiAq
IFRoZSBkZWZhdWx0IGltcGxlbWVudGF0
aW9uIG9mIHRoaXMgbWV0aG9kIGlzIGEg
bm8tb3AuICBJZiB5b3VyIHRlc3Qgc3Vp
dGUKICogcmVxdWlyZXMgc29tZSBraW5k
IG9mIHN1aXRlLXdpZGUgc2V0dXAsIHRo
aXMgaXMgdGhlIHBsYWNlIHRvIGRvIGl0
LgogKgogKiBJdCdzIGZpbmUgdG8gc3Rv
cmUgc3RhdGUgb24gdGhlIHRlc3Qgc3Vp
dGUgaW5zdGFuY2UsIHRoYXQgc3RhdGUg
d2lsbCBiZQogKiBhY2Nlc3NpYmxlIHRv
IGFsbCB0ZXN0cyBpbiB0aGUgc3VpdGUu
ICBJZiBhbnkgdGVzdCBjYXNlIGZhaWxz
LCB0aGUgZW50aXJlCiAqIHRlc3Qgc3Vp
dGUgb2JqZWN0IHdpbGwgYmUgZGlzY2Fy
ZGVkIGFuZCBhIG5ldyBvbmUgd2lsbCBi
ZSBjcmVhdGVkIGZvcgogKiB0aGUgcmVt
YWluaW5nIHRlc3RzLgogKgogKiBBbnkg
c2lkZSBlZmZlY3RzIG91dHNpZGUgb2Yg
dGhpcyB0ZXN0IHN1aXRlIGluc3RhbmNl
IG11c3QgYmUgaWRlbXBvdGVudC4KICog
Rm9yIGV4YW1wbGUsIGlmIHlvdSdyZSBh
ZGRpbmcgRE9NIG5vZGVzIHRvIGEgZG9j
dW1lbnQsIG1ha2Ugc3VyZSB0byBmaXJz
dAogKiB0ZXN0IHRoYXQgdGhleSdyZSBu
b3QgYWxyZWFkeSB0aGVyZS4gIElmIHRo
ZXkgYXJlLCByZW1vdmUgdGhlbSByYXRo
ZXIgdGhhbgogKiByZXVzZSB0aGVtLiAg
WW91IHNob3VsZCBub3QgY291bnQgb24g
dGhlaXIgc3RhdGUsIHNpbmNlIHRoZXkg
d2VyZSBwcm9iYWJseQogKiBsZWZ0IGJl
aGluZCBieSBhIGZhaWxlZCB0ZXN0Y2Fz
ZS4KICoKICogQW55IGV4Y2VwdGlvbiBo
ZXJlIHdpbGwgYWJvcnQgdGhlIHJlbWFp
bmRlciBvZiB0aGUgdGVzdCBydW4uCiAq
CiAqIEBwYXJhbSB7T2JqZWN0fSBjeCBU
aGUgY29udGV4dCBvYmplY3QgZm9yIGEg
dGVzdCBydW4uCiAqLwpsaWIuVGVzdE1h
bmFnZXIuU3VpdGUucHJvdG90eXBlLnNl
dHVwID0gZnVuY3Rpb24oY3gpIHt9OwoK
LyoqCiAqIFN1YmNsYXNzYWJsZSBtZXRo
b2QgY2FsbGVkIHRvIGRvIHByZS10ZXN0
IHNldCB1cC4KICoKICogVGhlIGRlZmF1
bHQgaW1wbGVtZW50YXRpb24gb2YgdGhp
cyBtZXRob2QgaXMgYSBuby1vcC4gIElm
IHlvdXIgdGVzdCBzdWl0ZQogKiByZXF1
aXJlcyBzb21lIGtpbmQgb2YgcHJlLXRl
c3Qgc2V0dXAsIHRoaXMgaXMgdGhlIHBs
YWNlIHRvIGRvIGl0LgogKgogKiBUaGlz
IGNhbiBiZSB1c2VkIHRvIGF2b2lkIGEg
YnVuY2ggb2YgYm9pbGVycGxhdGUgc2V0
dXAvdGVhcmRvd24gY29kZSBpbgogKiB0
aGlzIHN1aXRlJ3MgdGVzdGNhc2VzLgog
KgogKiBBbnkgZXhjZXB0aW9uIGhlcmUg
d2lsbCBhYm9ydCB0aGUgcmVtYWluZGVy
IG9mIHRoZSB0ZXN0IHJ1bi4KICoKICog
QHBhcmFtIHtsaWIuVGVzdE1hbmFnZXIu
UmVzdWx0fSByZXN1bHQgVGhlIHJlc3Vs
dCBvYmplY3QgZm9yIHRoZSB1cGNvbWlu
ZwogKiAgICAgdGVzdC4KICogQHBhcmFt
IHtPYmplY3R9IGN4IFRoZSBjb250ZXh0
IG9iamVjdCBmb3IgYSB0ZXN0IHJ1bi4K
ICovCmxpYi5UZXN0TWFuYWdlci5TdWl0
ZS5wcm90b3R5cGUucHJlYW1ibGUgPSBm
dW5jdGlvbihyZXN1bHQsIGN4KSB7fTsK
Ci8qKgogKiBTdWJjbGFzc2FibGUgbWV0
aG9kIGNhbGxlZCB0byBkbyBwb3N0LXRl
c3QgdGVhci1kb3duLgogKgogKiBUaGUg
ZGVmYXVsdCBpbXBsZW1lbnRhdGlvbiBv
ZiB0aGlzIG1ldGhvZCBpcyBhIG5vLW9w
LiAgSWYgeW91ciB0ZXN0IHN1aXRlCiAq
IHJlcXVpcmVzIHNvbWUga2luZCBvZiBw
cmUtdGVzdCBzZXR1cCwgdGhpcyBpcyB0
aGUgcGxhY2UgdG8gZG8gaXQuCiAqCiAq
IFRoaXMgY2FuIGJlIHVzZWQgdG8gYXZv
aWQgYSBidW5jaCBvZiBib2lsZXJwbGF0
ZSBzZXR1cC90ZWFyZG93biBjb2RlIGlu
CiAqIHRoaXMgc3VpdGUncyB0ZXN0Y2Fz
ZXMuCiAqCiAqIEFueSBleGNlcHRpb24g
aGVyZSB3aWxsIGFib3J0IHRoZSByZW1h
aW5kZXIgb2YgdGhlIHRlc3QgcnVuLgog
KgogKiBAcGFyYW0ge2xpYi5UZXN0TWFu
YWdlci5SZXN1bHR9IHJlc3VsdCBUaGUg
cmVzdWx0IG9iamVjdCBmb3IgdGhlIHVw
Y29taW5nCiAqICAgICB0ZXN0LgogKiBA
cGFyYW0ge09iamVjdH0gY3ggVGhlIGNv
bnRleHQgb2JqZWN0IGZvciBhIHRlc3Qg
cnVuLgogKi8KbGliLlRlc3RNYW5hZ2Vy
LlN1aXRlLnByb3RvdHlwZS5wb3N0YW1i
bGUgPSBmdW5jdGlvbihyZXN1bHQsIGN4
KSB7fTsKCi8qKgogKiBPYmplY3QgcmVw
cmVzZW50aW5nIGEgc2luZ2xlIHRlc3Qg
aW4gYSB0ZXN0IHN1aXRlLgogKgogKiBU
aGVzZSBhcmUgY3JlYXRlZCBhcyBwYXJ0
IG9mIHRoZSBsaWIuVGVzdE1hbmFnZXIu
U3VpdGUuYWRkVGVzdCgpIG1ldGhvZC4K
ICogWW91IHNob3VsZCBuZXZlciBoYXZl
IHRvIGNvbnN0cnVjdCBvbmUgYnkgaGFu
ZC4KICoKICogQHBhcmFtIHtsaWIuVGVz
dE1hbmFnZXIuU3VpdGV9IHN1aXRlQ2xh
c3MgVGhlIHRlc3Qgc3VpdGUgY2xhc3Mg
Y29udGFpbmluZwogKiAgICAgdGhpcyB0
ZXN0LgogKiBAcGFyYW0ge3N0cmluZ30g
dGVzdE5hbWUgVGhlIGxvY2FsIG5hbWUg
b2YgdGhpcyB0ZXN0IGNhc2UsIG5vdCBp
bmNsdWRpbmcgdGhlCiAqICAgICB0ZXN0
IHN1aXRlIG5hbWUuCiAqIEBwYXJhbSB7
ZnVuY3Rpb24obGliLlRlc3RNYW5hZ2Vy
LlJlc3VsdCwgT2JqZWN0KX0gdGVzdEZ1
bmN0aW9uIFRoZSBmdW5jdGlvbgogKiAg
ICAgdG8gaW52b2tlIGZvciB0aGlzIHRl
c3QgY2FzZS4gIFRoaXMgaXMgcGFzc2Vk
IGEgUmVzdWx0IGluc3RhbmNlIGFuZCB0
aGUKICogICAgIGNvbnRleHQgb2JqZWN0
IGFzc29jaWF0ZWQgd2l0aCB0aGUgdGVz
dCBydW4uCiAqCiAqLwpsaWIuVGVzdE1h
bmFnZXIuVGVzdCA9IGZ1bmN0aW9uKHN1
aXRlQ2xhc3MsIHRlc3ROYW1lLCB0ZXN0
RnVuY3Rpb24pIHsKICAvKioKICAgKiBU
aGUgdGVzdCBzdWl0ZSBjbGFzcyBjb250
YWluaW5nIHRoaXMgZnVuY3Rpb24uCiAg
ICovCiAgdGhpcy5zdWl0ZUNsYXNzID0g
c3VpdGVDbGFzczsKCiAgLyoqCiAgICog
VGhlIGxvY2FsIG5hbWUgb2YgdGhpcyB0
ZXN0LCBub3QgaW5jbHVkaW5nIHRoZSB0
ZXN0IHN1aXRlIG5hbWUuCiAgICovCiAg
dGhpcy50ZXN0TmFtZSA9IHRlc3ROYW1l
OwoKICAvKioKICAgKiBUaGUgZ2xvYmFs
IG5hbWUgb2YgdGhpcyB0ZXN0LCBpbmNs
dWRpbmcgdGhlIHRlc3Qgc3VpdGUgbmFt
ZS4KICAgKi8KICB0aGlzLmZ1bGxOYW1l
ID0gc3VpdGVDbGFzcy5zdWl0ZU5hbWUg
KyAnWycgKyB0ZXN0TmFtZSArICddJzsK
CiAgLy8gVGhlIGZ1bmN0aW9uIHRvIGNh
bGwgZm9yIHRoaXMgdGVzdC4KICB0aGlz
LnRlc3RGdW5jdGlvbl8gPSB0ZXN0RnVu
Y3Rpb247Cn07CgovKioKICogRXhlY3V0
ZSB0aGlzIHRlc3QuCiAqCiAqIFRoaXMg
aXMgY2FsbGVkIGJ5IGEgbGliLlRlc3RN
YW5hZ2VyLlJlc3VsdCBpbnN0YW5jZSwg
YXMgcGFydCBvZiBhCiAqIGxpYi5UZXN0
TWFuYWdlci5UZXN0UnVuLiAgWW91IHNo
b3VsZCBub3QgY2FsbCBpdCBieSBoYW5k
LgogKgogKiBAcGFyYW0ge2xpYi5UZXN0
TWFuYWdlci5SZXN1bHR9IHJlc3VsdCBU
aGUgcmVzdWx0IG9iamVjdCBmb3IgdGhl
IHRlc3QuCiAqLwpsaWIuVGVzdE1hbmFn
ZXIuVGVzdC5wcm90b3R5cGUucnVuID0g
ZnVuY3Rpb24ocmVzdWx0KSB7CiAgdHJ5
IHsKICAgIC8vIFRlc3RzIGFyZSBhcHBs
aWVkIHRvIHRoZSBwYXJlbnQgbGliLlRl
c3RNYW5hZ2VyLlN1aXRlIHN1YmNsYXNz
LgogICAgdGhpcy50ZXN0RnVuY3Rpb25f
LmFwcGx5KHJlc3VsdC5zdWl0ZSwKICAg
ICAgICAgICAgICAgICAgICAgICAgICAg
ICBbcmVzdWx0LCByZXN1bHQudGVzdFJ1
bi5jeF0pOwogIH0gY2F0Y2ggKGV4KSB7
CiAgICBpZiAoZXggaW5zdGFuY2VvZiBs
aWIuVGVzdE1hbmFnZXIuUmVzdWx0LlRl
c3RDb21wbGV0ZSkKICAgICAgcmV0dXJu
OwoKICAgIHJlc3VsdC5wcmludGxuKCdU
ZXN0IHJhaXNlZCBhbiBleGNlcHRpb246
ICcgKyBleCk7CgogICAgaWYgKGV4LnN0
YWNrKSB7CiAgICAgIGlmIChleC5zdGFj
ayBpbnN0YW5jZW9mIEFycmF5KSB7CiAg
ICAgICAgcmVzdWx0LnByaW50bG4oZXgu
c3RhY2suam9pbignXG4nKSk7CiAgICAg
IH0gZWxzZSB7CiAgICAgICAgcmVzdWx0
LnByaW50bG4oZXguc3RhY2spOwogICAg
ICB9CiAgICB9CgogICAgcmVzdWx0LmNv
bXBsZXRlVGVzdF8ocmVzdWx0LkZBSUxF
RCwgZmFsc2UpOwogIH0KfTsKCi8qKgog
KiBVc2VkIHRvIGNob29zZSBhIHNldCBv
ZiB0ZXN0cyBhbmQgcnVuIHRoZW0uCiAq
CiAqIEl0J3Mgc2xpZ2h0bHkgbW9yZSBj
b252ZW5pZW50IHRvIGNvbnN0cnVjdCBv
bmUgb2YgdGhlc2UgZnJvbQogKiBsaWIu
VGVzdE1hbmFnZXIucHJvdG90eXBlLmNy
ZWF0ZVRlc3RSdW4oKS4KICoKICogQHBh
cmFtIHtsaWIuVGVzdE1hbmFnZXJ9IHRl
c3RNYW5hZ2VyIFRoZSB0ZXN0TWFuYWdl
ciBhc3NvY2lhdGVkIHdpdGggdGhpcwog
KiAgICAgVGVzdFJ1bi4KICogQHBhcmFt
IHtPYmplY3R9IGN4IEEgY29udGV4dCB0
byBiZSBwYXNzZWQgaW50byB0aGUgdGVz
dHMuICBUaGlzIGNhbiBiZSB1c2VkCiAq
ICAgICB0byBzZXQgcGFyYW1ldGVycyBm
b3IgdGhlIHRlc3Qgc3VpdGUgb3IgaW5k
aXZpZHVhbCB0ZXN0IGNhc2VzLgogKi8K
bGliLlRlc3RNYW5hZ2VyLlRlc3RSdW4g
PSBmdW5jdGlvbih0ZXN0TWFuYWdlciwg
Y3gpIHsKICAvKioKICAgKiBUaGUgYXNz
b2NpYXRlZCBsaWIuVGVzdE1hbmFnZXIg
aW5zdGFuY2UuCiAgICovCiAgdGhpcy50
ZXN0TWFuYWdlciA9IHRlc3RNYW5hZ2Vy
OwoKICAvKioKICAgKiBTaG9ydGN1dCB0
byB0aGUgbGliLlRlc3RNYW5hZ2VyJ3Mg
bG9nLgogICAqLwogIHRoaXMubG9nID0g
dGVzdE1hbmFnZXIubG9nOwoKICAvKioK
ICAgKiBUaGUgdGVzdCBydW4gY29udGV4
dC4gIEl0J3MgZW50aXJlbHkgdXAgdG8g
dGhlIHRlc3Qgc3VpdGUgYW5kIHRlc3Qg
Y2FzZXMKICAgKiBob3cgdGhpcyBpcyB1
c2VkLiAgSXQgaXMgb3BhcXVlIHRvIGxp
Yi5UZXN0TWFuYWdlci4qIGNsYXNzZXMu
CiAgICovCiAgdGhpcy5jeCA9IGN4IHx8
IHt9OwoKICAvKioKICAgKiBUaGUgbGlz
dCBvZiB0ZXN0IGNhc2VzIHRoYXQgZW5j
b3VudGVyZWQgZmFpbHVyZXMuCiAgICov
CiAgdGhpcy5mYWlsdXJlcyA9IFtdOwoK
ICAvKioKICAgKiBUaGUgbGlzdCBvZiB0
ZXN0IGNhc2VzIHRoYXQgcGFzc2VkLgog
ICAqLwogIHRoaXMucGFzc2VzID0gW107
CgogIC8qKgogICAqIFRoZSB0aW1lIHRo
ZSB0ZXN0IHJ1biBzdGFydGVkLCBvciBu
dWxsIGlmIGl0IGhhc24ndCBiZWVuIHN0
YXJ0ZWQgeWV0LgogICAqLwogIHRoaXMu
c3RhcnREYXRlID0gbnVsbDsKCiAgLyoq
CiAgICogVGhlIHRpbWUgaW4gbWlsbGlz
ZWNvbmRzIHRoYXQgdGhlIHRlc3QgcnVu
IHRvb2sgdG8gY29tcGxldGUsIG9yIG51
bGwgaWYKICAgKiBpdCBoYXNuJ3QgY29t
cGxldGVkIHlldC4KICAgKi8KICB0aGlz
LmR1cmF0aW9uID0gbnVsbDsKCiAgLyoq
CiAgICogVGhlIG1vc3QgcmVjZW50IHJl
c3VsdCBvYmplY3QsIG9yIG51bGwgaWYg
dGhlIHRlc3QgcnVuIGhhc24ndCBzdGFy
dGVkCiAgICogeWV0LiAgSW4gb3JkZXIg
dG8gZGV0ZWN0IGxhdGUgZmFpbHVyZXMs
IHRoaXMgaXMgbm90IGNsZWFyZWQgd2hl
biB0aGUgdGVzdAogICAqIGNvbXBsZXRl
cy4KICAgKi8KICB0aGlzLmN1cnJlbnRS
ZXN1bHQgPSBudWxsOwoKICAvKioKICAg
KiBOdW1iZXIgb2YgbWF4aW11bSBmYWls
dXJlcy4gIFRoZSB0ZXN0IHJ1biB3aWxs
IHN0b3Agd2hlbiB0aGlzIG51bWJlciBp
cwogICAqIHJlYWNoZWQuICBJZiAwIG9y
IG9tbWl0dGVkLCB0aGUgZW50aXJlIHNl
dCBvZiBzZWxlY3RlZCB0ZXN0cyBpcyBy
dW4sIGV2ZW4KICAgKiBpZiBzb21lIGZh
aWwuCiAgICovCiAgdGhpcy5tYXhGYWls
dXJlcyA9IDA7CgogIC8qKgogICAqIFRy
dWUgaWYgdGhpcyB0ZXN0IHJ1biBlbmRl
ZCBlYXJseSBiZWNhdXNlIG9mIGFuIHVu
ZXhwZWN0ZWQgY29uZGl0aW9uLgogICAq
LwogIHRoaXMucGFuaWMgPSBmYWxzZTsK
CiAgLy8gTGlzdCBvZiBwZW5kaW5nIHRl
c3QgY2FzZXMuCiAgdGhpcy50ZXN0UXVl
dWVfID0gW107Cgp9OwoKLyoqCiAqIFRo
aXMgdmFsdWUgY2FuIGJlIHBhc3NlZCB0
byBzZWxlY3QoKSB0byBpbmRpY2F0ZSB0
aGF0IGFsbCB0ZXN0cyBzaG91bGQKICog
YmUgc2VsZWN0ZWQuCiAqLwpsaWIuVGVz
dE1hbmFnZXIuVGVzdFJ1bi5wcm90b3R5
cGUuQUxMX1RFU1RTID0gbmV3IFN0cmlu
ZygnPGFsbC10ZXN0cz4nKTsKCi8qKgog
KiBBZGQgYSBzaW5nbGUgdGVzdCB0byB0
aGUgdGVzdCBydW4uCiAqLwpsaWIuVGVz
dE1hbmFnZXIuVGVzdFJ1bi5wcm90b3R5
cGUuc2VsZWN0VGVzdCA9IGZ1bmN0aW9u
KHRlc3QpIHsKICB0aGlzLnRlc3RRdWV1
ZV8ucHVzaCh0ZXN0KTsKfTsKCmxpYi5U
ZXN0TWFuYWdlci5UZXN0UnVuLnByb3Rv
dHlwZS5zZWxlY3RTdWl0ZSA9IGZ1bmN0
aW9uKAogICAgc3VpdGVDbGFzcywgb3B0
X3BhdHRlcm4pIHsKICB2YXIgcGF0dGVy
biA9IG9wdF9wYXR0ZXJuIHx8IHRoaXMu
QUxMX1RFU1RTOwogIHZhciBzZWxlY3RD
b3VudCA9IDA7CiAgdmFyIHRlc3RMaXN0
ID0gc3VpdGVDbGFzcy5nZXRUZXN0TGlz
dCgpOwoKICBmb3IgKHZhciBqID0gMDsg
aiA8IHRlc3RMaXN0Lmxlbmd0aDsgaisr
KSB7CiAgICB2YXIgdGVzdCA9IHRlc3RM
aXN0W2pdOwogICAgLy8gTm90ZSB0aGF0
IHdlJ3JlIHVzaW5nICIhPT0iIHJhdGhl
ciB0aGFuICIhPSIgc28gdGhhdCB3ZSdy
ZSBtYXRjaGluZwogICAgLy8gdGhlIEFM
TF9URVNUUyBTdHJpbmcgb2JqZWN0LCBy
YXRoZXIgdGhhbiB0aGUgY29udGVudHMg
b2YgdGhlIHN0cmluZy4KICAgIGlmIChw
YXR0ZXJuICE9PSB0aGlzLkFMTF9URVNU
UykgewogICAgICBpZiAocGF0dGVybiBp
bnN0YW5jZW9mIFJlZ0V4cCkgewogICAg
ICAgIGlmICghcGF0dGVybi50ZXN0KHRl
c3QudGVzdE5hbWUpKQogICAgICAgICAg
Y29udGludWU7CiAgICAgIH0gZWxzZSBp
ZiAodGVzdC50ZXN0TmFtZSAhPSBwYXR0
ZXJuKSB7CiAgICAgICAgY29udGludWU7
CiAgICAgIH0KICAgIH0KCiAgICB0aGlz
LnNlbGVjdFRlc3QodGVzdCk7CiAgICBz
ZWxlY3RDb3VudCsrOwogIH0KCiAgcmV0
dXJuIHNlbGVjdENvdW50Owp9OwoKLyoq
CiAqIFNlbGVjdHMgb25lIG9yIG1vcmUg
dGVzdHMgdG8gZ2F0aGVyIHJlc3VsdHMg
Zm9yLgogKgogKiBTZWxlY3RpbmcgdGhl
IHNhbWUgdGVzdCBtb3JlIHRoYW4gb25j
ZSBpcyBhbGxvd2VkLgogKgogKiBAcGFy
YW0ge3N0cmluZ3xSZWdFeHB9IHBhdHRl
cm4gUGF0dGVybiB1c2VkIHRvIHNlbGVj
dCB0ZXN0cy4KICogICAgIElmIFRlc3RS
dW4ucHJvdG90eXBlLkFMTF9URVNUUywg
YWxsIHRlc3RzIGFyZSBzZWxlY3RlZC4K
ICogICAgIElmIGEgc3RyaW5nLCBvbmx5
IHRoZSB0ZXN0IHRoYXQgZXhhY3RseSBt
YXRjaGVzIGlzIHNlbGVjdGVkLgogKiAg
ICAgSWYgYSBSZWdFeHAsIG9ubHkgdGVz
dHMgbWF0Y2hpbmcgdGhlIFJlZ0V4cCBh
cmUgYWRkZWQuCiAqCiAqIEByZXR1cm4g
e2ludH0gVGhlIG51bWJlciBvZiBhZGRp
dGlvbmFsIHRlc3RzIHRoYXQgaGF2ZSBi
ZWVuIHNlbGVjdGVkIGludG8KICogICAg
IHRoaXMgVGVzdFJ1bi4KICovCmxpYi5U
ZXN0TWFuYWdlci5UZXN0UnVuLnByb3Rv
dHlwZS5zZWxlY3RQYXR0ZXJuID0gZnVu
Y3Rpb24ocGF0dGVybikgewogIHZhciBz
ZWxlY3RDb3VudCA9IDA7CgogIGZvciAo
dmFyIGkgPSAwOyBpIDwgbGliLlRlc3RN
YW5hZ2VyLlN1aXRlLnN1YmNsYXNzZXMu
bGVuZ3RoOyBpKyspIHsKICAgIHNlbGVj
dENvdW50ICs9IHRoaXMuc2VsZWN0U3Vp
dGUobGliLlRlc3RNYW5hZ2VyLlN1aXRl
LnN1YmNsYXNzZXNbaV0sCiAgICAgICAg
ICAgICAgICAgICAgICAgICAgICAgICAg
ICAgIHBhdHRlcm4pOwogIH0KCiAgaWYg
KCFzZWxlY3RDb3VudCkgewogICAgdGhp
cy5sb2cucHJpbnRsbignTm8gdGVzdHMg
bWF0Y2hlZCBzZWxlY3Rpb24gY3JpdGVy
aWE6ICcgKyBwYXR0ZXJuKTsKICB9Cgog
IHJldHVybiBzZWxlY3RDb3VudDsKfTsK
Ci8qKgogKiBIb29rZWQgdXAgdG8gd2lu
ZG93Lm9uZXJyb3IgZHVyaW5nIGEgdGVz
dCBydW4gaW4gb3JkZXIgdG8gY2F0Y2gg
ZXhjZXB0aW9ucwogKiB0aGF0IHdvdWxk
IG90aGVyd2lzZSBnbyB1bmNhdWdodC4K
ICovCmxpYi5UZXN0TWFuYWdlci5UZXN0
UnVuLnByb3RvdHlwZS5vblVuY2F1Z2h0
RXhjZXB0aW9uXyA9IGZ1bmN0aW9uKAog
ICAgbWVzc2FnZSwgZmlsZSwgbGluZSkg
ewoKICBpZiAobWVzc2FnZS5pbmRleE9m
KCdVbmNhdWdodCBsaWIuVGVzdE1hbmFn
ZXIuUmVzdWx0LlRlc3RDb21wbGV0ZScp
ID09IDAgfHwKICAgICAgbWVzc2FnZS5p
bmRleE9mKCdzdGF0dXM6IHBhc3NlZCcp
ICE9IC0xKSB7CiAgICAvLyBUaGlzIGlz
IGEgcmVzdWx0LnBhc3MoKSBvciByZXN1
bHQuZmFpbCgpIGNhbGwgZnJvbSBhIGNh
bGxiYWNrLiAgV2UncmUKICAgIC8vIGFs
cmVhZHkgZ29pbmcgdG8gZGVhbCB3aXRo
IGl0IGFzIHBhcnQgb2YgdGhlIGNvbXBs
ZXRlVGVzdF8oKSBjYWxsCiAgICAvLyB0
aGF0IHJhaXNlZCBpdC4gIFdlIGNhbiBz
YWZlbHkgc3F1ZWxjaCB0aGlzIGVycm9y
IG1lc3NhZ2UuCiAgICByZXR1cm4gdHJ1
ZTsKICB9CgogIGlmICghdGhpcy5jdXJy
ZW50UmVzdWx0KQogICAgcmV0dXJuOwoK
ICBpZiAobWVzc2FnZSA9PSAnVW5jYXVn
aHQgJyArIHRoaXMuY3VycmVudFJlc3Vs
dC5leHBlY3RlZEVycm9yTWVzc2FnZV8p
IHsKICAgIC8vIFRlc3QgY2FzZXMgbWF5
IG5lZWQgdG8gcmFpc2UgYW4gdW5oYW5k
bGVkIGV4Y2VwdGlvbiBhcyBwYXJ0IG9m
IHRoZSB0ZXN0LgogICAgcmV0dXJuOwog
IH0KCiAgdmFyIHdoZW4gPSAnZHVyaW5n
JzsKCiAgaWYgKHRoaXMuY3VycmVudFJl
c3VsdC5zdGF0dXMgIT0gdGhpcy5jdXJy
ZW50UmVzdWx0LlBFTkRJTkcpCiAgICB3
aGVuID0gJ2FmdGVyJzsKCiAgdGhpcy5s
b2cucHJpbnRsbignVW5jYXVnaHQgZXhj
ZXB0aW9uICcgKyB3aGVuICsgJyB0ZXN0
IGNhc2U6ICcgKwogICAgICAgICAgICAg
ICAgICAgdGhpcy5jdXJyZW50UmVzdWx0
LnRlc3QuZnVsbE5hbWUpOwogIHRoaXMu
bG9nLnByaW50bG4obWVzc2FnZSArICcs
ICcgKyBmaWxlICsgJzonICsgbGluZSk7
CgogIHRoaXMuY3VycmVudFJlc3VsdC5j
b21wbGV0ZVRlc3RfKHRoaXMuY3VycmVu
dFJlc3VsdC5GQUlMRUQsIGZhbHNlKTsK
CiAgcmV0dXJuIGZhbHNlOwp9OwoKLyoq
CiAqIENhbGxlZCB0byB3aGVuIHRoaXMg
dGVzdCBydW4gaGFzIGNvbXBsZXRlZC4K
ICoKICogVGhpcyBtZXRob2QgdHlwaWNh
bGx5IHJlLXJ1bnMgaXRzZWxmIGFzeW5j
aHJvbm91c2x5LCBpbiBvcmRlciB0byBs
ZXQgdGhlCiAqIERPTSBzdGFiaWxpemUg
YW5kIHNob3J0LXRlcm0gdGltZW91dHMg
dG8gY29tcGxldGUgYmVmb3JlIGRlY2xh
cmluZyB0aGUKICogdGVzdCBydW4gY29t
cGxldGUuCiAqCiAqIEBwYXJhbSB7Ym9v
bGVhbn0gb3B0X3NraXBUaW1lb3V0IElm
IHRydWUsIHRoZSB0aW1lb3V0IGlzIHNr
aXBwZWQgYW5kIHRoZQogKiAgICAgdGVz
dCBydW4gaXMgY29tcGxldGVkIGltbWVk
aWF0ZWx5LiAgVGhpcyBzaG91bGQgb25s
eSBiZSB1c2VkIGZyb20gd2l0aGluCiAq
ICAgICB0aGlzIGZ1bmN0aW9uLgogKi8K
bGliLlRlc3RNYW5hZ2VyLlRlc3RSdW4u
cHJvdG90eXBlLm9uVGVzdFJ1bkNvbXBs
ZXRlXyA9IGZ1bmN0aW9uKAogICAgb3B0
X3NraXBUaW1lb3V0KSB7CiAgaWYgKCFv
cHRfc2tpcFRpbWVvdXQpIHsKICAgIC8v
IFRoZSBmaW5hbCB0ZXN0IG1heSBoYXZl
IGxlZnQgYSBsaW5nZXJpbmcgc2V0VGlt
ZW91dCguLi4sIDApLCBvciBtYXliZQog
ICAgLy8gcG9rZWQgYXQgdGhlIERPTSBp
biBhIHdheSB0aGF0IHdpbGwgdHJpZ2dl
ciBhIGV2ZW50IHRvIGZpcmUgYXQgdGhl
IGVuZAogICAgLy8gb2YgdGhpcyBzdGFj
aywgc28gd2UgZ2l2ZSB0aGluZ3MgYSBj
aGFuY2UgdG8gc2V0dGxlIGRvd24gYmVm
b3JlIG91cgogICAgLy8gZmluYWwgY2xl
YW51cC4uLgogICAgc2V0VGltZW91dCh0
aGlzLm9uVGVzdFJ1bkNvbXBsZXRlXy5i
aW5kKHRoaXMpLCAwLCB0cnVlKTsKICAg
IHJldHVybjsKICB9CgogIHRoaXMuZHVy
YXRpb24gPSAobmV3IERhdGUoKSkgLSB0
aGlzLnN0YXJ0RGF0ZTsKCiAgdGhpcy5s
b2cucG9wUHJlZml4KCk7CiAgdGhpcy5s
b2cucHJpbnRsbignfSAnICsgdGhpcy5w
YXNzZXMubGVuZ3RoICsgJyBwYXNzZWQs
ICcgKwogICAgICAgICAgICAgICAgICAg
dGhpcy5mYWlsdXJlcy5sZW5ndGggKyAn
IGZhaWxlZCwgJyAgKwogICAgICAgICAg
ICAgICAgICAgdGhpcy5tc1RvU2Vjb25k
c18odGhpcy5kdXJhdGlvbikpOwogIHRo
aXMubG9nLnByaW50bG4oJycpOwoKICB0
aGlzLnN1bW1hcml6ZSgpOwoKICB3aW5k
b3cub25lcnJvciA9IG51bGw7CgogIHRo
aXMudGVzdE1hbmFnZXIub25UZXN0UnVu
Q29tcGxldGUodGhpcyk7Cn07CgovKioK
ICogQ2FsbGVkIGJ5IHRoZSBsaWIuVGVz
dE1hbmFnZXIuUmVzdWx0IG9iamVjdCB3
aGVuIGEgdGVzdCBjb21wbGV0ZXMuCiAq
CiAqIEBwYXJhbSB7bGliLlRlc3RNYW5h
Z2VyLlJlc3VsdH0gcmVzdWx0IFRoZSBy
ZXN1bHQgb2JqZWN0IHdoaWNoIGhhcyBq
dXN0CiAqICAgICBjb21wbGV0ZWQuCiAq
LwpsaWIuVGVzdE1hbmFnZXIuVGVzdFJ1
bi5wcm90b3R5cGUub25SZXN1bHRDb21w
bGV0ZSA9IGZ1bmN0aW9uKHJlc3VsdCkg
ewogIHRyeSB7CiAgICByZXN1bHQuc3Vp
dGUucG9zdGFtYmxlKCk7CiAgfSBjYXRj
aCAoZXgpIHsKICAgIHRoaXMubG9nLnBy
aW50bG4oJ1VuZXhwZWN0ZWQgZXhjZXB0
aW9uIGluIHBvc3RhbWJsZTogJyArCiAg
ICAgICAgICAgICAgICAgICAgIChleC5z
dGFjayA/IGV4LnN0YWNrIDogZXgpKTsK
ICAgIHRoaXMucGFuaWMgPSB0cnVlOwog
IH0KCiAgdGhpcy5sb2cucG9wUHJlZml4
KCk7CiAgdGhpcy5sb2cucHJpbnQoJ30g
JyArIHJlc3VsdC5zdGF0dXMgKyAnLCAn
ICsKICAgICAgICAgICAgICAgICB0aGlz
Lm1zVG9TZWNvbmRzXyhyZXN1bHQuZHVy
YXRpb24pKTsKICB0aGlzLmxvZy5mbHVz
aCgpOwoKICBpZiAocmVzdWx0LnN0YXR1
cyA9PSByZXN1bHQuRkFJTEVEKSB7CiAg
ICB0aGlzLmZhaWx1cmVzLnB1c2gocmVz
dWx0KTsKICAgIHRoaXMuY3VycmVudFN1
aXRlID0gbnVsbDsKICB9IGVsc2UgaWYg
KHJlc3VsdC5zdGF0dXMgPT0gcmVzdWx0
LlBBU1NFRCkgewogICAgdGhpcy5wYXNz
ZXMucHVzaChyZXN1bHQpOwogIH0gZWxz
ZSB7CiAgICB0aGlzLmxvZy5wcmludGxu
KCdVbmtub3duIHJlc3VsdCBzdGF0dXM6
ICcgKyByZXN1bHQudGVzdC5mdWxsTmFt
ZSArICc6ICcgKwogICAgICAgICAgICAg
ICAgICAgICByZXN1bHQuc3RhdHVzKTsK
ICAgIHJldHVybiB0aGlzLnBhbmljID0g
dHJ1ZTsKICB9CgogIHRoaXMucnVuTmV4
dFRlc3RfKCk7Cn07CgovKioKICogQ2Fs
bGVkIGJ5IHRoZSBsaWIuVGVzdE1hbmFn
ZXIuUmVzdWx0IG9iamVjdCB3aGVuIGEg
dGVzdCB3aGljaCBoYXMgYWxyZWFkeQog
KiBjb21wbGV0ZWQgcmVwb3J0cyBhbm90
aGVyIGNvbXBsZXRpb24uCiAqCiAqIFRo
aXMgaXMgdXN1YWxseSBpbmRpY2F0aXZl
IG9mIGEgYnVnZ3kgdGVzdGNhc2UuICBJ
dCBpcyBwcm9iYWJseSByZXBvcnRpbmcg
YQogKiByZXN1bHQgb24gZXhpdCBhbmQg
dGhlbiBhZ2FpbiBmcm9tIGFuIGFzeW5j
aHJvbm91cyBjYWxsYmFjay4KICoKICog
SXQgbWF5IGFsc28gYmUgdGhlIGNhc2Ug
dGhhdCB0aGUgbGFzdCBhY3Qgb2YgdGhl
IHRlc3RjYXNlIGNhdXNlcyBhIERPTSBj
aGFuZ2UKICogd2hpY2ggdHJpZ2dlcnMg
c29tZSBldmVudCB0byBydW4gYWZ0ZXIg
dGhlIHRlc3QgcmV0dXJucy4gIElmIHRo
ZSBldmVudAogKiBoYW5kbGVyIHJlcG9y
dHMgYSBmYWlsdXJlIG9yIHJhaXNlcyBh
biB1bmNhdWdodCBleGNlcHRpb24sIHRo
ZSB0ZXN0IHdpbGwKICogZmFpbCBldmVu
IHRob3VnaCBpdCBoYXMgYWxyZWFkeSBj
b21wbGV0ZWQuCiAqCiAqIEluIGFueSBj
YXNlLCByZS1jb21wbGV0aW5nIGEgdGVz
dCBBTFdBWVMgbW92ZXMgaXQgaW50byB0
aGUgZmFpbHVyZSBwaWxlLgogKgogKiBA
cGFyYW0ge2xpYi5UZXN0TWFuYWdlci5S
ZXN1bHR9IHJlc3VsdCBUaGUgcmVzdWx0
IG9iamVjdCB3aGljaCBoYXMganVzdAog
KiAgICAgY29tcGxldGVkLgogKiBAcGFy
YW0ge3N0cmluZ30gbGF0ZVN0YXR1cyBU
aGUgc3RhdHVzIHRoYXQgdGhlIHRlc3Qg
YXR0ZW1wdGVkIHRvIHJlY29yZCB0aGlz
CiAqICAgICB0aW1lIGFyb3VuZC4KICov
CmxpYi5UZXN0TWFuYWdlci5UZXN0UnVu
LnByb3RvdHlwZS5vblJlc3VsdFJlQ29t
cGxldGUgPSBmdW5jdGlvbigKICAgIHJl
c3VsdCwgbGF0ZVN0YXR1cykgewogIHRo
aXMubG9nLnByaW50bG4oJ0xhdGUgY29t
cGxldGUgZm9yIHRlc3Q6ICcgKyByZXN1
bHQudGVzdC5mdWxsTmFtZSArICc6ICcg
KwogICAgICAgICAgICAgICAgICAgbGF0
ZVN0YXR1cyk7CgogIC8vIENvbnNpZGVy
IGFueSBsYXRlIGNvbXBsZXRpb24gYSBm
YWlsdXJlLCBldmVuIGlmIGl0J3MgYSBk
b3VibGUtcGFzcywgc2luY2UKICAvLyBp
dCdzIGEgbWlzdXNlIG9mIHRoZSB0ZXN0
aW5nIEFQSS4KICB2YXIgaW5kZXggPSB0
aGlzLnBhc3Nlcy5pbmRleE9mKHJlc3Vs
dCk7CiAgaWYgKGluZGV4ID49IDApIHsK
ICAgIHRoaXMucGFzc2VzLnNwbGljZShp
bmRleCwgMSk7CiAgICB0aGlzLmZhaWx1
cmVzLnB1c2gocmVzdWx0KTsKICB9Cn07
CgovKioKICogUnVuIHRoZSBuZXh0IHRl
c3QgaW4gdGhlIHF1ZXVlLgogKi8KbGli
LlRlc3RNYW5hZ2VyLlRlc3RSdW4ucHJv
dG90eXBlLnJ1bk5leHRUZXN0XyA9IGZ1
bmN0aW9uKCkgewogIGlmICh0aGlzLnBh
bmljIHx8ICF0aGlzLnRlc3RRdWV1ZV8u
bGVuZ3RoKQogICAgcmV0dXJuIHRoaXMu
b25UZXN0UnVuQ29tcGxldGVfKCk7Cgog
IGlmICh0aGlzLm1heEZhaWx1cmVzICYm
IHRoaXMuZmFpbHVyZXMubGVuZ3RoID49
IHRoaXMubWF4RmFpbHVyZXMpIHsKICAg
IHRoaXMubG9nLnByaW50bG4oJ01heGlt
dW0gZmFpbHVyZSBjb3VudCByZWFjaGVk
LCBhYm9ydGluZyB0ZXN0IHJ1bi4nKTsK
ICAgIHJldHVybiB0aGlzLm9uVGVzdFJ1
bkNvbXBsZXRlXygpOwogIH0KCiAgLy8g
UGVlayBhdCB0aGUgdG9wIHRlc3QgZmly
c3QuICBXZSByZW1vdmUgaXQgbGF0ZXIg
anVzdCBiZWZvcmUgaXQncyBhYm91dAog
IC8vIHRvIHJ1biwgc28gdGhhdCB3ZSBk
b24ndCBkaXN0dXJiIHRoZSBpbmNvbXBs
ZXRlIHRlc3QgY291bnQgaW4gdGhlCiAg
Ly8gZXZlbnQgdGhhdCB3ZSBmYWlsIGJl
Zm9yZSBydW5uaW5nIGl0LgogIHZhciB0
ZXN0ID0gdGhpcy50ZXN0UXVldWVfWzBd
OwogIHZhciBzdWl0ZSA9IHRoaXMuY3Vy
cmVudFJlc3VsdCA/IHRoaXMuY3VycmVu
dFJlc3VsdC5zdWl0ZSA6IG51bGw7Cgog
IHRyeSB7CiAgICBpZiAoIXN1aXRlIHx8
ICEoc3VpdGUgaW5zdGFuY2VvZiB0ZXN0
LnN1aXRlQ2xhc3MpKSB7CiAgICAgIHRo
aXMubG9nLnByaW50bG4oJ0luaXRpYWxp
emluZyBzdWl0ZTogJyArIHRlc3Quc3Vp
dGVDbGFzcy5zdWl0ZU5hbWUpOwogICAg
ICBzdWl0ZSA9IG5ldyB0ZXN0LnN1aXRl
Q2xhc3ModGhpcy50ZXN0TWFuYWdlciwg
dGhpcy5jeCk7CiAgICB9CiAgfSBjYXRj
aCAoZXgpIHsKICAgIC8vIElmIHRlc3Qg
c3VpdGUgc2V0dXAgZmFpbHMgd2UncmUg
bm90IGV2ZW4gZ29pbmcgdG8gdHJ5IHRv
IHJ1biB0aGUgdGVzdHMuCiAgICB0aGlz
LmxvZy5wcmludGxuKCdFeGNlcHRpb24g
ZHVyaW5nIHNldHVwOiAnICsgKGV4LnN0
YWNrID8gZXguc3RhY2sgOiBleCkpOwog
ICAgdGhpcy5wYW5pYyA9IHRydWU7CiAg
ICB0aGlzLm9uVGVzdFJ1bkNvbXBsZXRl
XygpOwogICAgcmV0dXJuOwogIH0KCiAg
dHJ5IHsKICAgIHRoaXMubG9nLnByaW50
KCdUZXN0OiAnICsgdGVzdC5mdWxsTmFt
ZSArICcgeycpOwogICAgdGhpcy5sb2cu
cHVzaFByZWZpeCgnICAnKTsKCiAgICB0
aGlzLmN1cnJlbnRSZXN1bHQgPSBuZXcg
bGliLlRlc3RNYW5hZ2VyLlJlc3VsdCh0
aGlzLCBzdWl0ZSwgdGVzdCk7CiAgICBz
dWl0ZS5wcmVhbWJsZSh0aGlzLmN1cnJl
bnRSZXN1bHQsIHRoaXMuY3gpOwoKICAg
IHRoaXMudGVzdFF1ZXVlXy5zaGlmdCgp
OwogIH0gY2F0Y2ggKGV4KSB7CiAgICB0
aGlzLmxvZy5wcmludGxuKCdVbmV4cGVj
dGVkIGV4Y2VwdGlvbiBkdXJpbmcgdGVz
dCBwcmVhbWJsZTogJyArCiAgICAgICAg
ICAgICAgICAgICAgIChleC5zdGFjayA/
IGV4LnN0YWNrIDogZXgpKTsKICAgIHRo
aXMubG9nLnBvcFByZWZpeCgpOwogICAg
dGhpcy5sb2cucHJpbnRsbignfScpOwoK
ICAgIHRoaXMucGFuaWMgPSB0cnVlOwog
ICAgdGhpcy5vblRlc3RSdW5Db21wbGV0
ZV8oKTsKICAgIHJldHVybjsKICB9Cgog
IHRyeSB7CiAgICB0aGlzLmN1cnJlbnRS
ZXN1bHQucnVuKCk7CiAgfSBjYXRjaCAo
ZXgpIHsKICAgIC8vIFJlc3VsdC5ydW4o
KSBzaG91bGQgY2F0Y2ggdGVzdCBleGNl
cHRpb25zIGFuZCB0dXJuIHRoZW0gaW50
byBmYWlsdXJlcy4KICAgIC8vIElmIHdl
IGdvdCBoZXJlLCBpdCBtZWFucyB0aGVy
ZSBpcyB0cm91YmxlIGluIHRoZSB0ZXN0
aW5nIGZyYW1ld29yay4KICAgIHRoaXMu
bG9nLnByaW50bG4oJ1VuZXhwZWN0ZWQg
ZXhjZXB0aW9uIGR1cmluZyB0ZXN0IHJ1
bjogJyArCiAgICAgICAgICAgICAgICAg
ICAgIChleC5zdGFjayA/IGV4LnN0YWNr
IDogZXgpKTsKICAgIHRoaXMucGFuaWMg
PSB0cnVlOwogIH0KfTsKCi8qKgogKiBS
dW4gdGhlIHNlbGVjdGVkIGxpc3Qgb2Yg
dGVzdHMuCiAqCiAqIFNvbWUgdGVzdHMg
bWF5IG5lZWQgdG8gcnVuIGFzeW5jaHJv
bm91c2x5LCBzbyB5b3UgY2Fubm90IGFz
c3VtZSB0aGUgcnVuIGlzCiAqIGNvbXBs
ZXRlIHdoZW4gdGhpcyBmdW5jdGlvbiBy
ZXR1cm5zLiAgSW5zdGVhZCwgcGFzcyBp
biBhIGZ1bmN0aW9uIHRvIGJlCiAqIGNh
bGxlZCBiYWNrIHdoZW4gdGhlIHJ1biBo
YXMgY29tcGxldGVkLgogKgogKiBUaGlz
IGZ1bmN0aW9uIHdpbGwgbG9nIHRoZSBy
ZXN1bHRzIG9mIHRoZSB0ZXN0IHJ1biBh
cyB0aGV5IGhhcHBlbiBpbnRvIHRoZQog
KiBsb2cgZGVmaW5lZCBieSB0aGUgYXNz
b2NpYXRlZCBsaWIuVGVzdE1hbmFnZXIu
ICBCeSBkZWZhdWx0IHRoaXMgaXMKICog
Y29uc29sZS5sb2csIHdoaWNoIGNhbiBi
ZSB2aWV3ZWQgaW4gdGhlIEphdmFTY3Jp
cHQgY29uc29sZSBvZiBtb3N0IGJyb3dz
ZXJzLgogKgogKiBUaGUgYnJvd3NlciBz
dGF0ZSBpcyBkZXRlcm1pbmVkIGJ5IHRo
ZSBsYXN0IHRlc3QgdG8gcnVuLiAgV2Ug
aW50ZW50aW9uYWxseQogKiBkb24ndCBk
byBhbnkgY2xlYW51cCBzbyB0aGF0IHlv
dSBjYW4gaW5zcGVjdCB0aGUgc3RhdGUg
b2YgYSBmYWlsZWQgdGVzdCwgb3IKICog
bGVhdmUgdGhlIGJyb3dzZXIgcmVhZHkg
Zm9yIG1hbnVhbCB0ZXN0aW5nLgogKgog
KiBBbnkgZmFpbHVyZXMgaW4gbGliLlRl
c3RNYW5hZ2VyLiogY29kZSBvciB0ZXN0
IHN1aXRlIHNldHVwIG9yIHRlc3QgY2Fz
ZQogKiBwcmVhbWJsZSB3aWxsIGNhdXNl
IHRoZSB0ZXN0IHJ1biB0byBhYm9ydC4K
ICovCmxpYi5UZXN0TWFuYWdlci5UZXN0
UnVuLnByb3RvdHlwZS5ydW4gPSBmdW5j
dGlvbigpIHsKICB0aGlzLmxvZy5wcmlu
dGxuKCdSdW5uaW5nICcgKyB0aGlzLnRl
c3RRdWV1ZV8ubGVuZ3RoICsgJyB0ZXN0
KHMpIHsnKTsKICB0aGlzLmxvZy5wdXNo
UHJlZml4KCcgICcpOwoKICB3aW5kb3cu
b25lcnJvciA9IHRoaXMub25VbmNhdWdo
dEV4Y2VwdGlvbl8uYmluZCh0aGlzKTsK
ICB0aGlzLnN0YXJ0RGF0ZSA9IG5ldyBE
YXRlKCk7CiAgdGhpcy5ydW5OZXh0VGVz
dF8oKTsKfTsKCi8qKgogKiBGb3JtYXQg
bWlsbGlzZWNvbmRzIGFzIGZyYWN0aW9u
YWwgc2Vjb25kcy4KICovCmxpYi5UZXN0
TWFuYWdlci5UZXN0UnVuLnByb3RvdHlw
ZS5tc1RvU2Vjb25kc18gPSBmdW5jdGlv
bihtcykgewogIHZhciBzZWNzID0gKG1z
IC8gMTAwMCkudG9GaXhlZCgyKTsKICBy
ZXR1cm4gc2VjcyArICdzJzsKfTsKCi8q
KgogKiBMb2cgdGhlIGN1cnJlbnQgcmVz
dWx0IHN1bW1hcnkuCiAqLwpsaWIuVGVz
dE1hbmFnZXIuVGVzdFJ1bi5wcm90b3R5
cGUuc3VtbWFyaXplID0gZnVuY3Rpb24o
KSB7CiAgaWYgKHRoaXMuZmFpbHVyZXMu
bGVuZ3RoKSB7CiAgICBmb3IgKHZhciBp
ID0gMDsgaSA8IHRoaXMuZmFpbHVyZXMu
bGVuZ3RoOyBpKyspIHsKICAgICAgdGhp
cy5sb2cucHJpbnRsbignRkFJTEVEOiAn
ICsgdGhpcy5mYWlsdXJlc1tpXS50ZXN0
LmZ1bGxOYW1lKTsKICAgIH0KICB9Cgog
IGlmICh0aGlzLnRlc3RRdWV1ZV8ubGVu
Z3RoKSB7CiAgICB0aGlzLmxvZy5wcmlu
dGxuKCdUZXN0IHJ1biBpbmNvbXBsZXRl
OiAnICsgdGhpcy50ZXN0UXVldWVfLmxl
bmd0aCArCiAgICAgICAgICAgICAgICAg
ICAgICcgdGVzdChzKSB3ZXJlIG5vdCBy
dW4uJyk7CiAgfQp9OwoKLyoqCiAqIFJl
Y29yZCBvZiB0aGUgcmVzdWx0IG9mIGEg
c2luZ2xlIHRlc3QuCiAqCiAqIFRoZXNl
IGFyZSBjb25zdHJ1Y3RlZCBkdXJpbmcg
YSB0ZXN0IHJ1biwgeW91IHNob3VsZG4n
dCBoYXZlIHRvIG1ha2Ugb25lCiAqIG9u
IHlvdXIgb3duLgogKgogKiBBbiBpbnN0
YW5jZSBvZiB0aGlzIGNsYXNzIGlzIHBh
c3NlZCBpbiB0byBlYWNoIHRlc3QgZnVu
Y3Rpb24uICBJdCBjYW4gYmUKICogdXNl
ZCB0byBhZGQgbWVzc2FnZXMgdG8gdGhl
IHRlc3QgbG9nLCB0byByZWNvcmQgYSB0
ZXN0IHBhc3MvZmFpbCBzdGF0ZSwgdG8K
ICogdGVzdCBhc3NlcnRpb25zLCBvciB0
byBjcmVhdGUgZXhjZXB0aW9uLXByb29m
IHdyYXBwZXJzIGZvciBjYWxsYmFjawog
KiBmdW5jdGlvbnMuCiAqCiAqIEBwYXJh
bSB7bGliLlRlc3RNYW5hZ2VyLlRlc3RS
dW59IHRlc3RSdW4gVGhlIFRlc3RSdW4g
aW5zdGFuY2UgYXNzb2NpYXRlZCB3aXRo
CiAqICAgICB0aGlzIHJlc3VsdC4KICog
QHBhcmFtIHtsaWIuVGVzdE1hbmFnZXIu
U3VpdH0gc3VpdGUgVGhlIFN1aXRlIGNv
bnRhaW5pbmcgdGhlIHRlc3Qgd2UncmUK
ICogICAgIGNvbGxlY3RpbmcgdGhpcyBy
ZXN1bHQgZm9yLgogKiBAcGFyYW0ge2xp
Yi5UZXN0TWFuYWdlci5UZXN0fSB0ZXN0
IFRoZSB0ZXN0IHdlJ3JlIGNvbGxlY3Rp
bmcgdGhpcyByZXN1bHQgZm9yLgogKi8K
bGliLlRlc3RNYW5hZ2VyLlJlc3VsdCA9
IGZ1bmN0aW9uKHRlc3RSdW4sIHN1aXRl
LCB0ZXN0KSB7CiAgLyoqCiAgICogVGhl
IFRlc3RSdW4gaW5zdGFuY2UgYXNzb2Np
YXRlZCB3aXRoIHRoaXMgcmVzdWx0Lgog
ICAqLwogIHRoaXMudGVzdFJ1biA9IHRl
c3RSdW47CgogIC8qKgogICAqIFRoZSBT
dWl0ZSBjb250YWluaW5nIHRoZSB0ZXN0
IHdlJ3JlIGNvbGxlY3RpbmcgdGhpcyBy
ZXN1bHQgZm9yLgogICAqLwogIHRoaXMu
c3VpdGUgPSBzdWl0ZTsKCiAgLyoqCiAg
ICogVGhlIHRlc3Qgd2UncmUgY29sbGVj
dGluZyB0aGlzIHJlc3VsdCBmb3IuCiAg
ICovCiAgdGhpcy50ZXN0ID0gdGVzdDsK
CiAgLyoqCiAgICogVGhlIHRpbWUgd2Ug
c3RhcnRlZCB0byBjb2xsZWN0IHRoaXMg
cmVzdWx0LCBvciBudWxsIGlmIHdlIGhh
dmVuJ3Qgc3RhcnRlZC4KICAgKi8KICB0
aGlzLnN0YXJ0RGF0ZSA9IG51bGw7Cgog
IC8qKgogICAqIFRoZSB0aW1lIGluIG1p
bGxpc2Vjb25kcyB0aGF0IHRoZSB0ZXN0
IHRvb2sgdG8gY29tcGxldGUsIG9yIG51
bGwgaWYKICAgKiBpdCBoYXNuJ3QgY29t
cGxldGVkIHlldC4KICAgKi8KICB0aGlz
LmR1cmF0aW9uID0gbnVsbDsKCiAgLyoq
CiAgICogVGhlIGN1cnJlbnQgc3RhdHVz
IG9mIHRoaXMgdGVzdCByZXN1bHQuCiAg
ICovCiAgdGhpcy5zdGF0dXMgPSB0aGlz
LlBFTkRJTkc7CgogIC8vIEFuIGVycm9y
IG1lc3NhZ2UgdGhhdCB0aGUgdGVzdCBj
YXNlIGlzIGV4cGVjdGVkIHRvIGdlbmVy
YXRlLgogIHRoaXMuZXhwZWN0ZWRFcnJv
ck1lc3NhZ2VfID0gbnVsbDsKfTsKCi8q
KgogKiBQb3NzaWJsZSB2YWx1ZXMgZm9y
IHRoaXMuc3RhdHVzLgogKi8KbGliLlRl
c3RNYW5hZ2VyLlJlc3VsdC5wcm90b3R5
cGUuUEVORElORyA9ICdwZW5kaW5nJzsK
bGliLlRlc3RNYW5hZ2VyLlJlc3VsdC5w
cm90b3R5cGUuRkFJTEVEICA9ICdGQUlM
RUQnOwpsaWIuVGVzdE1hbmFnZXIuUmVz
dWx0LnByb3RvdHlwZS5QQVNTRUQgID0g
J3Bhc3NlZCc7CgovKioKICogRXhjZXB0
aW9uIHRocm93biB3aGVuIGEgdGVzdCBj
b21wbGV0ZXMgKHBhc3Mgb3IgZmFpbCks
IHRvIGVuc3VyZSBubyBtb3JlIG9mCiAq
IHRoZSB0ZXN0IGlzIHJ1bi4KICovCmxp
Yi5UZXN0TWFuYWdlci5SZXN1bHQuVGVz
dENvbXBsZXRlID0gZnVuY3Rpb24ocmVz
dWx0KSB7CiAgdGhpcy5yZXN1bHQgPSBy
ZXN1bHQ7Cn07CgpsaWIuVGVzdE1hbmFn
ZXIuUmVzdWx0LlRlc3RDb21wbGV0ZS5w
cm90b3R5cGUudG9TdHJpbmcgPSBmdW5j
dGlvbigpIHsKICByZXR1cm4gJ2xpYi5U
ZXN0TWFuYWdlci5SZXN1bHQuVGVzdENv
bXBsZXRlOiAnICsgdGhpcy5yZXN1bHQu
dGVzdC5mdWxsTmFtZSArCiAgICAgICcs
IHN0YXR1czogJyArIHRoaXMucmVzdWx0
LnN0YXR1czsKfQoKLyoqCiAqIFN0YXJ0
IHRoZSB0ZXN0IGFzc29jaWF0ZWQgd2l0
aCB0aGlzIHJlc3VsdC4KICovCmxpYi5U
ZXN0TWFuYWdlci5SZXN1bHQucHJvdG90
eXBlLnJ1biA9IGZ1bmN0aW9uKCkgewog
IHZhciBzZWxmID0gdGhpczsKCiAgdGhp
cy5zdGFydERhdGUgPSBuZXcgRGF0ZSgp
OwogIHRoaXMudGVzdC5ydW4odGhpcyk7
CgogIGlmICh0aGlzLnN0YXR1cyA9PSB0
aGlzLlBFTkRJTkcgJiYgIXRoaXMudGlt
ZW91dF8pIHsKICAgIHRoaXMucHJpbnRs
bignVGVzdCBkaWQgbm90IHJldHVybiBh
IHZhbHVlIGFuZCBkaWQgbm90IHJlcXVl
c3QgbW9yZSB0aW1lLicpOwogICAgdGhp
cy5jb21wbGV0ZVRlc3RfKHRoaXMuRkFJ
TEVELCBmYWxzZSk7CiAgfQp9OwoKLyoq
CiAqIFVuaGFuZGxlZCBlcnJvciBtZXNz
YWdlIHRoaXMgdGVzdCBleHBlY3RzIHRv
IGdlbmVyYXRlLgogKgogKiBUaGlzIG11
c3QgYmUgdGhlIGV4YWN0IHN0cmluZyB0
aGF0IHdvdWxkIGFwcGVhciBpbiB0aGUg
SmF2YVNjcmlwdCBjb25zb2xlLAogKiBt
aW51cyB0aGUgJ1VuY2F1Z2h0ICcgcHJl
Zml4LgogKgogKiBUaGUgdGVzdCBjYXNl
IGRvZXMgKm5vdCogYXV0b21hdGljYWxs
eSBmYWlsIGlmIHRoZSBlcnJvciBtZXNz
YWdlIGlzIG5vdAogKiBlbmNvdW50ZXJl
ZC4KICovCmxpYi5UZXN0TWFuYWdlci5S
ZXN1bHQucHJvdG90eXBlLmV4cGVjdEVy
cm9yTWVzc2FnZSA9IGZ1bmN0aW9uKHN0
cikgewogIHRoaXMuZXhwZWN0ZWRFcnJv
ck1lc3NhZ2VfID0gc3RyOwp9OwoKLyoq
CiAqIEZ1bmN0aW9uIGNhbGxlZCB3aGVu
IGEgdGVzdCB0aW1lcyBvdXQuCiAqLwps
aWIuVGVzdE1hbmFnZXIuUmVzdWx0LnBy
b3RvdHlwZS5vblRpbWVvdXRfID0gZnVu
Y3Rpb24oKSB7CiAgdGhpcy50aW1lb3V0
XyA9IG51bGw7CgogIGlmICh0aGlzLnN0
YXR1cyAhPSB0aGlzLlBFTkRJTkcpCiAg
ICByZXR1cm47CgogIHRoaXMucHJpbnRs
bignVGVzdCB0aW1lZCBvdXQuJyk7CiAg
dGhpcy5jb21wbGV0ZVRlc3RfKHRoaXMu
RkFJTEVELCBmYWxzZSk7Cn07CgovKioK
ICogSW5kaWNhdGUgdGhhdCBhIHRlc3Qg
Y2FzZSBuZWVkcyBtb3JlIHRpbWUgdG8g
Y29tcGxldGUuCiAqCiAqIEJlZm9yZSBh
IHRlc3QgY2FzZSByZXR1cm5zIGl0IG11
c3QgcmVwb3J0IGEgcGFzcy9mYWlsIHJl
c3VsdCwgb3IgcmVxdWVzdCBtb3JlCiAq
IHRpbWUgdG8gZG8gc28uCiAqCiAqIElm
IGEgdGVzdCBkb2VzIG5vdCByZXBvcnQg
cGFzcy9mYWlsIGJlZm9yZSB0aGUgdGlt
ZSBleHBpcmVzIGl0IHdpbGwKICogYmUg
cmVwb3J0ZWQgYXMgYSB0aW1lb3V0IGZh
aWx1cmUuICBBbnkgbGF0ZSBwYXNzL2Zh
aWxzIHdpbGwgYmUgbm90ZWQgaW4gdGhl
CiAqIHRlc3QgbG9nLCBidXQgd2lsbCBu
b3QgYWZmZWN0IHRoZSBmaW5hbCByZXN1
bHQgb2YgdGhlIHRlc3QuCiAqCiAqIFRl
c3QgY2FzZXMgbWF5IGNhbGwgcmVxdWVz
dFRpbWUgbW9yZSB0aGFuIG9uY2UuICBJ
ZiB5b3UgaGF2ZSBhIGZldyBsYXllcnMK
ICogb2YgYXN5bmNocm9ub3VzIEFQSSB0
byBnbyB0aHJvdWdoLCB5b3Ugc2hvdWxk
IGNhbGwgdGhpcyBvbmNlIHBlciBsYXll
ciB3aXRoCiAqIGFuIGVzdGltYXRlIG9m
IGhvdyBsb25nIGVhY2ggY2FsbGJhY2sg
d2lsbCB0YWtlIHRvIGNvbXBsZXRlLgog
KgogKiBAcGFyYW0ge2ludH0gbXMgTnVt
YmVyIG9mIG1pbGxpc2Vjb25kcyByZXF1
ZXN0ZWQuCiAqLwpsaWIuVGVzdE1hbmFn
ZXIuUmVzdWx0LnByb3RvdHlwZS5yZXF1
ZXN0VGltZSA9IGZ1bmN0aW9uKG1zKSB7
CiAgaWYgKHRoaXMudGltZW91dF8pCiAg
ICBjbGVhclRpbWVvdXQodGhpcy50aW1l
b3V0Xyk7CgogIHRoaXMudGltZW91dF8g
PSBzZXRUaW1lb3V0KHRoaXMub25UaW1l
b3V0Xy5iaW5kKHRoaXMpLCBtcyk7Cn07
CgovKioKICogUmVwb3J0IHRoZSBjb21w
bGV0aW9uIG9mIGEgdGVzdC4KICoKICog
QHBhcmFtIHtzdHJpbmd9IHN0YXR1cyBU
aGUgc3RhdHVzIG9mIHRoZSB0ZXN0IGNh
c2UuCiAqIEBwYXJhbSB7Ym9vbGVhbn0g
b3B0X3Rocm93IE9wdGlvbmFsIGJvb2xl
YW4gaW5kaWNhdGluZyB3aGV0aGVyIG9y
IG5vdAogKiAgICAgdG8gdGhyb3cgdGhl
IFRlc3RDb21wbGV0ZSBleGNlcHRpb24u
CiAqLwpsaWIuVGVzdE1hbmFnZXIuUmVz
dWx0LnByb3RvdHlwZS5jb21wbGV0ZVRl
c3RfID0gZnVuY3Rpb24oc3RhdHVzLCBv
cHRfdGhyb3cpIHsKICBpZiAodGhpcy5z
dGF0dXMgPT0gdGhpcy5QRU5ESU5HKSB7
CiAgICB0aGlzLmR1cmF0aW9uID0gKG5l
dyBEYXRlKCkpIC0gdGhpcy5zdGFydERh
dGU7CiAgICB0aGlzLnN0YXR1cyA9IHN0
YXR1czsKCiAgICB0aGlzLnRlc3RSdW4u
b25SZXN1bHRDb21wbGV0ZSh0aGlzKTsK
ICB9IGVsc2UgewogICAgdGhpcy50ZXN0
UnVuLm9uUmVzdWx0UmVDb21wbGV0ZSh0
aGlzLCBzdGF0dXMpOwogIH0KCiAgaWYg
KGFyZ3VtZW50cy5sZW5ndGggPCAyIHx8
IG9wdF90aHJvdykKICAgIHRocm93IG5l
dyBsaWIuVGVzdE1hbmFnZXIuUmVzdWx0
LlRlc3RDb21wbGV0ZSh0aGlzKTsKfTsK
Ci8qKgogKiBBc3NlcnQgdGhhdCBhbiBh
Y3R1YWwgdmFsdWUgaXMgZXhhY3RseSBl
cXVhbCB0byB0aGUgZXhwZWN0ZWQgdmFs
dWUuCiAqCiAqIFRoaXMgdXNlcyB0aGUg
SmF2YVNjcmlwdCAnPT09JyBvcGVyYXRv
ciBpbiBvcmRlciB0byBhdm9pZCB0eXBl
IGNvZXJjaW9uLgogKgogKiBJZiB0aGUg
YXNzZXJ0aW9uIGZhaWxzLCB0aGUgdGVz
dCBpcyBtYXJrZWQgYXMgYSBmYWlsdXJl
IGFuZCBhIFRlc3RDb21wbGV0ZWQKICog
ZXhjZXB0aW9uIGlzIHRocm93bi4KICoK
ICogQHBhcmFtIHsqfSBhY3R1YWwgVGhl
IGFjdHVhbCBtZWFzdXJlZCB2YWx1ZS4K
ICogQHBhcmFtIHsqfSBleHBlY3RlZCBU
aGUgdmFsdWUgZXhwZWN0ZWQuCiAqIEBw
YXJhbSB7c3RyaW5nfSBvcHRfbmFtZSBB
biBvcHRpb25hbCBuYW1lIHVzZWQgdG8g
aWRlbnRpZnkgdGhpcwogKiAgICAgYXNz
ZXJ0aW9uIGluIHRoZSB0ZXN0IGxvZy4g
IElmIG9tbWl0dGVkIGl0IHdpbGwgYmUg
dGhlIGZpbGU6bGluZQogKiAgICAgb2Yg
dGhlIGNhbGxlci4KICovCmxpYi5UZXN0
TWFuYWdlci5SZXN1bHQucHJvdG90eXBl
LmFzc2VydEVRID0gZnVuY3Rpb24oCiAg
ICBhY3R1YWwsIGV4cGVjdGVkLCBvcHRf
bmFtZSkgewogIC8vIFV0aWxpdHkgZnVu
Y3Rpb24gdG8gcHJldHR5IHVwIHRoZSBs
b2cuCiAgZnVuY3Rpb24gZm9ybWF0KHZh
bHVlKSB7CiAgICBpZiAodHlwZW9mIHZh
bHVlID09ICdudW1iZXInKQogICAgICBy
ZXR1cm4gdmFsdWU7CgogICAgdmFyIHN0
ciA9IFN0cmluZyh2YWx1ZSk7CiAgICB2
YXIgYXJ5ID0gc3RyLnNwbGl0KCdcbicp
Lm1hcChmdW5jdGlvbiAoZSkgeyByZXR1
cm4gSlNPTi5zdHJpbmdpZnkoZSkgfSk7
CiAgICBpZiAoYXJ5Lmxlbmd0aCA+IDEp
IHsKICAgICAgLy8gSWYgdGhlIHN0cmlu
ZyBoYXMgbmV3bGluZXMsIHN0YXJ0IGl0
IG9mZiBvbiBpdHMgb3duIGxpbmUgc28g
dGhhdAogICAgICAvLyBpdCdzIGVhc2ll
ciB0byBjb21wYXJlIGFnYWluc3QgYW5v
dGhlciBzdHJpbmcgd2l0aCBuZXdsaW5l
cy4KICAgICAgcmV0dXJuICdcbicgKyBh
cnkuam9pbignXG4nKTsKICAgIH0gZWxz
ZSB7CiAgICAgIHJldHVybiBhcnkuam9p
bignXG4nKTsKICAgIH0KICB9CgogIGlm
IChhY3R1YWwgPT09IGV4cGVjdGVkKQog
ICAgcmV0dXJuOwoKICB2YXIgbmFtZSA9
IG9wdF9uYW1lID8gJ1snICsgb3B0X25h
bWUgKyAnXScgOiAnJzsKCiAgdGhpcy5m
YWlsKCdhc3NlcnRFUScgKyBuYW1lICsg
JzogJyArIHRoaXMuZ2V0Q2FsbGVyTG9j
YXRpb25fKDEpICsgJzogJyArCiAgICAg
ICAgICAgIGZvcm1hdChhY3R1YWwpICsg
JyAhPT0gJyArIGZvcm1hdChleHBlY3Rl
ZCkpOwp9OwoKLyoqCiAqIEFzc2VydCB0
aGF0IGEgdmFsdWUgaXMgdHJ1ZS4KICoK
ICogVGhpcyB1c2VzIHRoZSBKYXZhU2Ny
aXB0ICc9PT0nIG9wZXJhdG9yIGluIG9y
ZGVyIHRvIGF2b2lkIHR5cGUgY29lcmNp
b24uCiAqIFRoZSBtdXN0IGJlIHRoZSBi
b29sZWFuIHZhbHVlIGB0cnVlYCwgbm90
IGp1c3Qgc29tZSAidHJ1aXNoIiB2YWx1
ZS4KICoKICogSWYgdGhlIGFzc2VydGlv
biBmYWlscywgdGhlIHRlc3QgaXMgbWFy
a2VkIGFzIGEgZmFpbHVyZSBhbmQgYSBU
ZXN0Q29tcGxldGVkCiAqIGV4Y2VwdGlv
biBpcyB0aHJvd24uCiAqCiAqIEBwYXJh
bSB7Ym9vbGVhbn0gYWN0dWFsIFRoZSBh
Y3R1YWwgbWVhc3VyZWQgdmFsdWUuCiAq
IEBwYXJhbSB7c3RyaW5nfSBvcHRfbmFt
ZSBBbiBvcHRpb25hbCBuYW1lIHVzZWQg
dG8gaWRlbnRpZnkgdGhpcwogKiAgICAg
YXNzZXJ0aW9uIGluIHRoZSB0ZXN0IGxv
Zy4gIElmIG9tbWl0dGVkIGl0IHdpbGwg
YmUgdGhlIGZpbGU6bGluZQogKiAgICAg
b2YgdGhlIGNhbGxlci4KICovCmxpYi5U
ZXN0TWFuYWdlci5SZXN1bHQucHJvdG90
eXBlLmFzc2VydCA9IGZ1bmN0aW9uKGFj
dHVhbCwgb3B0X25hbWUpIHsKICBpZiAo
YWN0dWFsID09PSB0cnVlKQogICAgcmV0
dXJuOwoKICB2YXIgbmFtZSA9IG9wdF9u
YW1lID8gJ1snICsgb3B0X25hbWUgKyAn
XScgOiAnJzsKCiAgdGhpcy5mYWlsKCdh
c3NlcnQnICsgbmFtZSArICc6ICcgKyB0
aGlzLmdldENhbGxlckxvY2F0aW9uXygx
KSArICc6ICcgKwogICAgICAgICAgICBT
dHJpbmcoYWN0dWFsKSk7Cn07CgovKioK
ICogUmV0dXJuIHRoZSBmaWxlbmFtZTps
aW5lIG9mIGEgY2FsbGluZyBzdGFjayBm
cmFtZS4KICoKICogVGhpcyB1c2VzIGEg
ZGlydHkgaGFjay4gIEl0IHRocm93cyBh
biBleGNlcHRpb24sIGNhdGNoZXMgaXQs
IGFuZCBleGFtaW5lcwogKiB0aGUgc3Rh
Y2sgcHJvcGVydHkgb2YgdGhlIGNhdWdo
dCBleGNlcHRpb24uCiAqCiAqIEBwYXJh
bSB7aW50fSBmcmFtZUluZGV4IFRoZSBz
dGFjayBmcmFtZSB0byByZXR1cm4uICAw
IGlzIHRoZSBmcmFtZSB0aGF0CiAqICAg
ICBjYWxsZWQgdGhpcyBtZXRob2QsIDEg
aXMgaXRzIGNhbGxlciwgYW5kIHNvIG9u
LgogKiBAcmV0dXJuIHtzdHJpbmd9IEEg
c3RyaW5nIG9mIHRoZSBmb3JtYXQgImZp
bGVuYW1lOmxpbmVudW1iZXIiLgogKi8K
bGliLlRlc3RNYW5hZ2VyLlJlc3VsdC5w
cm90b3R5cGUuZ2V0Q2FsbGVyTG9jYXRp
b25fID0gZnVuY3Rpb24oZnJhbWVJbmRl
eCkgewogIHRyeSB7CiAgICB0aHJvdyBu
ZXcgRXJyb3IoKTsKICB9IGNhdGNoIChl
eCkgewogICAgdmFyIGZyYW1lID0gZXgu
c3RhY2suc3BsaXQoJ1xuJylbZnJhbWVJ
bmRleCArIDJdOwogICAgdmFyIGFyeSA9
IGZyYW1lLm1hdGNoKC8oW14vXSs6XGQr
KTpcZCtcKT8kLyk7CiAgICByZXR1cm4g
YXJ5ID8gYXJ5WzFdIDogJz8/Pyc7CiAg
fQp9OwoKLyoqCiAqIFdyaXRlIGEgbWVz
c2FnZSB0byB0aGUgcmVzdWx0IGxvZy4K
ICovCmxpYi5UZXN0TWFuYWdlci5SZXN1
bHQucHJvdG90eXBlLnByaW50bG4gPSBm
dW5jdGlvbihtZXNzYWdlKSB7CiAgdGhp
cy50ZXN0UnVuLmxvZy5wcmludGxuKG1l
c3NhZ2UpOwp9OwoKLyoqCiAqIE1hcmsg
YSBmYWlsZWQgdGVzdCBhbmQgZXhpdCBv
dXQgb2YgdGhlIHJlc3Qgb2YgdGhlIHRl
c3QuCiAqCiAqIFRoaXMgd2lsbCB0aHJv
dyBhIFRlc3RDb21wbGV0ZWQgZXhjZXB0
aW9uLCBjYXVzaW5nIHRoZSBjdXJyZW50
IHRlc3QgdG8gc3RvcC4KICoKICogQHBh
cmFtIHtzdHJpbmd9IG9wdF9tZXNzYWdl
IE9wdGlvbmFsIG1lc3NhZ2UgdG8gYWRk
IHRvIHRoZSBsb2cuCiAqLwpsaWIuVGVz
dE1hbmFnZXIuUmVzdWx0LnByb3RvdHlw
ZS5mYWlsID0gZnVuY3Rpb24ob3B0X21l
c3NhZ2UpIHsKICBpZiAoYXJndW1lbnRz
Lmxlbmd0aCkKICAgIHRoaXMucHJpbnRs
bihvcHRfbWVzc2FnZSk7CgogIHRoaXMu
Y29tcGxldGVUZXN0Xyh0aGlzLkZBSUxF
RCwgdHJ1ZSk7Cn07CgovKioKICogTWFy
ayBhIHBhc3NlZCB0ZXN0IGFuZCBleGl0
IG91dCBvZiB0aGUgcmVzdCBvZiB0aGUg
dGVzdC4KICoKICogVGhpcyB3aWxsIHRo
cm93IGEgVGVzdENvbXBsZXRlZCBleGNl
cHRpb24sIGNhdXNpbmcgdGhlIGN1cnJl
bnQgdGVzdCB0byBzdG9wLgogKi8KbGli
LlRlc3RNYW5hZ2VyLlJlc3VsdC5wcm90
b3R5cGUucGFzcyA9IGZ1bmN0aW9uKCkg
ewogIHRoaXMuY29tcGxldGVUZXN0Xyh0
aGlzLlBBU1NFRCwgdHJ1ZSk7Cn07Ci8v
IFNPVVJDRSBGSUxFOiBsaWJkb3QvanMv
bGliX3V0ZjguanMKLy8gQ29weXJpZ2h0
IChjKSAyMDEyIFRoZSBDaHJvbWl1bSBP
UyBBdXRob3JzLiBBbGwgcmlnaHRzIHJl
c2VydmVkLgovLyBVc2Ugb2YgdGhpcyBz
b3VyY2UgY29kZSBpcyBnb3Zlcm5lZCBi
eSBhIEJTRC1zdHlsZSBsaWNlbnNlIHRo
YXQgY2FuIGJlCi8vIGZvdW5kIGluIHRo
ZSBMSUNFTlNFIGZpbGUuCgondXNlIHN0
cmljdCc7CgovLyBUT0RPKGRhdmlkYmVu
KTogV2hlbiB0aGUgc3RyaW5nIGVuY29k
aW5nIEFQSSBpcyBpbXBsZW1lbnRlZCwK
Ly8gcmVwbGFjZSB0aGlzIHdpdGggdGhl
IG5hdGl2ZSBpbi1icm93c2VyIGltcGxl
bWVudGF0aW9uLgovLwovLyBodHRwOi8v
d2lraS53aGF0d2cub3JnL3dpa2kvU3Ry
aW5nRW5jb2RpbmcKLy8gaHR0cDovL2R2
Y3MudzMub3JnL2hnL2VuY29kaW5nL3Jh
dy1maWxlL3RpcC9PdmVydmlldy5odG1s
CgovKioKICogQSBzdGF0ZWZ1bCBVVEYt
OCBkZWNvZGVyLgogKi8KbGliLlVURjhE
ZWNvZGVyID0gZnVuY3Rpb24oKSB7CiAg
Ly8gVGhlIG51bWJlciBvZiBieXRlcyBs
ZWZ0IGluIHRoZSBjdXJyZW50IHNlcXVl
bmNlLgogIHRoaXMuYnl0ZXNMZWZ0ID0g
MDsKICAvLyBUaGUgaW4tcHJvZ3Jlc3Mg
Y29kZSBwb2ludCBiZWluZyBkZWNvZGVk
LCBpZiBieXRlc0xlZnQgPiAwLgogIHRo
aXMuY29kZVBvaW50ID0gMDsKICAvLyBU
aGUgbG93ZXIgYm91bmQgb24gdGhlIGZp
bmFsIGNvZGUgcG9pbnQsIGlmIGJ5dGVz
TGVmdCA+IDAuCiAgdGhpcy5sb3dlckJv
dW5kID0gMDsKfTsKCi8qKgogKiBEZWNv
ZGVzIGEgc29tZSBVVEYtOCBkYXRhLCB0
YWtpbmcgaW50byBhY2NvdW50IHN0YXRl
IGZyb20gcHJldmlvdXMKICogZGF0YSBz
dHJlYW1lZCB0aHJvdWdoIHRoZSBlbmNv
ZGVyLgogKgogKiBAcGFyYW0ge1N0cmlu
Z30gc3RyIGRhdGEgdG8gZGVjb2RlLCBy
ZXByZXNlbnRlZCBhcyBhIEphdmFTY3Jp
cHQKICogICAgIFN0cmluZyB3aXRoIGVh
Y2ggY29kZSB1bml0IHJlcHJlc2VudGlu
ZyBhIGJ5dGUgYmV0d2VlbiAweDAwIHRv
CiAqICAgICAweEZGLgogKiBAcmV0dXJu
IHtTdHJpbmd9IFRoZSBkYXRhIGRlY29k
ZWQgaW50byBhIEphdmFTY3JpcHQgVVRG
LTE2IHN0cmluZy4KICovCmxpYi5VVEY4
RGVjb2Rlci5wcm90b3R5cGUuZGVjb2Rl
ID0gZnVuY3Rpb24oc3RyKSB7CiAgdmFy
IHJldCA9ICcnOwogIGZvciAodmFyIGkg
PSAwOyBpIDwgc3RyLmxlbmd0aDsgaSsr
KSB7CiAgICB2YXIgYyA9IHN0ci5jaGFy
Q29kZUF0KGkpOwogICAgaWYgKHRoaXMu
Ynl0ZXNMZWZ0ID09IDApIHsKICAgICAg
aWYgKGMgPD0gMHg3RikgewogICAgICAg
IHJldCArPSBzdHIuY2hhckF0KGkpOwog
ICAgICB9IGVsc2UgaWYgKDB4QzAgPD0g
YyAmJiBjIDw9IDB4REYpIHsKICAgICAg
ICB0aGlzLmNvZGVQb2ludCA9IGMgLSAw
eEMwOwogICAgICAgIHRoaXMuYnl0ZXNM
ZWZ0ID0gMTsKICAgICAgICB0aGlzLmxv
d2VyQm91bmQgPSAweDgwOwogICAgICB9
IGVsc2UgaWYgKDB4RTAgPD0gYyAmJiBj
IDw9IDB4RUYpIHsKICAgICAgICB0aGlz
LmNvZGVQb2ludCA9IGMgLSAweEUwOwog
ICAgICAgIHRoaXMuYnl0ZXNMZWZ0ID0g
MjsKICAgICAgICB0aGlzLmxvd2VyQm91
bmQgPSAweDgwMDsKICAgICAgfSBlbHNl
IGlmICgweEYwIDw9IGMgJiYgYyA8PSAw
eEY3KSB7CiAgICAgICAgdGhpcy5jb2Rl
UG9pbnQgPSBjIC0gMHhGMDsKICAgICAg
ICB0aGlzLmJ5dGVzTGVmdCA9IDM7CiAg
ICAgICAgdGhpcy5sb3dlckJvdW5kID0g
MHgxMDAwMDsKICAgICAgfSBlbHNlIGlm
ICgweEY4IDw9IGMgJiYgYyA8PSAweEZC
KSB7CiAgICAgICAgdGhpcy5jb2RlUG9p
bnQgPSBjIC0gMHhGODsKICAgICAgICB0
aGlzLmJ5dGVzTGVmdCA9IDQ7CiAgICAg
ICAgdGhpcy5sb3dlckJvdW5kID0gMHgy
MDAwMDA7CiAgICAgIH0gZWxzZSBpZiAo
MHhGQyA8PSBjICYmIGMgPD0gMHhGRCkg
ewogICAgICAgIHRoaXMuY29kZVBvaW50
ID0gYyAtIDB4RkM7CiAgICAgICAgdGhp
cy5ieXRlc0xlZnQgPSA1OwogICAgICAg
IHRoaXMubG93ZXJCb3VuZCA9IDB4NDAw
MDAwMDsKICAgICAgfSBlbHNlIHsKICAg
ICAgICByZXQgKz0gJ1x1ZmZmZCc7CiAg
ICAgIH0KICAgIH0gZWxzZSB7CiAgICAg
IGlmICgweDgwIDw9IGMgJiYgYyA8PSAw
eEJGKSB7CiAgICAgICAgdGhpcy5ieXRl
c0xlZnQtLTsKICAgICAgICB0aGlzLmNv
ZGVQb2ludCA9ICh0aGlzLmNvZGVQb2lu
dCA8PCA2KSArIChjIC0gMHg4MCk7CiAg
ICAgICAgaWYgKHRoaXMuYnl0ZXNMZWZ0
ID09IDApIHsKICAgICAgICAgIC8vIEdv
dCBhIGZ1bGwgc2VxdWVuY2UuIENoZWNr
IGlmIGl0J3Mgd2l0aGluIGJvdW5kcyBh
bmQKICAgICAgICAgIC8vIGZpbHRlciBv
dXQgc3Vycm9nYXRlIHBhaXJzLgogICAg
ICAgICAgdmFyIGNvZGVQb2ludCA9IHRo
aXMuY29kZVBvaW50OwogICAgICAgICAg
aWYgKGNvZGVQb2ludCA8IHRoaXMubG93
ZXJCb3VuZAogICAgICAgICAgICAgIHx8
ICgweEQ4MDAgPD0gY29kZVBvaW50ICYm
IGNvZGVQb2ludCA8PSAweERGRkYpCiAg
ICAgICAgICAgICAgfHwgY29kZVBvaW50
ID4gMHgxMEZGRkYpIHsKICAgICAgICAg
ICAgcmV0ICs9ICdcdWZmZmQnOwogICAg
ICAgICAgfSBlbHNlIHsKICAgICAgICAg
ICAgLy8gRW5jb2RlIGFzIFVURi0xNiBp
biB0aGUgb3V0cHV0LgogICAgICAgICAg
ICBpZiAoY29kZVBvaW50IDwgMHgxMDAw
MCkgewogICAgICAgICAgICAgIHJldCAr
PSBTdHJpbmcuZnJvbUNoYXJDb2RlKGNv
ZGVQb2ludCk7CiAgICAgICAgICAgIH0g
ZWxzZSB7CiAgICAgICAgICAgICAgLy8g
U3Vycm9nYXRlIHBhaXIuCiAgICAgICAg
ICAgICAgY29kZVBvaW50IC09IDB4MTAw
MDA7CiAgICAgICAgICAgICAgcmV0ICs9
IFN0cmluZy5mcm9tQ2hhckNvZGUoCiAg
ICAgICAgICAgICAgICAweEQ4MDAgKyAo
KGNvZGVQb2ludCA+Pj4gMTApICYgMHgz
RkYpLAogICAgICAgICAgICAgICAgMHhE
QzAwICsgKGNvZGVQb2ludCAmIDB4M0ZG
KSk7CiAgICAgICAgICAgIH0KICAgICAg
ICAgIH0KICAgICAgICB9CiAgICAgIH0g
ZWxzZSB7CiAgICAgICAgLy8gVG9vIGZl
dyBieXRlcyBpbiBtdWx0aS1ieXRlIHNl
cXVlbmNlLiBSZXdpbmQgc3RyZWFtIHNv
IHdlCiAgICAgICAgLy8gZG9uJ3QgbG9z
ZSB0aGUgbmV4dCBieXRlLgogICAgICAg
IHJldCArPSAnXHVmZmZkJzsKICAgICAg
ICB0aGlzLmJ5dGVzTGVmdCA9IDA7CiAg
ICAgICAgaS0tOwogICAgICB9CiAgICB9
CiAgfQogIHJldHVybiByZXQ7Cn07Cgov
KioKICogRGVjb2RlcyBVVEYtOCBkYXRh
LiBUaGlzIGlzIGEgY29udmVuaWVuY2Ug
ZnVuY3Rpb24gZm9yIHdoZW4gYWxsIHRo
ZQogKiBkYXRhIGlzIGFscmVhZHkga25v
d24uCiAqCiAqIEBwYXJhbSB7U3RyaW5n
fSBzdHIgZGF0YSB0byBkZWNvZGUsIHJl
cHJlc2VudGVkIGFzIGEgSmF2YVNjcmlw
dAogKiAgICAgU3RyaW5nIHdpdGggZWFj
aCBjb2RlIHVuaXQgcmVwcmVzZW50aW5n
IGEgYnl0ZSBiZXR3ZWVuIDB4MDAgdG8K
ICogICAgIDB4RkYuCiAqIEByZXR1cm4g
e1N0cmluZ30gVGhlIGRhdGEgZGVjb2Rl
ZCBpbnRvIGEgSmF2YVNjcmlwdCBVVEYt
MTYgc3RyaW5nLgogKi8KbGliLmRlY29k
ZVVURjggPSBmdW5jdGlvbih1dGY4KSB7
CiAgcmV0dXJuIChuZXcgbGliLlVURjhE
ZWNvZGVyKCkpLmRlY29kZSh1dGY4KTsK
fTsKCi8qKgogKiBFbmNvZGVzIGEgVVRG
LTE2IHN0cmluZyBpbnRvIFVURi04Lgog
KgogKiBUT0RPKGRhdmlkYmVuKTogRG8g
d2UgbmVlZCBhIHN0YXRlZnVsIHZlcnNp
b24gb2YgdGhpcyB0aGF0IGNhbgogKiBo
YW5kbGUgYSBzdXJyb2dhdGUgcGFpciBz
cGxpdCBpbiB0d28gY2FsbHM/IFdoYXQg
aGFwcGVucyBpZiBhCiAqIGtleXByZXNz
IGV2ZW50IHdvdWxkIGhhdmUgY29udGFp
bmVkIGEgY2hhcmFjdGVyIG91dHNpZGUg
dGhlIEJNUD8KICoKICogQHBhcmFtIHtT
dHJpbmd9IHN0ciBUaGUgc3RyaW5nIHRv
IGVuY29kZS4KICogQHJldHVybiB7U3Ry
aW5nfSBUaGUgc3RyaW5nIGVuY29kZWQg
YXMgVVRGLTgsIGFzIGEgSmF2YVNjcmlw
dAogKiAgICAgc3RyaW5nIHdpdGggYnl0
ZXMgcmVwcmVzZW50ZWQgYXMgY29kZSB1
bml0cyBmcm9tIDB4MDAgdG8gMHhGRi4K
ICovCmxpYi5lbmNvZGVVVEY4ID0gZnVu
Y3Rpb24oc3RyKSB7CiAgdmFyIHJldCA9
ICcnOwogIGZvciAodmFyIGkgPSAwOyBp
IDwgc3RyLmxlbmd0aDsgaSsrKSB7CiAg
ICAvLyBHZXQgYSB1bmljb2RlIGNvZGUg
cG9pbnQgb3V0IG9mIHN0ci4KICAgIHZh
ciBjID0gc3RyLmNoYXJDb2RlQXQoaSk7
CiAgICBpZiAoMHhEQzAwIDw9IGMgJiYg
YyA8PSAweERGRkYpIHsKICAgICAgYyA9
IDB4RkZGRDsKICAgIH0gZWxzZSBpZiAo
MHhEODAwIDw9IGMgJiYgYyA8PSAweERC
RkYpIHsKICAgICAgaWYgKGkrMSA8IHN0
ci5sZW5ndGgpIHsKICAgICAgICB2YXIg
ZCA9IHN0ci5jaGFyQ29kZUF0KGkrMSk7
CiAgICAgICAgaWYgKDB4REMwMCA8PSBk
ICYmIGQgPD0gMHhERkZGKSB7CiAgICAg
ICAgICAvLyBTd2FsbG93IGEgc3Vycm9n
YXRlIHBhaXIuCiAgICAgICAgICBjID0g
MHgxMDAwMCArICgoYyAmIDB4M0ZGKSA8
PCAxMCkgKyAoZCAmIDB4M0ZGKTsKICAg
ICAgICAgIGkrKzsKICAgICAgICB9IGVs
c2UgewogICAgICAgICAgYyA9IDB4RkZG
RDsKICAgICAgICB9CiAgICAgIH0gZWxz
ZSB7CiAgICAgICAgYyA9IDB4RkZGRDsK
ICAgICAgfQogICAgfQoKICAgIC8vIEVu
Y29kZSBjIGluIFVURi04LgogICAgdmFy
IGJ5dGVzTGVmdDsKICAgIGlmIChjIDw9
IDB4N0YpIHsKICAgICAgcmV0ICs9IHN0
ci5jaGFyQXQoaSk7CiAgICAgIGNvbnRp
bnVlOwogICAgfSBlbHNlIGlmIChjIDw9
IDB4N0ZGKSB7CiAgICAgIHJldCArPSBT
dHJpbmcuZnJvbUNoYXJDb2RlKDB4QzAg
fCAoYyA+Pj4gNikpOwogICAgICBieXRl
c0xlZnQgPSAxOwogICAgfSBlbHNlIGlm
IChjIDw9IDB4RkZGRikgewogICAgICBy
ZXQgKz0gU3RyaW5nLmZyb21DaGFyQ29k
ZSgweEUwIHwgKGMgPj4+IDEyKSk7CiAg
ICAgIGJ5dGVzTGVmdCA9IDI7CiAgICB9
IGVsc2UgLyogaWYgKGMgPD0gMHgxMEZG
RkYpICovIHsKICAgICAgcmV0ICs9IFN0
cmluZy5mcm9tQ2hhckNvZGUoMHhGMCB8
IChjID4+PiAxOCkpOwogICAgICBieXRl
c0xlZnQgPSAzOwogICAgfQoKICAgIHdo
aWxlIChieXRlc0xlZnQgPiAwKSB7CiAg
ICAgIGJ5dGVzTGVmdC0tOwogICAgICBy
ZXQgKz0gU3RyaW5nLmZyb21DaGFyQ29k
ZSgweDgwIHwgKChjID4+PiAoNiAqIGJ5
dGVzTGVmdCkpICYgMHgzRikpOwogICAg
fQogIH0KICByZXR1cm4gcmV0Owp9Owov
LyBTT1VSQ0UgRklMRTogbGliZG90L2pz
L2xpYl93Yy5qcwovLyBDb3B5cmlnaHQg
KGMpIDIwMTQgVGhlIENocm9taXVtIE9T
IEF1dGhvcnMuIEFsbCByaWdodHMgcmVz
ZXJ2ZWQuCi8vIFVzZSBvZiBsaWIud2Mg
c291cmNlIGNvZGUgaXMgZ292ZXJuZWQg
YnkgYSBCU0Qtc3R5bGUgbGljZW5zZSB0
aGF0IGNhbiBiZQovLyBmb3VuZCBpbiB0
aGUgTElDRU5TRSBmaWxlLgoKJ3VzZSBz
dHJpY3QnOwoKLyoqCiAqIFRoaXMgSmF2
YVNjcmlwdCBsaWJyYXJ5IGlzIHBvcnRl
ZCBmcm9tIHRoZSB3Y3dpZHRoLmpzIG1v
ZHVsZSBvZiBub2RlLmpzLgogKiBUaGUg
b3JpZ2luYWwgaW1wbGVtZW50YXRpb24g
Y2FuIGJlIGZvdW5kIGF0OgogKiBodHRw
czovL25wbWpzLm9yZy9wYWNrYWdlL3dj
d2lkdGguanMKICovCgovKioKICogSmF2
YVNjcmlwdCBwb3J0aW5nIG9mIE1hcmt1
cyBLdWhuJ3Mgd2N3aWR0aCgpIGltcGxl
bWVudGF0aW9uCiAqCiAqIFRoZSBmb2xs
b3dpbmcgZXhwbGFuYXRpb24gY29tZXMg
ZnJvbSB0aGUgb3JpZ2luYWwgQyBpbXBs
ZW1lbnRhdGlvbjoKICoKICogVGhpcyBp
cyBhbiBpbXBsZW1lbnRhdGlvbiBvZiB3
Y3dpZHRoKCkgYW5kIHdjc3dpZHRoKCkg
KGRlZmluZWQgaW4KICogSUVFRSBTdGQg
MTAwMi4xLTIwMDEpIGZvciBVbmljb2Rl
LgogKgogKiBodHRwOi8vd3d3Lm9wZW5n
cm91cC5vcmcvb25saW5lcHVicy8wMDc5
MDQ5NzUvZnVuY3Rpb25zL3djd2lkdGgu
aHRtbAogKiBodHRwOi8vd3d3Lm9wZW5n
cm91cC5vcmcvb25saW5lcHVicy8wMDc5
MDQ5NzUvZnVuY3Rpb25zL3djc3dpZHRo
Lmh0bWwKICoKICogSW4gZml4ZWQtd2lk
dGggb3V0cHV0IGRldmljZXMsIExhdGlu
IGNoYXJhY3RlcnMgYWxsIG9jY3VweSBh
IHNpbmdsZQogKiAiY2VsbCIgcG9zaXRp
b24gb2YgZXF1YWwgd2lkdGgsIHdoZXJl
YXMgaWRlb2dyYXBoaWMgQ0pLIGNoYXJh
Y3RlcnMKICogb2NjdXB5IHR3byBzdWNo
IGNlbGxzLiBJbnRlcm9wZXJhYmlsaXR5
IGJldHdlZW4gdGVybWluYWwtbGluZQog
KiBhcHBsaWNhdGlvbnMgYW5kICh0ZWxl
dHlwZS1zdHlsZSkgY2hhcmFjdGVyIHRl
cm1pbmFscyB1c2luZyB0aGUKICogVVRG
LTggZW5jb2RpbmcgcmVxdWlyZXMgYWdy
ZWVtZW50IG9uIHdoaWNoIGNoYXJhY3Rl
ciBzaG91bGQgYWR2YW5jZQogKiB0aGUg
Y3Vyc29yIGJ5IGhvdyBtYW55IGNlbGwg
cG9zaXRpb25zLiBObyBlc3RhYmxpc2hl
ZCBmb3JtYWwKICogc3RhbmRhcmRzIGV4
aXN0IGF0IHByZXNlbnQgb24gd2hpY2gg
VW5pY29kZSBjaGFyYWN0ZXIgc2hhbGwg
b2NjdXB5CiAqIGhvdyBtYW55IGNlbGwg
cG9zaXRpb25zIG9uIGNoYXJhY3RlciB0
ZXJtaW5hbHMuIFRoZXNlIHJvdXRpbmVz
IGFyZQogKiBhIGZpcnN0IGF0dGVtcHQg
b2YgZGVmaW5pbmcgc3VjaCBiZWhhdmlv
ciBiYXNlZCBvbiBzaW1wbGUgcnVsZXMK
ICogYXBwbGllZCB0byBkYXRhIHByb3Zp
ZGVkIGJ5IHRoZSBVbmljb2RlIENvbnNv
cnRpdW0uCiAqCiAqIEZvciBzb21lIGdy
YXBoaWNhbCBjaGFyYWN0ZXJzLCB0aGUg
VW5pY29kZSBzdGFuZGFyZCBleHBsaWNp
dGx5CiAqIGRlZmluZXMgYSBjaGFyYWN0
ZXItY2VsbCB3aWR0aCB2aWEgdGhlIGRl
ZmluaXRpb24gb2YgdGhlIEVhc3QgQXNp
YW4KICogRnVsbFdpZHRoIChGKSwgV2lk
ZSAoVyksIEhhbGYtd2lkdGggKEgpLCBh
bmQgTmFycm93IChOYSkgY2xhc3Nlcy4K
ICogSW4gYWxsIHRoZXNlIGNhc2VzLCB0
aGVyZSBpcyBubyBhbWJpZ3VpdHkgYWJv
dXQgd2hpY2ggd2lkdGggYQogKiB0ZXJt
aW5hbCBzaGFsbCB1c2UuIEZvciBjaGFy
YWN0ZXJzIGluIHRoZSBFYXN0IEFzaWFu
IEFtYmlndW91cyAoQSkKICogY2xhc3Ms
IHRoZSB3aWR0aCBjaG9pY2UgZGVwZW5k
cyBwdXJlbHkgb24gYSBwcmVmZXJlbmNl
IG9mIGJhY2t3YXJkCiAqIGNvbXBhdGli
aWxpdHkgd2l0aCBlaXRoZXIgaGlzdG9y
aWMgQ0pLIG9yIFdlc3Rlcm4gcHJhY3Rp
Y2UuCiAqIENob29zaW5nIHNpbmdsZS13
aWR0aCBmb3IgdGhlc2UgY2hhcmFjdGVy
cyBpcyBlYXN5IHRvIGp1c3RpZnkgYXMK
ICogdGhlIGFwcHJvcHJpYXRlIGxvbmct
dGVybSBzb2x1dGlvbiwgYXMgdGhlIENK
SyBwcmFjdGljZSBvZgogKiBkaXNwbGF5
aW5nIHRoZXNlIGNoYXJhY3RlcnMgYXMg
ZG91YmxlLXdpZHRoIGNvbWVzIGZyb20g
aGlzdG9yaWMKICogaW1wbGVtZW50YXRp
b24gc2ltcGxpY2l0eSAoOC1iaXQgZW5j
b2RlZCBjaGFyYWN0ZXJzIHdlcmUgZGlz
cGxheWVkCiAqIHNpbmdsZS13aWR0aCBh
bmQgMTYtYml0IG9uZXMgZG91YmxlLXdp
ZHRoLCBldmVuIGZvciBHcmVlaywKICog
Q3lyaWxsaWMsIGV0Yy4pIGFuZCBub3Qg
YW55IHR5cG9ncmFwaGljIGNvbnNpZGVy
YXRpb25zLgogKgogKiBNdWNoIGxlc3Mg
Y2xlYXIgaXMgdGhlIGNob2ljZSBvZiB3
aWR0aCBmb3IgdGhlIE5vdCBFYXN0IEFz
aWFuCiAqIChOZXV0cmFsKSBjbGFzcy4g
RXhpc3RpbmcgcHJhY3RpY2UgZG9lcyBu
b3QgZGljdGF0ZSBhIHdpZHRoIGZvciBh
bnkKICogb2YgdGhlc2UgY2hhcmFjdGVy
cy4gSXQgd291bGQgbmV2ZXJ0aGVsZXNz
IG1ha2Ugc2Vuc2UKICogdHlwb2dyYXBo
aWNhbGx5IHRvIGFsbG9jYXRlIHR3byBj
aGFyYWN0ZXIgY2VsbHMgdG8gY2hhcmFj
dGVycyBzdWNoCiAqIGFzIGZvciBpbnN0
YW5jZSBFTSBTUEFDRSBvciBWT0xVTUUg
SU5URUdSQUwsIHdoaWNoIGNhbm5vdCBi
ZQogKiByZXByZXNlbnRlZCBhZGVxdWF0
ZWx5IHdpdGggYSBzaW5nbGUtd2lkdGgg
Z2x5cGguIFRoZSBmb2xsb3dpbmcKICog
cm91dGluZXMgYXQgcHJlc2VudCBtZXJl
bHkgYXNzaWduIGEgc2luZ2xlLWNlbGwg
d2lkdGggdG8gYWxsCiAqIG5ldXRyYWwg
Y2hhcmFjdGVycywgaW4gdGhlIGludGVy
ZXN0IG9mIHNpbXBsaWNpdHkuIFRoaXMg
aXMgbm90CiAqIGVudGlyZWx5IHNhdGlz
ZmFjdG9yeSBhbmQgc2hvdWxkIGJlIHJl
Y29uc2lkZXJlZCBiZWZvcmUKICogZXN0
YWJsaXNoaW5nIGEgZm9ybWFsIHN0YW5k
YXJkIGluIGxpYi53YyBhcmVhLiBBdCB0
aGUgbW9tZW50LCB0aGUKICogZGVjaXNp
b24gd2hpY2ggTm90IEVhc3QgQXNpYW4g
KE5ldXRyYWwpIGNoYXJhY3RlcnMgc2hv
dWxkIGJlCiAqIHJlcHJlc2VudGVkIGJ5
IGRvdWJsZS13aWR0aCBnbHlwaHMgY2Fu
bm90IHlldCBiZSBhbnN3ZXJlZCBieQog
KiBhcHBseWluZyBhIHNpbXBsZSBydWxl
IGZyb20gdGhlIFVuaWNvZGUgZGF0YWJh
c2UgY29udGVudC4gU2V0dGluZwogKiB1
cCBhIHByb3BlciBzdGFuZGFyZCBmb3Ig
dGhlIGJlaGF2aW9yIG9mIFVURi04IGNo
YXJhY3RlciB0ZXJtaW5hbHMKICogd2ls
bCByZXF1aXJlIGEgY2FyZWZ1bCBhbmFs
eXNpcyBub3Qgb25seSBvZiBlYWNoIFVu
aWNvZGUgY2hhcmFjdGVyLAogKiBidXQg
YWxzbyBvZiBlYWNoIHByZXNlbnRhdGlv
biBmb3JtLCBzb21ldGhpbmcgdGhlIGF1
dGhvciBvZiB0aGVzZQogKiByb3V0aW5l
cyBoYXMgYXZvaWRlZCB0byBkbyBzbyBm
YXIuCiAqCiAqIGh0dHA6Ly93d3cudW5p
Y29kZS5vcmcvdW5pY29kZS9yZXBvcnRz
L3RyMTEvCiAqCiAqIE1hcmt1cyBLdWhu
IC0tIDIwMDctMDUtMjYgKFVuaWNvZGUg
NS4wKQogKgogKiBQZXJtaXNzaW9uIHRv
IHVzZSwgY29weSwgbW9kaWZ5LCBhbmQg
ZGlzdHJpYnV0ZSBsaWIud2Mgc29mdHdh
cmUKICogZm9yIGFueSBwdXJwb3NlIGFu
ZCB3aXRob3V0IGZlZSBpcyBoZXJlYnkg
Z3JhbnRlZC4gVGhlIGF1dGhvcgogKiBk
aXNjbGFpbXMgYWxsIHdhcnJhbnRpZXMg
d2l0aCByZWdhcmQgdG8gbGliLndjIHNv
ZnR3YXJlLgogKgogKiBMYXRlc3QgdmVy
c2lvbjogaHR0cDovL3d3dy5jbC5jYW0u
YWMudWsvfm1nazI1L3Vjcy93Y3dpZHRo
LmMKICovCgovKioKICogVGhlIGZvbGxv
d2luZyBmdW5jdGlvbiBkZWZpbmVzIHRo
ZSBjb2x1bW4gd2lkdGggb2YgYW4gSVNP
IDEwNjQ2IGNoYXJhY3RlcgogKiBhcyBm
b2xsb3dzOgogKgogKiAgLSBUaGUgbnVs
bCBjaGFyYWN0ZXIgKFUrMDAwMCkgaGFz
IGEgY29sdW1uIHdpZHRoIG9mIDAuCiAq
ICAtIE90aGVyIEMwL0MxIGNvbnRyb2wg
Y2hhcmFjdGVycyBhbmQgREVMIHdpbGwg
bGVhZCB0byBhIHJldHVybiB2YWx1ZSBv
ZiAtMS4KICogIC0gTm9uLXNwYWNpbmcg
YW5kIGVuY2xvc2luZyBjb21iaW5pbmcg
Y2hhcmFjdGVycyAoZ2VuZXJhbCBjYXRl
Z29yeSBjb2RlIE1uCiAqICAgIG9yIE1l
IGluIHRoZSBVbmljb2RlIGRhdGFiYXNl
KSBoYXZlIGEgY29sdW1uIHdpZHRoIG9m
IDAuCiAqICAtIFNPRlQgSFlQSEVOIChV
KzAwQUQpIGhhcyBhIGNvbHVtbiB3aWR0
aCBvZiAxLgogKiAgLSBPdGhlciBmb3Jt
YXQgY2hhcmFjdGVycyAoZ2VuZXJhbCBj
YXRlZ29yeSBjb2RlIENmIGluIHRoZSBV
bmljb2RlIGRhdGFiYXNlKQogKiAgICBh
bmQgWkVSTyBXSURUSCBTUEFDRSAoVSsy
MDBCKSBoYXZlIGEgY29sdW1uIHdpZHRo
IG9mIDAuCiAqICAtIEhhbmd1bCBKYW1v
IG1lZGlhbCB2b3dlbHMgYW5kIGZpbmFs
IGNvbnNvbmFudHMgKFUrMTE2MC1VKzEx
RkYpIGhhdmUgYQogKiAgICBjb2x1bW4g
d2lkdGggb2YgMC4KICogIC0gU3BhY2lu
ZyBjaGFyYWN0ZXJzIGluIHRoZSBFYXN0
IEFzaWFuIFdpZGUgKFcpIG9yIEVhc3Qg
QXNpYW4gRnVsbC13aWR0aCAoRikKICog
ICAgY2F0ZWdvcnkgYXMgZGVmaW5lZCBp
biBVbmljb2RlIFRlY2huaWNhbCBSZXBv
cnQgIzExIGhhdmUgYSBjb2x1bW4gd2lk
dGggb2YKICogICAgMi4KICogIC0gRWFz
dCBBc2lhbiBBbWJpZ291cyBjaGFyYWN0
ZXJzIGFyZSB0YWtlbiBpbnRvIGFjY291
bnQgaWYKICogICAgcmVnYXJkQ2prQW1i
aWd1b3VzIGZsYWcgaXMgZW5hYmxlZC4g
VGhleSBoYXZlIGEgY29sdW1uIHdpZHRo
IG9mIDIuCiAqICAtIEFsbCByZW1haW5p
bmcgY2hhcmFjdGVycyAoaW5jbHVkaW5n
IGFsbCBwcmludGFibGUgSVNPIDg4NTkt
MSBhbmQgV0dMNAogKiAgICBjaGFyYWN0
ZXJzLCBVbmljb2RlIGNvbnRyb2wgY2hh
cmFjdGVycywgZXRjLikgaGF2ZSBhIGNv
bHVtbiB3aWR0aCBvZiAxLgogKgogKiBU
aGlzIGltcGxlbWVudGF0aW9uIGFzc3Vt
ZXMgdGhhdCBjaGFyYWN0ZXJzIGFyZSBl
bmNvZGVkIGluIElTTyAxMDY0Ni4KICov
CgpsaWIud2MgPSB7fTsKCi8vIFdpZHRo
IG9mIGEgbnVsIGNoYXJhY3Rlci4KbGli
LndjLm51bFdpZHRoID0gMDsKCi8vIFdp
ZHRoIG9mIGEgY29udHJvbCBjaGFyYXRl
ci4KbGliLndjLmNvbnRyb2xXaWR0aCA9
IDA7CgovLyBGbGFnIHdoZXRoZXIgdG8g
Y29uc2lkZXIgRWFzdCBBc2lhbiBBbWJp
Z3VvdXMgY2hhcmFjdGVycy4KbGliLndj
LnJlZ2FyZENqa0FtYmlndW91cyA9IGZh
bHNlOwoKLy8gV2lkdGggb2YgYW4gRWFz
dCBBc2lhbiBBbWJpZ3VvdXMgY2hhcmFj
dGVyLgpsaWIud2MuY2prQW1iaWd1b3Vz
V2lkdGggPSAyOwoKLy8gU29ydGVkIGxp
c3Qgb2Ygbm9uLW92ZXJsYXBwaW5nIGlu
dGVydmFscyBvZiBub24tc3BhY2luZyBj
aGFyYWN0ZXJzCi8vIGdlbmVyYXRlZCBi
eSAidW5pc2V0ICtjYXQ9TWUgK2NhdD1N
biArY2F0PUNmIC0wMEFEICsxMTYwLTEx
RkYgKzIwMEIgYyIKbGliLndjLmNvbWJp
bmluZyA9IFsKICAgIFsgMHgwMzAwLCAw
eDAzNkYgXSwgWyAweDA0ODMsIDB4MDQ4
NiBdLCBbIDB4MDQ4OCwgMHgwNDg5IF0s
CiAgICBbIDB4MDU5MSwgMHgwNUJEIF0s
IFsgMHgwNUJGLCAweDA1QkYgXSwgWyAw
eDA1QzEsIDB4MDVDMiBdLAogICAgWyAw
eDA1QzQsIDB4MDVDNSBdLCBbIDB4MDVD
NywgMHgwNUM3IF0sIFsgMHgwNjAwLCAw
eDA2MDMgXSwKICAgIFsgMHgwNjEwLCAw
eDA2MTUgXSwgWyAweDA2NEIsIDB4MDY1
RSBdLCBbIDB4MDY3MCwgMHgwNjcwIF0s
CiAgICBbIDB4MDZENiwgMHgwNkU0IF0s
IFsgMHgwNkU3LCAweDA2RTggXSwgWyAw
eDA2RUEsIDB4MDZFRCBdLAogICAgWyAw
eDA3MEYsIDB4MDcwRiBdLCBbIDB4MDcx
MSwgMHgwNzExIF0sIFsgMHgwNzMwLCAw
eDA3NEEgXSwKICAgIFsgMHgwN0E2LCAw
eDA3QjAgXSwgWyAweDA3RUIsIDB4MDdG
MyBdLCBbIDB4MDkwMSwgMHgwOTAyIF0s
CiAgICBbIDB4MDkzQywgMHgwOTNDIF0s
IFsgMHgwOTQxLCAweDA5NDggXSwgWyAw
eDA5NEQsIDB4MDk0RCBdLAogICAgWyAw
eDA5NTEsIDB4MDk1NCBdLCBbIDB4MDk2
MiwgMHgwOTYzIF0sIFsgMHgwOTgxLCAw
eDA5ODEgXSwKICAgIFsgMHgwOUJDLCAw
eDA5QkMgXSwgWyAweDA5QzEsIDB4MDlD
NCBdLCBbIDB4MDlDRCwgMHgwOUNEIF0s
CiAgICBbIDB4MDlFMiwgMHgwOUUzIF0s
IFsgMHgwQTAxLCAweDBBMDIgXSwgWyAw
eDBBM0MsIDB4MEEzQyBdLAogICAgWyAw
eDBBNDEsIDB4MEE0MiBdLCBbIDB4MEE0
NywgMHgwQTQ4IF0sIFsgMHgwQTRCLCAw
eDBBNEQgXSwKICAgIFsgMHgwQTcwLCAw
eDBBNzEgXSwgWyAweDBBODEsIDB4MEE4
MiBdLCBbIDB4MEFCQywgMHgwQUJDIF0s
CiAgICBbIDB4MEFDMSwgMHgwQUM1IF0s
IFsgMHgwQUM3LCAweDBBQzggXSwgWyAw
eDBBQ0QsIDB4MEFDRCBdLAogICAgWyAw
eDBBRTIsIDB4MEFFMyBdLCBbIDB4MEIw
MSwgMHgwQjAxIF0sIFsgMHgwQjNDLCAw
eDBCM0MgXSwKICAgIFsgMHgwQjNGLCAw
eDBCM0YgXSwgWyAweDBCNDEsIDB4MEI0
MyBdLCBbIDB4MEI0RCwgMHgwQjREIF0s
CiAgICBbIDB4MEI1NiwgMHgwQjU2IF0s
IFsgMHgwQjgyLCAweDBCODIgXSwgWyAw
eDBCQzAsIDB4MEJDMCBdLAogICAgWyAw
eDBCQ0QsIDB4MEJDRCBdLCBbIDB4MEMz
RSwgMHgwQzQwIF0sIFsgMHgwQzQ2LCAw
eDBDNDggXSwKICAgIFsgMHgwQzRBLCAw
eDBDNEQgXSwgWyAweDBDNTUsIDB4MEM1
NiBdLCBbIDB4MENCQywgMHgwQ0JDIF0s
CiAgICBbIDB4MENCRiwgMHgwQ0JGIF0s
IFsgMHgwQ0M2LCAweDBDQzYgXSwgWyAw
eDBDQ0MsIDB4MENDRCBdLAogICAgWyAw
eDBDRTIsIDB4MENFMyBdLCBbIDB4MEQ0
MSwgMHgwRDQzIF0sIFsgMHgwRDRELCAw
eDBENEQgXSwKICAgIFsgMHgwRENBLCAw
eDBEQ0EgXSwgWyAweDBERDIsIDB4MERE
NCBdLCBbIDB4MERENiwgMHgwREQ2IF0s
CiAgICBbIDB4MEUzMSwgMHgwRTMxIF0s
IFsgMHgwRTM0LCAweDBFM0EgXSwgWyAw
eDBFNDcsIDB4MEU0RSBdLAogICAgWyAw
eDBFQjEsIDB4MEVCMSBdLCBbIDB4MEVC
NCwgMHgwRUI5IF0sIFsgMHgwRUJCLCAw
eDBFQkMgXSwKICAgIFsgMHgwRUM4LCAw
eDBFQ0QgXSwgWyAweDBGMTgsIDB4MEYx
OSBdLCBbIDB4MEYzNSwgMHgwRjM1IF0s
CiAgICBbIDB4MEYzNywgMHgwRjM3IF0s
IFsgMHgwRjM5LCAweDBGMzkgXSwgWyAw
eDBGNzEsIDB4MEY3RSBdLAogICAgWyAw
eDBGODAsIDB4MEY4NCBdLCBbIDB4MEY4
NiwgMHgwRjg3IF0sIFsgMHgwRjkwLCAw
eDBGOTcgXSwKICAgIFsgMHgwRjk5LCAw
eDBGQkMgXSwgWyAweDBGQzYsIDB4MEZD
NiBdLCBbIDB4MTAyRCwgMHgxMDMwIF0s
CiAgICBbIDB4MTAzMiwgMHgxMDMyIF0s
IFsgMHgxMDM2LCAweDEwMzcgXSwgWyAw
eDEwMzksIDB4MTAzOSBdLAogICAgWyAw
eDEwNTgsIDB4MTA1OSBdLCBbIDB4MTE2
MCwgMHgxMUZGIF0sIFsgMHgxMzVGLCAw
eDEzNUYgXSwKICAgIFsgMHgxNzEyLCAw
eDE3MTQgXSwgWyAweDE3MzIsIDB4MTcz
NCBdLCBbIDB4MTc1MiwgMHgxNzUzIF0s
CiAgICBbIDB4MTc3MiwgMHgxNzczIF0s
IFsgMHgxN0I0LCAweDE3QjUgXSwgWyAw
eDE3QjcsIDB4MTdCRCBdLAogICAgWyAw
eDE3QzYsIDB4MTdDNiBdLCBbIDB4MTdD
OSwgMHgxN0QzIF0sIFsgMHgxN0RELCAw
eDE3REQgXSwKICAgIFsgMHgxODBCLCAw
eDE4MEQgXSwgWyAweDE4QTksIDB4MThB
OSBdLCBbIDB4MTkyMCwgMHgxOTIyIF0s
CiAgICBbIDB4MTkyNywgMHgxOTI4IF0s
IFsgMHgxOTMyLCAweDE5MzIgXSwgWyAw
eDE5MzksIDB4MTkzQiBdLAogICAgWyAw
eDFBMTcsIDB4MUExOCBdLCBbIDB4MUIw
MCwgMHgxQjAzIF0sIFsgMHgxQjM0LCAw
eDFCMzQgXSwKICAgIFsgMHgxQjM2LCAw
eDFCM0EgXSwgWyAweDFCM0MsIDB4MUIz
QyBdLCBbIDB4MUI0MiwgMHgxQjQyIF0s
CiAgICBbIDB4MUI2QiwgMHgxQjczIF0s
IFsgMHgxREMwLCAweDFEQ0EgXSwgWyAw
eDFERkUsIDB4MURGRiBdLAogICAgWyAw
eDIwMEIsIDB4MjAwRiBdLCBbIDB4MjAy
QSwgMHgyMDJFIF0sIFsgMHgyMDYwLCAw
eDIwNjMgXSwKICAgIFsgMHgyMDZBLCAw
eDIwNkYgXSwgWyAweDIwRDAsIDB4MjBF
RiBdLCBbIDB4MzAyQSwgMHgzMDJGIF0s
CiAgICBbIDB4MzA5OSwgMHgzMDlBIF0s
IFsgMHhBODA2LCAweEE4MDYgXSwgWyAw
eEE4MEIsIDB4QTgwQiBdLAogICAgWyAw
eEE4MjUsIDB4QTgyNiBdLCBbIDB4RkIx
RSwgMHhGQjFFIF0sIFsgMHhGRTAwLCAw
eEZFMEYgXSwKICAgIFsgMHhGRTIwLCAw
eEZFMjMgXSwgWyAweEZFRkYsIDB4RkVG
RiBdLCBbIDB4RkZGOSwgMHhGRkZCIF0s
CiAgICBbIDB4MTBBMDEsIDB4MTBBMDMg
XSwgWyAweDEwQTA1LCAweDEwQTA2IF0s
IFsgMHgxMEEwQywgMHgxMEEwRiBdLAog
ICAgWyAweDEwQTM4LCAweDEwQTNBIF0s
IFsgMHgxMEEzRiwgMHgxMEEzRiBdLCBb
IDB4MUQxNjcsIDB4MUQxNjkgXSwKICAg
IFsgMHgxRDE3MywgMHgxRDE4MiBdLCBb
IDB4MUQxODUsIDB4MUQxOEIgXSwgWyAw
eDFEMUFBLCAweDFEMUFEIF0sCiAgICBb
IDB4MUQyNDIsIDB4MUQyNDQgXSwgWyAw
eEUwMDAxLCAweEUwMDAxIF0sIFsgMHhF
MDAyMCwgMHhFMDA3RiBdLAogICAgWyAw
eEUwMTAwLCAweEUwMUVGIF0KXTsKCi8v
IFNvcnRlZCBsaXN0IG9mIG5vbi1vdmVy
bGFwcGluZyBpbnRlcnZhbHMgb2YgRWFz
dCBBc2lhbiBBbWJpZ3VvdXMgY2hhcmFj
dGVycwovLyBnZW5lcmF0ZWQgYnkgInVu
aXNldCArV0lEVEgtQSAtY2F0PU1lIC1j
YXQ9TW4gLWNhdD1DZiBjIgpsaWIud2Mu
YW1iaWd1b3VzID0gWwogICAgWyAweDAw
QTEsIDB4MDBBMSBdLCBbIDB4MDBBNCwg
MHgwMEE0IF0sIFsgMHgwMEE3LCAweDAw
QTggXSwKICAgIFsgMHgwMEFBLCAweDAw
QUEgXSwgWyAweDAwQUUsIDB4MDBBRSBd
LCBbIDB4MDBCMCwgMHgwMEI0IF0sCiAg
ICBbIDB4MDBCNiwgMHgwMEJBIF0sIFsg
MHgwMEJDLCAweDAwQkYgXSwgWyAweDAw
QzYsIDB4MDBDNiBdLAogICAgWyAweDAw
RDAsIDB4MDBEMCBdLCBbIDB4MDBENywg
MHgwMEQ4IF0sIFsgMHgwMERFLCAweDAw
RTEgXSwKICAgIFsgMHgwMEU2LCAweDAw
RTYgXSwgWyAweDAwRTgsIDB4MDBFQSBd
LCBbIDB4MDBFQywgMHgwMEVEIF0sCiAg
ICBbIDB4MDBGMCwgMHgwMEYwIF0sIFsg
MHgwMEYyLCAweDAwRjMgXSwgWyAweDAw
RjcsIDB4MDBGQSBdLAogICAgWyAweDAw
RkMsIDB4MDBGQyBdLCBbIDB4MDBGRSwg
MHgwMEZFIF0sIFsgMHgwMTAxLCAweDAx
MDEgXSwKICAgIFsgMHgwMTExLCAweDAx
MTEgXSwgWyAweDAxMTMsIDB4MDExMyBd
LCBbIDB4MDExQiwgMHgwMTFCIF0sCiAg
ICBbIDB4MDEyNiwgMHgwMTI3IF0sIFsg
MHgwMTJCLCAweDAxMkIgXSwgWyAweDAx
MzEsIDB4MDEzMyBdLAogICAgWyAweDAx
MzgsIDB4MDEzOCBdLCBbIDB4MDEzRiwg
MHgwMTQyIF0sIFsgMHgwMTQ0LCAweDAx
NDQgXSwKICAgIFsgMHgwMTQ4LCAweDAx
NEIgXSwgWyAweDAxNEQsIDB4MDE0RCBd
LCBbIDB4MDE1MiwgMHgwMTUzIF0sCiAg
ICBbIDB4MDE2NiwgMHgwMTY3IF0sIFsg
MHgwMTZCLCAweDAxNkIgXSwgWyAweDAx
Q0UsIDB4MDFDRSBdLAogICAgWyAweDAx
RDAsIDB4MDFEMCBdLCBbIDB4MDFEMiwg
MHgwMUQyIF0sIFsgMHgwMUQ0LCAweDAx
RDQgXSwKICAgIFsgMHgwMUQ2LCAweDAx
RDYgXSwgWyAweDAxRDgsIDB4MDFEOCBd
LCBbIDB4MDFEQSwgMHgwMURBIF0sCiAg
ICBbIDB4MDFEQywgMHgwMURDIF0sIFsg
MHgwMjUxLCAweDAyNTEgXSwgWyAweDAy
NjEsIDB4MDI2MSBdLAogICAgWyAweDAy
QzQsIDB4MDJDNCBdLCBbIDB4MDJDNywg
MHgwMkM3IF0sIFsgMHgwMkM5LCAweDAy
Q0IgXSwKICAgIFsgMHgwMkNELCAweDAy
Q0QgXSwgWyAweDAyRDAsIDB4MDJEMCBd
LCBbIDB4MDJEOCwgMHgwMkRCIF0sCiAg
ICBbIDB4MDJERCwgMHgwMkREIF0sIFsg
MHgwMkRGLCAweDAyREYgXSwgWyAweDAz
OTEsIDB4MDNBMSBdLAogICAgWyAweDAz
QTMsIDB4MDNBOSBdLCBbIDB4MDNCMSwg
MHgwM0MxIF0sIFsgMHgwM0MzLCAweDAz
QzkgXSwKICAgIFsgMHgwNDAxLCAweDA0
MDEgXSwgWyAweDA0MTAsIDB4MDQ0RiBd
LCBbIDB4MDQ1MSwgMHgwNDUxIF0sCiAg
ICBbIDB4MjAxMCwgMHgyMDEwIF0sIFsg
MHgyMDEzLCAweDIwMTYgXSwgWyAweDIw
MTgsIDB4MjAxOSBdLAogICAgWyAweDIw
MUMsIDB4MjAxRCBdLCBbIDB4MjAyMCwg
MHgyMDIyIF0sIFsgMHgyMDI0LCAweDIw
MjcgXSwKICAgIFsgMHgyMDMwLCAweDIw
MzAgXSwgWyAweDIwMzIsIDB4MjAzMyBd
LCBbIDB4MjAzNSwgMHgyMDM1IF0sCiAg
ICBbIDB4MjAzQiwgMHgyMDNCIF0sIFsg
MHgyMDNFLCAweDIwM0UgXSwgWyAweDIw
NzQsIDB4MjA3NCBdLAogICAgWyAweDIw
N0YsIDB4MjA3RiBdLCBbIDB4MjA4MSwg
MHgyMDg0IF0sIFsgMHgyMEFDLCAweDIw
QUMgXSwKICAgIFsgMHgyMTAzLCAweDIx
MDMgXSwgWyAweDIxMDUsIDB4MjEwNSBd
LCBbIDB4MjEwOSwgMHgyMTA5IF0sCiAg
ICBbIDB4MjExMywgMHgyMTEzIF0sIFsg
MHgyMTE2LCAweDIxMTYgXSwgWyAweDIx
MjEsIDB4MjEyMiBdLAogICAgWyAweDIx
MjYsIDB4MjEyNiBdLCBbIDB4MjEyQiwg
MHgyMTJCIF0sIFsgMHgyMTUzLCAweDIx
NTQgXSwKICAgIFsgMHgyMTVCLCAweDIx
NUUgXSwgWyAweDIxNjAsIDB4MjE2QiBd
LCBbIDB4MjE3MCwgMHgyMTc5IF0sCiAg
ICBbIDB4MjE5MCwgMHgyMTk5IF0sIFsg
MHgyMUI4LCAweDIxQjkgXSwgWyAweDIx
RDIsIDB4MjFEMiBdLAogICAgWyAweDIx
RDQsIDB4MjFENCBdLCBbIDB4MjFFNywg
MHgyMUU3IF0sIFsgMHgyMjAwLCAweDIy
MDAgXSwKICAgIFsgMHgyMjAyLCAweDIy
MDMgXSwgWyAweDIyMDcsIDB4MjIwOCBd
LCBbIDB4MjIwQiwgMHgyMjBCIF0sCiAg
ICBbIDB4MjIwRiwgMHgyMjBGIF0sIFsg
MHgyMjExLCAweDIyMTEgXSwgWyAweDIy
MTUsIDB4MjIxNSBdLAogICAgWyAweDIy
MUEsIDB4MjIxQSBdLCBbIDB4MjIxRCwg
MHgyMjIwIF0sIFsgMHgyMjIzLCAweDIy
MjMgXSwKICAgIFsgMHgyMjI1LCAweDIy
MjUgXSwgWyAweDIyMjcsIDB4MjIyQyBd
LCBbIDB4MjIyRSwgMHgyMjJFIF0sCiAg
ICBbIDB4MjIzNCwgMHgyMjM3IF0sIFsg
MHgyMjNDLCAweDIyM0QgXSwgWyAweDIy
NDgsIDB4MjI0OCBdLAogICAgWyAweDIy
NEMsIDB4MjI0QyBdLCBbIDB4MjI1Miwg
MHgyMjUyIF0sIFsgMHgyMjYwLCAweDIy
NjEgXSwKICAgIFsgMHgyMjY0LCAweDIy
NjcgXSwgWyAweDIyNkEsIDB4MjI2QiBd
LCBbIDB4MjI2RSwgMHgyMjZGIF0sCiAg
ICBbIDB4MjI4MiwgMHgyMjgzIF0sIFsg
MHgyMjg2LCAweDIyODcgXSwgWyAweDIy
OTUsIDB4MjI5NSBdLAogICAgWyAweDIy
OTksIDB4MjI5OSBdLCBbIDB4MjJBNSwg
MHgyMkE1IF0sIFsgMHgyMkJGLCAweDIy
QkYgXSwKICAgIFsgMHgyMzEyLCAweDIz
MTIgXSwgWyAweDI0NjAsIDB4MjRFOSBd
LCBbIDB4MjRFQiwgMHgyNTRCIF0sCiAg
ICBbIDB4MjU1MCwgMHgyNTczIF0sIFsg
MHgyNTgwLCAweDI1OEYgXSwgWyAweDI1
OTIsIDB4MjU5NSBdLAogICAgWyAweDI1
QTAsIDB4MjVBMSBdLCBbIDB4MjVBMywg
MHgyNUE5IF0sIFsgMHgyNUIyLCAweDI1
QjMgXSwKICAgIFsgMHgyNUI2LCAweDI1
QjcgXSwgWyAweDI1QkMsIDB4MjVCRCBd
LCBbIDB4MjVDMCwgMHgyNUMxIF0sCiAg
ICBbIDB4MjVDNiwgMHgyNUM4IF0sIFsg
MHgyNUNCLCAweDI1Q0IgXSwgWyAweDI1
Q0UsIDB4MjVEMSBdLAogICAgWyAweDI1
RTIsIDB4MjVFNSBdLCBbIDB4MjVFRiwg
MHgyNUVGIF0sIFsgMHgyNjA1LCAweDI2
MDYgXSwKICAgIFsgMHgyNjA5LCAweDI2
MDkgXSwgWyAweDI2MEUsIDB4MjYwRiBd
LCBbIDB4MjYxNCwgMHgyNjE1IF0sCiAg
ICBbIDB4MjYxQywgMHgyNjFDIF0sIFsg
MHgyNjFFLCAweDI2MUUgXSwgWyAweDI2
NDAsIDB4MjY0MCBdLAogICAgWyAweDI2
NDIsIDB4MjY0MiBdLCBbIDB4MjY2MCwg
MHgyNjYxIF0sIFsgMHgyNjYzLCAweDI2
NjUgXSwKICAgIFsgMHgyNjY3LCAweDI2
NkEgXSwgWyAweDI2NkMsIDB4MjY2RCBd
LCBbIDB4MjY2RiwgMHgyNjZGIF0sCiAg
ICBbIDB4MjczRCwgMHgyNzNEIF0sIFsg
MHgyNzc2LCAweDI3N0YgXSwgWyAweEUw
MDAsIDB4RjhGRiBdLAogICAgWyAweEZG
RkQsIDB4RkZGRCBdLCBbIDB4RjAwMDAs
IDB4RkZGRkQgXSwgWyAweDEwMDAwMCwg
MHgxMEZGRkQgXQpdOwoKLyoqCiAqIEJp
bmFyeSBzZWFyY2ggdG8gY2hlY2sgaWYg
dGhlIGdpdmVuIHVuaWNvZGUgY2hhcmFj
dGVyIGlzIGEgc3BhY2UgY2hhcmFjdGVy
LgogKgogKiBAcGFyYW0ge2ludGVyZ2Vy
fSB1Y3MgQSB1bmljb2RlIGNoYXJhY3Rl
ciBjb2RlLgogKgogKiBAcmV0dXJuIHti
b29sZWFufSBUcnVlIGlmIHRoZSBnaXZl
biBjaGFyYWN0ZXIgaXMgYSBzcGFjZSBj
aGFyYWN0ZXI7IGZhbHNlCiAqICAgICBv
dGhlcndpc2UuCiAqLwpsaWIud2MuaXNT
cGFjZSA9IGZ1bmN0aW9uKHVjcykgewog
IC8vIEF1eGlsaWFyeSBmdW5jdGlvbiBm
b3IgYmluYXJ5IHNlYXJjaCBpbiBpbnRl
cnZhbCB0YWJsZS4KICB2YXIgbWluID0g
MCwgbWF4ID0gbGliLndjLmNvbWJpbmlu
Zy5sZW5ndGggLSAxOwogIHZhciBtaWQ7
CgogIGlmICh1Y3MgPCBsaWIud2MuY29t
YmluaW5nWzBdWzBdIHx8IHVjcyA+IGxp
Yi53Yy5jb21iaW5pbmdbbWF4XVsxXSkK
ICAgIHJldHVybiBmYWxzZTsKICB3aGls
ZSAobWF4ID49IG1pbikgewogICAgbWlk
ID0gTWF0aC5mbG9vcigobWluICsgbWF4
KSAvIDIpOwogICAgaWYgKHVjcyA+IGxp
Yi53Yy5jb21iaW5pbmdbbWlkXVsxXSkg
ewogICAgICBtaW4gPSBtaWQgKyAxOwog
ICAgfSBlbHNlIGlmICh1Y3MgPCBsaWIu
d2MuY29tYmluaW5nW21pZF1bMF0pIHsK
ICAgICAgbWF4ID0gbWlkIC0gMTsKICAg
IH0gZWxzZSB7CiAgICAgIHJldHVybiB0
cnVlOwogICAgfQogIH0KCiAgcmV0dXJu
IGZhbHNlOwp9OwoKLyoqCiAqIEF1eGls
aWFyeSBmdW5jdGlvbiBmb3IgY2hlY2tp
bmcgaWYgdGhlIGdpdmVuIHVuaWNvZGUg
Y2hhcmFjdGVyIGlzIGEgRWFzdAogKiBB
c2lhbiBBbWJpZ3VvdXMgY2hhcmFjdGVy
LgogKgogKiBAcGFyYW0ge2ludGVyZ2Vy
fSB1Y3MgQSB1bmljb2RlIGNoYXJhY3Rl
ciBjb2RlLgogKgogKiBAcmV0dXJuIHti
b29sZWFufSBUcnVlIGlmIHRoZSBnaXZl
biBjaGFyYWN0ZXIgaXMgYSBFYXN0IEFz
aWFuIEFtYmlndW91cwogKiBjaGFyYWN0
ZXIuCiAqLwpsaWIud2MuaXNDamtBbWJp
Z3VvdXMgPSBmdW5jdGlvbih1Y3MpIHsK
ICB2YXIgbWluID0gMCwgbWF4ID0gbGli
LndjLmFtYmlndW91cy5sZW5ndGggLSAx
OwogIHZhciBtaWQ7CgogIGlmICh1Y3Mg
PCBsaWIud2MuYW1iaWd1b3VzWzBdWzBd
IHx8IHVjcyA+IGxpYi53Yy5hbWJpZ3Vv
dXNbbWF4XVsxXSkKICAgIHJldHVybiBm
YWxzZTsKICB3aGlsZSAobWF4ID49IG1p
bikgewogICAgbWlkID0gTWF0aC5mbG9v
cigobWluICsgbWF4KSAvIDIpOwogICAg
aWYgKHVjcyA+IGxpYi53Yy5hbWJpZ3Vv
dXNbbWlkXVsxXSkgewogICAgICBtaW4g
PSBtaWQgKyAxOwogICAgfSBlbHNlIGlm
ICh1Y3MgPCBsaWIud2MuYW1iaWd1b3Vz
W21pZF1bMF0pIHsKICAgICAgbWF4ID0g
bWlkIC0gMTsKICAgIH0gZWxzZSB7CiAg
ICAgIHJldHVybiB0cnVlOwogICAgfQog
IH0KCiAgcmV0dXJuIGZhbHNlOwp9OwoK
LyoqCiAqIERldGVybWluZSB0aGUgY29s
dW1uIHdpZHRoIG9mIHRoZSBnaXZlbiBj
aGFyYWN0ZXIuCiAqCiAqIEBwYXJhbSB7
aW50ZWdlcn0gdWNzIEEgdW5pY29kZSBj
aGFyYWN0ZXIgY29kZS4KICoKICogQHJl
dHVybiB7aW50ZWdlcn0gVGhlIGNvbHVt
biB3aWR0aCBvZiB0aGUgZ2l2ZW4gY2hh
cmFjdGVyLgogKi8KbGliLndjLmNoYXJX
aWR0aCA9IGZ1bmN0aW9uKHVjcykgewog
IGlmIChsaWIud2MucmVnYXJkQ2prQW1i
aWd1b3VzKSB7CiAgICByZXR1cm4gbGli
LndjLmNoYXJXaWR0aFJlZ2FyZEFtYmln
dW91cyh1Y3MpOwogIH0gZWxzZSB7CiAg
ICByZXR1cm4gbGliLndjLmNoYXJXaWR0
aERpc3JlZ2FyZEFtYmlndW91cyh1Y3Mp
OwogIH0KfTsKCi8qKgogKiBEZXRlcm1p
bmUgdGhlIGNvbHVtbiB3aWR0aCBvZiB0
aGUgZ2l2ZW4gY2hhcmFjdGVyIHdpdGhv
dXQgY29uc2lkZXJpbmcgRWFzdAogKiBB
c2lhbiBBbWJpZ3VvdXMgY2hhcmFjdGVy
cy4KICoKICogQHBhcmFtIHtpbnRlZ2Vy
fSB1Y3MgQSB1bmljb2RlIGNoYXJhY3Rl
ciBjb2RlLgogKgogKiBAcmV0dXJuIHtp
bnRlZ2VyfSBUaGUgY29sdW1uIHdpZHRo
IG9mIHRoZSBnaXZlbiBjaGFyYWN0ZXIu
CiAqLwpsaWIud2MuY2hhcldpZHRoRGlz
cmVnYXJkQW1iaWd1b3VzID0gZnVuY3Rp
b24odWNzKSB7CiAgLy8gVGVzdCBmb3Ig
OC1iaXQgY29udHJvbCBjaGFyYWN0ZXJz
LgogIGlmICh1Y3MgPT09IDApCiAgICBy
ZXR1cm4gbGliLndjLm51bFdpZHRoOwog
IGlmICh1Y3MgPCAzMiB8fCAodWNzID49
IDB4N2YgJiYgdWNzIDwgMHhhMCkpCiAg
ICByZXR1cm4gbGliLndjLmNvbnRyb2xX
aWR0aDsKCiAgLy8gT3B0aW1pemUgZm9y
IEFTQ0lJIGNoYXJhY3RlcnMuCiAgaWYg
KHVjcyA8IDB4N2YpCiAgICByZXR1cm4g
MTsKCiAgLy8gQmluYXJ5IHNlYXJjaCBp
biB0YWJsZSBvZiBub24tc3BhY2luZyBj
aGFyYWN0ZXJzLgogIGlmIChsaWIud2Mu
aXNTcGFjZSh1Y3MpKQogICAgcmV0dXJu
IDA7CgogIC8vIElmIHdlIGFycml2ZSBo
ZXJlLCB1Y3MgaXMgbm90IGEgY29tYmlu
aW5nIG9yIEMwL0MxIGNvbnRyb2wgY2hh
cmFjdGVyLgogIHJldHVybiAxICsKICAg
ICh1Y3MgPj0gMHgxMTAwICYmCiAgICAg
KHVjcyA8PSAweDExNWYgfHwgICAgICAg
ICAgICAgLy8gSGFuZ3VsIEphbW8gaW5p
dC4gY29uc29uYW50cwogICAgICB1Y3Mg
PT0gMHgyMzI5IHx8IHVjcyA9PSAweDIz
MmEgfHwKICAgICAgKHVjcyA+PSAweDJl
ODAgJiYgdWNzIDw9IDB4YTRjZiAmJgog
ICAgICAgdWNzICE9IDB4MzAzZikgfHwg
ICAgICAgICAgIC8vIENKSyAuLi4gWWkK
ICAgICAgKHVjcyA+PSAweGFjMDAgJiYg
dWNzIDw9IDB4ZDdhMykgfHwgIC8vIEhh
bmd1bCBTeWxsYWJsZXMKICAgICAgKHVj
cyA+PSAweGY5MDAgJiYgdWNzIDw9IDB4
ZmFmZikgfHwgIC8vIENKSyBDb21wYXRp
YmlsaXR5IElkZW9ncmFwaHMKICAgICAg
KHVjcyA+PSAweGZlMTAgJiYgdWNzIDw9
IDB4ZmUxOSkgfHwgIC8vIFZlcnRpY2Fs
IGZvcm1zCiAgICAgICh1Y3MgPj0gMHhm
ZTMwICYmIHVjcyA8PSAweGZlNmYpIHx8
ICAvLyBDSksgQ29tcGF0aWJpbGl0eSBG
b3JtcwogICAgICAodWNzID49IDB4ZmYw
MCAmJiB1Y3MgPD0gMHhmZjYwKSB8fCAg
Ly8gRnVsbHdpZHRoIEZvcm1zCiAgICAg
ICh1Y3MgPj0gMHhmZmUwICYmIHVjcyA8
PSAweGZmZTYpIHx8CiAgICAgICh1Y3Mg
Pj0gMHgyMDAwMCAmJiB1Y3MgPD0gMHgy
ZmZmZCkgfHwKICAgICAgKHVjcyA+PSAw
eDMwMDAwICYmIHVjcyA8PSAweDNmZmZk
KSkpOwp9OwoKLyoqCiAqIERldGVybWlu
ZSB0aGUgY29sdW1uIHdpZHRoIG9mIHRo
ZSBnaXZlbiBjaGFyYWN0ZXIgY29uc2lk
ZXJpbmcgRWFzdCBBc2lhbgogKiBBbWJp
Z3VvdXMgY2hhcmFjdGVycy4KICoKICog
QHBhcmFtIHtpbnRlZ2VyfSB1Y3MgQSB1
bmljb2RlIGNoYXJhY3RlciBjb2RlLgog
KgogKiBAcmV0dXJuIHtpbnRlZ2VyfSBU
aGUgY29sdW1uIHdpZHRoIG9mIHRoZSBn
aXZlbiBjaGFyYWN0ZXIuCiAqLwpsaWIu
d2MuY2hhcldpZHRoUmVnYXJkQW1iaWd1
b3VzID0gZnVuY3Rpb24odWNzKSB7CiAg
aWYgKGxpYi53Yy5pc0Nqa0FtYmlndW91
cyh1Y3MpKQogICAgcmV0dXJuIGxpYi53
Yy5jamtBbWJpZ3VvdXNXaWR0aDsKCiAg
cmV0dXJuIGxpYi53Yy5jaGFyV2lkdGhE
aXNyZWdhcmRBbWJpZ3VvdXModWNzKTsK
fTsKCi8qKgogKiBEZXRlcm1pbmUgdGhl
IGNvbHVtbiB3aWR0aCBvZiB0aGUgZ2l2
ZW4gc3RyaW5nLgogKgogKiBAcGFyYW0g
e3N0cmluZ30gc3RyIEEgc3RyaW5nLgog
KgogKiBAcmV0dXJuIHtpbnRlZ2VyfSBU
aGUgY29sdW1uIHdpZHRoIG9mIHRoZSBn
aXZlbiBzdHJpbmcuCiAqLwpsaWIud2Mu
c3RyV2lkdGggPSBmdW5jdGlvbihzdHIp
IHsKICB2YXIgd2lkdGgsIHJ2ID0gMDsK
CiAgZm9yICh2YXIgaSA9IDA7IGkgPCBz
dHIubGVuZ3RoOyBpKyspIHsKICAgIHdp
ZHRoID0gbGliLndjLmNoYXJXaWR0aChz
dHIuY2hhckNvZGVBdChpKSk7CiAgICBp
ZiAod2lkdGggPCAwKQogICAgICByZXR1
cm4gLTE7CiAgICBydiArPSB3aWR0aDsK
ICB9CgogIHJldHVybiBydjsKfTsKCi8q
KgogKiBHZXQgdGhlIHN1YnN0cmluZyBh
dCB0aGUgZ2l2ZW4gY29sdW1uIG9mZnNl
dCBvZiB0aGUgZ2l2ZW4gY29sdW1uIHdp
ZHRoLgogKgogKiBAcGFyYW0ge3N0cmlu
Z30gc3RyIFRoZSBzdHJpbmcgdG8gZ2V0
IHN1YnN0cmluZyBmcm9tLgogKiBAcGFy
YW0ge2ludGVnZXJ9IHN0YXJ0IFRoZSBz
dGFydGluZyBjb2x1bW4gb2Zmc2V0IHRv
IGdldCBzdWJzdHJpbmcuCiAqIEBwYXJh
bSB7aW50ZWdlcn0gb3B0X3dpZHRoIFRo
ZSBjb2x1bW4gd2lkdGggb2YgdGhlIHN1
YnN0cmluZy4KICoKICogQHJldHVybiB7
c3RyaW5nfSBUaGUgc3Vic3RyaW5nLgog
Ki8KbGliLndjLnN1YnN0ciA9IGZ1bmN0
aW9uKHN0ciwgc3RhcnQsIG9wdF93aWR0
aCkgewogIHZhciBzdGFydEluZGV4LCBl
bmRJbmRleCwgd2lkdGg7CgogIGZvciAo
c3RhcnRJbmRleCA9IDAsIHdpZHRoID0g
MDsgc3RhcnRJbmRleCA8IHN0ci5sZW5n
dGg7IHN0YXJ0SW5kZXgrKykgewogICAg
d2lkdGggKz0gbGliLndjLmNoYXJXaWR0
aChzdHIuY2hhckNvZGVBdChzdGFydElu
ZGV4KSk7CiAgICBpZiAod2lkdGggPiBz
dGFydCkKICAgICAgYnJlYWs7CiAgfQoK
ICBpZiAob3B0X3dpZHRoICE9IHVuZGVm
aW5lZCkgewogICAgZm9yIChlbmRJbmRl
eCA9IHN0YXJ0SW5kZXgsIHdpZHRoID0g
MDsKICAgICAgICAgZW5kSW5kZXggPCBz
dHIubGVuZ3RoICYmIHdpZHRoIDwgb3B0
X3dpZHRoOwogICAgICAgICB3aWR0aCAr
PSBsaWIud2MuY2hhcldpZHRoKHN0ci5j
aGFyQ29kZUF0KGVuZEluZGV4KSksIGVu
ZEluZGV4KyspOwogICAgaWYgKHdpZHRo
ID4gb3B0X3dpZHRoKQogICAgICBlbmRJ
bmRleC0tOwogICAgcmV0dXJuIHN0ci5z
dWJzdHJpbmcoc3RhcnRJbmRleCwgZW5k
SW5kZXgpOwogIH0KCiAgcmV0dXJuIHN0
ci5zdWJzdHIoc3RhcnRJbmRleCk7Cn07
CgovKioKICogR2V0IHN1YnN0cmluZyBh
dCB0aGUgZ2l2ZW4gc3RhcnQgYW5kIGVu
ZCBjb2x1bW4gb2Zmc2V0LgogKgogKiBA
cGFyYW0ge3N0cmluZ30gc3RyIFRoZSBz
dHJpbmcgdG8gZ2V0IHN1YnN0cmluZyBm
cm9tLgogKiBAcGFyYW0ge2ludGVnZXJ9
IHN0YXJ0IFRoZSBzdGFydGluZyBjb2x1
bW4gb2Zmc2V0LgogKiBAcGFyYW0ge2lu
dGVnZXJ9IGVuZCBUaGUgZW5kaW5nIGNv
bHVtbiBvZmZzZXQuCiAqCiAqIEByZXR1
cm4ge3N0cmluZ30gVGhlIHN1YnN0cmlu
Zy4KICovCmxpYi53Yy5zdWJzdHJpbmcg
PSBmdW5jdGlvbihzdHIsIHN0YXJ0LCBl
bmQpIHsKICByZXR1cm4gbGliLndjLnN1
YnN0cihzdHIsIHN0YXJ0LCBlbmQgLSBz
dGFydCk7Cn07CmxpYi5yZXNvdXJjZS5h
ZGQoJ2xpYmRvdC9jaGFuZ2Vsb2cvdmVy
c2lvbicsICd0ZXh0L3BsYWluJywKJzEu
OScgKwonJwopOwoKbGliLnJlc291cmNl
LmFkZCgnbGliZG90L2NoYW5nZWxvZy9k
YXRlJywgJ3RleHQvcGxhaW4nLAonMjAx
NC0wNS0yNycgKwonJwopOwoKLy8gU09V
UkNFIEZJTEU6IGh0ZXJtL2pzL2h0ZXJt
LmpzCi8vIENvcHlyaWdodCAoYykgMjAx
MiBUaGUgQ2hyb21pdW0gT1MgQXV0aG9y
cy4gQWxsIHJpZ2h0cyByZXNlcnZlZC4K
Ly8gVXNlIG9mIHRoaXMgc291cmNlIGNv
ZGUgaXMgZ292ZXJuZWQgYnkgYSBCU0Qt
c3R5bGUgbGljZW5zZSB0aGF0IGNhbiBi
ZQovLyBmb3VuZCBpbiB0aGUgTElDRU5T
RSBmaWxlLgoKJ3VzZSBzdHJpY3QnOwoK
bGliLnJ0ZGVwKCdsaWIuU3RvcmFnZScp
OwoKLyoqCiAqIEBmaWxlb3ZlcnZpZXcg
RGVjbGFyZXMgdGhlIGh0ZXJtLiogbmFt
ZXNwYWNlIGFuZCBzb21lIGJhc2ljIHNo
YXJlZCB1dGlsaXRpZXMKICogdGhhdCBh
cmUgdG9vIHNtYWxsIHRvIGRlc2VydmUg
ZGVkaWNhdGVkIGZpbGVzLgogKi8KdmFy
IGh0ZXJtID0ge307CgovKioKICogVGhl
IHR5cGUgb2Ygd2luZG93IGhvc3Rpbmcg
aHRlcm0uCiAqCiAqIFRoaXMgaXMgc2V0
IGFzIHBhcnQgb2YgaHRlcm0uaW5pdCgp
LiAgVGhlIHZhbHVlIGlzIGludmFsaWQg
dW50aWwKICogaW5pdGlhbGl6YXRpb24g
Y29tcGxldGVzLgogKi8KaHRlcm0ud2lu
ZG93VHlwZSA9IG51bGw7CgovKioKICog
V2FybmluZyBtZXNzYWdlIHRvIGRpc3Bs
YXkgaW4gdGhlIHRlcm1pbmFsIHdoZW4g
YnJvd3NlciB6b29tIGlzIGVuYWJsZWQu
CiAqCiAqIFlvdSBjYW4gcmVwbGFjZSBp
dCB3aXRoIHlvdXIgb3duIGxvY2FsaXpl
ZCBtZXNzYWdlLgogKi8KaHRlcm0uem9v
bVdhcm5pbmdNZXNzYWdlID0gJ1pPT00g
IT0gMTAwJSc7CgovKioKICogQnJpZWYg
b3ZlcmxheSBtZXNzYWdlIGRpc3BsYXll
ZCB3aGVuIHRleHQgaXMgY29waWVkIHRv
IHRoZSBjbGlwYm9hcmQuCiAqCiAqIEJ5
IGRlZmF1bHQgaXQgaXMgdGhlIHVuaWNv
ZGUgQkxBQ0sgU0NJU1NPUlMgY2hhcmFj
dGVyLCBidXQgeW91IGNhbgogKiByZXBs
YWNlIGl0IHdpdGggeW91ciBvd24gbG9j
YWxpemVkIG1lc3NhZ2UuCiAqCiAqIFRo
aXMgaXMgb25seSBkaXNwbGF5ZWQgd2hl
biB0aGUgJ2VuYWJsZS1jbGlwYm9hcmQt
bm90aWNlJyBwcmVmZXJlbmNlCiAqIGlz
IGVuYWJsZWQuCiAqLwpodGVybS5ub3Rp
ZnlDb3B5TWVzc2FnZSA9ICdcdTI3MDIn
OwoKCi8qKgogKiBUZXh0IHNob3duIGlu
IGEgZGVza3RvcCBub3RpZmljYXRpb24g
Zm9yIHRoZSB0ZXJtaW5hbAogKiBiZWxs
LiAgXHUyMjZhIGlzIGEgdW5pY29kZSBF
SUdIVEggTk9URSwgJSh0aXRsZSkgd2ls
bAogKiBiZSByZXBsYWNlZCBieSB0aGUg
dGVybWluYWwgdGl0bGUuCiAqLwpodGVy
bS5kZXNrdG9wTm90aWZpY2F0aW9uVGl0
bGUgPSAnXHUyNjZBICUodGl0bGUpIFx1
MjY2QSc7CgovKioKICogTGlzdCBvZiBr
bm93biBodGVybSB0ZXN0IHN1aXRlcy4K
ICoKICogQSB0ZXN0IGhhcm5lc3Mgc2hv
dWxkIGVuc3VyZSB0aGF0IHRoZXkgYWxs
IGV4aXN0IGJlZm9yZSBydW5uaW5nLgog
Ki8KaHRlcm0udGVzdERlcHMgPSBbJ2h0
ZXJtLlNjcm9sbFBvcnQuVGVzdHMnLCAn
aHRlcm0uU2NyZWVuLlRlc3RzJywKICAg
ICAgICAgICAgICAgICAgJ2h0ZXJtLlRl
cm1pbmFsLlRlc3RzJywgJ2h0ZXJtLlZU
LlRlc3RzJywKICAgICAgICAgICAgICAg
ICAgJ2h0ZXJtLlZULkNhbm5lZFRlc3Rz
J107CgovKioKICogVGhlIGh0ZXJtIGlu
aXQgZnVuY3Rpb24sIHJlZ2lzdGVyZWQg
d2l0aCBsaWIucmVnaXN0ZXJJbml0KCku
CiAqCiAqIFRoaXMgaXMgY2FsbGVkIGR1
cmluZyBsaWIuaW5pdCgpLgogKgogKiBA
cGFyYW0ge2Z1bmN0aW9ufSBvbkluaXQg
VGhlIGZ1bmN0aW9uIGxpYi5pbml0KCkg
d2FudHMgdXMgdG8gaW52b2tlIHdoZW4K
ICogICAgIGluaXRpYWxpemF0aW9uIGlz
IGNvbXBsZXRlLgogKi8KbGliLnJlZ2lz
dGVySW5pdCgnaHRlcm0nLCBmdW5jdGlv
bihvbkluaXQpIHsKICBmdW5jdGlvbiBv
bldpbmRvdyh3aW5kb3cpIHsKICAgIGh0
ZXJtLndpbmRvd1R5cGUgPSB3aW5kb3cu
dHlwZTsKICAgIHNldFRpbWVvdXQob25J
bml0LCAwKTsKICB9CgogIGZ1bmN0aW9u
IG9uVGFiKHRhYikgewogICAgaWYgKHRh
YiAmJiB3aW5kb3cuY2hyb21lKSB7CiAg
ICAgIGNocm9tZS53aW5kb3dzLmdldCh0
YWIud2luZG93SWQsIG51bGwsIG9uV2lu
ZG93KTsKICAgIH0gZWxzZSB7CiAgICAg
IC8vIFRPRE8ocmdpbmRhKTogVGhpcyBp
cyB3aGVyZSB3ZSBlbmQgdXAgZm9yIGEg
djEgYXBwJ3MgYmFja2dyb3VuZCBwYWdl
LgogICAgICAvLyBNYXliZSB3aW5kb3dU
eXBlID0gJ25vbmUnIHdvdWxkIGJlIG1v
cmUgYXBwcm9wcmlhdGUsIG9yIHNvbWV0
aGluZy4KICAgICAgaHRlcm0ud2luZG93
VHlwZSA9ICdub3JtYWwnOwogICAgICBz
ZXRUaW1lb3V0KG9uSW5pdCwgMCk7CiAg
ICB9CiAgfQoKICBpZiAoIWh0ZXJtLmRl
ZmF1bHRTdG9yYWdlKSB7CiAgICB2YXIg
YXJ5ID0gbmF2aWdhdG9yLnVzZXJBZ2Vu
dC5tYXRjaCgvXHNDaHJvbWVcLyhcZFxk
KS8pOwogICAgdmFyIHZlcnNpb24gPSBh
cnkgPyBwYXJzZUludChhcnlbMV0pIDog
LTE7CiAgICBpZiAod2luZG93LmNocm9t
ZSAmJiBjaHJvbWUuc3RvcmFnZSAmJiBj
aHJvbWUuc3RvcmFnZS5zeW5jICYmCiAg
ICAgICAgdmVyc2lvbiA+IDIxKSB7CiAg
ICAgIGh0ZXJtLmRlZmF1bHRTdG9yYWdl
ID0gbmV3IGxpYi5TdG9yYWdlLkNocm9t
ZShjaHJvbWUuc3RvcmFnZS5zeW5jKTsK
ICAgIH0gZWxzZSB7CiAgICAgIGh0ZXJt
LmRlZmF1bHRTdG9yYWdlID0gbmV3IGxp
Yi5TdG9yYWdlLkxvY2FsKCk7CiAgICB9
CiAgfQoKICAvLyBUaGUgY2hyb21lLnRh
YnMgQVBJIGlzIG5vdCBzdXBwb3J0ZWQg
aW4gcGFja2FnZWQgYXBwcywgYW5kIGRl
dGVjdGluZyBpZgogIC8vIHlvdSdyZSBh
IHBhY2thZ2VkIGFwcCBpcyBhIGxpdHRs
ZSBhd2t3YXJkLgogIHZhciBpc1BhY2th
Z2VkQXBwID0gZmFsc2U7CiAgaWYgKHdp
bmRvdy5jaHJvbWUgJiYgY2hyb21lLnJ1
bnRpbWUgJiYgY2hyb21lLnJ1bnRpbWUu
Z2V0TWFuaWZlc3QpIHsKICAgIHZhciBt
YW5pZmVzdCA9IGNocm9tZS5ydW50aW1l
LmdldE1hbmlmZXN0KCk7CiAgICB2YXIg
aXNQYWNrYWdlZEFwcCA9IG1hbmlmZXN0
LmFwcCAmJiBtYW5pZmVzdC5hcHAuYmFj
a2dyb3VuZDsKICB9CgogIGlmIChpc1Bh
Y2thZ2VkQXBwKSB7CiAgICAvLyBQYWNr
YWdlZCBhcHBzIGFyZSBuZXZlciBkaXNw
bGF5ZWQgaW4gYnJvd3NlciB0YWJzLgog
ICAgc2V0VGltZW91dChvbldpbmRvdy5i
aW5kKG51bGwsIHt0eXBlOiAncG9wdXAn
fSksIDApOwogIH0gZWxzZSB7CiAgICBp
ZiAod2luZG93LmNocm9tZSAmJiBjaHJv
bWUudGFicykgewogICAgICAvLyBUaGUg
Z2V0Q3VycmVudCBtZXRob2QgZ2V0cyB0
aGUgdGFiIHRoYXQgaXMgImN1cnJlbnRs
eSBydW5uaW5nIiwgbm90IHRoZQogICAg
ICAvLyB0b3Btb3N0IG9yIGZvY3VzZWQg
dGFiLgogICAgICBjaHJvbWUudGFicy5n
ZXRDdXJyZW50KG9uVGFiKTsKICAgIH0g
ZWxzZSB7CiAgICAgIHNldFRpbWVvdXQo
b25XaW5kb3cuYmluZChudWxsLCB7dHlw
ZTogJ25vcm1hbCd9KSwgMCk7CiAgICB9
CiAgfQp9KTsKCi8qKgogKiBSZXR1cm4g
ZGVjaW1hbCB7IHdpZHRoLCBoZWlnaHQg
fSBmb3IgYSBnaXZlbiBkb20gbm9kZS4K
ICovCmh0ZXJtLmdldENsaWVudFNpemUg
PSBmdW5jdGlvbihkb20pIHsKICByZXR1
cm4gZG9tLmdldEJvdW5kaW5nQ2xpZW50
UmVjdCgpOwp9OwoKLyoqCiAqIFJldHVy
biBkZWNpbWFsIHdpZHRoIGZvciBhIGdp
dmVuIGRvbSBub2RlLgogKi8KaHRlcm0u
Z2V0Q2xpZW50V2lkdGggPSBmdW5jdGlv
bihkb20pIHsKICByZXR1cm4gZG9tLmdl
dEJvdW5kaW5nQ2xpZW50UmVjdCgpLndp
ZHRoOwp9OwoKLyoqCiAqIFJldHVybiBk
ZWNpbWFsIGhlaWdodCBmb3IgYSBnaXZl
biBkb20gbm9kZS4KICovCmh0ZXJtLmdl
dENsaWVudEhlaWdodCA9IGZ1bmN0aW9u
KGRvbSkgewogIHJldHVybiBkb20uZ2V0
Qm91bmRpbmdDbGllbnRSZWN0KCkuaGVp
Z2h0Owp9OwoKLyoqCiAqIENvcHkgdGhl
IGN1cnJlbnQgc2VsZWN0aW9uIHRvIHRo
ZSBzeXN0ZW0gY2xpcGJvYXJkLgogKgog
KiBAcGFyYW0ge0hUTUxEb2N1bWVudH0g
VGhlIGRvY3VtZW50IHdpdGggdGhlIHNl
bGVjdGlvbiB0byBjb3B5LgogKi8KaHRl
cm0uY29weVNlbGVjdGlvblRvQ2xpcGJv
YXJkID0gZnVuY3Rpb24oZG9jdW1lbnQp
IHsKICB0cnkgewogICAgZG9jdW1lbnQu
ZXhlY0NvbW1hbmQoJ2NvcHknKTsKICB9
IGNhdGNoIChmaXJlZm94RXhjZXB0aW9u
KSB7CiAgICAvLyBJZ25vcmUgdGhpcy4g
RkYgdGhyb3dzIGFuIGV4Y2VwdGlvbiBp
ZiB0aGVyZSB3YXMgYW4gZXJyb3IsIGV2
ZW4gdGhvdWdoCiAgICAvLyB0aGUgc3Bl
YyBzYXlzIGp1c3QgcmV0dXJuIGZhbHNl
LgogIH0KfTsKCi8qKgogKiBQYXN0ZSB0
aGUgc3lzdGVtIGNsaXBib2FyZCBpbnRv
IHRoZSBlbGVtZW50IHdpdGggZm9jdXMu
CiAqCiAqIEBwYXJhbSB7SFRNTERvY3Vt
ZW50fSBUaGUgZG9jdW1lbnQgdG8gcGFz
dGUgaW50by4KICovCmh0ZXJtLnBhc3Rl
RnJvbUNsaXBib2FyZCA9IGZ1bmN0aW9u
KGRvY3VtZW50KSB7CiAgdHJ5IHsKICAg
IGRvY3VtZW50LmV4ZWNDb21tYW5kKCdw
YXN0ZScpOwogIH0gY2F0Y2ggKGZpcmVm
b3hFeGNlcHRpb24pIHsKICAgIC8vIEln
bm9yZSB0aGlzLiBGRiB0aHJvd3MgYW4g
ZXhjZXB0aW9uIGlmIHRoZXJlIHdhcyBh
biBlcnJvciwgZXZlbiB0aG91Z2gKICAg
IC8vIHRoZSBzcGVjIHNheXMganVzdCBy
ZXR1cm4gZmFsc2UuCiAgfQp9OwoKLyoq
CiAqIENvbnN0cnVjdG9yIGZvciBhIGh0
ZXJtLlNpemUgcmVjb3JkLgogKgogKiBJ
bnN0YW5jZXMgb2YgdGhpcyBjbGFzcyBo
YXZlIHB1YmxpYyByZWFkL3dyaXRlIG1l
bWJlcnMgZm9yIHdpZHRoIGFuZCBoZWln
aHQuCiAqCiAqIEBwYXJhbSB7aW50ZWdl
cn0gd2lkdGggVGhlIHdpZHRoIG9mIHRo
aXMgcmVjb3JkLgogKiBAcGFyYW0ge2lu
dGVnZXJ9IGhlaWdodCBUaGUgaGVpZ2h0
IG9mIHRoaXMgcmVjb3JkLgogKi8KaHRl
cm0uU2l6ZSA9IGZ1bmN0aW9uKHdpZHRo
LCBoZWlnaHQpIHsKICB0aGlzLndpZHRo
ID0gd2lkdGg7CiAgdGhpcy5oZWlnaHQg
PSBoZWlnaHQ7Cn07CgovKioKICogQWRq
dXN0IHRoZSB3aWR0aCBhbmQgaGVpZ2h0
IG9mIHRoaXMgcmVjb3JkLgogKgogKiBA
cGFyYW0ge2ludGVnZXJ9IHdpZHRoIFRo
ZSBuZXcgd2lkdGggb2YgdGhpcyByZWNv
cmQuCiAqIEBwYXJhbSB7aW50ZWdlcn0g
aGVpZ2h0IFRoZSBuZXcgaGVpZ2h0IG9m
IHRoaXMgcmVjb3JkLgogKi8KaHRlcm0u
U2l6ZS5wcm90b3R5cGUucmVzaXplID0g
ZnVuY3Rpb24od2lkdGgsIGhlaWdodCkg
ewogIHRoaXMud2lkdGggPSB3aWR0aDsK
ICB0aGlzLmhlaWdodCA9IGhlaWdodDsK
fTsKCi8qKgogKiBSZXR1cm4gYSBjb3B5
IG9mIHRoaXMgcmVjb3JkLgogKgogKiBA
cmV0dXJuIHtodGVybS5TaXplfSBBIG5l
dyBodGVybS5TaXplIGluc3RhbmNlIHdp
dGggdGhlIHNhbWUgd2lkdGggYW5kCiAq
IGhlaWdodC4KICovCmh0ZXJtLlNpemUu
cHJvdG90eXBlLmNsb25lID0gZnVuY3Rp
b24oKSB7CiAgcmV0dXJuIG5ldyBodGVy
bS5TaXplKHRoaXMud2lkdGgsIHRoaXMu
aGVpZ2h0KTsKfTsKCi8qKgogKiBTZXQg
dGhlIGhlaWdodCBhbmQgd2lkdGggb2Yg
dGhpcyBpbnN0YW5jZSBiYXNlZCBvbiBh
bm90aGVyIGh0ZXJtLlNpemUuCiAqCiAq
IEBwYXJhbSB7aHRlcm0uU2l6ZX0gdGhh
dCBUaGUgb2JqZWN0IHRvIGNvcHkgZnJv
bS4KICovCmh0ZXJtLlNpemUucHJvdG90
eXBlLnNldFRvID0gZnVuY3Rpb24odGhh
dCkgewogIHRoaXMud2lkdGggPSB0aGF0
LndpZHRoOwogIHRoaXMuaGVpZ2h0ID0g
dGhhdC5oZWlnaHQ7Cn07CgovKioKICog
VGVzdCBpZiBhbm90aGVyIGh0ZXJtLlNp
emUgaW5zdGFuY2UgaXMgZXF1YWwgdG8g
dGhpcyBvbmUuCiAqCiAqIEBwYXJhbSB7
aHRlcm0uU2l6ZX0gdGhhdCBUaGUgb3Ro
ZXIgaHRlcm0uU2l6ZSBpbnN0YW5jZS4K
ICogQHJldHVybiB7Ym9vbGVufSBUcnVl
IGlmIGJvdGggaW5zdGFuY2VzIGhhdmUg
dGhlIHNhbWUgd2lkdGgvaGVpZ2h0LCBm
YWxzZQogKiAgICAgb3RoZXJ3aXNlLgog
Ki8KaHRlcm0uU2l6ZS5wcm90b3R5cGUu
ZXF1YWxzID0gZnVuY3Rpb24odGhhdCkg
ewogIHJldHVybiB0aGlzLndpZHRoID09
IHRoYXQud2lkdGggJiYgdGhpcy5oZWln
aHQgPT0gdGhhdC5oZWlnaHQ7Cn07Cgov
KioKICogUmV0dXJuIGEgc3RyaW5nIHJl
cHJlc2VudGF0aW9uIG9mIHRoaXMgaW5z
dGFuY2UuCiAqCiAqIEByZXR1cm4ge3N0
cmluZ30gQSBzdHJpbmcgdGhhdCBpZGVu
dGlmaWVzIHRoZSB3aWR0aCBhbmQgaGVp
Z2h0IG9mIHRoaXMKICogICAgIGluc3Rh
bmNlLgogKi8KaHRlcm0uU2l6ZS5wcm90
b3R5cGUudG9TdHJpbmcgPSBmdW5jdGlv
bigpIHsKICByZXR1cm4gJ1todGVybS5T
aXplOiAnICsgdGhpcy53aWR0aCArICcs
ICcgKyB0aGlzLmhlaWdodCArICddJzsK
fTsKCi8qKgogKiBDb25zdHJ1Y3RvciBm
b3IgYSBodGVybS5Sb3dDb2wgcmVjb3Jk
LgogKgogKiBJbnN0YW5jZXMgb2YgdGhp
cyBjbGFzcyBoYXZlIHB1YmxpYyByZWFk
L3dyaXRlIG1lbWJlcnMgZm9yIHJvdyBh
bmQgY29sdW1uLgogKgogKiBUaGlzIGNs
YXNzIGluY2x1ZGVzIGFuICdvdmVyZmxv
dycgYml0IHdoaWNoIGlzIHVzZSB0byBp
bmRpY2F0ZSB0aGF0IHRoZSBhbgogKiBh
dHRlbXB0IGhhcyBiZWVuIG1hZGUgdG8g
bW92ZSB0aGUgY3Vyc29yIGNvbHVtbiBw
YXNzZWQgdGhlIGVuZCBvZiB0aGUKICog
c2NyZWVuLiAgV2hlbiB0aGlzIGhhcHBl
bnMgd2UgbGVhdmUgdGhlIGN1cnNvciBj
b2x1bW4gc2V0IHRvIHRoZSBsYXN0IGNv
bHVtbgogKiBvZiB0aGUgc2NyZWVuIGJ1
dCBzZXQgdGhlIG92ZXJmbG93IGJpdC4g
IEluIHRoaXMgc3RhdGUgY3Vyc29yIG1v
dmVtZW50CiAqIGhhcHBlbnMgbm9ybWFs
bHksIGJ1dCBhbnkgYXR0ZW1wdCB0byBw
cmludCBuZXcgY2hhcmFjdGVycyBjYXVz
ZXMgYSBjci9sZgogKiBmaXJzdC4KICoK
ICogQHBhcmFtIHtpbnRlZ2VyfSByb3cg
VGhlIHJvdyBvZiB0aGlzIHJlY29yZC4K
ICogQHBhcmFtIHtpbnRlZ2VyfSBjb2x1
bW4gVGhlIGNvbHVtbiBvZiB0aGlzIHJl
Y29yZC4KICogQHBhcmFtIHtib29sZWFu
fSBvcHRfb3ZlcmZsb3cgT3B0aW9uYWwg
Ym9vbGVhbiBpbmRpY2F0aW5nIHRoYXQg
dGhlIFJvd0NvbAogKiAgICAgaGFzIG92
ZXJmbG93ZWQuCiAqLwpodGVybS5Sb3dD
b2wgPSBmdW5jdGlvbihyb3csIGNvbHVt
biwgb3B0X292ZXJmbG93KSB7CiAgdGhp
cy5yb3cgPSByb3c7CiAgdGhpcy5jb2x1
bW4gPSBjb2x1bW47CiAgdGhpcy5vdmVy
ZmxvdyA9ICEhb3B0X292ZXJmbG93Owp9
OwoKLyoqCiAqIEFkanVzdCB0aGUgcm93
IGFuZCBjb2x1bW4gb2YgdGhpcyByZWNv
cmQuCiAqCiAqIEBwYXJhbSB7aW50ZWdl
cn0gcm93IFRoZSBuZXcgcm93IG9mIHRo
aXMgcmVjb3JkLgogKiBAcGFyYW0ge2lu
dGVnZXJ9IGNvbHVtbiBUaGUgbmV3IGNv
bHVtbiBvZiB0aGlzIHJlY29yZC4KICog
QHBhcmFtIHtib29sZWFufSBvcHRfb3Zl
cmZsb3cgT3B0aW9uYWwgYm9vbGVhbiBp
bmRpY2F0aW5nIHRoYXQgdGhlIFJvd0Nv
bAogKiAgICAgaGFzIG92ZXJmbG93ZWQu
CiAqLwpodGVybS5Sb3dDb2wucHJvdG90
eXBlLm1vdmUgPSBmdW5jdGlvbihyb3cs
IGNvbHVtbiwgb3B0X292ZXJmbG93KSB7
CiAgdGhpcy5yb3cgPSByb3c7CiAgdGhp
cy5jb2x1bW4gPSBjb2x1bW47CiAgdGhp
cy5vdmVyZmxvdyA9ICEhb3B0X292ZXJm
bG93Owp9OwoKLyoqCiAqIFJldHVybiBh
IGNvcHkgb2YgdGhpcyByZWNvcmQuCiAq
CiAqIEByZXR1cm4ge2h0ZXJtLlJvd0Nv
bH0gQSBuZXcgaHRlcm0uUm93Q29sIGlu
c3RhbmNlIHdpdGggdGhlIHNhbWUgcm93
IGFuZAogKiBjb2x1bW4uCiAqLwpodGVy
bS5Sb3dDb2wucHJvdG90eXBlLmNsb25l
ID0gZnVuY3Rpb24oKSB7CiAgcmV0dXJu
IG5ldyBodGVybS5Sb3dDb2wodGhpcy5y
b3csIHRoaXMuY29sdW1uLCB0aGlzLm92
ZXJmbG93KTsKfTsKCi8qKgogKiBTZXQg
dGhlIHJvdyBhbmQgY29sdW1uIG9mIHRo
aXMgaW5zdGFuY2UgYmFzZWQgb24gYW5v
dGhlciBodGVybS5Sb3dDb2wuCiAqCiAq
IEBwYXJhbSB7aHRlcm0uUm93Q29sfSB0
aGF0IFRoZSBvYmplY3QgdG8gY29weSBm
cm9tLgogKi8KaHRlcm0uUm93Q29sLnBy
b3RvdHlwZS5zZXRUbyA9IGZ1bmN0aW9u
KHRoYXQpIHsKICB0aGlzLnJvdyA9IHRo
YXQucm93OwogIHRoaXMuY29sdW1uID0g
dGhhdC5jb2x1bW47CiAgdGhpcy5vdmVy
ZmxvdyA9IHRoYXQub3ZlcmZsb3c7Cn07
CgovKioKICogVGVzdCBpZiBhbm90aGVy
IGh0ZXJtLlJvd0NvbCBpbnN0YW5jZSBp
cyBlcXVhbCB0byB0aGlzIG9uZS4KICoK
ICogQHBhcmFtIHtodGVybS5Sb3dDb2x9
IHRoYXQgVGhlIG90aGVyIGh0ZXJtLlJv
d0NvbCBpbnN0YW5jZS4KICogQHJldHVy
biB7Ym9vbGVufSBUcnVlIGlmIGJvdGgg
aW5zdGFuY2VzIGhhdmUgdGhlIHNhbWUg
cm93L2NvbHVtbiwgZmFsc2UKICogICAg
IG90aGVyd2lzZS4KICovCmh0ZXJtLlJv
d0NvbC5wcm90b3R5cGUuZXF1YWxzID0g
ZnVuY3Rpb24odGhhdCkgewogIHJldHVy
biAodGhpcy5yb3cgPT0gdGhhdC5yb3cg
JiYgdGhpcy5jb2x1bW4gPT0gdGhhdC5j
b2x1bW4gJiYKICAgICAgICAgIHRoaXMu
b3ZlcmZsb3cgPT0gdGhhdC5vdmVyZmxv
dyk7Cn07CgovKioKICogUmV0dXJuIGEg
c3RyaW5nIHJlcHJlc2VudGF0aW9uIG9m
IHRoaXMgaW5zdGFuY2UuCiAqCiAqIEBy
ZXR1cm4ge3N0cmluZ30gQSBzdHJpbmcg
dGhhdCBpZGVudGlmaWVzIHRoZSByb3cg
YW5kIGNvbHVtbiBvZiB0aGlzCiAqICAg
ICBpbnN0YW5jZS4KICovCmh0ZXJtLlJv
d0NvbC5wcm90b3R5cGUudG9TdHJpbmcg
PSBmdW5jdGlvbigpIHsKICByZXR1cm4g
KCdbaHRlcm0uUm93Q29sOiAnICsgdGhp
cy5yb3cgKyAnLCAnICsgdGhpcy5jb2x1
bW4gKyAnLCAnICsKICAgICAgICAgIHRo
aXMub3ZlcmZsb3cgKyAnXScpOwp9Owov
LyBTT1VSQ0UgRklMRTogaHRlcm0vanMv
aHRlcm1fZnJhbWUuanMKLy8gQ29weXJp
Z2h0IChjKSAyMDEyIFRoZSBDaHJvbWl1
bSBPUyBBdXRob3JzLiBBbGwgcmlnaHRz
IHJlc2VydmVkLgovLyBVc2Ugb2YgdGhp
cyBzb3VyY2UgY29kZSBpcyBnb3Zlcm5l
ZCBieSBhIEJTRC1zdHlsZSBsaWNlbnNl
IHRoYXQgY2FuIGJlCi8vIGZvdW5kIGlu
IHRoZSBMSUNFTlNFIGZpbGUuCgondXNl
IHN0cmljdCc7CgpsaWIucnRkZXAoJ2xp
Yi5mJyk7CgovKioKICogRmlyc3QgZHJh
ZnQgb2YgdGhlIGludGVyZmFjZSBiZXR3
ZWVuIHRoZSB0ZXJtaW5hbCBhbmQgYSB0
aGlyZCBwYXJ0eSBkaWFsb2cuCiAqCiAq
IFRoaXMgaXMgcm91Z2guICBJdCdzIGp1
c3QgdGhlIHRlcm1pbmFsLT5kaWFsb2cg
bGF5ZXIuICBUbyBjb21wbGV0ZSB0aGlu
Z3MKICogd2UnbGwgYWxzbyBuZWVkIGEg
Y29tbWFuZC0+dGVybWluYWwgbGF5ZXIu
ICBUaGF0IHdpbGwgaGF2ZSB0byBmYWNp
bGl0YXRlCiAqIGNvbW1hbmQtPnRlcm1p
bmFsLT5kaWFsb2cgb3IgZGlyZWN0IGNv
bW1hbmQtPmRpYWxvZyBjb21tdW5pY2F0
aW9uLgogKgogKiBJIGltYWdpbmUgdGhp
cyBjbGFzcyB3aWxsIGNoYW5nZSBzaWdu
aWZpY2FudGx5IHdoZW4gdGhhdCBoYXBw
ZW5zLgogKi8KCi8qKgogKiBDb25zdHJ1
Y3QgYSBuZXcgZnJhbWUgZm9yIHRoZSBn
aXZlbiB0ZXJtaW5hbC4KICoKICogQHBh
cmFtIHRlcm1pbmFsIHtodGVybS5UZXJt
aW5hbH0gVGhlIHBhcmVudCB0ZXJtaW5h
bCBvYmplY3QuCiAqIEBwYXJhbSB1cmwg
e1N0cmluZ30gVGhlIHVybCB0byBsb2Fk
IGluIHRoZSBmcmFtZS4KICogQHBhcmFt
IG9wdF9vcHRpb25zIHtPYmplY3R9IE9w
dGlvbmFsIG9wdGlvbnMgZm9yIHRoZSBm
cmFtZS4gIE5vdCBpbXBsZW1lbnRlZC4K
ICovCmh0ZXJtLkZyYW1lID0gZnVuY3Rp
b24odGVybWluYWwsIHVybCwgb3B0X29w
dGlvbnMpIHsKICB0aGlzLnRlcm1pbmFs
XyA9IHRlcm1pbmFsOwogIHRoaXMuZGl2
XyA9IHRlcm1pbmFsLmRpdl87CiAgdGhp
cy51cmwgPSB1cmw7CiAgdGhpcy5vcHRp
b25zID0gb3B0X29wdGlvbnMgfHwge307
CiAgdGhpcy5pZnJhbWVfID0gbnVsbDsK
ICB0aGlzLmNvbnRhaW5lcl8gPSBudWxs
OwogIHRoaXMubWVzc2FnZUNoYW5uZWxf
ID0gbnVsbDsKfTsKCi8qKgogKiBIYW5k
bGUgbWVzc2FnZXMgZnJvbSB0aGUgaWZy
YW1lLgogKi8KaHRlcm0uRnJhbWUucHJv
dG90eXBlLm9uTWVzc2FnZV8gPSBmdW5j
dGlvbihlKSB7CiAgaWYgKGUuZGF0YS5u
YW1lICE9ICdpcGMtaW5pdC1vaycpIHsK
ICAgIGNvbnNvbGUubG9nKCdVbmtub3du
IG1lc3NhZ2UgZnJvbSBmcmFtZTonLCBl
LmRhdGEpOwogICAgcmV0dXJuOwogIH0K
CiAgdGhpcy5zZW5kVGVybWluYWxJbmZv
XygpOwogIHRoaXMubWVzc2FnZUNoYW5u
ZWxfLnBvcnQxLm9ubWVzc2FnZSA9IHRo
aXMub25NZXNzYWdlLmJpbmQodGhpcyk7
CiAgdGhpcy5vbkxvYWQoKTsKfTsKCi8q
KgogKiBDbGllbnRzIGNvdWxkIG92ZXJy
aWRlIHRoaXMsIEkgZ3Vlc3MuCiAqCiAq
IEl0IGRvZXNuJ3Qgc3VwcG9ydCBtdWx0
aXBsZSBsaXN0ZW5lcnMsIGJ1dCBJJ20g
bm90IHN1cmUgdGhhdCB3b3VsZCBtYWtl
IHNlbnNlCiAqIGhlcmUuICBJdCdzIHBy
b2JhYmx5IGJldHRlciB0byBzcGVhayBk
aXJlY3RseSB0byBvdXIgcGFyZW50cy4K
ICovCmh0ZXJtLkZyYW1lLnByb3RvdHlw
ZS5vbk1lc3NhZ2UgPSBmdW5jdGlvbigp
IHt9OwoKLyoqCiAqIEhhbmRsZSBpZnJh
bWUgb25Mb2FkIGV2ZW50LgogKi8KaHRl
cm0uRnJhbWUucHJvdG90eXBlLm9uTG9h
ZF8gPSBmdW5jdGlvbigpIHsKICB0aGlz
Lm1lc3NhZ2VDaGFubmVsXyA9IG5ldyBN
ZXNzYWdlQ2hhbm5lbCgpOwogIHRoaXMu
bWVzc2FnZUNoYW5uZWxfLnBvcnQxLm9u
bWVzc2FnZSA9IHRoaXMub25NZXNzYWdl
Xy5iaW5kKHRoaXMpOwogIHRoaXMubWVz
c2FnZUNoYW5uZWxfLnBvcnQxLnN0YXJ0
KCk7CiAgdGhpcy5pZnJhbWVfLmNvbnRl
bnRXaW5kb3cucG9zdE1lc3NhZ2UoCiAg
ICAgIHtuYW1lOiAnaXBjLWluaXQnLCBh
cmd2OiBbe21lc3NhZ2VQb3J0OiB0aGlz
Lm1lc3NhZ2VDaGFubmVsXy5wb3J0Mn1d
fSwKICAgICAgW3RoaXMubWVzc2FnZUNo
YW5uZWxfLnBvcnQyXSwgdGhpcy51cmwp
Owp9OwoKLyoqCiAqIENsaWVudHMgbWF5
IG92ZXJyaWRlIHRoaXMuCiAqLwpodGVy
bS5GcmFtZS5wcm90b3R5cGUub25Mb2Fk
ID0gZnVuY3Rpb24oKSB7fTsKCi8qKgog
KiBTZW5kcyB0aGUgdGVybWluYWwtaW5m
byBtZXNzYWdlIHRvIHRoZSBpZnJhbWUu
CiAqLwpodGVybS5GcmFtZS5wcm90b3R5
cGUuc2VuZFRlcm1pbmFsSW5mb18gPSBm
dW5jdGlvbigpIHsKICBsaWIuZi5nZXRB
Y2NlcHRMYW5ndWFnZXMoZnVuY3Rpb24o
bGFuZ3VhZ2VzKSB7CiAgICAgIHRoaXMu
cG9zdE1lc3NhZ2UoJ3Rlcm1pbmFsLWlu
Zm8nLCBbewogICAgICAgICBhY2NlcHRM
YW5ndWFnZXM6IGxhbmd1YWdlcywKICAg
ICAgICAgZm9yZWdyb3VuZENvbG9yOiB0
aGlzLnRlcm1pbmFsXy5nZXRGb3JlZ3Jv
dW5kQ29sb3IoKSwKICAgICAgICAgYmFj
a2dyb3VuZENvbG9yOiB0aGlzLnRlcm1p
bmFsXy5nZXRCYWNrZ3JvdW5kQ29sb3Io
KSwKICAgICAgICAgY3Vyc29yQ29sb3I6
IHRoaXMudGVybWluYWxfLmdldEN1cnNv
ckNvbG9yKCksCiAgICAgICAgIGZvbnRT
aXplOiB0aGlzLnRlcm1pbmFsXy5nZXRG
b250U2l6ZSgpLAogICAgICAgICBmb250
RmFtaWx5OiB0aGlzLnRlcm1pbmFsXy5n
ZXRGb250RmFtaWx5KCksCiAgICAgICAg
IGJhc2VVUkw6IGxpYi5mLmdldFVSTCgn
LycpCiAgICAgICAgICB9XQogICAgICAg
ICk7CiAgICB9LmJpbmQodGhpcykpOwp9
OwoKLyoqCiAqIFVzZXIgY2xpY2tlZCB0
aGUgY2xvc2UgYnV0dG9uIG9uIHRoZSBm
cmFtZSBkZWNvcmF0aW9uLgogKi8KaHRl
cm0uRnJhbWUucHJvdG90eXBlLm9uQ2xv
c2VDbGlja2VkXyA9IGZ1bmN0aW9uKCkg
ewogIHRoaXMuY2xvc2UoKTsKfTsKCi8q
KgogKiBDbG9zZSB0aGlzIGZyYW1lLgog
Ki8KaHRlcm0uRnJhbWUucHJvdG90eXBl
LmNsb3NlID0gZnVuY3Rpb24oKSB7CiAg
aWYgKCF0aGlzLmNvbnRhaW5lcl8gfHwg
IXRoaXMuY29udGFpbmVyXy5wYXJlbnRO
b2RlKQogICAgICByZXR1cm47CgogIHRo
aXMuY29udGFpbmVyXy5wYXJlbnROb2Rl
LnJlbW92ZUNoaWxkKHRoaXMuY29udGFp
bmVyXyk7CiAgdGhpcy5vbkNsb3NlKCk7
Cn07CgoKLyoqCiAqIENsaWVudHMgbWF5
IG92ZXJyaWRlIHRoaXMuCiAqLwpodGVy
bS5GcmFtZS5wcm90b3R5cGUub25DbG9z
ZSA9IGZ1bmN0aW9uKCkge307CgovKioK
ICogU2VuZCBhIG1lc3NhZ2UgdG8gdGhl
IGlmcmFtZS4KICovCmh0ZXJtLkZyYW1l
LnByb3RvdHlwZS5wb3N0TWVzc2FnZSA9
IGZ1bmN0aW9uKG5hbWUsIGFyZ3YpIHsK
ICBpZiAoIXRoaXMubWVzc2FnZUNoYW5u
ZWxfKQogICAgdGhyb3cgbmV3IEVycm9y
KCdNZXNzYWdlIGNoYW5uZWwgaXMgbm90
IHNldCB1cC4nKTsKCiAgdGhpcy5tZXNz
YWdlQ2hhbm5lbF8ucG9ydDEucG9zdE1l
c3NhZ2Uoe25hbWU6IG5hbWUsIGFyZ3Y6
IGFyZ3Z9KTsKfTsKCi8qKgogKiBTaG93
IHRoZSBVSSBmb3IgdGhpcyBmcmFtZS4K
ICoKICogVGhlIGlmcmFtZSBzcmMgaXMg
bm90IGxvYWRlZCB1bnRpbCB0aGlzIG1l
dGhvZCBpcyBjYWxsZWQuCiAqLwpodGVy
bS5GcmFtZS5wcm90b3R5cGUuc2hvdyA9
IGZ1bmN0aW9uKCkgewogIHZhciBzZWxm
ID0gdGhpczsKCiAgZnVuY3Rpb24gb3B0
KG5hbWUsIGRlZmF1bHRWYWx1ZSkgewog
ICAgaWYgKG5hbWUgaW4gc2VsZi5vcHRp
b25zKQogICAgICByZXR1cm4gc2VsZi5v
cHRpb25zW25hbWVdOwoKICAgIHJldHVy
biBkZWZhdWx0VmFsdWU7CiAgfQoKICB2
YXIgc2VsZiA9IHRoaXM7CgogIGlmICh0
aGlzLmNvbnRhaW5lcl8gJiYgdGhpcy5j
b250YWluZXJfLnBhcmVudE5vZGUpIHsK
ICAgIGNvbnNvbGUuZXJyb3IoJ0ZyYW1l
IGFscmVhZHkgdmlzaWJsZScpOwogICAg
cmV0dXJuOwogIH0KCiAgdmFyIGhlYWRl
ckhlaWdodCA9ICcxNnB4JzsKCiAgdmFy
IGRpdlNpemUgPSBodGVybS5nZXRDbGll
bnRTaXplKHRoaXMuZGl2Xyk7CgogIHZh
ciB3aWR0aCA9IG9wdCgnd2lkdGgnLCA2
NDApOwogIHZhciBoZWlnaHQgPSBvcHQo
J2hlaWdodCcsIDQ4MCk7CiAgdmFyIGxl
ZnQgPSAoZGl2U2l6ZS53aWR0aCAtIHdp
ZHRoKSAvIDI7CiAgdmFyIHRvcCA9IChk
aXZTaXplLmhlaWdodCAtIGhlaWdodCkg
LyAyOwoKICB2YXIgZG9jdW1lbnQgPSB0
aGlzLnRlcm1pbmFsXy5kb2N1bWVudF87
CgogIHZhciBjb250YWluZXIgPSB0aGlz
LmNvbnRhaW5lcl8gPSBkb2N1bWVudC5j
cmVhdGVFbGVtZW50KCdkaXYnKTsKICBj
b250YWluZXIuc3R5bGUuY3NzVGV4dCA9
ICgKICAgICAgJ3Bvc2l0aW9uOiBhYnNv
bHV0ZTsnICsKICAgICAgJ2Rpc3BsYXk6
IC13ZWJraXQtZmxleDsnICsKICAgICAg
Jy13ZWJraXQtZmxleC1kaXJlY3Rpb246
IGNvbHVtbjsnICsKICAgICAgJ3RvcDog
MTAlOycgKwogICAgICAnbGVmdDogNCU7
JyArCiAgICAgICd3aWR0aDogOTAlOycg
KwogICAgICAnaGVpZ2h0OiA4MCU7JyAr
CiAgICAgICdib3gtc2hhZG93OiAwIDAg
MnB4ICcgKyB0aGlzLnRlcm1pbmFsXy5n
ZXRGb3JlZ3JvdW5kQ29sb3IoKSArICc7
JyArCiAgICAgICdib3JkZXI6IDJweCAn
ICsgdGhpcy50ZXJtaW5hbF8uZ2V0Rm9y
ZWdyb3VuZENvbG9yKCkgKyAnIHNvbGlk
OycpOwoKICB2YXIgaGVhZGVyID0gZG9j
dW1lbnQuY3JlYXRlRWxlbWVudCgnZGl2
Jyk7CiAgaGVhZGVyLnN0eWxlLmNzc1Rl
eHQgPSAoCiAgICAgICdkaXNwbGF5OiAt
d2Via2l0LWZsZXg7JyArCiAgICAgICct
d2Via2l0LWp1c3RpZnktY29udGVudDog
ZmxleC1lbmQ7JyArCiAgICAgICdoZWln
aHQ6ICcgKyBoZWFkZXJIZWlnaHQgKyAn
OycgKwogICAgICAnYmFja2dyb3VuZC1j
b2xvcjogJyArIHRoaXMudGVybWluYWxf
LmdldEZvcmVncm91bmRDb2xvcigpICsg
JzsnICsKICAgICAgJ2NvbG9yOiAnICsg
dGhpcy50ZXJtaW5hbF8uZ2V0QmFja2dy
b3VuZENvbG9yKCkgKyAnOycgKwogICAg
ICAnZm9udC1zaXplOiAxNnB4OycgKwog
ICAgICAnZm9udC1mYW1pbHk6ICcgKyB0
aGlzLnRlcm1pbmFsXy5nZXRGb250RmFt
aWx5KCkpOwogIGNvbnRhaW5lci5hcHBl
bmRDaGlsZChoZWFkZXIpOwoKICBpZiAo
ZmFsc2UpIHsKICAgIC8vIE5vIHVzZSBm
b3IgdGhlIGNsb3NlIGJ1dHRvbi4KICAg
IHZhciBidXR0b24gPSBkb2N1bWVudC5j
cmVhdGVFbGVtZW50KCdkaXYnKTsKICAg
IGJ1dHRvbi5zZXRBdHRyaWJ1dGUoJ3Jv
bGUnLCAnYnV0dG9uJyk7CiAgICBidXR0
b24uc3R5bGUuY3NzVGV4dCA9ICgKICAg
ICAgICAnbWFyZ2luLXRvcDogLTNweDsn
ICsKICAgICAgICAnbWFyZ2luLXJpZ2h0
OiAzcHg7JyArCiAgICAgICAgJ2N1cnNv
cjogcG9pbnRlcjsnKTsKICAgIGJ1dHRv
bi50ZXh0Q29udGVudCA9ICdcdTJhMmYn
OwogICAgYnV0dG9uLmFkZEV2ZW50TGlz
dGVuZXIoJ2NsaWNrJywgdGhpcy5vbkNs
b3NlQ2xpY2tlZF8uYmluZCh0aGlzKSk7
CiAgICBoZWFkZXIuYXBwZW5kQ2hpbGQo
YnV0dG9uKTsKICB9CgogIHZhciBpZnJh
bWUgPSB0aGlzLmlmcmFtZV8gPSBkb2N1
bWVudC5jcmVhdGVFbGVtZW50KCdpZnJh
bWUnKTsKICBpZnJhbWUub25sb2FkID0g
dGhpcy5vbkxvYWRfLmJpbmQodGhpcyk7
CiAgaWZyYW1lLnN0eWxlLmNzc1RleHQg
PSAoCiAgICAgICdkaXNwbGF5OiAtd2Vi
a2l0LWZsZXg7JyArCiAgICAgICctd2Vi
a2l0LWZsZXg6IDE7JyArCiAgICAgICd3
aWR0aDogMTAwJScpOwogIGlmcmFtZS5z
ZXRBdHRyaWJ1dGUoJ3NyYycsIHRoaXMu
dXJsKTsKICBpZnJhbWUuc2V0QXR0cmli
dXRlKCdzZWFtbGVzcycsIHRydWUpOwog
IGNvbnRhaW5lci5hcHBlbmRDaGlsZChp
ZnJhbWUpOwoKICB0aGlzLmRpdl8uYXBw
ZW5kQ2hpbGQoY29udGFpbmVyKTsKfTsK
Ly8gU09VUkNFIEZJTEU6IGh0ZXJtL2pz
L2h0ZXJtX2tleWJvYXJkLmpzCi8vIENv
cHlyaWdodCAoYykgMjAxMiBUaGUgQ2hy
b21pdW0gT1MgQXV0aG9ycy4gQWxsIHJp
Z2h0cyByZXNlcnZlZC4KLy8gVXNlIG9m
IHRoaXMgc291cmNlIGNvZGUgaXMgZ292
ZXJuZWQgYnkgYSBCU0Qtc3R5bGUgbGlj
ZW5zZSB0aGF0IGNhbiBiZQovLyBmb3Vu
ZCBpbiB0aGUgTElDRU5TRSBmaWxlLgoK
J3VzZSBzdHJpY3QnOwoKbGliLnJ0ZGVw
KCdodGVybS5LZXlib2FyZC5LZXlNYXAn
KTsKCi8qKgogKiBLZXlib2FyZCBoYW5k
bGVyLgogKgogKiBDb25zdW1lcyBvbktl
eSogZXZlbnRzIGFuZCBpbnZva2VzIG9u
VlRLZXlzdHJva2Ugb24gdGhlIGFzc29j
aWF0ZWQKICogaHRlcm0uVGVybWluYWwg
b2JqZWN0LgogKgogKiBTZWUgYWxzbzog
W1hURVJNXSBhcyByZWZlcmVuY2VkIGlu
IHZ0LmpzLgogKgogKiBAcGFyYW0ge2h0
ZXJtLlRlcm1pbmFsfSBUaGUgVGVybWlu
YWwgb2JqZWN0IGFzc29jaWF0ZWQgd2l0
aCB0aGlzIGtleWJvYXJkLgogKi8KaHRl
cm0uS2V5Ym9hcmQgPSBmdW5jdGlvbih0
ZXJtaW5hbCkgewogIC8vIFRoZSBwYXJl
bnQgdnQgaW50ZXJwcmV0ZXIuCiAgdGhp
cy50ZXJtaW5hbCA9IHRlcm1pbmFsOwoK
ICAvLyBUaGUgZWxlbWVudCB3ZSdyZSBj
dXJyZW50bHkgY2FwdHVyaW5nIGtleWJv
YXJkIGV2ZW50cyBmb3IuCiAgdGhpcy5r
ZXlib2FyZEVsZW1lbnRfID0gbnVsbDsK
CiAgLy8gVGhlIGV2ZW50IGhhbmRsZXJz
IHdlIGFyZSBpbnRlcmVzdGVkIGluLCBh
bmQgdGhlaXIgYm91bmQgY2FsbGJhY2tz
LCBzYXZlZAogIC8vIHNvIHRoZXkgY2Fu
IGJlIHVuaW5zdGFsbGVkIHdpdGggcmVt
b3ZlRXZlbnRMaXN0ZW5lciwgd2hlbiBy
ZXF1aXJlZC4KICB0aGlzLmhhbmRsZXJz
XyA9IFsKICAgICAgWydibHVyJywgdGhp
cy5vbkJsdXJfLmJpbmQodGhpcyldLAog
ICAgICBbJ2tleWRvd24nLCB0aGlzLm9u
S2V5RG93bl8uYmluZCh0aGlzKV0sCiAg
ICAgIFsna2V5cHJlc3MnLCB0aGlzLm9u
S2V5UHJlc3NfLmJpbmQodGhpcyldLAog
ICAgICBbJ2tleXVwJywgdGhpcy5vbktl
eVVwXy5iaW5kKHRoaXMpXSwKICAgICAg
Wyd0ZXh0SW5wdXQnLCB0aGlzLm9uVGV4
dElucHV0Xy5iaW5kKHRoaXMpXQogIF07
CgogIC8qKgogICAqIFRoZSBjdXJyZW50
IGtleSBtYXAuCiAgICovCiAgdGhpcy5r
ZXlNYXAgPSBuZXcgaHRlcm0uS2V5Ym9h
cmQuS2V5TWFwKHRoaXMpOwoKICAvKioK
ICAgKiBub25lOiBEaXNhYmxlIGFueSBB
bHRHciByZWxhdGVkIG11bmdpbmcuCiAg
ICogY3RybC1hbHQ6IEFzc3VtZSBDdHJs
K0FsdCBtZWFucyBBbHRHci4KICAgKiBs
ZWZ0LWFsdDogQXNzdW1lIGxlZnQgQWx0
IG1lYW5zIEFsdEdyLgogICAqIHJpZ2h0
LWFsdDogQXNzdW1lIHJpZ2h0IEFsdCBt
ZWFucyBBbHRHci4KICAgKi8KICB0aGlz
LmFsdEdyTW9kZSA9ICdub25lJzsKCiAg
LyoqCiAgICogSWYgdHJ1ZSwgU2hpZnQt
SW5zZXJ0IHdpbGwgZmFsbCB0aHJvdWdo
IHRvIHRoZSBicm93c2VyIGFzIGEgcGFz
dGUuCiAgICogSWYgZmFsc2UsIHRoZSBr
ZXlzdHJva2Ugd2lsbCBiZSBzZW50IHRv
IHRoZSBob3N0LgogICAqLwogIHRoaXMu
c2hpZnRJbnNlcnRQYXN0ZSA9IHRydWU7
CgogIC8qKgogICAqIElmIHRydWUsIGhv
bWUvZW5kIHdpbGwgY29udHJvbCB0aGUg
dGVybWluYWwgc2Nyb2xsYmFyIGFuZCBz
aGlmdCBob21lL2VuZAogICAqIHdpbGwg
c2VuZCB0aGUgVlQga2V5Y29kZXMuICBJ
ZiBmYWxzZSB0aGVuIGhvbWUvZW5kIHNl
bmRzIFZUIGNvZGVzIGFuZAogICAqIHNo
aWZ0IGhvbWUvZW5kIHNjcm9sbHMuCiAg
ICovCiAgdGhpcy5ob21lS2V5c1Njcm9s
bCA9IGZhbHNlOwoKICAvKioKICAgKiBT
YW1lIGFzIGFib3ZlLCBleGNlcHQgZm9y
IHBhZ2UgdXAvcGFnZSBkb3duLgogICAq
LwogIHRoaXMucGFnZUtleXNTY3JvbGwg
PSBmYWxzZTsKCiAgLyoqCiAgICogSWYg
dHJ1ZSwgQ3RybC1QbHVzL01pbnVzL1pl
cm8gY29udHJvbHMgem9vbS4KICAgKiBJ
ZiBmYWxzZSwgQ3RybC1TaGlmdC1QbHVz
L01pbnVzL1plcm8gY29udHJvbHMgem9v
bSwgQ3RybC1NaW51cyBzZW5kcyBeXywK
ICAgKiBDdHJsLVBsdXMvWmVybyBkbyBu
b3RoaW5nLgogICAqLwogIHRoaXMuY3Ry
bFBsdXNNaW51c1plcm9ab29tID0gdHJ1
ZTsKCiAgLyoqCiAgICogQ3RybCtDIGNv
cGllcyBpZiB0cnVlLCBzZW5kcyBeQyB0
byBob3N0IGlmIGZhbHNlLgogICAqIEN0
cmwrU2hpZnQrQyBzZW5kcyBeQyB0byBo
b3N0IGlmIHRydWUsIGNvcGllcyBpZiBm
YWxzZS4KICAgKi8KICB0aGlzLmN0cmxD
Q29weSA9IGZhbHNlOwoKICAvKioKICAg
KiBDdHJsK1YgcGFzdGVzIGlmIHRydWUs
IHNlbmRzIF5WIHRvIGhvc3QgaWYgZmFs
c2UuCiAgICogQ3RybCtTaGlmdCtWIHNl
bmRzIF5WIHRvIGhvc3QgaWYgdHJ1ZSwg
cGFzdGVzIGlmIGZhbHNlLgogICAqLwog
IHRoaXMuY3RybFZQYXN0ZSA9IGZhbHNl
OwoKICAvKioKICAgKiBFbmFibGUvZGlz
YWJsZSBhcHBsaWNhdGlvbiBrZXlwYWQu
CiAgICoKICAgKiBUaGlzIGNoYW5nZXMg
dGhlIHdheSBudW1lcmljIGtleXMgYXJl
IHNlbnQgZnJvbSB0aGUga2V5Ym9hcmQu
CiAgICovCiAgdGhpcy5hcHBsaWNhdGlv
bktleXBhZCA9IGZhbHNlOwoKICAvKioK
ICAgKiBFbmFibGUvZGlzYWJsZSB0aGUg
YXBwbGljYXRpb24gY3Vyc29yIG1vZGUu
CiAgICoKICAgKiBUaGlzIGNoYW5nZXMg
dGhlIHdheSBjdXJzb3Iga2V5cyBhcmUg
c2VudCBmcm9tIHRoZSBrZXlib2FyZC4K
ICAgKi8KICB0aGlzLmFwcGxpY2F0aW9u
Q3Vyc29yID0gZmFsc2U7CgogIC8qKgog
ICAqIElmIHRydWUsIHRoZSBiYWNrc3Bh
Y2Ugc2hvdWxkIHNlbmQgQlMgKCdceDA4
JywgYWthIF5IKS4gIE90aGVyd2lzZQog
ICAqIHRoZSBiYWNrc3BhY2Uga2V5IHNo
b3VsZCBzZW5kICdceDdmJy4KICAgKi8K
ICB0aGlzLmJhY2tzcGFjZVNlbmRzQmFj
a3NwYWNlID0gZmFsc2U7CgogIC8qKgog
ICAqIFRoZSBlbmNvZGluZyBtZXRob2Qg
Zm9yIGRhdGEgc2VudCB0byB0aGUgaG9z
dC4KICAgKi8KICB0aGlzLmNoYXJhY3Rl
ckVuY29kaW5nID0gJ3V0Zi04JzsKCiAg
LyoqCiAgICogU2V0IHdoZXRoZXIgdGhl
IG1ldGEga2V5IHNlbmRzIGEgbGVhZGlu
ZyBlc2NhcGUgb3Igbm90LgogICAqLwog
IHRoaXMubWV0YVNlbmRzRXNjYXBlID0g
dHJ1ZTsKCiAgLyoqCiAgICogU2V0IHdo
ZXRoZXIgbWV0YS1WIGdldHMgcGFzc2Vk
IHRvIGhvc3QuCiAgICovCiAgdGhpcy5w
YXNzTWV0YVYgPSB0cnVlOwoKICAvKioK
ICAgKiBDb250cm9scyBob3cgdGhlIGFs
dCBrZXkgaXMgaGFuZGxlZC4KICAgKgog
ICAqICBlc2NhcGUuLi4uLi4uIFNlbmQg
YW4gRVNDIHByZWZpeC4KICAgKiAgOC1i
aXQuLi4uLi4uLiBBZGQgMTI4IHRvIHRo
ZSB1bnNoaWZ0ZWQgY2hhcmFjdGVyIGFz
IGluIHh0ZXJtLgogICAqICBicm93c2Vy
LWtleS4uIFdhaXQgZm9yIHRoZSBrZXlw
cmVzcyBldmVudCBhbmQgc2VlIHdoYXQg
dGhlIGJyb3dzZXIgc2F5cy4KICAgKiAg
ICAgICAgICAgICAgICAoVGhpcyB3b24n
dCB3b3JrIHdlbGwgb24gcGxhdGZvcm1z
IHdoZXJlIHRoZSBicm93c2VyCiAgICog
ICAgICAgICAgICAgICAgIHBlcmZvcm1z
IGEgZGVmYXVsdCBhY3Rpb24gZm9yIHNv
bWUgYWx0IHNlcXVlbmNlcy4pCiAgICoK
ICAgKiBUaGlzIHNldHRpbmcgb25seSBt
YXR0ZXJzIHdoZW4gYWx0IGlzIGRpc3Rp
bmN0IGZyb20gbWV0YSAoYWx0SXNNZXRh
IGlzCiAgICogZmFsc2UuKQogICAqLwog
IHRoaXMuYWx0U2VuZHNXaGF0ID0gJ2Vz
Y2FwZSc7CgogIC8qKgogICAqIFNldCB3
aGV0aGVyIHRoZSBhbHQga2V5IGFjdHMg
YXMgYSBtZXRhIGtleSwgaW5zdGVhZCBv
ZiBwcm9kdWNpbmcgOC1iaXQKICAgKiBj
aGFyYWN0ZXJzLgogICAqCiAgICogVHJ1
ZSB0byBlbmFibGUsIGZhbHNlIHRvIGRp
c2FibGUsIG51bGwgdG8gYXV0b2RldGVj
dCBiYXNlZCBvbiBwbGF0Zm9ybS4KICAg
Ki8KICB0aGlzLmFsdElzTWV0YSA9IGZh
bHNlOwoKICAvKioKICAgKiBJZiB0cnVl
LCB0cmllcyB0byBkZXRlY3QgREVMIGtl
eSBldmVudHMgdGhhdCBhcmUgZnJvbSBh
bHQtYmFja3NwYWNlIG9uCiAgICogQ2hy
b21lIE9TIHZzIGZyb20gYSB0cnVlIERF
TCBrZXkgcHJlc3MuCiAgICoKICAgKiBC
YWNrZ3JvdW5kOiBBdCB0aGUgdGltZSBv
ZiB3cml0aW5nLCBvbiBDaHJvbWUgT1Ms
IGFsdC1iYWNrc3BhY2UgaXMgbWFwcGVk
CiAgICogdG8gREVMLiBTb21lIHVzZXJz
IG1heSBiZSBoYXBweSB3aXRoIHRoaXMs
IGJ1dCBvdGhlcnMgbWF5IGJlIGZydXN0
cmF0ZWQKICAgKiB0aGF0IGl0J3MgaW1w
b3NzaWJsZSB0byBkbyBtZXRhLWJhY2tz
cGFjZS4gSWYgdGhlIHVzZXIgZW5hYmxl
cyB0aGlzIHByZWYsCiAgICogd2UgdXNl
IGEgdHJpY2sgdG8gdGVsbCBhIHRydWUg
REVMIGtleXByZXNzIGZyb20gYWx0LWJh
Y2tzcGFjZTogb24KICAgKiBhbHQtYmFj
a3NwYWNlLCB3ZSB3aWxsIHNlZSB0aGUg
YWx0IGtleSBnbyBkb3duLCB0aGVuIGdl
dCBhIERFTCBrZXlzdHJva2UKICAgKiB0
aGF0IGluZGljYXRlcyB0aGF0IGFsdCBp
cyBub3QgcHJlc3NlZC4gU2VlIGh0dHA6
Ly9jcmJ1Zy5jb20vMTc0NDEwIC4KICAg
Ki8KICB0aGlzLmFsdEJhY2tzcGFjZUlz
TWV0YUJhY2tzcGFjZSA9IGZhbHNlOwoK
ICAvKioKICAgKiBVc2VkIHRvIGtlZXAg
dHJhY2sgb2YgdGhlIGN1cnJlbnQgYWx0
LWtleSBzdGF0ZSwgd2hpY2ggaXMgbmVj
ZXNzYXJ5IGZvcgogICAqIHRoZSBhbHRC
YWNrc3BhY2VJc01ldGFCYWNrc3BhY2Ug
cHJlZmVyZW5jZSBhYm92ZSBhbmQgZm9y
IHRoZSBhbHRHck1vZGUKICAgKiBwcmVm
ZXJlbmNlLiAgVGhpcyBpcyBhIGJpdG1h
cCB3aXRoIHdoZXJlIGJpdCBwb3NpdGlv
bnMgY29ycmVzcG9uZCB0byB0aGUKICAg
KiAibG9jYXRpb24iIHByb3BlcnR5IG9m
IHRoZSBrZXkgZXZlbnQuCiAgICovCiAg
dGhpcy5hbHRLZXlQcmVzc2VkID0gMDsK
CiAgLyoqCiAgICogSWYgdHJ1ZSwgQ2hy
b21lIE9TIG1lZGlhIGtleXMgd2lsbCBi
ZSBtYXBwZWQgdG8gdGhlaXIgRi1rZXkg
ZXF1aXZhbGVudC4KICAgKiBFLmcuICJC
YWNrIiB3aWxsIGJlIG1hcHBlZCB0byBG
MS4gSWYgZmFsc2UsIENocm9tZSB3aWxs
IGhhbmRsZSB0aGUga2V5cy4KICAgKi8K
ICB0aGlzLm1lZGlhS2V5c0FyZUZLZXlz
ID0gZmFsc2U7CgogIC8qKgogICAqIEhv
bGRzIHRoZSBwcmV2aW91cyBzZXR0aW5n
IG9mIGFsdFNlbmRzV2hhdCB3aGVuIERF
Q1NFVCAxMDM5IGlzIHVzZWQuIFdoZW4K
ICAgKiBERUNSU1QgMTAzOSBpcyB1c2Vk
LCBhbHRTZW5kc1doYXQgaXMgY2hhbmdl
ZCBiYWNrIHRvIHRoaXMgYW5kIHRoaXMg
aXMKICAgKiBudWxsZWQgb3V0LgogICAq
LwogIHRoaXMucHJldmlvdXNBbHRTZW5k
c1doYXRfID0gbnVsbDsKfTsKCi8qKgog
KiBTcGVjaWFsIGhhbmRsaW5nIGZvciBr
ZXlDb2RlcyBpbiBhIGtleWJvYXJkIGxh
eW91dC4KICovCmh0ZXJtLktleWJvYXJk
LktleUFjdGlvbnMgPSB7CiAgLyoqCiAg
ICogQ2FsbCBwcmV2ZW50RGVmYXVsdCBh
bmQgc3RvcFByb3BhZ2F0aW9uIGZvciB0
aGlzIGtleSBldmVudCBhbmQgbm90aGlu
ZwogICAqIGVsc2UuCiAgICovCiAgQ0FO
Q0VMOiBuZXcgU3RyaW5nKCdDQU5DRUwn
KSwKCiAgLyoqCiAgICogVGhpcyBwZXJm
b3JtcyB0aGUgZGVmYXVsdCB0ZXJtaW5h
bCBhY3Rpb24gZm9yIHRoZSBrZXkuICBJ
ZiB1c2VkIGluIHRoZQogICAqICdub3Jt
YWwnIGFjdGlvbiBhbmQgdGhlIHRoZSBr
ZXlzdHJva2UgcmVwcmVzZW50cyBhIHBy
aW50YWJsZSBrZXksIHRoZQogICAqIGNo
YXJhY3RlciB3aWxsIGJlIHNlbnQgdG8g
dGhlIGhvc3QuICBJZiB1c2VkIGluIG9u
ZSBvZiB0aGUgbW9kaWZpZXIKICAgKiBh
Y3Rpb25zLCB0aGUgdGVybWluYWwgd2ls
bCBwZXJmb3JtIHRoZSBub3JtYWwgYWN0
aW9uIGFmdGVyIChwb3NzaWJseSkKICAg
KiBhbHRlcmluZyBpdC4KICAgKgogICAq
ICAtIElmIHRoZSBub3JtYWwgc2VxdWVu
Y2Ugc3RhcnRzIHdpdGggQ1NJLCB0aGUg
c2VxdWVuY2Ugd2lsbCBiZSBhZGp1c3Rl
ZAogICAqICAgIHRvIGluY2x1ZGUgdGhl
IG1vZGlmaWVyIHBhcmFtZXRlciBhcyBk
ZXNjcmliZWQgaW4gW1hURVJNXSBpbiB0
aGUgZmluYWwKICAgKiAgICB0YWJsZSBv
ZiB0aGUgIlBDLVN0eWxlIEZ1bmN0aW9u
IEtleXMiIHNlY3Rpb24uCiAgICoKICAg
KiAgLSBJZiB0aGUgY29udHJvbCBrZXkg
aXMgZG93biBhbmQgdGhlIGtleSByZXBy
ZXNlbnRzIGEgcHJpbnRhYmxlIGNoYXJh
Y3RlciwKICAgKiAgICBhbmQgdGhlIHVw
cGVyY2FzZSB2ZXJzaW9uIG9mIHRoZSB1
bnNoaWZ0ZWQga2V5Y2FwIGlzIGJldHdl
ZW4KICAgKiAgICA2NCAoQVNDSUkgJ0An
KSBhbmQgOTUgKEFTQ0lJICdfJyksIHRo
ZW4gdGhlIHVwcGVyY2FzZSB2ZXJzaW9u
IG9mIHRoZQogICAqICAgIHVuc2hpZnRl
ZCBrZXljYXAgbWludXMgNjQgaXMgc2Vu
dC4gIFRoaXMgbWFrZXMgJ15AJyBzZW5k
ICdceDAwJyBhbmQKICAgKiAgICAnXl8n
IHNlbmQgJ1x4MWYnLiAgKE5vdGUgdGhh
dCBvbmUgaGlnaGVyIHRoYXQgMHgxZiBp
cyAweDIwLCB3aGljaCBpcwogICAqICAg
IHRoZSBmaXJzdCBwcmludGFibGUgQVND
SUkgdmFsdWUuKQogICAqCiAgICogIC0g
SWYgdGhlIGFsdCBrZXkgaXMgZG93biBh
bmQgdGhlIGtleSByZXByZXNlbnRzIGEg
cHJpbnRhYmxlIGNoYXJhY3RlciB0aGVu
CiAgICogICAgdGhlIHZhbHVlIG9mIHRo
ZSBjaGFyYWN0ZXIgaXMgc2hpZnRlZCB1
cCBieSAxMjguCiAgICoKICAgKiAgLSBJ
ZiBtZXRhIGlzIGRvd24gYW5kIGNvbmZp
Z3VyZWQgdG8gc2VuZCBhbiBlc2NhcGUs
ICdceDFiJyB3aWxsIGJlIHNlbnQKICAg
KiAgICBiZWZvcmUgdGhlIG5vcm1hbCBh
Y3Rpb24gaXMgcGVyZm9ybWVkLgogICAq
LwogIERFRkFVTFQ6IG5ldyBTdHJpbmco
J0RFRkFVTFQnKSwKCiAgLyoqCiAgICog
Q2F1c2VzIHRoZSB0ZXJtaW5hbCB0byBv
cHQgb3V0IG9mIGhhbmRsaW5nIHRoZSBr
ZXkgZXZlbnQsIGluc3RlYWQgbGV0dGlu
ZwogICAqIHRoZSBicm93c2VyIGRlYWwg
d2l0aCBpdC4KICAgKi8KICBQQVNTOiBu
ZXcgU3RyaW5nKCdQQVNTJyksCgogIC8q
KgogICAqIEluc2VydCB0aGUgZmlyc3Qg
b3Igc2Vjb25kIGNoYXJhY3RlciBvZiB0
aGUga2V5Q2FwLCBiYXNlZCBvbiBlLnNo
aWZ0S2V5LgogICAqIFRoZSBrZXkgd2ls
bCBiZSBoYW5kbGVkIGluIG9uS2V5RG93
biwgYW5kIGUucHJldmVudERlZmF1bHQo
KSB3aWxsIGJlCiAgICogY2FsbGVkLgog
ICAqCiAgICogSXQgaXMgdXNlZnVsIGZv
ciBhIG1vZGlmaWVkIGtleSBhY3Rpb24s
IHdoZXJlIGl0IGVzc2VudGlhbGx5IHN0
cmlwcyB0aGUKICAgKiBtb2RpZmllciB3
aGlsZSBwcmV2ZW50aW5nIHRoZSBicm93
c2VyIGZyb20gcmVhY3RpbmcgdG8gdGhl
IGtleS4KICAgKi8KICBTVFJJUDogbmV3
IFN0cmluZygnU1RSSVAnKQp9OwoKLyoq
CiAqIEVuY29kZSBhIHN0cmluZyBhY2Nv
cmRpbmcgdG8gdGhlICdzZW5kLWVuY29k
aW5nJyBwcmVmZXJlbmNlLgogKi8KaHRl
cm0uS2V5Ym9hcmQucHJvdG90eXBlLmVu
Y29kZSA9IGZ1bmN0aW9uKHN0cikgewog
IGlmICh0aGlzLmNoYXJhY3RlckVuY29k
aW5nID09ICd1dGYtOCcpCiAgICByZXR1
cm4gdGhpcy50ZXJtaW5hbC52dC5lbmNv
ZGVVVEY4KHN0cik7CgogIHJldHVybiBz
dHI7Cn07CgovKioKICogQ2FwdHVyZSBr
ZXlib2FyZCBldmVudHMgc2VudCB0byB0
aGUgYXNzb2NpYXRlZCBlbGVtZW50Lgog
KgogKiBUaGlzIGVuYWJsZXMgdGhlIGtl
eWJvYXJkLiAgQ2FwdHVyZWQgZXZlbnRz
IGFyZSBjb25zdW1lZCBieSB0aGlzIGNs
YXNzCiAqIGFuZCB3aWxsIG5vdCBwZXJm
b3JtIHRoZWlyIGRlZmF1bHQgYWN0aW9u
IG9yIGJ1YmJsZSB0byBvdGhlciBlbGVt
ZW50cy4KICoKICogUGFzc2luZyBhIG51
bGwgZWxlbWVudCB3aWxsIHVuaW5zdGFs
bCB0aGUga2V5Ym9hcmQgaGFuZGxlcnMu
CiAqCiAqIEBwYXJhbSB7SFRNTEVsZW1l
bnR9IGVsZW1lbnQgVGhlIGVsZW1lbnQg
d2hvc2UgZXZlbnRzIHNob3VsZCBiZSBj
YXB0dXJlZCwgb3IKICogICAgIG51bGwg
dG8gZGlzYWJsZSB0aGUga2V5Ym9hcmQu
CiAqLwpodGVybS5LZXlib2FyZC5wcm90
b3R5cGUuaW5zdGFsbEtleWJvYXJkID0g
ZnVuY3Rpb24oZWxlbWVudCkgewogIGlm
IChlbGVtZW50ID09IHRoaXMua2V5Ym9h
cmRFbGVtZW50XykKICAgIHJldHVybjsK
CiAgaWYgKGVsZW1lbnQgJiYgdGhpcy5r
ZXlib2FyZEVsZW1lbnRfKQogICAgdGhp
cy5pbnN0YWxsS2V5Ym9hcmQobnVsbCk7
CgogIGZvciAodmFyIGkgPSAwOyBpIDwg
dGhpcy5oYW5kbGVyc18ubGVuZ3RoOyBp
KyspIHsKICAgIHZhciBoYW5kbGVyID0g
dGhpcy5oYW5kbGVyc19baV07CiAgICBp
ZiAoZWxlbWVudCkgewogICAgICBlbGVt
ZW50LmFkZEV2ZW50TGlzdGVuZXIoaGFu
ZGxlclswXSwgaGFuZGxlclsxXSk7CiAg
ICB9IGVsc2UgewogICAgICB0aGlzLmtl
eWJvYXJkRWxlbWVudF8ucmVtb3ZlRXZl
bnRMaXN0ZW5lcihoYW5kbGVyWzBdLCBo
YW5kbGVyWzFdKTsKICAgIH0KICB9Cgog
IHRoaXMua2V5Ym9hcmRFbGVtZW50XyA9
IGVsZW1lbnQ7Cn07CgovKioKICogRGlz
YWJsZSBrZXlib2FyZCBldmVudCBjYXB0
dXJlLgogKgogKiBUaGlzIHdpbGwgYWxs
b3cgdGhlIGJyb3dzZXIgdG8gcHJvY2Vz
cyBrZXkgZXZlbnRzIG5vcm1hbGx5Lgog
Ki8KaHRlcm0uS2V5Ym9hcmQucHJvdG90
eXBlLnVuaW5zdGFsbEtleWJvYXJkID0g
ZnVuY3Rpb24oKSB7CiAgdGhpcy5pbnN0
YWxsS2V5Ym9hcmQobnVsbCk7Cn07Cgov
KioKICogSGFuZGxlIG9uVGV4dElucHV0
IGV2ZW50cy4KICoKICogV2UncmUgbm90
IGFjdHVhbGx5IHN1cHBvc2VkIHRvIGdl
dCB0aGVzZSwgYnV0IHdlIGRvIG9uIHRo
ZSBNYWMgaW4gdGhlIGNhc2UKICogd2hl
cmUgYSB0aGlyZCBwYXJ0eSBhcHAgc2Vu
ZHMgc3ludGhldGljIGtleXN0cm9rZXMg
dG8gQ2hyb21lLgogKi8KaHRlcm0uS2V5
Ym9hcmQucHJvdG90eXBlLm9uVGV4dElu
cHV0XyA9IGZ1bmN0aW9uKGUpIHsKICBp
ZiAoIWUuZGF0YSkKICAgIHJldHVybjsK
CiAgZS5kYXRhLnNwbGl0KCcnKS5mb3JF
YWNoKHRoaXMudGVybWluYWwub25WVEtl
eXN0cm9rZS5iaW5kKHRoaXMudGVybWlu
YWwpKTsKfTsKCi8qKgogKiBIYW5kbGUg
b25LZXlQcmVzcyBldmVudHMuCiAqLwpo
dGVybS5LZXlib2FyZC5wcm90b3R5cGUu
b25LZXlQcmVzc18gPSBmdW5jdGlvbihl
KSB7CiAgdmFyIGNvZGU7CgogIHZhciBr
ZXkgPSBTdHJpbmcuZnJvbUNoYXJDb2Rl
KGUud2hpY2gpOwogIHZhciBsb3dlcktl
eSA9IGtleS50b0xvd2VyQ2FzZSgpOwog
IGlmICgoZS5jdHJsS2V5IHx8IGUubWV0
YUtleSkgJiYgKGxvd2VyS2V5ID09ICdj
JyB8fCBsb3dlcktleSA9PSAndicpKSB7
CiAgICAvLyBPbiBGRiB0aGUga2V5IHBy
ZXNzIChub3Qga2V5IGRvd24pIGV2ZW50
IGdldHMgZmlyZWQgZm9yIGNvcHkvcGFz
dGUuCiAgICAvLyBMZXQgaXQgZmFsbCB0
aHJvdWdoIGZvciB0aGUgZGVmYXVsdCBi
cm93c2VyIGJlaGF2aW91ci4KICAgIHJl
dHVybjsKICB9CgogIGlmIChlLmFsdEtl
eSAmJiB0aGlzLmFsdFNlbmRzV2hhdCA9
PSAnYnJvd3Nlci1rZXknICYmIGUuY2hh
ckNvZGUgPT0gMCkgewogICAgLy8gSWYg
d2UgZ290IGhlcmUgYmVjYXVzZSB3ZSB3
ZXJlIGV4cGVjdGluZyB0aGUgYnJvd3Nl
ciB0byBoYW5kbGUgYW4KICAgIC8vIGFs
dCBzZXF1ZW5jZSBidXQgaXQgZGlkbid0
IGRvIGl0LCB0aGVuIHdlIG1pZ2h0IGJl
IG9uIGFuIE9TIHdpdGhvdXQKICAgIC8v
IGFuIGVuYWJsZWQgSU1FIHN5c3RlbS4g
IEluIHRoYXQgY2FzZSB3ZSBmYWxsIGJh
Y2sgdG8geHRlcm0tbGlrZQogICAgLy8g
YmVoYXZpb3IuCiAgICAvLwogICAgLy8g
VGhpcyBoYXBwZW5zIGhlcmUgb25seSBh
cyBhIGZhbGxiYWNrLiAgVHlwaWNhbGx5
IHRoZXNlIHBsYXRmb3JtcyBzaG91bGQK
ICAgIC8vIHNldCBhbHRTZW5kc1doYXQg
dG8gZWl0aGVyICdlc2NhcGUnIG9yICc4
LWJpdCcuCiAgICB2YXIgY2ggPSBTdHJp
bmcuZnJvbUNoYXJDb2RlKGUua2V5Q29k
ZSk7CiAgICBpZiAoIWUuc2hpZnRLZXkp
CiAgICAgIGNoID0gY2gudG9Mb3dlckNh
c2UoKTsKICAgIGNvZGUgPSBjaC5jaGFy
Q29kZUF0KDApICsgMTI4OwoKICB9IGVs
c2UgaWYgKGUuY2hhckNvZGUgPj0gMzIp
IHsKICAgIGNoID0gZS5jaGFyQ29kZTsK
ICB9CgogIGlmIChjaCkKICAgIHRoaXMu
dGVybWluYWwub25WVEtleXN0cm9rZShT
dHJpbmcuZnJvbUNoYXJDb2RlKGNoKSk7
CgogIGUucHJldmVudERlZmF1bHQoKTsK
ICBlLnN0b3BQcm9wYWdhdGlvbigpOwp9
OwoKLyoqCiAqIFByZXZlbnQgZGVmYXVs
dCBoYW5kbGluZyBmb3Igbm9uLXNoaWZ0
ZWQgZXZlbnQuCiAqCiAqIFdoZW4gY29t
YmluZWQgd2l0aCBDaHJvbWUgcGVybWlz
c2lvbiAnYXBwLndpbmRvdy5mdWxsc2Ny
ZWVuLm92ZXJyaWRlRXNjJywKICogYW5k
IGNhbGxlZCBmb3IgYm90aCBrZXkgZG93
biBhbmQga2V5IHVwIGV2ZW50cywKICog
dGhlIEVTQyBrZXkgcmVtYWlucyB1c2Fi
bGUgd2l0aGluIGZ1bGxzY3JlZW4gQ2hy
b21lIGFwcCB3aW5kb3dzLgogKi8KaHRl
cm0uS2V5Ym9hcmQucHJvdG90eXBlLnBy
ZXZlbnRDaHJvbWVBcHBOb25TaGlmdERl
ZmF1bHRfID0gZnVuY3Rpb24oZSkgewog
IGlmICghd2luZG93LmNocm9tZSB8fCAh
d2luZG93LmNocm9tZS5hcHAgfHwgIXdp
bmRvdy5jaHJvbWUuYXBwLndpbmRvdykK
ICAgIHJldHVybjsKICBpZiAoIWUuc2hp
ZnRLZXkpCiAgICBlLnByZXZlbnREZWZh
dWx0KCk7Cn07CgpodGVybS5LZXlib2Fy
ZC5wcm90b3R5cGUub25CbHVyXyA9IGZ1
bmN0aW9uKGUpIHsKICB0aGlzLmFsdEtl
eVByZXNzZWQgPSAwOwp9OwoKaHRlcm0u
S2V5Ym9hcmQucHJvdG90eXBlLm9uS2V5
VXBfID0gZnVuY3Rpb24oZSkgewogIGlm
IChlLmtleUNvZGUgPT0gMTgpCiAgICB0
aGlzLmFsdEtleVByZXNzZWQgPSB0aGlz
LmFsdEtleVByZXNzZWQgJiB+KDEgPDwg
KGUubG9jYXRpb24gLSAxKSk7CgogIGlm
IChlLmtleUNvZGUgPT0gMjcpCiAgICB0
aGlzLnByZXZlbnRDaHJvbWVBcHBOb25T
aGlmdERlZmF1bHRfKGUpOwp9OwoKLyoq
CiAqIEhhbmRsZSBvbktleURvd24gZXZl
bnRzLgogKi8KaHRlcm0uS2V5Ym9hcmQu
cHJvdG90eXBlLm9uS2V5RG93bl8gPSBm
dW5jdGlvbihlKSB7CiAgaWYgKGUua2V5
Q29kZSA9PSAxOCkKICAgIHRoaXMuYWx0
S2V5UHJlc3NlZCA9IHRoaXMuYWx0S2V5
UHJlc3NlZCB8ICgxIDw8IChlLmxvY2F0
aW9uIC0gMSkpOwoKICBpZiAoZS5rZXlD
b2RlID09IDI3KQogICAgdGhpcy5wcmV2
ZW50Q2hyb21lQXBwTm9uU2hpZnREZWZh
dWx0XyhlKTsKCiAgdmFyIGtleURlZiA9
IHRoaXMua2V5TWFwLmtleURlZnNbZS5r
ZXlDb2RlXTsKICBpZiAoIWtleURlZikg
ewogICAgY29uc29sZS53YXJuKCdObyBk
ZWZpbml0aW9uIGZvciBrZXlDb2RlOiAn
ICsgZS5rZXlDb2RlKTsKICAgIHJldHVy
bjsKICB9CgogIC8vIFRoZSB0eXBlIG9m
IGFjdGlvbiB3ZSdyZSBnb2luZyB0byB1
c2UuCiAgdmFyIHJlc29sdmVkQWN0aW9u
VHlwZSA9IG51bGw7CgogIHZhciBzZWxm
ID0gdGhpczsKICBmdW5jdGlvbiBnZXRB
Y3Rpb24obmFtZSkgewogICAgLy8gR2V0
IHRoZSBrZXkgYWN0aW9uIGZvciB0aGUg
Z2l2ZW4gYWN0aW9uIG5hbWUuICBJZiB0
aGUgYWN0aW9uIGlzIGEKICAgIC8vIGZ1
bmN0aW9uLCBkaXNwYXRjaCBpdC4gIElm
IHRoZSBhY3Rpb24gZGVmZXJzIHRvIHRo
ZSBub3JtYWwgYWN0aW9uLAogICAgLy8g
cmVzb2x2ZSB0aGF0IGluc3RlYWQuCgog
ICAgcmVzb2x2ZWRBY3Rpb25UeXBlID0g
bmFtZTsKCiAgICB2YXIgYWN0aW9uID0g
a2V5RGVmW25hbWVdOwogICAgaWYgKHR5
cGVvZiBhY3Rpb24gPT0gJ2Z1bmN0aW9u
JykKICAgICAgYWN0aW9uID0gYWN0aW9u
LmFwcGx5KHNlbGYua2V5TWFwLCBbZSwg
a2V5RGVmXSk7CgogICAgaWYgKGFjdGlv
biA9PT0gREVGQVVMVCAmJiBuYW1lICE9
ICdub3JtYWwnKQogICAgICBhY3Rpb24g
PSBnZXRBY3Rpb24oJ25vcm1hbCcpOwoK
ICAgIHJldHVybiBhY3Rpb247CiAgfQoK
ICAvLyBOb3RlIHRoYXQgd2UgdXNlIHRo
ZSB0cmlwbGUtZXF1YWxzICgnPT09Jykg
b3BlcmF0b3IgdG8gdGVzdCBlcXVhbGl0
eSBmb3IKICAvLyB0aGVzZSBjb25zdGFu
dHMsIGluIG9yZGVyIHRvIGRpc3Rpbmd1
c2ggdXNhZ2Ugb2YgdGhlIGNvbnN0YW50
IGZyb20gdXNhZ2UKICAvLyBvZiBhIGxp
dGVyYWwgc3RyaW5nIHRoYXQgaGFwcGVu
cyB0byBjb250YWluIHRoZSBzYW1lIGJ5
dGVzLgogIHZhciBDQU5DRUwgPSBodGVy
bS5LZXlib2FyZC5LZXlBY3Rpb25zLkNB
TkNFTDsKICB2YXIgREVGQVVMVCA9IGh0
ZXJtLktleWJvYXJkLktleUFjdGlvbnMu
REVGQVVMVDsKICB2YXIgUEFTUyA9IGh0
ZXJtLktleWJvYXJkLktleUFjdGlvbnMu
UEFTUzsKICB2YXIgU1RSSVAgPSBodGVy
bS5LZXlib2FyZC5LZXlBY3Rpb25zLlNU
UklQOwoKICB2YXIgY29udHJvbCA9IGUu
Y3RybEtleTsKICB2YXIgYWx0ID0gdGhp
cy5hbHRJc01ldGEgPyBmYWxzZSA6IGUu
YWx0S2V5OwogIHZhciBtZXRhID0gdGhp
cy5hbHRJc01ldGEgPyAoZS5hbHRLZXkg
fHwgZS5tZXRhS2V5KSA6IGUubWV0YUtl
eTsKCiAgLy8gSW4gdGhlIGtleS1tYXAs
IHdlIHN1cnJvdW5kIHRoZSBrZXlDYXAg
Zm9yIG5vbi1wcmludGFibGVzIGluICJb
Li4uXSIKICB2YXIgaXNQcmludGFibGUg
PSAhKC9eXFtcdytcXSQvLnRlc3Qoa2V5
RGVmLmtleUNhcCkpOwoKICBzd2l0Y2gg
KHRoaXMuYWx0R3JNb2RlKSB7CiAgICBj
YXNlICdjdHJsLWFsdCc6CiAgICBpZiAo
aXNQcmludGFibGUgJiYgY29udHJvbCAm
JiBhbHQpIHsKICAgICAgLy8gY3RybC1h
bHQtcHJpbnRhYmxlIG1lYW5zIGFsdEdy
LiAgV2UgY2xlYXIgb3V0IHRoZSBjb250
cm9sIGFuZAogICAgICAvLyBhbHQgbW9k
aWZpZXJzIGFuZCB3YWl0IHRvIHNlZSB0
aGUgY2hhckNvZGUgaW4gdGhlIGtleWRv
d24gZXZlbnQuCiAgICAgIGNvbnRyb2wg
PSBmYWxzZTsKICAgICAgYWx0ID0gZmFs
c2U7CiAgICB9CiAgICBicmVhazsKCiAg
ICBjYXNlICdyaWdodC1hbHQnOgogICAg
aWYgKGlzUHJpbnRhYmxlICYmICh0aGlz
LnRlcm1pbmFsLmtleWJvYXJkLmFsdEtl
eVByZXNzZWQgJiAyKSkgewogICAgICBj
b250cm9sID0gZmFsc2U7CiAgICAgIGFs
dCA9IGZhbHNlOwogICAgfQogICAgYnJl
YWs7CgogICAgY2FzZSAnbGVmdC1hbHQn
OgogICAgaWYgKGlzUHJpbnRhYmxlICYm
ICh0aGlzLnRlcm1pbmFsLmtleWJvYXJk
LmFsdEtleVByZXNzZWQgJiAxKSkgewog
ICAgICBjb250cm9sID0gZmFsc2U7CiAg
ICAgIGFsdCA9IGZhbHNlOwogICAgfQog
ICAgYnJlYWs7CiAgfQoKICB2YXIgYWN0
aW9uOwoKICBpZiAoY29udHJvbCkgewog
ICAgYWN0aW9uID0gZ2V0QWN0aW9uKCdj
b250cm9sJyk7CiAgfSBlbHNlIGlmIChh
bHQpIHsKICAgIGFjdGlvbiA9IGdldEFj
dGlvbignYWx0Jyk7CiAgfSBlbHNlIGlm
IChtZXRhKSB7CiAgICBhY3Rpb24gPSBn
ZXRBY3Rpb24oJ21ldGEnKTsKICB9IGVs
c2UgewogICAgYWN0aW9uID0gZ2V0QWN0
aW9uKCdub3JtYWwnKTsKICB9CgogIGlm
IChhbHQgJiYgdGhpcy5hbHRTZW5kc1do
YXQgPT0gJ2Jyb3dzZXIta2V5JyAmJiBh
Y3Rpb24gPT0gREVGQVVMVCkgewogICAg
Ly8gV2hlbiBhbHRTZW5kc1doYXQgaXMg
J2Jyb3dzZXIta2V5Jywgd2Ugd2FpdCBm
b3IgdGhlIGtleXByZXNzIGV2ZW50Lgog
ICAgLy8gSW4ga2V5cHJlc3MsIHRoZSBi
cm93c2VyIHNob3VsZCBoYXZlIHNldCB0
aGUgZXZlbnQuY2hhckNvZGUgdG8gdGhl
CiAgICAvLyBhcHByb3ByaWF0ZSBjaGFy
YWN0ZXIuCiAgICAvLyBUT0RPKHJnaW5k
YSk6IENoYXJhY3RlciBjb21wb3NpdGlv
bnMgd2lsbCBuZWVkIHNvbWUgYmxhY2sg
bWFnaWMuCiAgICBhY3Rpb24gPSBQQVNT
OwogIH0KCiAgaWYgKGFjdGlvbiA9PT0g
UEFTUyB8fCAoYWN0aW9uID09PSBERUZB
VUxUICYmICEoY29udHJvbCB8fCBhbHQg
fHwgbWV0YSkpKSB7CiAgICAvLyBJZiB0
aGlzIGtleSBpcyBzdXBwb3NlZCB0byBi
ZSBoYW5kbGVkIGJ5IHRoZSBicm93c2Vy
LCBvciBpdCBpcyBhbgogICAgLy8gdW5t
b2RpZmllZCBrZXkgd2l0aCB0aGUgZGVm
YXVsdCBhY3Rpb24sIHRoZW4gZXhpdCB0
aGlzIGV2ZW50IGhhbmRsZXIuCiAgICAv
LyBJZiBpdCdzIGFuIHVubW9kaWZpZWQg
a2V5LCBpdCdsbCBiZSBoYW5kbGVkIGlu
IG9uS2V5UHJlc3Mgd2hlcmUgd2UKICAg
IC8vIGNhbiB0ZWxsIGZvciBzdXJlIHdo
aWNoIEFTQ0lJIGNvZGUgdG8gaW5zZXJ0
LgogICAgLy8KICAgIC8vIFRoaXMgYmxv
Y2sgbmVlZHMgdG8gY29tZSBiZWZvcmUg
dGhlIFNUUklQIHRlc3QsIG90aGVyd2lz
ZSB3ZSdsbCBzdHJpcAogICAgLy8gdGhl
IG1vZGlmaWVyIGFuZCB0aGluayBpdCdz
IG9rIHRvIGxldCB0aGUgYnJvd3NlciBo
YW5kbGUgdGhlIGtleXByZXNzLgogICAg
Ly8gVGhlIGJyb3dzZXIgd29uJ3Qga25v
dyB3ZSdyZSB0cnlpbmcgdG8gaWdub3Jl
IHRoZSBtb2RpZmllcnMgYW5kIG1pZ2h0
CiAgICAvLyBwZXJmb3JtIHNvbWUgZGVm
YXVsdCBhY3Rpb24uCiAgICByZXR1cm47
CiAgfQoKICBpZiAoYWN0aW9uID09PSBT
VFJJUCkgewogICAgYWx0ID0gY29udHJv
bCA9IGZhbHNlOwogICAgYWN0aW9uID0g
a2V5RGVmLm5vcm1hbDsKICAgIGlmICh0
eXBlb2YgYWN0aW9uID09ICdmdW5jdGlv
bicpCiAgICAgIGFjdGlvbiA9IGFjdGlv
bi5hcHBseSh0aGlzLmtleU1hcCwgW2Us
IGtleURlZl0pOwoKICAgIGlmIChhY3Rp
b24gPT0gREVGQVVMVCAmJiBrZXlEZWYu
a2V5Q2FwLmxlbmd0aCA9PSAyKQogICAg
ICBhY3Rpb24gPSBrZXlEZWYua2V5Q2Fw
LnN1YnN0cigoZS5zaGlmdEtleSA/IDEg
OiAwKSwgMSk7CiAgfQoKICBlLnByZXZl
bnREZWZhdWx0KCk7CiAgZS5zdG9wUHJv
cGFnYXRpb24oKTsKCiAgaWYgKGFjdGlv
biA9PT0gQ0FOQ0VMKQogICAgcmV0dXJu
OwoKICBpZiAoYWN0aW9uICE9PSBERUZB
VUxUICYmIHR5cGVvZiBhY3Rpb24gIT0g
J3N0cmluZycpIHsKICAgIGNvbnNvbGUu
d2FybignSW52YWxpZCBhY3Rpb246ICcg
KyBKU09OLnN0cmluZ2lmeShhY3Rpb24p
KTsKICAgIHJldHVybjsKICB9CgogIC8v
IFN0cmlwIHRoZSBtb2RpZmllciB0aGF0
IGlzIGFzc29jaWF0ZWQgd2l0aCB0aGUg
YWN0aW9uLCBzaW5jZSB3ZSBhc3N1bWUg
dGhhdAogIC8vIG1vZGlmaWVyIGhhcyBh
bHJlYWR5IGJlZW4gYWNjb3VudGVkIGZv
ciBpbiB0aGUgYWN0aW9uLgogIGlmIChy
ZXNvbHZlZEFjdGlvblR5cGUgPT0gJ2Nv
bnRyb2wnKSB7CiAgICBjb250cm9sID0g
ZmFsc2U7CiAgfSBlbHNlIGlmIChyZXNv
bHZlZEFjdGlvblR5cGUgPT0gJ2FsdCcp
IHsKICAgIGFsdCA9IGZhbHNlOwogIH0g
ZWxzZSBpZiAocmVzb2x2ZWRBY3Rpb25U
eXBlID09ICdtZXRhJykgewogICAgbWV0
YSA9IGZhbHNlOwogIH0KCiAgLy8gTWF5
YmUgc3RyaXAgdGhlIHNoaWZ0IG1vZGlm
aWVyIHRvbywgZm9yIHRoZSBzYW1lIHJl
YXNvbiBhcyBhYm92ZS4KICAvLyBUaGlz
IGlzIG9ubHkgdXNlZCBmb3IgQ3RybC1T
aGlmdC1UYWIsIHdoaWNoIHNob3VsZCBz
ZW5kICJDU0kgWiIsIG5vdAogIC8vICJD
U0kgMSA7IDIgWiIuCiAgdmFyIHNoaWZ0
ID0gIWUubWFza1NoaWZ0S2V5ICYmIGUu
c2hpZnRLZXk7CgogIGlmIChhY3Rpb24u
c3Vic3RyKDAsIDIpID09ICdceDFiWycg
JiYgKGFsdCB8fCBjb250cm9sIHx8IHNo
aWZ0KSkgewogICAgLy8gVGhlIGFjdGlv
biBpcyBhbiBlc2NhcGUgc2VxdWVuY2Ug
dGhhdCBhbmQgaXQgd2FzIHRyaWdnZXJl
ZCBpbiB0aGUKICAgIC8vIHByZXNlbmNl
IG9mIGEga2V5Ym9hcmQgbW9kaWZpZXIs
IHdlIG1heSBuZWVkIHRvIGFsdGVyIHRo
ZSBhY3Rpb24gdG8KICAgIC8vIGluY2x1
ZGUgdGhlIG1vZGlmaWVyIGJlZm9yZSBz
ZW5kaW5nIGl0LgoKICAgIHZhciBtb2Q7
CgogICAgaWYgKHNoaWZ0ICYmICEoYWx0
IHx8IGNvbnRyb2wpKSB7CiAgICAgIG1v
ZCA9ICc7Mic7CiAgICB9IGVsc2UgaWYg
KGFsdCAmJiAhKHNoaWZ0IHx8IGNvbnRy
b2wpKSB7CiAgICAgIG1vZCA9ICc7Myc7
CiAgICB9IGVsc2UgaWYgKHNoaWZ0ICYm
IGFsdCAmJiAhY29udHJvbCkgewogICAg
ICBtb2QgPSAnOzQnOwogICAgfSBlbHNl
IGlmIChjb250cm9sICYmICEoc2hpZnQg
fHwgYWx0KSkgewogICAgICBtb2QgPSAn
OzUnOwogICAgfSBlbHNlIGlmIChzaGlm
dCAmJiBjb250cm9sICYmICFhbHQpIHsK
ICAgICAgbW9kID0gJzs2JzsKICAgIH0g
ZWxzZSBpZiAoYWx0ICYmIGNvbnRyb2wg
JiYgIXNoaWZ0KSB7CiAgICAgIG1vZCA9
ICc7Nyc7CiAgICB9IGVsc2UgaWYgKHNo
aWZ0ICYmIGFsdCAmJiBjb250cm9sKSB7
CiAgICAgIG1vZCA9ICc7OCc7CiAgICB9
CgogICAgaWYgKGFjdGlvbi5sZW5ndGgg
PT0gMykgewogICAgICAvLyBTb21lIG9m
IHRoZSBDU0kgc2VxdWVuY2VzIGhhdmUg
emVybyBwYXJhbWV0ZXJzIHVubGVzcyBt
b2RpZmllZC4KICAgICAgYWN0aW9uID0g
J1x4MWJbMScgKyBtb2QgKyBhY3Rpb24u
c3Vic3RyKDIsIDEpOwogICAgfSBlbHNl
IHsKICAgICAgLy8gT3RoZXJzIGFsd2F5
cyBoYXZlIGF0IGxlYXN0IG9uZSBwYXJh
bWV0ZXIuCiAgICAgIGFjdGlvbiA9IGFj
dGlvbi5zdWJzdHIoMCwgYWN0aW9uLmxl
bmd0aCAtIDEpICsgbW9kICsKICAgICAg
ICAgIGFjdGlvbi5zdWJzdHIoYWN0aW9u
Lmxlbmd0aCAtIDEpOwogICAgfQoKICB9
IGVsc2UgewogICAgaWYgKGFjdGlvbiA9
PT0gREVGQVVMVCkgewogICAgICBhY3Rp
b24gPSBrZXlEZWYua2V5Q2FwLnN1YnN0
cigoZS5zaGlmdEtleSA/IDEgOiAwKSwg
MSk7CgogICAgICBpZiAoY29udHJvbCkg
ewogICAgICAgIHZhciB1bnNoaWZ0ZWQg
PSBrZXlEZWYua2V5Q2FwLnN1YnN0cigw
LCAxKTsKICAgICAgICB2YXIgY29kZSA9
IHVuc2hpZnRlZC5jaGFyQ29kZUF0KDAp
OwogICAgICAgIGlmIChjb2RlID49IDY0
ICYmIGNvZGUgPD0gOTUpIHsKICAgICAg
ICAgIGFjdGlvbiA9IFN0cmluZy5mcm9t
Q2hhckNvZGUoY29kZSAtIDY0KTsKICAg
ICAgICB9CiAgICAgIH0KICAgIH0KCiAg
ICBpZiAoYWx0ICYmIHRoaXMuYWx0U2Vu
ZHNXaGF0ID09ICc4LWJpdCcgJiYgYWN0
aW9uLmxlbmd0aCA9PSAxKSB7CiAgICAg
IHZhciBjb2RlID0gYWN0aW9uLmNoYXJD
b2RlQXQoMCkgKyAxMjg7CiAgICAgIGFj
dGlvbiA9IFN0cmluZy5mcm9tQ2hhckNv
ZGUoY29kZSk7CiAgICB9CgogICAgLy8g
V2UgcmVzcGVjdCBhbHQvbWV0YVNlbmRz
RXNjYXBlIGV2ZW4gaWYgdGhlIGtleW1h
cCBhY3Rpb24gd2FzIGEgbGl0ZXJhbAog
ICAgLy8gc3RyaW5nLiAgT3RoZXJ3aXNl
LCBldmVyeSBvdmVycmlkZGVuIGFsdC9t
ZXRhIGFjdGlvbiB3b3VsZCBoYXZlIHRv
CiAgICAvLyBjaGVjayBhbHQvbWV0YVNl
bmRzRXNjYXBlLgogICAgaWYgKChhbHQg
JiYgdGhpcy5hbHRTZW5kc1doYXQgPT0g
J2VzY2FwZScpIHx8CiAgICAgICAgKG1l
dGEgJiYgdGhpcy5tZXRhU2VuZHNFc2Nh
cGUpKSB7CiAgICAgIGFjdGlvbiA9ICdc
eDFiJyArIGFjdGlvbjsKICAgIH0KICB9
CgogIHRoaXMudGVybWluYWwub25WVEtl
eXN0cm9rZShhY3Rpb24pOwp9OwovLyBT
T1VSQ0UgRklMRTogaHRlcm0vanMvaHRl
cm1fa2V5Ym9hcmRfa2V5bWFwLmpzCi8v
IENvcHlyaWdodCAoYykgMjAxMiBUaGUg
Q2hyb21pdW0gT1MgQXV0aG9ycy4gQWxs
IHJpZ2h0cyByZXNlcnZlZC4KLy8gVXNl
IG9mIHRoaXMgc291cmNlIGNvZGUgaXMg
Z292ZXJuZWQgYnkgYSBCU0Qtc3R5bGUg
bGljZW5zZSB0aGF0IGNhbiBiZQovLyBm
b3VuZCBpbiB0aGUgTElDRU5TRSBmaWxl
LgoKJ3VzZSBzdHJpY3QnOwoKbGliLnJ0
ZGVwKCdodGVybS5LZXlib2FyZC5LZXlB
Y3Rpb25zJyk7CgovKioKICogVGhlIGRl
ZmF1bHQga2V5IG1hcCBmb3IgaHRlcm0u
CiAqCiAqIENvbnRhaW5zIGEgbWFwcGlu
ZyBvZiBrZXlDb2RlcyB0byBrZXlEZWZz
IChha2Ega2V5IGRlZmluaXRpb25zKS4g
IFRoZSBrZXkKICogZGVmaW5pdGlvbiB0
ZWxscyB0aGUgaHRlcm0uS2V5Ym9hcmQg
Y2xhc3MgaG93IHRvIGhhbmRsZSBrZXlj
b2Rlcy4KICoKICogVGhpcyBzaG91bGQg
d29yayBmb3IgbW9zdCBjYXNlcywgYXMg
dGhlIHByaW50YWJsZSBjaGFyYWN0ZXJz
IGdldCBoYW5kbGVkCiAqIGluIHRoZSBr
ZXlwcmVzcyBldmVudC4gIEluIHRoYXQg
Y2FzZSwgZXZlbiBpZiB0aGUga2V5Y2Fw
IGlzIHdyb25nIGluIHRoZQogKiBrZXkg
bWFwLCB0aGUgY29ycmVjdCBjaGFyYWN0
ZXIgc2hvdWxkIGJlIHNlbnQuCiAqCiAq
IERpZmZlcmVudCBsYXlvdXRzLCBzdWNo
IGFzIER2b3JhayBzaG91bGQgd29yayB3
aXRoIHRoaXMga2V5bWFwLCBhcyB0aG9z
ZQogKiBsYXlvdXRzIHR5cGljYWxseSBt
b3ZlIGtleWNvZGVzIGFyb3VuZCBvbiB0
aGUga2V5Ym9hcmQgd2l0aG91dCBkaXN0
dXJiaW5nCiAqIHRoZSBhY3R1YWwga2V5
Y2Fwcy4KICoKICogVGhlcmUgbWF5IGJl
IGlzc3VlcyB3aXRoIGNvbnRyb2wga2V5
cyBvbiBub24tVVMga2V5Ym9hcmRzIG9y
IHdpdGgga2V5Ym9hcmRzCiAqIHRoYXQg
dmVyeSBzaWduaWZpY2FudGx5IGZyb20g
dGhlIGV4cGVjdGF0aW9ucyBoZXJlLCBp
biB3aGljaCBjYXNlIHdlIG1heQogKiBo
YXZlIHRvIGludmVudCBuZXcga2V5IG1h
cHMuCiAqCiAqIFRoZSBzZXF1ZW5jZXMg
ZGVmaW5lZCBpbiB0aGlzIGtleSBtYXAg
Y29tZSBmcm9tIFtYVEVSTV0gYXMgcmVm
ZXJlbmNlZCBpbgogKiB2dC5qcywgc3Rh
cnRpbmcgd2l0aCB0aGUgc2VjdGlvbiB0
aXRsZWQgIkFsdCBhbmQgTWV0YSBLZXlz
Ii4KICovCmh0ZXJtLktleWJvYXJkLktl
eU1hcCA9IGZ1bmN0aW9uKGtleWJvYXJk
KSB7CiAgdGhpcy5rZXlib2FyZCA9IGtl
eWJvYXJkOwogIHRoaXMua2V5RGVmcyA9
IHt9OwogIHRoaXMucmVzZXQoKTsKfTsK
Ci8qKgogKiBBZGQgYSBzaW5nbGUga2V5
IGRlZmluaXRpb24uCiAqCiAqIFRoZSBk
ZWZpbml0aW9uIGlzIGEgaGFzaCBjb250
YWluaW5nIHRoZSBmb2xsb3dpbmcga2V5
czogJ2tleUNhcCcsICdub3JtYWwnLAog
KiAnY29udHJvbCcsIGFuZCAnYWx0Jy4K
ICoKICogIC0ga2V5Q2FwIGlzIGEgc3Ry
aW5nIGlkZW50aWZ5aW5nIHRoZSBrZXku
ICBGb3IgcHJpbnRhYmxlCiAqICAgIGtl
eXMsIHRoZSBrZXkgY2FwIHNob3VsZCBi
ZSBleGFjdGx5IHR3byBjaGFyYWN0ZXJz
LCBzdGFydGluZyB3aXRoIHRoZQogKiAg
ICB1bnNoaWZ0ZWQgdmVyc2lvbi4gIEZv
ciBleGFtcGxlLCAnYUEnLCAnYkInLCAn
MSEnIGFuZCAnPSsnLiAgRm9yCiAqICAg
IG5vbi1wcmludGFibGUgdGhlIGtleSBj
YXAgc2hvdWxkIGJlIHN1cnJvdW5kZWQg
aW4gc3F1YXJlIGJyYWNlcywgYXMgaW4K
ICogICAgJ1tJTlNdJywgJ1tMRUZUXScu
ICBCeSBjb252ZW50aW9uLCBub24tcHJp
bnRhYmxlIGtleWNhcHMgYXJlIGluIHVw
cGVyY2FzZQogKiAgICBidXQgdGhpcyBp
cyBub3QgYSBzdHJpY3QgcmVxdWlyZW1l
bnQuCiAqCiAqICAtIE5vcm1hbCBpcyB0
aGUgYWN0aW9uIHRoYXQgc2hvdWxkIGJl
IHBlcmZvcm1lZCB3aGVuIHRoZXkga2V5
IGlzIHByZXNzZWQKICogICAgaW4gdGhl
IGFic2VuY2Ugb2YgYW55IG1vZGlmaWVy
LiAgU2VlIGJlbG93IGZvciB0aGUgc3Vw
cG9ydGVkIGFjdGlvbnMuCiAqCiAqICAt
IENvbnRyb2wgaXMgdGhlIGFjdGlvbiB0
aGF0IHNob3VsZCBiZSBwZXJmb3JtZWQg
d2hlbiB0aGV5IGtleSBpcyBwcmVzc2Vk
CiAqICAgIGFsb25nIHdpdGggdGhlIGNv
bnRyb2wgbW9kaWZpZXIuICBTZWUgYmVs
b3cgZm9yIHRoZSBzdXBwb3J0ZWQgYWN0
aW9ucy4KICoKICogIC0gQWx0IGlzIHRo
ZSBhY3Rpb24gdGhhdCBzaG91bGQgYmUg
cGVyZm9ybWVkIHdoZW4gdGhleSBrZXkg
aXMgcHJlc3NlZAogKiAgICBhbG9uZyB3
aXRoIHRoZSBhbHQgbW9kaWZpZXIuICBT
ZWUgYmVsb3cgZm9yIHRoZSBzdXBwb3J0
ZWQgYWN0aW9ucy4KICoKICogIC0gTWV0
YSBpcyB0aGUgYWN0aW9uIHRoYXQgc2hv
dWxkIGJlIHBlcmZvcm1lZCB3aGVuIHRo
ZXkga2V5IGlzIHByZXNzZWQKICogICAg
YWxvbmcgd2l0aCB0aGUgbWV0YSBtb2Rp
Zmllci4gIFNlZSBiZWxvdyBmb3IgdGhl
IHN1cHBvcnRlZCBhY3Rpb25zLgogKgog
KiBBY3Rpb25zIGNhbiBiZSBvbmUgb2Yg
dGhlIGh0ZXJtLktleWJvYXJkLktleUFj
dGlvbnMgYXMgZG9jdW1lbnRlZCBiZWxv
dywKICogYSBsaXRlcmFsIHN0cmluZywg
b3IgYW4gYXJyYXkuICBJZiB0aGUgYWN0
aW9uIGlzIGEgbGl0ZXJhbCBzdHJpbmcg
dGhlbgogKiB0aGUgc3RyaW5nIGlzIHNl
bnQgZGlyZWN0bHkgdG8gdGhlIGhvc3Qu
ICBJZiB0aGUgYWN0aW9uIGlzIGFuIGFy
cmF5IGl0CiAqIGlzIHRha2VuIHRvIGJl
IGFuIGVzY2FwZSBzZXF1ZW5jZSB0aGF0
IG1heSBiZSBhbHRlcmVkIGJ5IG1vZGlm
aWVyIGtleXMuCiAqIFRoZSBzZWNvbmQt
dG8tbGFzdCBlbGVtZW50IG9mIHRoZSBh
cnJheSB3aWxsIGJlIG92ZXJ3cml0dGVu
IHdpdGggdGhlCiAqIHN0YXRlIG9mIHRo
ZSBtb2RpZmllciBrZXlzLCBhcyBzcGVj
aWZpZWQgaW4gdGhlIGZpbmFsIHRhYmxl
IG9mICJQQy1TdHlsZQogKiBGdW5jdGlv
biBLZXlzIiBmcm9tIFtYVEVSTV0uCiAq
LwpodGVybS5LZXlib2FyZC5LZXlNYXAu
cHJvdG90eXBlLmFkZEtleURlZiA9IGZ1
bmN0aW9uKGtleUNvZGUsIGRlZikgewog
IGlmIChrZXlDb2RlIGluIHRoaXMua2V5
RGVmcykKICAgIGNvbnNvbGUud2Fybign
RHVwbGljYXRlIGtleUNvZGU6ICcgKyBr
ZXlDb2RlKTsKCiAgdGhpcy5rZXlEZWZz
W2tleUNvZGVdID0gZGVmOwp9OwoKLyoq
CiAqIEFkZCBtdXRpcGxlIGtleSBkZWZp
bml0aW9ucyBpbiBhIHNpbmdsZSBjYWxs
LgogKgogKiBUaGlzIGZ1bmN0aW9uIHRh
a2VzIHRoZSBrZXkgZGVmaW5pdGlvbnMg
YXMgdmFyaWFibGUgYXJndW1lbnQgbGlz
dC4gIEVhY2gKICogYXJndW1lbnQgaXMg
dGhlIGtleSBkZWZpbml0aW9uIHNwZWNp
ZmllZCBhcyBhbiBhcnJheS4KICoKICog
KElmIHRoZSBmdW5jdGlvbiB0b29rIGV2
ZXJ5dGhpbmcgYXMgb25lIGJpZyBoYXNo
IHdlIGNvdWxkbid0IGRldGVjdAogKiBk
dXBsaWNhdGVzLCBhbmQgdGhlcmUgd291
bGQgYmUgYSBsb3QgbW9yZSB0eXBpbmcg
aW52b2x2ZWQuKQogKgogKiBFYWNoIGtl
eSBkZWZpbml0aW9uIHNob3VsZCBoYXZl
IDYgZWxlbWVudHM6IChrZXlDb2RlLCBr
ZXlDYXAsIG5vcm1hbCBhY3Rpb24sCiAq
IGNvbnRyb2wgYWN0aW9uLCBhbHQgYWN0
aW9uIGFuZCBtZXRhIGFjdGlvbikuICBT
ZWUgS2V5TWFwLmFkZEtleURlZiBmb3Ig
dGhlCiAqIG1lYW5pbmcgb2YgdGhlc2Ug
ZWxlbWVudHMuCiAqLwpodGVybS5LZXli
b2FyZC5LZXlNYXAucHJvdG90eXBlLmFk
ZEtleURlZnMgPSBmdW5jdGlvbih2YXJf
YXJncykgewogIGZvciAodmFyIGkgPSAw
OyBpIDwgYXJndW1lbnRzLmxlbmd0aDsg
aSsrKSB7CiAgICB0aGlzLmFkZEtleURl
Zihhcmd1bWVudHNbaV1bMF0sCiAgICAg
ICAgICAgICAgICAgICB7IGtleUNhcDog
YXJndW1lbnRzW2ldWzFdLAogICAgICAg
ICAgICAgICAgICAgICBub3JtYWw6IGFy
Z3VtZW50c1tpXVsyXSwKICAgICAgICAg
ICAgICAgICAgICAgY29udHJvbDogYXJn
dW1lbnRzW2ldWzNdLAogICAgICAgICAg
ICAgICAgICAgICBhbHQ6IGFyZ3VtZW50
c1tpXVs0XSwKICAgICAgICAgICAgICAg
ICAgICAgbWV0YTogYXJndW1lbnRzW2ld
WzVdCiAgICAgICAgICAgICAgICAgICB9
KTsKICB9Cn07CgovKioKICogSW5oZXJp
dCBmcm9tIGh0ZXJtLktleWJvYXJkLktl
eU1hcCwgYXMgZGVmaW5lZCBpbiBrZXli
b2FyZC5qcy4KICovCmh0ZXJtLktleWJv
YXJkLktleU1hcC5wcm90b3R5cGUgPSB7
CiAgX19wcm90b19fOiBodGVybS5LZXli
b2FyZC5LZXlNYXAucHJvdG90eXBlCn07
CgovKioKICogU2V0IHVwIHRoZSBkZWZh
dWx0IHN0YXRlIGZvciB0aGlzIGtleW1h
cC4KICovCmh0ZXJtLktleWJvYXJkLktl
eU1hcC5wcm90b3R5cGUucmVzZXQgPSBm
dW5jdGlvbigpIHsKICB0aGlzLmtleURl
ZnMgPSB7fTsKCiAgdmFyIHNlbGYgPSB0
aGlzOwoKICAvLyBUaGlzIGZ1bmN0aW9u
IGlzIHVzZWQgYnkgdGhlICJtYWNybyIg
ZnVuY3Rpb25zIGJlbG93LiAgSXQgbWFr
ZXMgaXQKICAvLyBwb3NzaWJsZSB0byB1
c2UgdGhlIGNhbGwoKSBtYWNybyBhcyBh
biBhcmd1bWVudCB0byBhbnkgb3RoZXIg
bWFjcm8uCiAgZnVuY3Rpb24gcmVzb2x2
ZShhY3Rpb24sIGUsIGspIHsKICAgIGlm
ICh0eXBlb2YgYWN0aW9uID09ICdmdW5j
dGlvbicpCiAgICAgIHJldHVybiBhY3Rp
b24uYXBwbHkoc2VsZiwgW2UsIGtdKTsK
CiAgICByZXR1cm4gYWN0aW9uOwogIH0K
CiAgLy8gSWYgbm90IGFwcGxpY2F0aW9u
IGtleXBhZCBhLCBlbHNlIGIuICBUaGUg
a2V5cyB0aGF0IGNhcmUgYWJvdXQKICAv
LyBhcHBsaWNhdGlvbiBrZXlwYWQgaWdu
b3JlIGl0IHdoZW4gdGhlIGtleSBpcyBt
b2RpZmllZC4KICBmdW5jdGlvbiBhayhh
LCBiKSB7CiAgICByZXR1cm4gZnVuY3Rp
b24oZSwgaykgewogICAgICB2YXIgYWN0
aW9uID0gKGUuc2hpZnRLZXkgfHwgZS5j
dHJsS2V5IHx8IGUuYWx0S2V5IHx8IGUu
bWV0YUtleSB8fAogICAgICAgICAgICAg
ICAgICAgICFzZWxmLmtleWJvYXJkLmFw
cGxpY2F0aW9uS2V5cGFkKSA/IGEgOiBi
OwogICAgICByZXR1cm4gcmVzb2x2ZShh
Y3Rpb24sIGUsIGspOwogICAgfTsKICB9
CgogIC8vIElmIG1vZCBvciBub3QgYXBw
bGljYXRpb24gY3Vyc29yIGEsIGVsc2Ug
Yi4gIFRoZSBrZXlzIHRoYXQgY2FyZSBh
Ym91dAogIC8vIGFwcGxpY2F0aW9uIGN1
cnNvciBpZ25vcmUgaXQgd2hlbiB0aGUg
a2V5IGlzIG1vZGlmaWVkLgogIGZ1bmN0
aW9uIGFjKGEsIGIpIHsKICAgIHJldHVy
biBmdW5jdGlvbihlLCBrKSB7CiAgICAg
IHZhciBhY3Rpb24gPSAoZS5zaGlmdEtl
eSB8fCBlLmN0cmxLZXkgfHwgZS5hbHRL
ZXkgfHwgZS5tZXRhS2V5IHx8CiAgICAg
ICAgICAgICAgICAgICAgIXNlbGYua2V5
Ym9hcmQuYXBwbGljYXRpb25DdXJzb3Ip
ID8gYSA6IGI7CiAgICAgIHJldHVybiBy
ZXNvbHZlKGFjdGlvbiwgZSwgayk7CiAg
ICB9OwogIH0KCiAgLy8gSWYgbm90IGJh
Y2tzcGFjZS1zZW5kcy1iYWNrc3BhY2Ug
a2V5cGFkIGEsIGVsc2UgYi4KICBmdW5j
dGlvbiBicyhhLCBiKSB7CiAgICByZXR1
cm4gZnVuY3Rpb24oZSwgaykgewogICAg
ICB2YXIgYWN0aW9uID0gIXNlbGYua2V5
Ym9hcmQuYmFja3NwYWNlU2VuZHNCYWNr
c3BhY2UgPyBhIDogYjsKICAgICAgcmV0
dXJuIHJlc29sdmUoYWN0aW9uLCBlLCBr
KTsKICAgIH07CiAgfQoKICAvLyBJZiBu
b3QgZS5zaGlmdEtleSBhLCBlbHNlIGIu
CiAgZnVuY3Rpb24gc2goYSwgYikgewog
ICAgcmV0dXJuIGZ1bmN0aW9uKGUsIGsp
IHsKICAgICAgdmFyIGFjdGlvbiA9ICFl
LnNoaWZ0S2V5ID8gYSA6IGI7CiAgICAg
IGUubWFza1NoaWZ0S2V5ID0gdHJ1ZTsK
ICAgICAgcmV0dXJuIHJlc29sdmUoYWN0
aW9uLCBlLCBrKTsKICAgIH07CiAgfQoK
ICAvLyBJZiBub3QgZS5hbHRLZXkgYSwg
ZWxzZSBiLgogIGZ1bmN0aW9uIGFsdChh
LCBiKSB7CiAgICByZXR1cm4gZnVuY3Rp
b24oZSwgaykgewogICAgICB2YXIgYWN0
aW9uID0gIWUuYWx0S2V5ID8gYSA6IGI7
CiAgICAgIHJldHVybiByZXNvbHZlKGFj
dGlvbiwgZSwgayk7CiAgICB9OwogIH0K
CiAgLy8gSWYgbm8gbW9kaWZpZXJzIGEs
IGVsc2UgYi4KICBmdW5jdGlvbiBtb2Qo
YSwgYikgewogICAgcmV0dXJuIGZ1bmN0
aW9uKGUsIGspIHsKICAgICAgdmFyIGFj
dGlvbiA9ICEoZS5zaGlmdEtleSB8fCBl
LmN0cmxLZXkgfHwgZS5hbHRLZXkgfHwg
ZS5tZXRhS2V5KSA/IGEgOiBiOwogICAg
ICByZXR1cm4gcmVzb2x2ZShhY3Rpb24s
IGUsIGspOwogICAgfTsKICB9CgogIC8v
IENvbXB1dGUgYSBjb250cm9sIGNoYXJh
Y3RlciBmb3IgYSBnaXZlbiBjaGFyYWN0
ZXIuCiAgZnVuY3Rpb24gY3RsKGNoKSB7
IHJldHVybiBTdHJpbmcuZnJvbUNoYXJD
b2RlKGNoLmNoYXJDb2RlQXQoMCkgLSA2
NCkgfQoKICAvLyBDYWxsIGEgbWV0aG9k
IG9uIHRoZSBrZXltYXAgaW5zdGFuY2Uu
CiAgZnVuY3Rpb24gYyhtKSB7IHJldHVy
biBmdW5jdGlvbiAoZSwgaykgeyByZXR1
cm4gdGhpc1ttXShlLCBrKSB9IH0KCiAg
Ly8gSWdub3JlIGlmIG5vdCB0cmFwcGlu
ZyBtZWRpYSBrZXlzLgogIGZ1bmN0aW9u
IG1lZChmbikgewogICAgcmV0dXJuIGZ1
bmN0aW9uKGUsIGspIHsKICAgICAgaWYg
KCFzZWxmLmtleWJvYXJkLm1lZGlhS2V5
c0FyZUZLZXlzKSB7CiAgICAgICAgLy8g
QmxvY2sgQmFjaywgRm9yd2FyZCwgYW5k
IFJlbG9hZCBrZXlzIHRvIGF2b2lkIG5h
dmlnYXRpbmcgYXdheSBmcm9tCiAgICAg
ICAgLy8gdGhlIGN1cnJlbnQgcGFnZS4K
ICAgICAgICByZXR1cm4gKGUua2V5Q29k
ZSA9PSAxNjYgfHwgZS5rZXlDb2RlID09
IDE2NyB8fCBlLmtleUNvZGUgPT0gMTY4
KSA/CiAgICAgICAgICAgIGh0ZXJtLktl
eWJvYXJkLktleUFjdGlvbnMuQ0FOQ0VM
IDoKICAgICAgICAgICAgaHRlcm0uS2V5
Ym9hcmQuS2V5QWN0aW9ucy5QQVNTOwog
ICAgICB9CiAgICAgIHJldHVybiByZXNv
bHZlKGZuLCBlLCBrKTsKICAgIH07CiAg
fQoKICB2YXIgRVNDID0gJ1x4MWInOwog
IHZhciBDU0kgPSAnXHgxYlsnOwogIHZh
ciBTUzMgPSAnXHgxYk8nOwoKICB2YXIg
Q0FOQ0VMID0gaHRlcm0uS2V5Ym9hcmQu
S2V5QWN0aW9ucy5DQU5DRUw7CiAgdmFy
IERFRkFVTFQgPSBodGVybS5LZXlib2Fy
ZC5LZXlBY3Rpb25zLkRFRkFVTFQ7CiAg
dmFyIFBBU1MgPSBodGVybS5LZXlib2Fy
ZC5LZXlBY3Rpb25zLlBBU1M7CiAgdmFy
IFNUUklQID0gaHRlcm0uS2V5Ym9hcmQu
S2V5QWN0aW9ucy5TVFJJUDsKCiAgdGhp
cy5hZGRLZXlEZWZzKAogICAgLy8gVGhl
c2UgZmllbGRzIGFyZTogW2tleWNvZGUs
IGtleWNhcCwgbm9ybWFsLCBjb250cm9s
LCBhbHQsIG1ldGFdCgogICAgLy8gVGhl
IGJyb3dzZXIgc2VuZHMgdGhlIGtleWNv
ZGUgMCBmb3Igc29tZSBrZXlzLiAgV2Un
bGwganVzdCBhc3N1bWUgaXQncwogICAg
Ly8gZ29pbmcgdG8gZG8gdGhlIHJpZ2h0
IHRoaW5nIGJ5IGRlZmF1bHQgZm9yIHRo
b3NlIGtleXMuCiAgICBbMCwgICAnW1VO
S05PV05dJywgUEFTUywgUEFTUywgUEFT
UywgUEFTU10sCgogICAgLy8gRmlyc3Qg
cm93LgogICAgWzI3LCAgJ1tFU0NdJywg
RVNDLCAgICAgICAgICAgICAgICAgICAg
ICAgREVGQVVMVCwgREVGQVVMVCwgICAg
IERFRkFVTFRdLAogICAgWzExMiwgJ1tG
MV0nLCAgbW9kKFNTMyArICdQJywgQ1NJ
ICsgJ1AnKSwgREVGQVVMVCwgQ1NJICsg
IjIzfiIsIERFRkFVTFRdLAogICAgWzEx
MywgJ1tGMl0nLCAgbW9kKFNTMyArICdR
JywgQ1NJICsgJ1EnKSwgREVGQVVMVCwg
Q1NJICsgIjI0fiIsIERFRkFVTFRdLAog
ICAgWzExNCwgJ1tGM10nLCAgbW9kKFNT
MyArICdSJywgQ1NJICsgJ1InKSwgREVG
QVVMVCwgQ1NJICsgIjI1fiIsIERFRkFV
TFRdLAogICAgWzExNSwgJ1tGNF0nLCAg
bW9kKFNTMyArICdTJywgQ1NJICsgJ1Mn
KSwgREVGQVVMVCwgQ1NJICsgIjI2fiIs
IERFRkFVTFRdLAogICAgWzExNiwgJ1tG
NV0nLCAgQ1NJICsgJzE1ficsICAgICAg
ICAgICAgICAgREVGQVVMVCwgQ1NJICsg
IjI4fiIsIERFRkFVTFRdLAogICAgWzEx
NywgJ1tGNl0nLCAgQ1NJICsgJzE3fics
ICAgICAgICAgICAgICAgREVGQVVMVCwg
Q1NJICsgIjI5fiIsIERFRkFVTFRdLAog
ICAgWzExOCwgJ1tGN10nLCAgQ1NJICsg
JzE4ficsICAgICAgICAgICAgICAgREVG
QVVMVCwgQ1NJICsgIjMxfiIsIERFRkFV
TFRdLAogICAgWzExOSwgJ1tGOF0nLCAg
Q1NJICsgJzE5ficsICAgICAgICAgICAg
ICAgREVGQVVMVCwgQ1NJICsgIjMyfiIs
IERFRkFVTFRdLAogICAgWzEyMCwgJ1tG
OV0nLCAgQ1NJICsgJzIwficsICAgICAg
ICAgICAgICAgREVGQVVMVCwgQ1NJICsg
IjMzfiIsIERFRkFVTFRdLAogICAgWzEy
MSwgJ1tGMTBdJywgQ1NJICsgJzIxfics
ICAgICAgICAgICAgICAgREVGQVVMVCwg
Q1NJICsgIjM0fiIsIERFRkFVTFRdLAog
ICAgWzEyMiwgJ1tGMTFdJywgQ1NJICsg
JzIzficsICAgICAgICAgICAgICAgREVG
QVVMVCwgQ1NJICsgIjQyfiIsIERFRkFV
TFRdLAogICAgWzEyMywgJ1tGMTJdJywg
Q1NJICsgJzI0ficsICAgICAgICAgICAg
ICAgREVGQVVMVCwgQ1NJICsgIjQzfiIs
IERFRkFVTFRdLAoKICAgIC8vIFNlY29u
ZCByb3cuCiAgICBbMTkyLCAnYH4nLCBE
RUZBVUxULCBzaChjdGwoJ0AnKSwgY3Rs
KCdeJykpLCAgICAgREVGQVVMVCwgICAg
ICAgICAgIFBBU1NdLAogICAgWzQ5LCAg
JzEhJywgREVGQVVMVCwgYygnb25DdHJs
TnVtXycpLCAgICBjKCdvbkFsdE51bV8n
KSwgYygnb25NZXRhTnVtXycpXSwKICAg
IFs1MCwgICcyQCcsIERFRkFVTFQsIGMo
J29uQ3RybE51bV8nKSwgICAgYygnb25B
bHROdW1fJyksIGMoJ29uTWV0YU51bV8n
KV0sCiAgICBbNTEsICAnMyMnLCBERUZB
VUxULCBjKCdvbkN0cmxOdW1fJyksICAg
IGMoJ29uQWx0TnVtXycpLCBjKCdvbk1l
dGFOdW1fJyldLAogICAgWzUyLCAgJzQk
JywgREVGQVVMVCwgYygnb25DdHJsTnVt
XycpLCAgICBjKCdvbkFsdE51bV8nKSwg
Yygnb25NZXRhTnVtXycpXSwKICAgIFs1
MywgICc1JScsIERFRkFVTFQsIGMoJ29u
Q3RybE51bV8nKSwgICAgYygnb25BbHRO
dW1fJyksIGMoJ29uTWV0YU51bV8nKV0s
CiAgICBbNTQsICAnNl4nLCBERUZBVUxU
LCBjKCdvbkN0cmxOdW1fJyksICAgIGMo
J29uQWx0TnVtXycpLCBjKCdvbk1ldGFO
dW1fJyldLAogICAgWzU1LCAgJzcmJywg
REVGQVVMVCwgYygnb25DdHJsTnVtXycp
LCAgICBjKCdvbkFsdE51bV8nKSwgYygn
b25NZXRhTnVtXycpXSwKICAgIFs1Niwg
ICc4KicsIERFRkFVTFQsIGMoJ29uQ3Ry
bE51bV8nKSwgICAgYygnb25BbHROdW1f
JyksIGMoJ29uTWV0YU51bV8nKV0sCiAg
ICBbNTcsICAnOSgnLCBERUZBVUxULCBj
KCdvbkN0cmxOdW1fJyksICAgIGMoJ29u
QWx0TnVtXycpLCBjKCdvbk1ldGFOdW1f
JyldLAogICAgWzQ4LCAgJzApJywgREVG
QVVMVCwgYygnb25QbHVzTWludXNaZXJv
XycpLGMoJ29uQWx0TnVtXycpLGMoJ29u
UGx1c01pbnVzWmVyb18nKV0sCiAgICBb
MTg5LCAnLV8nLCBERUZBVUxULCBjKCdv
blBsdXNNaW51c1plcm9fJyksIERFRkFV
TFQsIGMoJ29uUGx1c01pbnVzWmVyb18n
KV0sCiAgICBbMTg3LCAnPSsnLCBERUZB
VUxULCBjKCdvblBsdXNNaW51c1plcm9f
JyksIERFRkFVTFQsIGMoJ29uUGx1c01p
bnVzWmVyb18nKV0sCiAgICAvLyBGaXJl
Zm94IC1fIGFuZCA9KwogICAgWzE3Mywg
Jy1fJywgREVGQVVMVCwgYygnb25QbHVz
TWludXNaZXJvXycpLCBERUZBVUxULCBj
KCdvblBsdXNNaW51c1plcm9fJyldLAog
ICAgWzYxLCAnPSsnLCBERUZBVUxULCBj
KCdvblBsdXNNaW51c1plcm9fJyksIERF
RkFVTFQsIGMoJ29uUGx1c01pbnVzWmVy
b18nKV0sCiAgICAvLyBGaXJlZm94IEl0
YWxpYW4gKyoKICAgIFsxNzEsICcrKics
IERFRkFVTFQsIGMoJ29uUGx1c01pbnVz
WmVyb18nKSwgREVGQVVMVCwgYygnb25Q
bHVzTWludXNaZXJvXycpXSwKCiAgICBb
OCwgICAnW0JLU1BdJywgYnMoJ1x4N2Yn
LCAnXGInKSwgYnMoJ1xiJywgJ1x4N2Yn
KSwgREVGQVVMVCwgICAgIERFRkFVTFRd
LAoKICAgIC8vIFRoaXJkIHJvdy4KICAg
IFs5LCAgICdbVEFCXScsIHNoKCdcdCcs
IENTSSArICdaJyksIFNUUklQLCAgICAg
UEFTUywgICAgREVGQVVMVF0sCiAgICBb
ODEsICAncVEnLCAgICBERUZBVUxULCAg
ICAgICAgICAgICBjdGwoJ1EnKSwgIERF
RkFVTFQsIERFRkFVTFRdLAogICAgWzg3
LCAgJ3dXJywgICAgREVGQVVMVCwgICAg
ICAgICAgICAgY3RsKCdXJyksICBERUZB
VUxULCBERUZBVUxUXSwKICAgIFs2OSwg
ICdlRScsICAgIERFRkFVTFQsICAgICAg
ICAgICAgIGN0bCgnRScpLCAgREVGQVVM
VCwgREVGQVVMVF0sCiAgICBbODIsICAn
clInLCAgICBERUZBVUxULCAgICAgICAg
ICAgICBjdGwoJ1InKSwgIERFRkFVTFQs
IERFRkFVTFRdLAogICAgWzg0LCAgJ3RU
JywgICAgREVGQVVMVCwgICAgICAgICAg
ICAgY3RsKCdUJyksICBERUZBVUxULCBE
RUZBVUxUXSwKICAgIFs4OSwgICd5WScs
ICAgIERFRkFVTFQsICAgICAgICAgICAg
IGN0bCgnWScpLCAgREVGQVVMVCwgREVG
QVVMVF0sCiAgICBbODUsICAndVUnLCAg
ICBERUZBVUxULCAgICAgICAgICAgICBj
dGwoJ1UnKSwgIERFRkFVTFQsIERFRkFV
TFRdLAogICAgWzczLCAgJ2lJJywgICAg
REVGQVVMVCwgICAgICAgICAgICAgY3Rs
KCdJJyksICBERUZBVUxULCBERUZBVUxU
XSwKICAgIFs3OSwgICdvTycsICAgIERF
RkFVTFQsICAgICAgICAgICAgIGN0bCgn
TycpLCAgREVGQVVMVCwgREVGQVVMVF0s
CiAgICBbODAsICAncFAnLCAgICBERUZB
VUxULCAgICAgICAgICAgICBjdGwoJ1An
KSwgIERFRkFVTFQsIERFRkFVTFRdLAog
ICAgWzIxOSwgJ1t7JywgICAgREVGQVVM
VCwgICAgICAgICAgICAgY3RsKCdbJyks
ICBERUZBVUxULCBERUZBVUxUXSwKICAg
IFsyMjEsICddfScsICAgIERFRkFVTFQs
ICAgICAgICAgICAgIGN0bCgnXScpLCAg
REVGQVVMVCwgREVGQVVMVF0sCiAgICBb
MjIwLCAnXFx8JywgICBERUZBVUxULCAg
ICAgICAgICAgICBjdGwoJ1xcJyksIERF
RkFVTFQsIERFRkFVTFRdLAoKICAgIC8v
IEZvdXJ0aCByb3cuIChXZSBsZXQgQ3Ry
bC1TaGlmdC1KIHBhc3MgZm9yIENocm9t
ZSBEZXZUb29scy4pCiAgICBbMjAsICAn
W0NBUFNdJywgIFBBU1MsICAgIFBBU1Ms
ICAgICAgICAgICAgICAgICAgICAgICAg
ICAgUEFTUywgICAgREVGQVVMVF0sCiAg
ICBbNjUsICAnYUEnLCAgICAgIERFRkFV
TFQsIGN0bCgnQScpLCAgICAgICAgICAg
ICAgICAgICAgICAgREVGQVVMVCwgREVG
QVVMVF0sCiAgICBbODMsICAnc1MnLCAg
ICAgIERFRkFVTFQsIGN0bCgnUycpLCAg
ICAgICAgICAgICAgICAgICAgICAgREVG
QVVMVCwgREVGQVVMVF0sCiAgICBbNjgs
ICAnZEQnLCAgICAgIERFRkFVTFQsIGN0
bCgnRCcpLCAgICAgICAgICAgICAgICAg
ICAgICAgREVGQVVMVCwgREVGQVVMVF0s
CiAgICBbNzAsICAnZkYnLCAgICAgIERF
RkFVTFQsIGN0bCgnRicpLCAgICAgICAg
ICAgICAgICAgICAgICAgREVGQVVMVCwg
REVGQVVMVF0sCiAgICBbNzEsICAnZ0cn
LCAgICAgIERFRkFVTFQsIGN0bCgnRycp
LCAgICAgICAgICAgICAgICAgICAgICAg
REVGQVVMVCwgREVGQVVMVF0sCiAgICBb
NzIsICAnaEgnLCAgICAgIERFRkFVTFQs
IGN0bCgnSCcpLCAgICAgICAgICAgICAg
ICAgICAgICAgREVGQVVMVCwgREVGQVVM
VF0sCiAgICBbNzQsICAnakonLCAgICAg
IERFRkFVTFQsIHNoKGN0bCgnSicpLCBQ
QVNTKSwgICAgICAgICAgICAgREVGQVVM
VCwgREVGQVVMVF0sCiAgICBbNzUsICAn
a0snLCAgICAgIERFRkFVTFQsIHNoKGN0
bCgnSycpLCBjKCdvbkNsZWFyXycpKSwg
ICAgREVGQVVMVCwgREVGQVVMVF0sCiAg
ICBbNzYsICAnbEwnLCAgICAgIERFRkFV
TFQsIHNoKGN0bCgnTCcpLCBQQVNTKSwg
ICAgICAgICAgICAgREVGQVVMVCwgREVG
QVVMVF0sCiAgICBbMTg2LCAnOzonLCAg
ICAgIERFRkFVTFQsIFNUUklQLCAgICAg
ICAgICAgICAgICAgICAgICAgICAgREVG
QVVMVCwgREVGQVVMVF0sCiAgICBbMjIy
LCAnXCciJywgICAgIERFRkFVTFQsIFNU
UklQLCAgICAgICAgICAgICAgICAgICAg
ICAgICAgREVGQVVMVCwgREVGQVVMVF0s
CiAgICBbMTMsICAnW0VOVEVSXScsICdc
cicsICAgIENBTkNFTCwgICAgICAgICAg
ICAgICAgICAgICAgICAgQ0FOQ0VMLCAg
REVGQVVMVF0sCgogICAgLy8gRmlmdGgg
cm93LiAgVGhpcyBpbmNsdWRlcyB0aGUg
Y29weS9wYXN0ZSBzaG9ydGN1dHMuICBP
biBzb21lCiAgICAvLyBwbGF0Zm9ybXMg
aXQncyBDdHJsLUMvViwgb24gb3RoZXJz
IGl0J3MgTWV0YS1DL1YuICBXZSBhc3N1
bWUgZWl0aGVyCiAgICAvLyBDdHJsLUMv
TWV0YS1DIHNob3VsZCBwYXNzIHRvIHRo
ZSBicm93c2VyIHdoZW4gdGhlcmUgaXMg
YSBzZWxlY3Rpb24sCiAgICAvLyBhbmQg
Q3RybC1TaGlmdC1WL01ldGEtKi1WIHNo
b3VsZCBhbHdheXMgcGFzcyB0byB0aGUg
YnJvd3NlciAoc2luY2UKICAgIC8vIHRo
ZXNlIHNlZW0gdG8gYmUgcmVjb2duaXpl
ZCBhcyBwYXN0ZSB0b28pLgogICAgWzE2
LCAgJ1tTSElGVF0nLCBQQVNTLCBQQVNT
LCAgICAgICAgICAgICAgICAgICBQQVNT
LCAgICBERUZBVUxUXSwKICAgIFs5MCwg
ICd6WicsICAgREVGQVVMVCwgY3RsKCda
JyksICAgICAgICAgICAgICAgREVGQVVM
VCwgREVGQVVMVF0sCiAgICBbODgsICAn
eFgnLCAgIERFRkFVTFQsIGN0bCgnWCcp
LCAgICAgICAgICAgICAgIERFRkFVTFQs
IERFRkFVTFRdLAogICAgWzY3LCAgJ2ND
JywgICBERUZBVUxULCBjKCdvbkN0cmxD
XycpLCAgICAgICAgICBERUZBVUxULCBj
KCdvbk1ldGFDXycpXSwKICAgIFs4Niwg
ICd2VicsICAgREVGQVVMVCwgYygnb25D
dHJsVl8nKSwgICAgICAgICAgREVGQVVM
VCwgYygnb25NZXRhVl8nKV0sCiAgICBb
NjYsICAnYkInLCAgIERFRkFVTFQsIHNo
KGN0bCgnQicpLCBQQVNTKSwgICAgIERF
RkFVTFQsIHNoKERFRkFVTFQsIFBBU1Mp
XSwKICAgIFs3OCwgICduTicsICAgREVG
QVVMVCwgYygnb25DdHJsTl8nKSwgICAg
ICAgICAgREVGQVVMVCwgYygnb25NZXRh
Tl8nKV0sCiAgICBbNzcsICAnbU0nLCAg
IERFRkFVTFQsIGN0bCgnTScpLCAgICAg
ICAgICAgICAgIERFRkFVTFQsIERFRkFV
TFRdLAogICAgWzE4OCwgJyw8JywgICBE
RUZBVUxULCBhbHQoU1RSSVAsIFBBU1Mp
LCAgICAgICBERUZBVUxULCBERUZBVUxU
XSwKICAgIFsxOTAsICcuPicsICAgREVG
QVVMVCwgYWx0KFNUUklQLCBQQVNTKSwg
ICAgICAgREVGQVVMVCwgREVGQVVMVF0s
CiAgICBbMTkxLCAnLz8nLCAgIERFRkFV
TFQsIHNoKGN0bCgnXycpLCBjdGwoJz8n
KSksIERFRkFVTFQsIERFRkFVTFRdLAoK
ICAgIC8vIFNpeHRoIGFuZCBmaW5hbCBy
b3cuCiAgICBbMTcsICAnW0NUUkxdJywg
IFBBU1MsICAgIFBBU1MsICAgICBQQVNT
LCAgICBQQVNTXSwKICAgIFsxOCwgICdb
QUxUXScsICAgUEFTUywgICAgUEFTUywg
ICAgIFBBU1MsICAgIFBBU1NdLAogICAg
WzkxLCAgJ1tMQVBMXScsICBQQVNTLCAg
ICBQQVNTLCAgICAgUEFTUywgICAgUEFT
U10sCiAgICBbMzIsICAnICcsICAgICAg
IERFRkFVTFQsIGN0bCgnQCcpLCBERUZB
VUxULCBERUZBVUxUXSwKICAgIFs5Miwg
ICdbUkFQTF0nLCAgUEFTUywgICAgUEFT
UywgICAgIFBBU1MsICAgIFBBU1NdLAog
ICAgWzkzLCAgJ1tSTUVOVV0nLCBQQVNT
LCAgICBQQVNTLCAgICAgUEFTUywgICAg
UEFTU10sCgogICAgLy8gVGhlc2UgdGhp
bmdzLgogICAgWzQyLCAgJ1tQUlRTQ1Jd
JywgUEFTUywgUEFTUywgUEFTUywgUEFT
U10sCiAgICBbMTQ1LCAnW1NDUkxLXScs
ICBQQVNTLCBQQVNTLCBQQVNTLCBQQVNT
XSwKICAgIFsxOSwgICdbQlJFQUtdJywg
IFBBU1MsIFBBU1MsIFBBU1MsIFBBU1Nd
LAoKICAgIC8vIFRoZSBibG9jayBvZiBz
aXgga2V5cyBhYm92ZSB0aGUgYXJyb3dz
LgogICAgWzQ1LCAgJ1tJTlNFUlRdJywg
Yygnb25LZXlJbnNlcnRfJyksICAgREVG
QVVMVCwgREVGQVVMVCwgREVGQVVMVF0s
CiAgICBbMzYsICAnW0hPTUVdJywgICBj
KCdvbktleUhvbWVfJyksICAgICBERUZB
VUxULCBERUZBVUxULCBERUZBVUxUXSwK
ICAgIFszMywgICdbUEdVUF0nLCAgIGMo
J29uS2V5UGFnZVVwXycpLCAgIERFRkFV
TFQsIERFRkFVTFQsIERFRkFVTFRdLAog
ICAgWzQ2LCAgJ1tERUxdJywgICAgYygn
b25LZXlEZWxfJyksICAgICAgREVGQVVM
VCwgREVGQVVMVCwgREVGQVVMVF0sCiAg
ICBbMzUsICAnW0VORF0nLCAgICBjKCdv
bktleUVuZF8nKSwgICAgICBERUZBVUxU
LCBERUZBVUxULCBERUZBVUxUXSwKICAg
IFszNCwgICdbUEdET1dOXScsIGMoJ29u
S2V5UGFnZURvd25fJyksIERFRkFVTFQs
IERFRkFVTFQsIERFRkFVTFRdLAoKICAg
IC8vIEFycm93IGtleXMuICBXaGVuIHVu
bW9kaWZpZWQgdGhleSByZXNwZWN0IHRo
ZSBhcHBsaWNhdGlvbiBjdXJzb3Igc3Rh
dGUsCiAgICAvLyBvdGhlcndpc2UgdGhl
eSBhbHdheXMgc2VuZCB0aGUgQ1NJIGNv
ZGVzLgogICAgWzM4LCAnW1VQXScsICAg
IGFjKENTSSArICdBJywgU1MzICsgJ0En
KSwgREVGQVVMVCwgREVGQVVMVCwgREVG
QVVMVF0sCiAgICBbNDAsICdbRE9XTl0n
LCAgYWMoQ1NJICsgJ0InLCBTUzMgKyAn
QicpLCBERUZBVUxULCBERUZBVUxULCBE
RUZBVUxUXSwKICAgIFszOSwgJ1tSSUdI
VF0nLCBhYyhDU0kgKyAnQycsIFNTMyAr
ICdDJyksIERFRkFVTFQsIERFRkFVTFQs
IERFRkFVTFRdLAogICAgWzM3LCAnW0xF
RlRdJywgIGFjKENTSSArICdEJywgU1Mz
ICsgJ0QnKSwgREVGQVVMVCwgREVGQVVM
VCwgREVGQVVMVF0sCgogICAgWzE0NCwg
J1tOVU1MT0NLXScsIFBBU1MsIFBBU1Ms
IFBBU1MsIFBBU1NdLAoKICAgIC8vIFdp
dGggbnVtbG9jayBvZmYsIHRoZSBrZXlw
YWQgZ2VuZXJhdGVzIHRoZSBzYW1lIGtl
eSBjb2RlcyBhcyB0aGUgYXJyb3dzCiAg
ICAvLyBhbmQgJ2Jsb2NrIG9mIHNpeCcg
Zm9yIHNvbWUga2V5cywgYW5kIG51bGwg
a2V5IGNvZGVzIGZvciB0aGUgcmVzdC4K
CiAgICAvLyBLZXlwYWQgd2l0aCBudW1s
b2NrIG9uIGdlbmVyYXRlcyB1bmlxdWUg
a2V5IGNvZGVzLi4uCiAgICBbOTYsICAn
W0tQMF0nLCBERUZBVUxULCBERUZBVUxU
LCBERUZBVUxULCBERUZBVUxUXSwKICAg
IFs5NywgICdbS1AxXScsIERFRkFVTFQs
IERFRkFVTFQsIERFRkFVTFQsIERFRkFV
TFRdLAogICAgWzk4LCAgJ1tLUDJdJywg
REVGQVVMVCwgREVGQVVMVCwgREVGQVVM
VCwgREVGQVVMVF0sCiAgICBbOTksICAn
W0tQM10nLCBERUZBVUxULCBERUZBVUxU
LCBERUZBVUxULCBERUZBVUxUXSwKICAg
IFsxMDAsICdbS1A0XScsIERFRkFVTFQs
IERFRkFVTFQsIERFRkFVTFQsIERFRkFV
TFRdLAogICAgWzEwMSwgJ1tLUDVdJywg
REVGQVVMVCwgREVGQVVMVCwgREVGQVVM
VCwgREVGQVVMVF0sCiAgICBbMTAyLCAn
W0tQNl0nLCBERUZBVUxULCBERUZBVUxU
LCBERUZBVUxULCBERUZBVUxUXSwKICAg
IFsxMDMsICdbS1A3XScsIERFRkFVTFQs
IERFRkFVTFQsIERFRkFVTFQsIERFRkFV
TFRdLAogICAgWzEwNCwgJ1tLUDhdJywg
REVGQVVMVCwgREVGQVVMVCwgREVGQVVM
VCwgREVGQVVMVF0sCiAgICBbMTA1LCAn
W0tQOV0nLCBERUZBVUxULCBERUZBVUxU
LCBERUZBVUxULCBERUZBVUxUXSwKICAg
IFsxMDcsICdbS1ArXScsIERFRkFVTFQs
IERFRkFVTFQsIERFRkFVTFQsIERFRkFV
TFRdLAogICAgWzEwOSwgJ1tLUC1dJywg
REVGQVVMVCwgREVGQVVMVCwgREVGQVVM
VCwgREVGQVVMVF0sCiAgICBbMTA2LCAn
W0tQKl0nLCBERUZBVUxULCBERUZBVUxU
LCBERUZBVUxULCBERUZBVUxUXSwKICAg
IFsxMTEsICdbS1AvXScsIERFRkFVTFQs
IERFRkFVTFQsIERFRkFVTFQsIERFRkFV
TFRdLAogICAgWzExMCwgJ1tLUC5dJywg
REVGQVVMVCwgREVGQVVMVCwgREVGQVVM
VCwgREVGQVVMVF0sCgogICAgLy8gQ2hy
b21lIE9TIGtleWJvYXJkIHRvcCByb3cu
CiAgICBbMTY2LCAnW0JBQ0tdJywgICBt
ZWQobW9kKFNTMysnUCcsIENTSSsnUCcp
KSwgREVGQVVMVCwgQ1NJKyIyM34iLCBE
RUZBVUxUXSwKICAgIFsxNjcsICdbRldE
XScsICAgIG1lZChtb2QoU1MzKydRJywg
Q1NJKydRJykpLCBERUZBVUxULCBDU0kr
IjI0fiIsIERFRkFVTFRdLAogICAgWzE2
OCwgJ1tSRUxPQURdJywgbWVkKG1vZChT
UzMrJ1InLCBDU0krJ1InKSksIERFRkFV
TFQsIENTSSsiMjV+IiwgREVGQVVMVF0s
CiAgICBbMTgzLCAnW0ZTQ1JdJywgICBt
ZWQobW9kKFNTMysnUycsIENTSSsnUycp
KSwgREVGQVVMVCwgQ1NJKyIyNn4iLCBE
RUZBVUxUXSwKICAgIFsxODIsICdbV0lO
U10nLCAgIG1lZChDU0kgKyAnMTV+Jyks
ICAgICAgICAgICBERUZBVUxULCBDU0kr
IjI4fiIsIERFRkFVTFRdLAogICAgWzIx
NiwgJ1tCUklULV0nLCAgbWVkKENTSSAr
ICcxN34nKSwgICAgICAgICAgIERFRkFV
TFQsIENTSSsiMjl+IiwgREVGQVVMVF0s
CiAgICBbMjE3LCAnW0JSSVQrXScsICBt
ZWQoQ1NJICsgJzE4ficpLCAgICAgICAg
ICAgREVGQVVMVCwgQ1NJKyIzMX4iLCBE
RUZBVUxUXQoKICAgIC8vIDE3MyBbTVVU
RV0sIDE3NCBbVk9MLV0gYW5kIDE3NSBb
Vk9MK10gYXJlIHRyYXBwZWQgYnkgdGhl
IENocm9tZSBPUwogICAgLy8gd2luZG93
IG1hbmFnZXIsIHNvIHdlJ2xsIG5ldmVy
IHNlZSB0aGVtLiBOb3RlIHRoYXQgMTcz
IGlzIGFsc28KICAgIC8vIEZpcmVmb3gn
cyAtXyBrZXljb2RlLgogICk7Cn07Cgov
KioKICogRWl0aGVyIGFsbG93IHRoZSBw
YXN0ZSBvciBzZW5kIGEga2V5IHNlcXVl
bmNlLgogKi8KaHRlcm0uS2V5Ym9hcmQu
S2V5TWFwLnByb3RvdHlwZS5vbktleUlu
c2VydF8gPSBmdW5jdGlvbihlKSB7CiAg
aWYgKHRoaXMua2V5Ym9hcmQuc2hpZnRJ
bnNlcnRQYXN0ZSAmJiBlLnNoaWZ0S2V5
KQogICAgcmV0dXJuIGh0ZXJtLktleWJv
YXJkLktleUFjdGlvbnMuUEFTUzsKCiAg
cmV0dXJuICdceDFiWzJ+JzsKfTsKCi8q
KgogKiBFaXRoZXIgc2Nyb2xsIHRoZSBz
Y3JvbGxiYWNrIGJ1ZmZlciBvciBzZW5k
IGEga2V5IHNlcXVlbmNlLgogKi8KaHRl
cm0uS2V5Ym9hcmQuS2V5TWFwLnByb3Rv
dHlwZS5vbktleUhvbWVfID0gZnVuY3Rp
b24oZSkgewogIGlmICghdGhpcy5rZXli
b2FyZC5ob21lS2V5c1Njcm9sbCBeIGUu
c2hpZnRLZXkpIHsKICAgIGlmICgoZS5h
bHRleSB8fCBlLmN0cmxLZXkgfHwgZS5z
aGlmdEtleSkgfHwKICAgICAgICAhdGhp
cy5rZXlib2FyZC5hcHBsaWNhdGlvbkN1
cnNvcikgewogICAgICByZXR1cm4gJ1x4
MWJbSCc7CiAgICB9CgogICAgcmV0dXJu
ICdceDFiT0gnOwogIH0KCiAgdGhpcy5r
ZXlib2FyZC50ZXJtaW5hbC5zY3JvbGxI
b21lKCk7CiAgcmV0dXJuIGh0ZXJtLktl
eWJvYXJkLktleUFjdGlvbnMuQ0FOQ0VM
Owp9OwoKLyoqCiAqIEVpdGhlciBzY3Jv
bGwgdGhlIHNjcm9sbGJhY2sgYnVmZmVy
IG9yIHNlbmQgYSBrZXkgc2VxdWVuY2Uu
CiAqLwpodGVybS5LZXlib2FyZC5LZXlN
YXAucHJvdG90eXBlLm9uS2V5RW5kXyA9
IGZ1bmN0aW9uKGUpIHsKICBpZiAoIXRo
aXMua2V5Ym9hcmQuaG9tZUtleXNTY3Jv
bGwgXiBlLnNoaWZ0S2V5KSB7CiAgICBp
ZiAoKGUuYWx0S2V5IHx8IGUuY3RybEtl
eSB8fCBlLnNoaWZ0S2V5KSB8fAogICAg
ICAgICF0aGlzLmtleWJvYXJkLmFwcGxp
Y2F0aW9uQ3Vyc29yKSB7CiAgICAgIHJl
dHVybiAnXHgxYltGJzsKICAgIH0KCiAg
ICByZXR1cm4gJ1x4MWJPRic7CiAgfQoK
ICB0aGlzLmtleWJvYXJkLnRlcm1pbmFs
LnNjcm9sbEVuZCgpOwogIHJldHVybiBo
dGVybS5LZXlib2FyZC5LZXlBY3Rpb25z
LkNBTkNFTDsKfTsKCi8qKgogKiBFaXRo
ZXIgc2Nyb2xsIHRoZSBzY3JvbGxiYWNr
IGJ1ZmZlciBvciBzZW5kIGEga2V5IHNl
cXVlbmNlLgogKi8KaHRlcm0uS2V5Ym9h
cmQuS2V5TWFwLnByb3RvdHlwZS5vbktl
eVBhZ2VVcF8gPSBmdW5jdGlvbihlKSB7
CiAgaWYgKCF0aGlzLmtleWJvYXJkLnBh
Z2VLZXlzU2Nyb2xsIF4gZS5zaGlmdEtl
eSkKICAgIHJldHVybiAnXHgxYls1fic7
CgogIHRoaXMua2V5Ym9hcmQudGVybWlu
YWwuc2Nyb2xsUGFnZVVwKCk7CiAgcmV0
dXJuIGh0ZXJtLktleWJvYXJkLktleUFj
dGlvbnMuQ0FOQ0VMOwp9OwoKLyoqCiAq
IEVpdGhlciBzZW5kIGEgdHJ1ZSBERUws
IG9yIHN1YiBpbiBtZXRhLWJhY2tzcGFj
ZS4KICoKICogT24gQ2hyb21lIE9TLCBp
ZiB3ZSBrbm93IHRoZSBhbHQga2V5IGlz
IGRvd24sIGJ1dCB3ZSBnZXQgYSBERUwg
ZXZlbnQgdGhhdAogKiBjbGFpbXMgdGhh
dCB0aGUgYWx0IGtleSBpcyBub3QgcHJl
c3NlZCwgd2Uga25vdyB0aGUgREVMIHdh
cyBhIHN5bnRoZXRpYwogKiBvbmUgZnJv
bSBhIHVzZXIgdGhhdCBoaXQgYWx0LWJh
Y2tzcGFjZS4gQmFzZWQgb24gYSB1c2Vy
IHByZWYsIHdlIGNhbiBzdWIKICogaW4g
bWV0YS1iYWNrc3BhY2UgaW4gdGhpcyBj
YXNlLgogKi8KaHRlcm0uS2V5Ym9hcmQu
S2V5TWFwLnByb3RvdHlwZS5vbktleURl
bF8gPSBmdW5jdGlvbihlKSB7CiAgaWYg
KHRoaXMua2V5Ym9hcmQuYWx0QmFja3Nw
YWNlSXNNZXRhQmFja3NwYWNlICYmCiAg
ICAgIHRoaXMua2V5Ym9hcmQuYWx0S2V5
UHJlc3NlZCAmJiAhZS5hbHRLZXkpCiAg
ICByZXR1cm4gJ1x4MWJceDdmJzsKICBy
ZXR1cm4gJ1x4MWJbM34nOwp9OwoKLyoq
CiAqIEVpdGhlciBzY3JvbGwgdGhlIHNj
cm9sbGJhY2sgYnVmZmVyIG9yIHNlbmQg
YSBrZXkgc2VxdWVuY2UuCiAqLwpodGVy
bS5LZXlib2FyZC5LZXlNYXAucHJvdG90
eXBlLm9uS2V5UGFnZURvd25fID0gZnVu
Y3Rpb24oZSkgewogIGlmICghdGhpcy5r
ZXlib2FyZC5wYWdlS2V5c1Njcm9sbCBe
IGUuc2hpZnRLZXkpCiAgICByZXR1cm4g
J1x4MWJbNn4nOwoKICB0aGlzLmtleWJv
YXJkLnRlcm1pbmFsLnNjcm9sbFBhZ2VE
b3duKCk7CiAgcmV0dXJuIGh0ZXJtLktl
eWJvYXJkLktleUFjdGlvbnMuQ0FOQ0VM
Owp9OwoKLyoqCiAqIENsZWFyIHRoZSBw
cmltYXJ5L2FsdGVybmF0ZSBzY3JlZW5z
IGFuZCB0aGUgc2Nyb2xsYmFjayBidWZm
ZXIuCiAqLwpodGVybS5LZXlib2FyZC5L
ZXlNYXAucHJvdG90eXBlLm9uQ2xlYXJf
ID0gZnVuY3Rpb24oZSwga2V5RGVmKSB7
CiAgdGhpcy5rZXlib2FyZC50ZXJtaW5h
bC53aXBlQ29udGVudHMoKTsKICByZXR1
cm4gaHRlcm0uS2V5Ym9hcmQuS2V5QWN0
aW9ucy5DQU5DRUw7Cn07CgovKioKICog
RWl0aGVyIHBhc3MgQ3RybC0xLi45IHRv
IHRoZSBicm93c2VyIG9yIHNlbmQgdGhl
bSB0byB0aGUgaG9zdC4KICoKICogTm90
ZSB0aGF0IEN0cmwtMSBhbmQgQ3RybC05
IGRvbid0IGFjdHVhbGx5IGhhdmUgc3Bl
Y2lhbCBzZXF1ZW5jZXMgbWFwcGVkCiAq
IHRvIHRoZW0gaW4geHRlcm0gb3IgZ25v
bWUtdGVybWluYWwuICBUaGUgcmFuZ2Ug
aXMgcmVhbGx5IEN0cmwtMi4uOCwgYnV0
CiAqIHdlIGhhbmRsZSAxLi45IHNpbmNl
IENocm9tZSB0cmVhdHMgdGhlIHdob2xl
IHJhbmdlIHNwZWNpYWwuCiAqLwpodGVy
bS5LZXlib2FyZC5LZXlNYXAucHJvdG90
eXBlLm9uQ3RybE51bV8gPSBmdW5jdGlv
bihlLCBrZXlEZWYpIHsKICAvLyBDb21w
dXRlIGEgY29udHJvbCBjaGFyYWN0ZXIg
Zm9yIGEgZ2l2ZW4gY2hhcmFjdGVyLgog
IGZ1bmN0aW9uIGN0bChjaCkgeyByZXR1
cm4gU3RyaW5nLmZyb21DaGFyQ29kZShj
aC5jaGFyQ29kZUF0KDApIC0gNjQpIH0K
CiAgaWYgKHRoaXMua2V5Ym9hcmQudGVy
bWluYWwucGFzc0N0cmxOdW1iZXIgJiYg
IWUuc2hpZnRLZXkpCiAgICByZXR1cm4g
aHRlcm0uS2V5Ym9hcmQuS2V5QWN0aW9u
cy5QQVNTOwoKICBzd2l0Y2ggKGtleURl
Zi5rZXlDYXAuc3Vic3RyKDAsIDEpKSB7
CiAgICBjYXNlICcxJzogcmV0dXJuICcx
JzsKICAgIGNhc2UgJzInOiByZXR1cm4g
Y3RsKCdAJyk7CiAgICBjYXNlICczJzog
cmV0dXJuIGN0bCgnWycpOwogICAgY2Fz
ZSAnNCc6IHJldHVybiBjdGwoJ1xcJyk7
CiAgICBjYXNlICc1JzogcmV0dXJuIGN0
bCgnXScpOwogICAgY2FzZSAnNic6IHJl
dHVybiBjdGwoJ14nKTsKICAgIGNhc2Ug
JzcnOiByZXR1cm4gY3RsKCdfJyk7CiAg
ICBjYXNlICc4JzogcmV0dXJuICdceDdm
JzsKICAgIGNhc2UgJzknOiByZXR1cm4g
JzknOwogIH0KfTsKCi8qKgogKiBFaXRo
ZXIgcGFzcyBBbHQtMS4uOSB0byB0aGUg
YnJvd3NlciBvciBzZW5kIHRoZW0gdG8g
dGhlIGhvc3QuCiAqLwpodGVybS5LZXli
b2FyZC5LZXlNYXAucHJvdG90eXBlLm9u
QWx0TnVtXyA9IGZ1bmN0aW9uKGUsIGtl
eURlZikgewogIGlmICh0aGlzLmtleWJv
YXJkLnRlcm1pbmFsLnBhc3NBbHROdW1i
ZXIgJiYgIWUuc2hpZnRLZXkpCiAgICBy
ZXR1cm4gaHRlcm0uS2V5Ym9hcmQuS2V5
QWN0aW9ucy5QQVNTOwoKICByZXR1cm4g
aHRlcm0uS2V5Ym9hcmQuS2V5QWN0aW9u
cy5ERUZBVUxUOwp9OwoKLyoqCiAqIEVp
dGhlciBwYXNzIE1ldGEtMS4uOSB0byB0
aGUgYnJvd3NlciBvciBzZW5kIHRoZW0g
dG8gdGhlIGhvc3QuCiAqLwpodGVybS5L
ZXlib2FyZC5LZXlNYXAucHJvdG90eXBl
Lm9uTWV0YU51bV8gPSBmdW5jdGlvbihl
LCBrZXlEZWYpIHsKICBpZiAodGhpcy5r
ZXlib2FyZC50ZXJtaW5hbC5wYXNzTWV0
YU51bWJlciAmJiAhZS5zaGlmdEtleSkK
ICAgIHJldHVybiBodGVybS5LZXlib2Fy
ZC5LZXlBY3Rpb25zLlBBU1M7CgogIHJl
dHVybiBodGVybS5LZXlib2FyZC5LZXlB
Y3Rpb25zLkRFRkFVTFQ7Cn07CgovKioK
ICogRWl0aGVyIHNlbmQgYSBeQyBvciBp
bnRlcnByZXQgdGhlIGtleXN0cm9rZSBh
cyBhIGNvcHkgY29tbWFuZC4KICovCmh0
ZXJtLktleWJvYXJkLktleU1hcC5wcm90
b3R5cGUub25DdHJsQ18gPSBmdW5jdGlv
bihlLCBrZXlEZWYpIHsKICB2YXIgc2Vs
ZWN0aW9uID0gdGhpcy5rZXlib2FyZC50
ZXJtaW5hbC5nZXREb2N1bWVudCgpLmdl
dFNlbGVjdGlvbigpOwoKICBpZiAoIXNl
bGVjdGlvbi5pc0NvbGxhcHNlZCkgewog
ICAgaWYgKHRoaXMua2V5Ym9hcmQuY3Ry
bENDb3B5ICYmICFlLnNoaWZ0S2V5KSB7
CiAgICAgIC8vIEN0cmwtQyBzaG91bGQg
Y29weSBpZiB0aGVyZSBpcyBhIHNlbGVj
dGlvbiwgc2VuZCBeQyBvdGhlcndpc2Uu
CiAgICAgIC8vIFBlcmZvcm0gdGhlIGNv
cHkgYnkgbGV0dGluZyB0aGUgYnJvd3Nl
ciBoYW5kbGUgQ3RybC1DLiAgT24gbW9z
dAogICAgICAvLyBicm93c2VycywgdGhp
cyBpcyB0aGUgKm9ubHkqIHdheSB0byBw
bGFjZSB0ZXh0IG9uIHRoZSBjbGlwYm9h
cmQgZnJvbQogICAgICAvLyB0aGUgJ2Ry
aXZlLWJ5JyB3ZWIuCiAgICAgIGlmICh0
aGlzLmtleWJvYXJkLnRlcm1pbmFsLmNs
ZWFyU2VsZWN0aW9uQWZ0ZXJDb3B5KSB7
CiAgICAgICAgc2V0VGltZW91dChzZWxl
Y3Rpb24uY29sbGFwc2VUb0VuZC5iaW5k
KHNlbGVjdGlvbiksIDUwKTsKICAgICAg
fQogICAgICBpZiAodGhpcy5rZXlib2Fy
ZC50ZXJtaW5hbC5wcmVmc18uZ2V0KCdl
bmFibGUtY2xpcGJvYXJkLW5vdGljZScp
KQogICAgICAgIHNldFRpbWVvdXQodGhp
cy5rZXlib2FyZC50ZXJtaW5hbC5zaG93
T3ZlcmxheS5iaW5kKHRoaXMua2V5Ym9h
cmQudGVybWluYWwsIGh0ZXJtLm5vdGlm
eUNvcHlNZXNzYWdlLCA1MDApLCAyMDAp
OwogICAgICByZXR1cm4gaHRlcm0uS2V5
Ym9hcmQuS2V5QWN0aW9ucy5QQVNTOwog
ICAgfQoKICAgIGlmICghdGhpcy5rZXli
b2FyZC5jdHJsQ0NvcHkgJiYgZS5zaGlm
dEtleSkgewogICAgICAvLyBDdHJsLVNo
aWZ0LUMgc2hvdWxkIGNvcHkgaWYgdGhl
cmUgaXMgYSBzZWxlY3Rpb24sIHNlbmQg
XkMgb3RoZXJ3aXNlLgogICAgICAvLyBQ
ZXJmb3JtIHRoZSBjb3B5IG1hbnVhbGx5
LiAgVGhpcyBvbmx5IHdvcmtzIGluIHNp
dHVhdGlvbnMgd2hlcmUKICAgICAgLy8g
ZG9jdW1lbnQuZXhlY0NvbW1hbmQoJ2Nv
cHknKSBpcyBhbGxvd2VkLgogICAgICBp
ZiAodGhpcy5rZXlib2FyZC50ZXJtaW5h
bC5jbGVhclNlbGVjdGlvbkFmdGVyQ29w
eSkgewogICAgICAgIHNldFRpbWVvdXQo
c2VsZWN0aW9uLmNvbGxhcHNlVG9FbmQu
YmluZChzZWxlY3Rpb24pLCA1MCk7CiAg
ICAgIH0KICAgICAgdGhpcy5rZXlib2Fy
ZC50ZXJtaW5hbC5jb3B5U2VsZWN0aW9u
VG9DbGlwYm9hcmQoKTsKICAgICAgcmV0
dXJuIGh0ZXJtLktleWJvYXJkLktleUFj
dGlvbnMuQ0FOQ0VMOwogICAgfQogIH0K
CiAgcmV0dXJuICdceDAzJzsKfTsKCi8q
KgogKiBFaXRoZXIgc2VuZCBhIF5OIG9y
IG9wZW4gYSBuZXcgd2luZG93IHRvIHRo
ZSBzYW1lIGxvY2F0aW9uLgogKi8KaHRl
cm0uS2V5Ym9hcmQuS2V5TWFwLnByb3Rv
dHlwZS5vbkN0cmxOXyA9IGZ1bmN0aW9u
KGUsIGtleURlZikgewogIGlmIChlLnNo
aWZ0S2V5KSB7CiAgICB3aW5kb3cub3Bl
bihkb2N1bWVudC5sb2NhdGlvbi5ocmVm
LCAnJywKICAgICAgICAgICAgICAgICdj
aHJvbWU9bm8sY2xvc2U9eWVzLHJlc2l6
ZT15ZXMsc2Nyb2xsYmFycz15ZXMsJyAr
CiAgICAgICAgICAgICAgICAnbWluaW1p
emFibGU9eWVzLHdpZHRoPScgKyB3aW5k
b3cuaW5uZXJXaWR0aCArCiAgICAgICAg
ICAgICAgICAnLGhlaWdodD0nICsgd2lu
ZG93LmlubmVySGVpZ2h0KTsKICAgIHJl
dHVybiBodGVybS5LZXlib2FyZC5LZXlB
Y3Rpb25zLkNBTkNFTDsKICB9CgogIHJl
dHVybiAnXHgwZSc7Cn07CgovKioKICog
RWl0aGVyIHNlbmQgYSBeViBvciBhbGxv
dyB0aGUgYnJvd3NlciB0byBpbnRlcnBy
ZXQgdGhlIGtleXN0cm9rZSBhcyBhIHBh
c3RlCiAqIGNvbW1hbmQuCiAqCiAqIFRo
ZSBkZWZhdWx0IGJlaGF2aW9yIGlzIHRv
IHBhc3RlIGlmIHRoZSB1c2VyIHByZXNz
ZXMgQ3RybC1TaGlmdC1WLCBhbmQgc2Vu
ZAogKiBhIF5WIGlmIHRoZSB1c2VyIHBy
ZXNzZXMgQ3RybC1WLiBUaGlzIGNhbiBi
ZSBmbGlwcGVkIHdpdGggdGhlCiAqICdj
dHJsLXYtcGFzdGUnIHByZWZlcmVuY2Uu
CiAqLwpodGVybS5LZXlib2FyZC5LZXlN
YXAucHJvdG90eXBlLm9uQ3RybFZfID0g
ZnVuY3Rpb24oZSwga2V5RGVmKSB7CiAg
aWYgKCghZS5zaGlmdEtleSAmJiB0aGlz
LmtleWJvYXJkLmN0cmxWUGFzdGUpIHx8
CiAgICAgIChlLnNoaWZ0S2V5ICYmICF0
aGlzLmtleWJvYXJkLmN0cmxWUGFzdGUp
KSB7CiAgICByZXR1cm4gaHRlcm0uS2V5
Ym9hcmQuS2V5QWN0aW9ucy5QQVNTOwog
IH0KCiAgcmV0dXJuICdceDE2JzsKfTsK
Ci8qKgogKiBFaXRoZXIgdGhlIGRlZmF1
bHQgYWN0aW9uIG9yIG9wZW4gYSBuZXcg
d2luZG93IHRvIHRoZSBzYW1lIGxvY2F0
aW9uLgogKi8KaHRlcm0uS2V5Ym9hcmQu
S2V5TWFwLnByb3RvdHlwZS5vbk1ldGFO
XyA9IGZ1bmN0aW9uKGUsIGtleURlZikg
ewogIGlmIChlLnNoaWZ0S2V5KSB7CiAg
ICB3aW5kb3cub3Blbihkb2N1bWVudC5s
b2NhdGlvbi5ocmVmLCAnJywKICAgICAg
ICAgICAgICAgICdjaHJvbWU9bm8sY2xv
c2U9eWVzLHJlc2l6ZT15ZXMsc2Nyb2xs
YmFycz15ZXMsJyArCiAgICAgICAgICAg
ICAgICAnbWluaW1pemFibGU9eWVzLHdp
ZHRoPScgKyB3aW5kb3cub3V0ZXJXaWR0
aCArCiAgICAgICAgICAgICAgICAnLGhl
aWdodD0nICsgd2luZG93Lm91dGVySGVp
Z2h0KTsKICAgIHJldHVybiBodGVybS5L
ZXlib2FyZC5LZXlBY3Rpb25zLkNBTkNF
TDsKICB9CgogIHJldHVybiBodGVybS5L
ZXlib2FyZC5LZXlBY3Rpb25zLkRFRkFV
TFQ7Cn07CgovKioKICogRWl0aGVyIHNl
bmQgYSBNZXRhLUMgb3IgYWxsb3cgdGhl
IGJyb3dzZXIgdG8gaW50ZXJwcmV0IHRo
ZSBrZXlzdHJva2UgYXMgYQogKiBjb3B5
IGNvbW1hbmQuCiAqCiAqIElmIHRoZXJl
IGlzIG5vIHNlbGVjdGlvbiwgb3IgaWYg
dGhlIHVzZXIgcHJlc3NlcyBNZXRhLVNo
aWZ0LUMsIHRoZW4gd2UnbGwKICogdHJh
bnNtaXQgYW4gJ1x4MWInIChpZiBtZXRh
U2VuZHNFc2NhcGUgaXMgb24pIGZvbGxv
d2VkIGJ5ICdjJyBvciAnQycuCiAqCiAq
IElmIHRoZXJlIGlzIGEgc2VsZWN0aW9u
LCB3ZSBkZWZlciB0byB0aGUgYnJvd3Nl
ci4gIEluIHRoaXMgY2FzZSB3ZSBjbGVh
ciBvdXQKICogdGhlIHNlbGVjdGlvbiBz
byB0aGUgdXNlciBrbm93cyB3ZSBoZWFy
ZCB0aGVtLCBhbmQgYWxzbyB0byBnaXZl
IHRoZW0gYQogKiBjaGFuY2UgdG8gc2Vu
ZCBhIE1ldGEtQyBieSBqdXN0IGhpdHRp
bmcgdGhlIGtleSBhZ2Fpbi4KICovCmh0
ZXJtLktleWJvYXJkLktleU1hcC5wcm90
b3R5cGUub25NZXRhQ18gPSBmdW5jdGlv
bihlLCBrZXlEZWYpIHsKICB2YXIgZG9j
dW1lbnQgPSB0aGlzLmtleWJvYXJkLnRl
cm1pbmFsLmdldERvY3VtZW50KCk7CiAg
aWYgKGUuc2hpZnRLZXkgfHwgZG9jdW1l
bnQuZ2V0U2VsZWN0aW9uKCkuaXNDb2xs
YXBzZWQpIHsKICAgIC8vIElmIHRoZSBz
aGlmdCBrZXkgaXMgYmVpbmcgaGVsZCwg
b3IgdGhlcmUgaXMgbm8gZG9jdW1lbnQg
c2VsZWN0aW9uLCBzZW5kCiAgICAvLyBh
IE1ldGEtQy4gIFRoZSBrZXlib2FyZCBj
b2RlIHdpbGwgYWRkIHRoZSBFU0MgaWYg
bWV0YVNlbmRzRXNjYXBlIGlzIHRydWUs
CiAgICAvLyB3ZSBqdXN0IGhhdmUgdG8g
ZGVjaWRlIGJldHdlZW4gJ2MnIGFuZCAn
QycuCiAgICByZXR1cm4ga2V5RGVmLmtl
eUNhcC5zdWJzdHIoZS5zaGlmdEtleSA/
IDEgOiAwLCAxKTsKICB9CgogIC8vIE90
aGVyd2lzZSBsZXQgdGhlIGJyb3dzZXIg
aGFuZGxlIGl0IGFzIGEgY29weSBjb21t
YW5kLgogIGlmICh0aGlzLmtleWJvYXJk
LnRlcm1pbmFsLmNsZWFyU2VsZWN0aW9u
QWZ0ZXJDb3B5KSB7CiAgICBzZXRUaW1l
b3V0KGZ1bmN0aW9uKCkgeyBkb2N1bWVu
dC5nZXRTZWxlY3Rpb24oKS5jb2xsYXBz
ZVRvRW5kKCkgfSwgNTApOwogIH0KICBy
ZXR1cm4gaHRlcm0uS2V5Ym9hcmQuS2V5
QWN0aW9ucy5QQVNTOwp9OwoKLyoqCiAq
IEVpdGhlciBQQVNTIG9yIERFRkFVTFQg
TWV0YS1WLCBkZXBlbmRpbmcgb24gcHJl
ZmVyZW5jZS4KICoKICogQWx3YXlzIFBB
U1MgTWV0YS1TaGlmdC1WIHRvIGFsbG93
IGJyb3dzZXIgdG8gaW50ZXJwcmV0IHRo
ZSBrZXlzdHJva2UgYXMKICogYSBwYXN0
ZSBjb21tYW5kLgogKi8KaHRlcm0uS2V5
Ym9hcmQuS2V5TWFwLnByb3RvdHlwZS5v
bk1ldGFWXyA9IGZ1bmN0aW9uKGUsIGtl
eURlZikgewogIGlmIChlLnNoaWZ0S2V5
KQogICAgcmV0dXJuIGh0ZXJtLktleWJv
YXJkLktleUFjdGlvbnMuUEFTUzsKCiAg
cmV0dXJuIHRoaXMua2V5Ym9hcmQucGFz
c01ldGFWID8KICAgICAgaHRlcm0uS2V5
Ym9hcmQuS2V5QWN0aW9ucy5QQVNTIDoK
ICAgICAgaHRlcm0uS2V5Ym9hcmQuS2V5
QWN0aW9ucy5ERUZBVUxUOwp9OwoKLyoq
CiAqIEhhbmRsZSBmb250IHpvb21pbmcu
CiAqCiAqIFRoZSBicm93c2VyJ3MgYnVp
bHQtaW4gem9vbSBoYXMgYSBiaXQgb2Yg
YW4gaXNzdWUgYXQgY2VydGFpbiB6b29t
IGxldmVscy4KICogQXQgc29tZSBtYWdu
aWZpY2F0aW9ucywgdGhlIG1lYXN1cmVk
IGhlaWdodCBvZiBhIHJvdyBvZiB0ZXh0
IGRpZmZlcnMgZnJvbQogKiB0aGUgaGVp
Z2h0IHRoYXQgd2FzIGV4cGxpY2l0bHkg
c2V0LgogKgogKiBXZSBvdmVycmlkZSB0
aGUgYnJvd3NlciB6b29tIGtleXMgdG8g
Y2hhbmdlIHRoZSBTY3JvbGxQb3J0J3Mg
Zm9udCBzaXplIHRvCiAqIGF2b2lkIHRo
ZSBpc3N1ZS4KICovCmh0ZXJtLktleWJv
YXJkLktleU1hcC5wcm90b3R5cGUub25Q
bHVzTWludXNaZXJvXyA9IGZ1bmN0aW9u
KGUsIGtleURlZikgewogIGlmICghKHRo
aXMua2V5Ym9hcmQuY3RybFBsdXNNaW51
c1plcm9ab29tIF4gZS5zaGlmdEtleSkp
IHsKICAgIC8vIElmIGN0cmwtUE1aIGNv
bnRyb2xzIHpvb20gYW5kIHRoZSBzaGlm
dCBrZXkgaXMgcHJlc3NlZCwgb3IKICAg
IC8vIGN0cmwtc2hpZnQtUE1aIGNvbnRy
b2xzIHpvb20gYW5kIHRoaXMgc2hpZnQg
a2V5IGlzIG5vdCBwcmVzc2VkLAogICAg
Ly8gdGhlbiB3ZSB3YW50IHRvIHNlbmQg
dGhlIGNvbnRyb2wgY29kZSBpbnN0ZWFk
IG9mIGFmZmVjdGluZyB6b29tLgogICAg
aWYgKGtleURlZi5rZXlDYXAgPT0gJy1f
JykKICAgICAgcmV0dXJuICdceDFmJzsg
IC8vIF5fCgogICAgLy8gT25seSBeXyBp
cyB2YWxpZCwgdGhlIG90aGVyIHNlcXVl
bmNlcyBoYXZlIG5vIG1lYW5pbmcuCiAg
ICByZXR1cm4gaHRlcm0uS2V5Ym9hcmQu
S2V5QWN0aW9ucy5DQU5DRUw7CiAgfQoK
ICBpZiAodGhpcy5rZXlib2FyZC50ZXJt
aW5hbC5nZXRab29tRmFjdG9yKCkgIT0g
MSkgewogICAgLy8gSWYgd2UncmUgbm90
IGF0IDE6MSB6b29tIGZhY3RvciwgbGV0
IHRoZSBDdHJsICsvLS8wIGtleXMgY29u
dHJvbCB0aGUKICAgIC8vIGJyb3dzZXIg
em9vbSwgc28gaXQncyBlYXNpZXIgdG8g
Zm9yIHRoZSB1c2VyIHRvIGdldCBiYWNr
IHRvIDEwMCUuCiAgICByZXR1cm4gaHRl
cm0uS2V5Ym9hcmQuS2V5QWN0aW9ucy5Q
QVNTOwogIH0KCiAgdmFyIGNhcCA9IGtl
eURlZi5rZXlDYXAuc3Vic3RyKDAsIDEp
OwogIGlmIChjYXAgPT0gJzAnKSB7CiAg
ICAgIHRoaXMua2V5Ym9hcmQudGVybWlu
YWwuc2V0Rm9udFNpemUoMCk7CiAgfSBl
bHNlIHsKICAgIHZhciBzaXplID0gdGhp
cy5rZXlib2FyZC50ZXJtaW5hbC5nZXRG
b250U2l6ZSgpOwoKICAgIGlmIChjYXAg
PT0gJy0nKSB7CiAgICAgIHNpemUgLT0g
MTsKICAgIH0gZWxzZSB7CiAgICAgIHNp
emUgKz0gMTsKICAgIH0KCiAgICB0aGlz
LmtleWJvYXJkLnRlcm1pbmFsLnNldEZv
bnRTaXplKHNpemUpOwogIH0KCiAgcmV0
dXJuIGh0ZXJtLktleWJvYXJkLktleUFj
dGlvbnMuQ0FOQ0VMOwp9OwovLyBTT1VS
Q0UgRklMRTogaHRlcm0vanMvaHRlcm1f
b3B0aW9ucy5qcwovLyBDb3B5cmlnaHQg
KGMpIDIwMTIgVGhlIENocm9taXVtIE9T
IEF1dGhvcnMuIEFsbCByaWdodHMgcmVz
ZXJ2ZWQuCi8vIFVzZSBvZiB0aGlzIHNv
dXJjZSBjb2RlIGlzIGdvdmVybmVkIGJ5
IGEgQlNELXN0eWxlIGxpY2Vuc2UgdGhh
dCBjYW4gYmUKLy8gZm91bmQgaW4gdGhl
IExJQ0VOU0UgZmlsZS4KCid1c2Ugc3Ry
aWN0JzsKCi8qKgogKiBAZmlsZW92ZXJ2
aWV3IFRoaXMgZmlsZSBpbXBsZW1lbnRz
IHRoZSBodGVybS5PcHRpb25zIGNsYXNz
LAogKiB3aGljaCBzdG9yZXMgY3VycmVu
dCBvcGVyYXRpbmcgY29uZGl0aW9ucyBm
b3IgdGhlIHRlcm1pbmFsLiAgVGhpcyBv
YmplY3QgaXMKICogdXNlZCBpbnN0ZWFk
IG9mIGEgc2VyaWVzIG9mIHBhcmFtZXRl
cnMgdG8gYWxsb3cgc2F2aW5nL3Jlc3Rv
cmluZyBvZiBjdXJzb3IKICogY29uZGl0
aW9ucyBlYXNpbHksIGFuZCB0byBwcm92
aWRlIGFuIGVhc3kgcGxhY2UgZm9yIGNv
bW1vbiBjb25maWd1cmF0aW9uCiAqIG9w
dGlvbnMuCiAqCiAqIE9yaWdpbmFsIGNv
ZGUgYnkgQ29yeSBNYWNjYXJyb25lLgog
Ki8KCi8qKgogKiBDb25zdHJ1Y3RvciBm
b3IgdGhlIGh0ZXJtLk9wdGlvbnMgY2xh
c3MsIG9wdGlvbmFsbHkgYWN0aW5nIGFz
IGEgY29weQogKiBjb25zdHJ1Y3Rvci4K
ICoKICogVGhlIGRlZmF1bHRzIGFyZSBh
cyBkZWZpbmVkIGluIGh0dHA6Ly93d3cu
dnQxMDAubmV0L2RvY3MvdnQ1MTAtcm0v
REVDU1RSCiAqIGV4Y2VwdCB0aGF0IHdl
IGVuYWJsZSBhdXRvd3JhcCAod3JhcGFy
b3VuZCkgYnkgZGVmYXV0IHNpbmNlIHRo
YXQgc2VlbXMgdG8KICogYmUgd2hhdCB4
dGVybSBkb2VzLgogKgogKiBAcGFyYW0g
e2h0ZXJtLk9wdGlvbnM9fSBvcHRfY29w
eSBPcHRpb25hbCBpbnN0YW5jZSB0byBj
b3B5LgogKiBAY29uc3RydWN0b3IKICov
Cmh0ZXJtLk9wdGlvbnMgPSBmdW5jdGlv
bihvcHRfY29weSkgewogIC8vIEFsbCBh
dHRyaWJ1dGVzIGluIHRoaXMgY2xhc3Mg
YXJlIHB1YmxpYyB0byBhbGxvdyBlYXN5
IGFjY2VzcyBieSB0aGUKICAvLyB0ZXJt
aW5hbC4KCiAgdGhpcy53cmFwYXJvdW5k
ID0gb3B0X2NvcHkgPyBvcHRfY29weS53
cmFwYXJvdW5kIDogdHJ1ZTsKICB0aGlz
LnJldmVyc2VXcmFwYXJvdW5kID0gb3B0
X2NvcHkgPyBvcHRfY29weS5yZXZlcnNl
V3JhcGFyb3VuZCA6IGZhbHNlOwogIHRo
aXMub3JpZ2luTW9kZSA9IG9wdF9jb3B5
ID8gb3B0X2NvcHkub3JpZ2luTW9kZSA6
IGZhbHNlOwogIHRoaXMuYXV0b0NhcnJp
YWdlUmV0dXJuID0gb3B0X2NvcHkgPyBv
cHRfY29weS5hdXRvQ2FycmlhZ2VSZXR1
cm4gOiBmYWxzZTsKICB0aGlzLmN1cnNv
clZpc2libGUgPSBvcHRfY29weSA/IG9w
dF9jb3B5LmN1cnNvclZpc2libGUgOiBm
YWxzZTsKICB0aGlzLmN1cnNvckJsaW5r
ID0gb3B0X2NvcHkgPyBvcHRfY29weS5j
dXJzb3JCbGluayA6IGZhbHNlOwogIHRo
aXMuaW5zZXJ0TW9kZSA9IG9wdF9jb3B5
ID8gb3B0X2NvcHkuaW5zZXJ0TW9kZSA6
IGZhbHNlOwogIHRoaXMucmV2ZXJzZVZp
ZGVvID0gb3B0X2NvcHkgPyBvcHRfY29w
eS5yZXZlcnNlVmlkZW8gOiBmYWxzZTsK
ICB0aGlzLmJyYWNrZXRlZFBhc3RlID0g
b3B0X2NvcHkgPyBvcHRfY29weS5icmFj
a2V0ZWRQYXN0ZSA6IGZhbHNlOwp9Owov
LyBTT1VSQ0UgRklMRTogaHRlcm0vanMv
aHRlcm1fcHJlZmVyZW5jZV9tYW5hZ2Vy
LmpzCi8vIENvcHlyaWdodCAoYykgMjAx
MiBUaGUgQ2hyb21pdW0gT1MgQXV0aG9y
cy4gQWxsIHJpZ2h0cyByZXNlcnZlZC4K
Ly8gVXNlIG9mIHRoaXMgc291cmNlIGNv
ZGUgaXMgZ292ZXJuZWQgYnkgYSBCU0Qt
c3R5bGUgbGljZW5zZSB0aGF0IGNhbiBi
ZQovLyBmb3VuZCBpbiB0aGUgTElDRU5T
RSBmaWxlLgoKJ3VzZSBzdHJpY3QnOwoK
bGliLnJ0ZGVwKCdsaWIuZicsICdsaWIu
U3RvcmFnZScpOwoKLyoqCiAqIFByZWZl
cmVuY2VNYW5hZ2VyIHN1YmNsYXNzIG1h
bmFnaW5nIGdsb2JhbCBOYVNTSCBwcmVm
ZXJlbmNlcy4KICoKICogVGhpcyBpcyBj
dXJyZW50bHkganVzdCBhbiBvcmRlcmVk
IGxpc3Qgb2Yga25vd24gY29ubmVjdGlv
biBwcm9maWxlcy4KICovCmh0ZXJtLlBy
ZWZlcmVuY2VNYW5hZ2VyID0gZnVuY3Rp
b24ocHJvZmlsZUlkKSB7CiAgbGliLlBy
ZWZlcmVuY2VNYW5hZ2VyLmNhbGwodGhp
cywgaHRlcm0uZGVmYXVsdFN0b3JhZ2Us
CiAgICAgICAgICAgICAgICAgICAgICAg
ICAgICAgJy9odGVybS9wcm9maWxlcy8n
ICsgcHJvZmlsZUlkKTsKICB2YXIgZGVm
cyA9IGh0ZXJtLlByZWZlcmVuY2VNYW5h
Z2VyLmRlZmF1bHRQcmVmZXJlbmNlczsK
ICBPYmplY3Qua2V5cyhkZWZzKS5mb3JF
YWNoKGZ1bmN0aW9uKGtleSkgewogICAg
dGhpcy5kZWZpbmVQcmVmZXJlbmNlKGtl
eSwgZGVmc1trZXldKTsKICB9LmJpbmQo
dGhpcykpOwp9OwoKaHRlcm0uUHJlZmVy
ZW5jZU1hbmFnZXIuZGVmYXVsdFByZWZl
cmVuY2VzID0gewogIC8qKgogICAqIFNl
bGVjdCBhbiBBbHRHciBkZXRlY3Rpb24g
aGFja15XaGV1cmlzdGljLgogICAqCiAg
ICogbnVsbDogQXV0b2RldGVjdCBiYXNl
ZCBvbiBuYXZpZ2F0b3IubGFuZ3VhZ2U6
CiAgICogICAgICAgJ2VuLXVzJyA9PiAn
bm9uZScsIGVsc2UgPT4gJ3JpZ2h0LWFs
dCcKICAgKiAnbm9uZSc6IERpc2FibGUg
YW55IEFsdEdyIHJlbGF0ZWQgbXVuZ2lu
Zy4KICAgKiAnY3RybC1hbHQnOiBBc3N1
bWUgQ3RybCtBbHQgbWVhbnMgQWx0R3Iu
CiAgICogJ2xlZnQtYWx0JzogQXNzdW1l
IGxlZnQgQWx0IG1lYW5zIEFsdEdyLgog
ICAqICdyaWdodC1hbHQnOiBBc3N1bWUg
cmlnaHQgQWx0IG1lYW5zIEFsdEdyLgog
ICAqLwogICdhbHQtZ3ItbW9kZSc6IG51
bGwsCgogIC8qKgogICAqIElmIHNldCwg
dW5kb2VzIHRoZSBDaHJvbWUgT1MgQWx0
LUJhY2tzcGFjZS0+REVMIHJlbWFwLCBz
byB0aGF0CiAgICogYWx0LWJhY2tzcGFj
ZSBpbmRlZWQgaXMgYWx0LWJhY2tzcGFj
ZS4KICAgKi8KICAnYWx0LWJhY2tzcGFj
ZS1pcy1tZXRhLWJhY2tzcGFjZSc6IGZh
bHNlLAoKICAvKioKICAgKiBTZXQgd2hl
dGhlciB0aGUgYWx0IGtleSBhY3RzIGFz
IGEgbWV0YSBrZXkgb3IgYXMgYSBkaXN0
aW5jdCBhbHQga2V5LgogICAqLwogICdh
bHQtaXMtbWV0YSc6IGZhbHNlLAoKICAv
KioKICAgKiBDb250cm9scyBob3cgdGhl
IGFsdCBrZXkgaXMgaGFuZGxlZC4KICAg
KgogICAqICBlc2NhcGUuLi4uLi4uIFNl
bmQgYW4gRVNDIHByZWZpeC4KICAgKiAg
OC1iaXQuLi4uLi4uLiBBZGQgMTI4IHRv
IHRoZSB1bnNoaWZ0ZWQgY2hhcmFjdGVy
IGFzIGluIHh0ZXJtLgogICAqICBicm93
c2VyLWtleS4uIFdhaXQgZm9yIHRoZSBr
ZXlwcmVzcyBldmVudCBhbmQgc2VlIHdo
YXQgdGhlIGJyb3dzZXIgc2F5cy4KICAg
KiAgICAgICAgICAgICAgICAoVGhpcyB3
b24ndCB3b3JrIHdlbGwgb24gcGxhdGZv
cm1zIHdoZXJlIHRoZSBicm93c2VyCiAg
ICogICAgICAgICAgICAgICAgIHBlcmZv
cm1zIGEgZGVmYXVsdCBhY3Rpb24gZm9y
IHNvbWUgYWx0IHNlcXVlbmNlcy4pCiAg
ICovCiAgJ2FsdC1zZW5kcy13aGF0Jzog
J2VzY2FwZScsCgogIC8qKgogICAqIFRl
cm1pbmFsIGJlbGwgc291bmQuICBFbXB0
eSBzdHJpbmcgZm9yIG5vIGF1ZGlibGUg
YmVsbC4KICAgKi8KICAnYXVkaWJsZS1i
ZWxsLXNvdW5kJzogJ2xpYi1yZXNvdXJj
ZTpodGVybS9hdWRpby9iZWxsJywKCiAg
LyoqCiAgICogSWYgdHJ1ZSwgdGVybWlu
YWwgYmVsbHMgaW4gdGhlIGJhY2tncm91
bmQgd2lsbCBjcmVhdGUgYSBXZWIKICAg
KiBOb3RpZmljYXRpb24uIGh0dHA6Ly93
d3cudzMub3JnL1RSL25vdGlmaWNhdGlv
bnMvCiAgICoKICAgKiBEaXNwbGF5aW5n
IG5vdGlmaWNhdGlvbnMgcmVxdWlyZXMg
cGVybWlzc2lvbiBmcm9tIHRoZSB1c2Vy
LiBXaGVuIHRoaXMKICAgKiBvcHRpb24g
aXMgc2V0IHRvIHRydWUsIGh0ZXJtIHdp
bGwgYXR0ZW1wdCB0byBhc2sgdGhlIHVz
ZXIgZm9yIHBlcm1pc3Npb24KICAgKiBp
ZiBuZWNlc3NhcnkuIE5vdGUgYnJvd3Nl
cnMgbWF5IG5vdCBzaG93IHRoaXMgcGVy
bWlzc2lvbiByZXF1ZXN0IGlmIGl0CiAg
ICogZGlkIG5vdCBvcmlnaW5hdGUgZnJv
bSBhIHVzZXIgYWN0aW9uLgogICAqCiAg
ICogQ2hyb21lIGV4dGVuc2lvbnMgd2l0
aCB0aGUgIm5vdGZpY2F0aW9ucyIgcGVy
bWlzc2lvbiBoYXZlIHBlcm1pc3Npb24g
dG8KICAgKiBkaXNwbGF5IG5vdGlmaWNh
dGlvbnMuCiAgICovCiAgJ2Rlc2t0b3At
bm90aWZpY2F0aW9uLWJlbGwnOiBmYWxz
ZSwKCiAgLyoqCiAgICogVGhlIGJhY2tn
cm91bmQgY29sb3IgZm9yIHRleHQgd2l0
aCBubyBvdGhlciBjb2xvciBhdHRyaWJ1
dGVzLgogICAqLwogICdiYWNrZ3JvdW5k
LWNvbG9yJzogJ3JnYigxNiwgMTYsIDE2
KScsCgogIC8qKgogICAqIFRoZSBiYWNr
Z3JvdW5kIGltYWdlLgogICAqLwogICdi
YWNrZ3JvdW5kLWltYWdlJzogJycsCgog
IC8qKgogICAqIFRoZSBiYWNrZ3JvdW5k
IGltYWdlIHNpemUsCiAgICoKICAgKiBE
ZWZhdWx0cyB0byBub25lLgogICAqLwog
ICdiYWNrZ3JvdW5kLXNpemUnOiAnJywK
CiAgLyoqCiAgICogVGhlIGJhY2tncm91
bmQgaW1hZ2UgcG9zaXRpb24sCiAgICoK
ICAgKiBEZWZhdWx0cyB0byBub25lLgog
ICAqLwogICdiYWNrZ3JvdW5kLXBvc2l0
aW9uJzogJycsCgogIC8qKgogICAqIElm
IHRydWUsIHRoZSBiYWNrc3BhY2Ugc2hv
dWxkIHNlbmQgQlMgKCdceDA4JywgYWth
IF5IKS4gIE90aGVyd2lzZQogICAqIHRo
ZSBiYWNrc3BhY2Uga2V5IHNob3VsZCBz
ZW5kICdceDdmJy4KICAgKi8KICAnYmFj
a3NwYWNlLXNlbmRzLWJhY2tzcGFjZSc6
IGZhbHNlLAoKICAvKioKICAgKiBDaGFy
YWN0ZXIgbWFwIG92ZXJyaWRlcy4KICAg
KgogICAqIFRoaXMgaXMgc3BlY2lmaWVk
IGFzIGFuIG9iamVjdC4gSXQgaXMgYSBz
cGFyc2UgYXJyYXksIHdoZXJlIGVhY2gg
cHJvcGVydHkKICAgKiBpcyB0aGUgY2hh
cmFjdGVyIHNldCBjb2RlIGFuZCB0aGUg
dmFsdWUgaXMgYW4gb2JqZWN0IHRoYXQg
aXMgYSBzcGFyc2UgYXJyYXkKICAgKiBp
dHNlbGYuIEluIHRoYXQgc3BhcnNlIGFy
cmF5LCBlYWNoIHByb3BlcnR5IGlzIHRo
ZSByZWNlaXZlZCBjaGFyYWN0ZXIgYW5k
CiAgICogdGhlIHZhbHVlIGlzIHRoZSBk
aXNwbGF5ZWQgY2hhcmFjdGVyLgogICAq
CiAgICogRm9yIGV4YW1wbGU6CiAgICog
ICB7IjAiOnsiKyI6Ilx1MjE5MiIsIiwi
OiJcdTIxOTAiLCItIjoiXHUyMTkxIiwi
LiI6Ilx1MjE5MyIsIjAiOiJcdTI1ODgi
fX0KICAgKi8KICAnY2hhcmFjdGVyLW1h
cC1vdmVycmlkZXMnOiBudWxsLAoKICAv
KioKICAgKiBXaGV0aGVyIG9yIG5vdCB0
byBjbG9zZSB0aGUgd2luZG93IHdoZW4g
dGhlIGNvbW1hbmQgZXhpdHMuCiAgICov
CiAgJ2Nsb3NlLW9uLWV4aXQnOiB0cnVl
LAoKICAvKioKICAgKiBXaGV0aGVyIG9y
IG5vdCB0byBibGluayB0aGUgY3Vyc29y
IGJ5IGRlZmF1bHQuCiAgICovCiAgJ2N1
cnNvci1ibGluayc6IGZhbHNlLAoKICAv
KioKICAgKiBUaGUgY3Vyc29yIGJsaW5r
IHJhdGUgaW4gbWlsbGlzZWNvbmRzLgog
ICAqCiAgICogQSB0d28gZWxlbWVudCBh
cnJheSwgdGhlIGZpcnN0IG9mIHdoaWNo
IGlzIGhvdyBsb25nIHRoZSBjdXJzb3Ig
c2hvdWxkIGJlCiAgICogb24sIHNlY29u
ZCBpcyBob3cgbG9uZyBpdCBzaG91bGQg
YmUgb2ZmLgogICAqLwogICdjdXJzb3It
YmxpbmstY3ljbGUnOiBbMTAwMCwgNTAw
XSwKCiAgLyoqCiAgICogVGhlIGNvbG9y
IG9mIHRoZSB2aXNpYmxlIGN1cnNvci4K
ICAgKi8KICAnY3Vyc29yLWNvbG9yJzog
J3JnYmEoMjU1LCAwLCAwLCAwLjUpJywK
CiAgLyoqCiAgICogT3ZlcnJpZGUgY29s
b3JzIGluIHRoZSBkZWZhdWx0IHBhbGV0
dGUuCiAgICoKICAgKiBUaGlzIGNhbiBi
ZSBzcGVjaWZpZWQgYXMgYW4gYXJyYXkg
b3IgYW4gb2JqZWN0LiAgSWYgc3BlY2lm
aWVkIGFzIGFuCiAgICogb2JqZWN0IGl0
IGlzIGFzc3VtZWQgdG8gYmUgYSBzcGFy
c2UgYXJyYXksIHdoZXJlIGVhY2ggcHJv
cGVydHkKICAgKiBpcyBhIG51bWVyaWMg
aW5kZXggaW50byB0aGUgY29sb3IgcGFs
ZXR0ZS4KICAgKgogICAqIFZhbHVlcyBj
YW4gYmUgc3BlY2lmaWVkIGFzIGNzcyBh
bG1vc3QgYW55IGNzcyBjb2xvciB2YWx1
ZS4gIFRoaXMKICAgKiBpbmNsdWRlcyAj
UkdCLCAjUlJHR0JCLCByZ2IoLi4uKSwg
cmdiYSguLi4pLCBhbmQgYW55IGNvbG9y
IG5hbWVzCiAgICogdGhhdCBhcmUgYWxz
byBwYXJ0IG9mIHRoZSBzdG9jayBYMTEg
cmdiLnR4dCBmaWxlLgogICAqCiAgICog
WW91IGNhbiB1c2UgJ251bGwnIHRvIHNw
ZWNpZnkgdGhhdCB0aGUgZGVmYXVsdCB2
YWx1ZSBzaG91bGQgYmUgbm90CiAgICog
YmUgY2hhbmdlZC4gIFRoaXMgaXMgdXNl
ZnVsIGZvciBza2lwcGluZyBhIHNtYWxs
IG51bWJlciBvZiBpbmRpY2llcwogICAq
IHdoZW4gdGhlIHZhbHVlIGlzIHNwZWNp
ZmllZCBhcyBhbiBhcnJheS4KICAgKi8K
ICAnY29sb3ItcGFsZXR0ZS1vdmVycmlk
ZXMnOiBudWxsLAoKICAvKioKICAgKiBB
dXRvbWF0aWNhbGx5IGNvcHkgbW91c2Ug
c2VsZWN0aW9uIHRvIHRoZSBjbGlwYm9h
cmQuCiAgICovCiAgJ2NvcHktb24tc2Vs
ZWN0JzogdHJ1ZSwKCiAgLyoqCiAgICog
V2hldGhlciB0byB1c2UgdGhlIGRlZmF1
bHQgd2luZG93IGNvcHkgYmVoYXZpb3Vy
LgogICAqLwogICd1c2UtZGVmYXVsdC13
aW5kb3ctY29weSc6IGZhbHNlLAoKICAv
KioKICAgKiBXaGV0aGVyIHRvIGNsZWFy
IHRoZSBzZWxlY3Rpb24gYWZ0ZXIgY29w
eWluZy4KICAgKi8KICAnY2xlYXItc2Vs
ZWN0aW9uLWFmdGVyLWNvcHknOiB0cnVl
LAoKICAvKioKICAgKiBJZiB0cnVlLCBD
dHJsLVBsdXMvTWludXMvWmVybyBjb250
cm9scyB6b29tLgogICAqIElmIGZhbHNl
LCBDdHJsLVNoaWZ0LVBsdXMvTWludXMv
WmVybyBjb250cm9scyB6b29tLCBDdHJs
LU1pbnVzIHNlbmRzIF5fLAogICAqIEN0
cmwtUGx1cy9aZXJvIGRvIG5vdGhpbmcu
CiAgICovCiAgJ2N0cmwtcGx1cy1taW51
cy16ZXJvLXpvb20nOiB0cnVlLAoKICAv
KioKICAgKiBDdHJsK0MgY29waWVzIGlm
IHRydWUsIHNlbmQgXkMgdG8gaG9zdCBp
ZiBmYWxzZS4KICAgKiBDdHJsK1NoaWZ0
K0Mgc2VuZHMgXkMgdG8gaG9zdCBpZiB0
cnVlLCBjb3BpZXMgaWYgZmFsc2UuCiAg
ICovCiAgJ2N0cmwtYy1jb3B5JzogZmFs
c2UsCgogIC8qKgogICAqIEN0cmwrViBw
YXN0ZXMgaWYgdHJ1ZSwgc2VuZCBeViB0
byBob3N0IGlmIGZhbHNlLgogICAqIEN0
cmwrU2hpZnQrViBzZW5kcyBeViB0byBo
b3N0IGlmIHRydWUsIHBhc3RlcyBpZiBm
YWxzZS4KICAgKi8KICAnY3RybC12LXBh
c3RlJzogZmFsc2UsCgogIC8qKgogICAq
IFNldCB3aGV0aGVyIEVhc3QgQXNpYW4g
QW1iaWd1b3VzIGNoYXJhY3RlcnMgaGF2
ZSB0d28gY29sdW1uIHdpZHRoLgogICAq
LwogICdlYXN0LWFzaWFuLWFtYmlndW91
cy1hcy10d28tY29sdW1uJzogZmFsc2Us
CgogIC8qKgogICAqIFRydWUgdG8gZW5h
YmxlIDgtYml0IGNvbnRyb2wgY2hhcmFj
dGVycywgZmFsc2UgdG8gaWdub3JlIHRo
ZW0uCiAgICoKICAgKiBXZSdsbCByZXNw
ZWN0IHRoZSB0d28tYnl0ZSB2ZXJzaW9u
cyBvZiB0aGVzZSBjb250cm9sIGNoYXJh
Y3RlcnMKICAgKiByZWdhcmRsZXNzIG9m
IHRoaXMgc2V0dGluZy4KICAgKi8KICAn
ZW5hYmxlLTgtYml0LWNvbnRyb2wnOiBm
YWxzZSwKCiAgLyoqCiAgICogVHJ1ZSBp
ZiB3ZSBzaG91bGQgdXNlIGJvbGQgd2Vp
Z2h0IGZvbnQgZm9yIHRleHQgd2l0aCB0
aGUgYm9sZC9icmlnaHQKICAgKiBhdHRy
aWJ1dGUuICBGYWxzZSB0byB1c2UgdGhl
IG5vcm1hbCB3ZWlnaHQgZm9udC4gIE51
bGwgdG8gYXV0b2RldGVjdC4KICAgKi8K
ICAnZW5hYmxlLWJvbGQnOiBudWxsLAoK
ICAvKioKICAgKiBUcnVlIGlmIHdlIHNo
b3VsZCB1c2UgYnJpZ2h0IGNvbG9ycyAo
OC0xNSBvbiBhIDE2IGNvbG9yIHBhbGV0
dGUpCiAgICogZm9yIGFueSB0ZXh0IHdp
dGggdGhlIGJvbGQgYXR0cmlidXRlLiAg
RmFsc2Ugb3RoZXJ3aXNlLgogICAqLwog
ICdlbmFibGUtYm9sZC1hcy1icmlnaHQn
OiB0cnVlLAoKICAvKioKICAgKiBBbGxv
dyB0aGUgaG9zdCB0byB3cml0ZSBkaXJl
Y3RseSB0byB0aGUgc3lzdGVtIGNsaXBi
b2FyZC4KICAgKi8KICAnZW5hYmxlLWNs
aXBib2FyZC1ub3RpY2UnOiB0cnVlLAoK
ICAvKioKICAgKiBBbGxvdyB0aGUgaG9z
dCB0byB3cml0ZSBkaXJlY3RseSB0byB0
aGUgc3lzdGVtIGNsaXBib2FyZC4KICAg
Ki8KICAnZW5hYmxlLWNsaXBib2FyZC13
cml0ZSc6IHRydWUsCgogIC8qKgogICAq
IFJlc3BlY3QgdGhlIGhvc3QncyBhdHRl
bXB0IHRvIGNoYW5nZSB0aGUgY3Vyc29y
IGJsaW5rIHN0YXR1cyB1c2luZwogICAq
IERFQyBQcml2YXRlIE1vZGUgMTIuCiAg
ICovCiAgJ2VuYWJsZS1kZWMxMic6IGZh
bHNlLAoKICAvKioKICAgKiBUaGUgZGVm
YXVsdCBlbnZpcm9ubWVudCB2YXJpYWJs
ZXMuCiAgICovCiAgJ2Vudmlyb25tZW50
JzogeydURVJNJzogJ3h0ZXJtLTI1NmNv
bG9yJ30sCgogIC8qKgogICAqIERlZmF1
bHQgZm9udCBmYW1pbHkgZm9yIHRoZSB0
ZXJtaW5hbCB0ZXh0LgogICAqLwogICdm
b250LWZhbWlseSc6ICgnIkRlamFWdSBT
YW5zIE1vbm8iLCAiRXZlcnNvbiBNb25v
IiwgJyArCiAgICAgICAgICAgICAgICAg
ICdGcmVlTW9ubywgIk1lbmxvIiwgIlRl
cm1pbmFsIiwgJyArCiAgICAgICAgICAg
ICAgICAgICdtb25vc3BhY2UnKSwKCiAg
LyoqCiAgICogVGhlIGRlZmF1bHQgZm9u
dCBzaXplIGluIHBpeGVscy4KICAgKi8K
ICAnZm9udC1zaXplJzogMTUsCgogIC8q
KgogICAqIEFudGktYWxpYXNpbmcuCiAg
ICovCiAgJ2ZvbnQtc21vb3RoaW5nJzog
J2FudGlhbGlhc2VkJywKCiAgLyoqCiAg
ICogVGhlIGZvcmVncm91bmQgY29sb3Ig
Zm9yIHRleHQgd2l0aCBubyBvdGhlciBj
b2xvciBhdHRyaWJ1dGVzLgogICAqLwog
ICdmb3JlZ3JvdW5kLWNvbG9yJzogJ3Jn
YigyNDAsIDI0MCwgMjQwKScsCgogIC8q
KgogICAqIElmIHRydWUsIGhvbWUvZW5k
IHdpbGwgY29udHJvbCB0aGUgdGVybWlu
YWwgc2Nyb2xsYmFyIGFuZCBzaGlmdCBo
b21lL2VuZAogICAqIHdpbGwgc2VuZCB0
aGUgVlQga2V5Y29kZXMuICBJZiBmYWxz
ZSB0aGVuIGhvbWUvZW5kIHNlbmRzIFZU
IGNvZGVzIGFuZAogICAqIHNoaWZ0IGhv
bWUvZW5kIHNjcm9sbHMuCiAgICovCiAg
J2hvbWUta2V5cy1zY3JvbGwnOiBmYWxz
ZSwKCiAgLyoqCiAgICogTWF4IGxlbmd0
aCBvZiBhIERDUywgT1NDLCBQTSwgb3Ig
QVBTIHNlcXVlbmNlIGJlZm9yZSB3ZSBn
aXZlIHVwIGFuZAogICAqIGlnbm9yZSB0
aGUgY29kZS4KICAgKi8KICAnbWF4LXN0
cmluZy1zZXF1ZW5jZSc6IDEwMDAwMCwK
CiAgLyoqCiAgICogSWYgdHJ1ZSwgY29u
dmVydCBtZWRpYSBrZXlzIHRvIHRoZWly
IEZrZXkgZXF1aXZhbGVudC4gSWYgZmFs
c2UsIGxldAogICAqIENocm9tZSBoYW5k
bGUgdGhlIGtleXMuCiAgICovCiAgJ21l
ZGlhLWtleXMtYXJlLWZrZXlzJzogZmFs
c2UsCgogIC8qKgogICAqIFNldCB3aGV0
aGVyIHRoZSBtZXRhIGtleSBzZW5kcyBh
IGxlYWRpbmcgZXNjYXBlIG9yIG5vdC4K
ICAgKi8KICAnbWV0YS1zZW5kcy1lc2Nh
cGUnOiB0cnVlLAoKICAvKioKICAgKiBN
b3VzZSBwYXN0ZSBidXR0b24sIG9yIG51
bGwgdG8gYXV0b2RldGVjdC4KICAgKgog
ICAqIEZvciBhdXRvZGV0ZWN0LCB3ZSds
bCB0cnkgdG8gZW5hYmxlIG1pZGRsZSBi
dXR0b24gcGFzdGUgZm9yIG5vbi1YMTEK
ICAgKiBwbGF0Zm9ybXMuCiAgICoKICAg
KiBPbiBYMTEgd2UgbW92ZSBpdCB0byBi
dXR0b24gMywgYnV0IHRoYXQnbGwgcHJv
YmFibHkgYmUgYSBjb250ZXh0IG1lbnUK
ICAgKiBpbiB0aGUgZnV0dXJlLgogICAq
LwogICdtb3VzZS1wYXN0ZS1idXR0b24n
OiBudWxsLAoKICAvKioKICAgKiBJZiB0
cnVlLCBwYWdlIHVwL2Rvd24gd2lsbCBj
b250cm9sIHRoZSB0ZXJtaW5hbCBzY3Jv
bGxiYXIgYW5kIHNoaWZ0CiAgICogcGFn
ZSB1cC9kb3duIHdpbGwgc2VuZCB0aGUg
VlQga2V5Y29kZXMuICBJZiBmYWxzZSB0
aGVuIHBhZ2UgdXAvZG93bgogICAqIHNl
bmRzIFZUIGNvZGVzIGFuZCBzaGlmdCBw
YWdlIHVwL2Rvd24gc2Nyb2xscy4KICAg
Ki8KICAncGFnZS1rZXlzLXNjcm9sbCc6
IGZhbHNlLAoKICAvKioKICAgKiBTZXQg
d2hldGhlciB3ZSBzaG91bGQgcGFzcyBB
bHQtMS4uOSB0byB0aGUgYnJvd3Nlci4K
ICAgKgogICAqIFRoaXMgaXMgaGFuZHkg
d2hlbiBydW5uaW5nIGh0ZXJtIGluIGEg
YnJvd3NlciB0YWIsIHNvIHRoYXQgeW91
IGRvbid0IGxvc2UKICAgKiBDaHJvbWUn
cyAic3dpdGNoIHRvIHRhYiIga2V5Ym9h
cmQgYWNjZWxlcmF0b3JzLiAgV2hlbiBu
b3QgcnVubmluZyBpbiBhCiAgICogdGFi
IGl0J3MgYmV0dGVyIHRvIHNlbmQgdGhl
c2Uga2V5cyB0byB0aGUgaG9zdCBzbyB0
aGV5IGNhbiBiZSB1c2VkIGluCiAgICog
dmltIG9yIGVtYWNzLgogICAqCiAgICog
SWYgdHJ1ZSwgQWx0LTEuLjkgd2lsbCBi
ZSBoYW5kbGVkIGJ5IHRoZSBicm93c2Vy
LiAgSWYgZmFsc2UsIEFsdC0xLi45CiAg
ICogd2lsbCBiZSBzZW50IHRvIHRoZSBo
b3N0LiAgSWYgbnVsbCwgYXV0b2RldGVj
dCBiYXNlZCBvbiBicm93c2VyIHBsYXRm
b3JtCiAgICogYW5kIHdpbmRvdyB0eXBl
LgogICAqLwogICdwYXNzLWFsdC1udW1i
ZXInOiBudWxsLAoKICAvKioKICAgKiBT
ZXQgd2hldGhlciB3ZSBzaG91bGQgcGFz
cyBDdHJsLTEuLjkgdG8gdGhlIGJyb3dz
ZXIuCiAgICoKICAgKiBUaGlzIGlzIGhh
bmR5IHdoZW4gcnVubmluZyBodGVybSBp
biBhIGJyb3dzZXIgdGFiLCBzbyB0aGF0
IHlvdSBkb24ndCBsb3NlCiAgICogQ2hy
b21lJ3MgInN3aXRjaCB0byB0YWIiIGtl
eWJvYXJkIGFjY2VsZXJhdG9ycy4gIFdo
ZW4gbm90IHJ1bm5pbmcgaW4gYQogICAq
IHRhYiBpdCdzIGJldHRlciB0byBzZW5k
IHRoZXNlIGtleXMgdG8gdGhlIGhvc3Qg
c28gdGhleSBjYW4gYmUgdXNlZCBpbgog
ICAqIHZpbSBvciBlbWFjcy4KICAgKgog
ICAqIElmIHRydWUsIEN0cmwtMS4uOSB3
aWxsIGJlIGhhbmRsZWQgYnkgdGhlIGJy
b3dzZXIuICBJZiBmYWxzZSwgQ3RybC0x
Li45CiAgICogd2lsbCBiZSBzZW50IHRv
IHRoZSBob3N0LiAgSWYgbnVsbCwgYXV0
b2RldGVjdCBiYXNlZCBvbiBicm93c2Vy
IHBsYXRmb3JtCiAgICogYW5kIHdpbmRv
dyB0eXBlLgogICAqLwogICdwYXNzLWN0
cmwtbnVtYmVyJzogbnVsbCwKCiAgLyoq
CiAgICogU2V0IHdoZXRoZXIgd2Ugc2hv
dWxkIHBhc3MgTWV0YS0xLi45IHRvIHRo
ZSBicm93c2VyLgogICAqCiAgICogVGhp
cyBpcyBoYW5keSB3aGVuIHJ1bm5pbmcg
aHRlcm0gaW4gYSBicm93c2VyIHRhYiwg
c28gdGhhdCB5b3UgZG9uJ3QgbG9zZQog
ICAqIENocm9tZSdzICJzd2l0Y2ggdG8g
dGFiIiBrZXlib2FyZCBhY2NlbGVyYXRv
cnMuICBXaGVuIG5vdCBydW5uaW5nIGlu
IGEKICAgKiB0YWIgaXQncyBiZXR0ZXIg
dG8gc2VuZCB0aGVzZSBrZXlzIHRvIHRo
ZSBob3N0IHNvIHRoZXkgY2FuIGJlIHVz
ZWQgaW4KICAgKiB2aW0gb3IgZW1hY3Mu
CiAgICoKICAgKiBJZiB0cnVlLCBNZXRh
LTEuLjkgd2lsbCBiZSBoYW5kbGVkIGJ5
IHRoZSBicm93c2VyLiAgSWYgZmFsc2Us
IE1ldGEtMS4uOQogICAqIHdpbGwgYmUg
c2VudCB0byB0aGUgaG9zdC4gIElmIG51
bGwsIGF1dG9kZXRlY3QgYmFzZWQgb24g
YnJvd3NlciBwbGF0Zm9ybQogICAqIGFu
ZCB3aW5kb3cgdHlwZS4KICAgKi8KICAn
cGFzcy1tZXRhLW51bWJlcic6IG51bGws
CgogIC8qKgogICAqIFNldCB3aGV0aGVy
IG1ldGEtViBnZXRzIHBhc3NlZCB0byBo
b3N0LgogICAqLwogICdwYXNzLW1ldGEt
dic6IHRydWUsCgogIC8qKgogICAqIFNl
dCB0aGUgZXhwZWN0ZWQgZW5jb2Rpbmcg
Zm9yIGRhdGEgcmVjZWl2ZWQgZnJvbSB0
aGUgaG9zdC4KICAgKgogICAqIFZhbGlk
IHZhbHVlcyBhcmUgJ3V0Zi04JyBhbmQg
J3JhdycuCiAgICovCiAgJ3JlY2VpdmUt
ZW5jb2RpbmcnOiAndXRmLTgnLAoKICAv
KioKICAgKiBJZiB0cnVlLCBzY3JvbGwg
dG8gdGhlIGJvdHRvbSBvbiBhbnkga2V5
c3Ryb2tlLgogICAqLwogICdzY3JvbGwt
b24ta2V5c3Ryb2tlJzogdHJ1ZSwKCiAg
LyoqCiAgICogSWYgdHJ1ZSwgc2Nyb2xs
IHRvIHRoZSBib3R0b20gb24gdGVybWlu
YWwgb3V0cHV0LgogICAqLwogICdzY3Jv
bGwtb24tb3V0cHV0JzogZmFsc2UsCgog
IC8qKgogICAqIFRoZSB2ZXJ0aWNhbCBz
Y3JvbGxiYXIgbW9kZS4KICAgKi8KICAn
c2Nyb2xsYmFyLXZpc2libGUnOiB0cnVl
LAoKICAvKioKICAgKiBUaGUgbXVsdGlw
bGllciBmb3IgdGhlIHBpeGVsIGRlbHRh
IGluIG1vdXNld2hlZWwgZXZlbnQgY2F1
c2VkIGJ5IHRoZSBzY3JvbGwKICAgKiB3
aGVlbC4gQWx0ZXJzIGhvdyBmYXN0IHRo
ZSBwYWdlIHNjcm9sbHMuCiAgICovCiAg
J3Njcm9sbC13aGVlbC1tb3ZlLW11bHRp
cGxpZXInOiAxLAoKICAvKioKICAgKiBT
ZXQgdGhlIGVuY29kaW5nIGZvciBkYXRh
IHNlbnQgdG8gaG9zdC4KICAgKgogICAq
IFZhbGlkIHZhbHVlcyBhcmUgJ3V0Zi04
JyBhbmQgJ3JhdycuCiAgICovCiAgJ3Nl
bmQtZW5jb2RpbmcnOiAndXRmLTgnLAoK
ICAvKioKICAgKiBTaGlmdCArIEluc2Vy
dCBwYXN0ZXMgaWYgdHJ1ZSwgc2VudCB0
byBob3N0IGlmIGZhbHNlLgogICAqLwog
ICdzaGlmdC1pbnNlcnQtcGFzdGUnOiB0
cnVlLAoKICAvKioKICAgKiBVc2VyIHN0
eWxlc2hlZXQgdG8gaW5jbHVkZSBpbiB0
aGUgdGVybWluYWwgZG9jdW1lbnQuCiAg
ICovCiAgJ3VzZXItY3NzJzogJycKfTsK
Cmh0ZXJtLlByZWZlcmVuY2VNYW5hZ2Vy
LnByb3RvdHlwZSA9IHsKICBfX3Byb3Rv
X186IGxpYi5QcmVmZXJlbmNlTWFuYWdl
ci5wcm90b3R5cGUKfTsKLy8gU09VUkNF
IEZJTEU6IGh0ZXJtL2pzL2h0ZXJtX3B1
YnN1Yi5qcwovLyBDb3B5cmlnaHQgKGMp
IDIwMTIgVGhlIENocm9taXVtIE9TIEF1
dGhvcnMuIEFsbCByaWdodHMgcmVzZXJ2
ZWQuCi8vIFVzZSBvZiB0aGlzIHNvdXJj
ZSBjb2RlIGlzIGdvdmVybmVkIGJ5IGEg
QlNELXN0eWxlIGxpY2Vuc2UgdGhhdCBj
YW4gYmUKLy8gZm91bmQgaW4gdGhlIExJ
Q0VOU0UgZmlsZS4KCid1c2Ugc3RyaWN0
JzsKCi8qKgogKiBVdGlsaXR5IGNsYXNz
IHVzZWQgdG8gYWRkIHB1Ymxpc2gvc3Vi
c2NyaWJlL3Vuc3Vic2NyaWJlIGZ1bmN0
aW9uYWxpdHkgdG8KICogYW4gZXhpc3Rp
bmcgb2JqZWN0LgogKi8KaHRlcm0uUHVi
U3ViID0gZnVuY3Rpb24oKSB7CiAgdGhp
cy5vYnNlcnZlcnNfID0ge307Cn07Cgov
KioKICogQWRkIHB1Ymxpc2gsIHN1YnNj
cmliZSwgYW5kIHVuc3Vic2NyaWJlIG1l
dGhvZHMgdG8gYW4gZXhpc3Rpbmcgb2Jq
ZWN0LgogKgogKiBObyBvdGhlciBwcm9w
ZXJ0aWVzIG9mIHRoZSBvYmplY3QgYXJl
IHRvdWNoZWQsIHNvIHRoZXJlIGlzIG5v
IG5lZWQgdG8KICogd29ycnkgYWJvdXQg
Y2xhc2hpbmcgcHJpdmF0ZSBwcm9wZXJ0
aWVzLgogKgogKiBAcGFyYW0ge09iamVj
dH0gb2JqIFRoZSBvYmplY3QgdG8gYWRk
IHRoaXMgYmVoYXZpb3IgdG8uCiAqLwpo
dGVybS5QdWJTdWIuYWRkQmVoYXZpb3Ig
PSBmdW5jdGlvbihvYmopIHsKICB2YXIg
cHVic3ViID0gbmV3IGh0ZXJtLlB1YlN1
YigpOwogIGZvciAodmFyIG0gaW4gaHRl
cm0uUHViU3ViLnByb3RvdHlwZSkgewog
ICAgb2JqW21dID0gaHRlcm0uUHViU3Vi
LnByb3RvdHlwZVttXS5iaW5kKHB1YnN1
Yik7CiAgfQp9OwoKLyoqCiAqIFN1YnNj
cmliZSB0byBiZSBub3RpZmllZCBvZiBt
ZXNzYWdlcyBhYm91dCBhIHN1YmplY3Qu
CiAqCiAqIEBwYXJhbSB7c3RyaW5nfSBz
dWJqZWN0IFRoZSBzdWJqZWN0IHRvIHN1
YnNjcmliZSB0by4KICogQHBhcmFtIHtm
dW5jdGlvbihPYmplY3QpfSBjYWxsYmFj
ayBUaGUgZnVuY3Rpb24gdG8gaW52b2tl
IGZvciBub3RpZmljYXRpb25zLgogKi8K
aHRlcm0uUHViU3ViLnByb3RvdHlwZS5z
dWJzY3JpYmUgPSBmdW5jdGlvbihzdWJq
ZWN0LCBjYWxsYmFjaykgewogIGlmICgh
KHN1YmplY3QgaW4gdGhpcy5vYnNlcnZl
cnNfKSkKICAgIHRoaXMub2JzZXJ2ZXJz
X1tzdWJqZWN0XSA9IFtdOwoKICB0aGlz
Lm9ic2VydmVyc19bc3ViamVjdF0ucHVz
aChjYWxsYmFjayk7Cn07CgovKioKICog
VW5zdWJzY3JpYmUgZnJvbSBhIHN1Ympl
Y3QuCiAqCiAqIEBwYXJhbSB7c3RyaW5n
fSBzdWJqZWN0IFRoZSBzdWJqZWN0IHRv
IHVuc3Vic2NyaWJlIGZyb20uCiAqIEBw
YXJhbSB7ZnVuY3Rpb24oT2JqZWN0KX0g
Y2FsbGJhY2sgQSBjYWxsYmFjayBwcmV2
aW91c2x5IHJlZ2lzdGVyZWQgdmlhCiAq
ICAgICBzdWJzY3JpYmUoKS4KICovCmh0
ZXJtLlB1YlN1Yi5wcm90b3R5cGUudW5z
dWJzY3JpYmUgPSBmdW5jdGlvbihzdWJq
ZWN0LCBjYWxsYmFjaykgewogIHZhciBs
aXN0ID0gdGhpcy5vYnNlcnZlcnNfW3N1
YmplY3RdOwogIGlmICghbGlzdCkKICAg
IHRocm93ICdJbnZhbGlkIHN1YmplY3Q6
ICcgKyBzdWJqZWN0OwoKICB2YXIgaSA9
IGxpc3QuaW5kZXhPZihjYWxsYmFjayk7
CiAgaWYgKGkgPCAwKQogICAgdGhyb3cg
J05vdCBzdWJzY3JpYmVkOiAnICsgc3Vi
amVjdDsKCiAgbGlzdC5zcGxpY2UoaSwg
MSk7Cn07CgovKioKICogUHVibGlzaCBh
IG1lc3NhZ2UgYWJvdXQgYSBzdWJqZWN0
LgogKgogKiBTdWJzY3JpYmVycyAoYW5k
IHRoZSBvcHRpb25hbCBmaW5hbCBjYWxs
YmFjaykgYXJlIGludm9rZWQgYXN5bmNo
cm9ub3VzbHkuCiAqIFRoaXMgbWV0aG9k
IHdpbGwgcmV0dXJuIGJlZm9yZSBhbnlv
bmUgaXMgYWN0dWFsbHkgbm90aWZpZWQu
CiAqCiAqIEBwYXJhbSB7c3RyaW5nfSBz
dWJqZWN0IFRoZSBzdWJqZWN0IHRvIHB1
Ymxpc2ggYWJvdXQuCiAqIEBwYXJhbSB7
T2JqZWN0fSBlIEFuIGFyYml0cmFyeSBv
YmplY3QgYXNzb2NpYXRlZCB3aXRoIHRo
aXMgbm90aWZpY2F0aW9uLgogKiBAcGFy
YW0ge2Z1bmN0aW9uKE9iamVjdCl9IG9w
dF9sYXN0Q2FsbGJhY2sgQW4gb3B0aW9u
YWwgZnVuY3Rpb24gdG8gY2FsbCBhZnRl
cgogKiAgICAgYWxsIHN1YnNjcmliZXJz
IGhhdmUgYmVlbiBub3RpZmllZC4KICov
Cmh0ZXJtLlB1YlN1Yi5wcm90b3R5cGUu
cHVibGlzaCA9IGZ1bmN0aW9uKHN1Ympl
Y3QsIGUsIG9wdF9sYXN0Q2FsbGJhY2sp
IHsKICBmdW5jdGlvbiBub3RpZnlMaXN0
KGkpIHsKICAgIC8vIFNldCB0aGlzIHRp
bWVvdXQgYmVmb3JlIGludm9raW5nIHRo
ZSBjYWxsYmFjaywgc28gd2UgZG9uJ3Qg
aGF2ZSB0bwogICAgLy8gY29uY2VybiBv
dXJzZWx2ZXMgd2l0aCBleGNlcHRpb25z
LgogICAgaWYgKGkgPCBsaXN0Lmxlbmd0
aCAtIDEpCiAgICAgIHNldFRpbWVvdXQo
bm90aWZ5TGlzdCwgMCwgaSArIDEpOwoK
ICAgIGxpc3RbaV0oZSk7CiAgfQoKICB2
YXIgbGlzdCA9IHRoaXMub2JzZXJ2ZXJz
X1tzdWJqZWN0XTsKICBpZiAobGlzdCkg
ewogICAgLy8gQ29weSB0aGUgbGlzdCwg
aW4gY2FzZSBpdCBjaGFuZ2VzIHdoaWxl
IHdlJ3JlIG5vdGlmeWluZy4KICAgIGxp
c3QgPSBbXS5jb25jYXQobGlzdCk7CiAg
fQoKICBpZiAob3B0X2xhc3RDYWxsYmFj
aykgewogICAgaWYgKGxpc3QpIHsKICAg
ICAgbGlzdC5wdXNoKG9wdF9sYXN0Q2Fs
bGJhY2spOwogICAgfSBlbHNlIHsKICAg
ICAgbGlzdCA9IFtvcHRfbGFzdENhbGxi
YWNrXTsKICAgIH0KICB9CgogIGlmIChs
aXN0KQogICAgc2V0VGltZW91dChub3Rp
ZnlMaXN0LCAwLCAwKTsKfTsKLy8gU09V
UkNFIEZJTEU6IGh0ZXJtL2pzL2h0ZXJt
X3NjcmVlbi5qcwovLyBDb3B5cmlnaHQg
KGMpIDIwMTIgVGhlIENocm9taXVtIE9T
IEF1dGhvcnMuIEFsbCByaWdodHMgcmVz
ZXJ2ZWQuCi8vIFVzZSBvZiB0aGlzIHNv
dXJjZSBjb2RlIGlzIGdvdmVybmVkIGJ5
IGEgQlNELXN0eWxlIGxpY2Vuc2UgdGhh
dCBjYW4gYmUKLy8gZm91bmQgaW4gdGhl
IExJQ0VOU0UgZmlsZS4KCid1c2Ugc3Ry
aWN0JzsKCmxpYi5ydGRlcCgnbGliLmYn
LCAnbGliLndjJywKICAgICAgICAgICdo
dGVybS5Sb3dDb2wnLCAnaHRlcm0uU2l6
ZScsICdodGVybS5UZXh0QXR0cmlidXRl
cycpOwoKLyoqCiAqIEBmaWxlb3ZlcnZp
ZXcgVGhpcyBjbGFzcyByZXByZXNlbnRz
IGEgc2luZ2xlIHRlcm1pbmFsIHNjcmVl
biBmdWxsIG9mIHRleHQuCiAqCiAqIEl0
IG1haW50YWlucyB0aGUgY3VycmVudCBj
dXJzb3IgcG9zaXRpb24gYW5kIGhhcyBi
YXNpYyBtZXRob2RzIGZvciB0ZXh0CiAq
IGluc2VydCBhbmQgb3ZlcndyaXRlLCBh
bmQgYWRkaW5nIG9yIHJlbW92aW5nIHJv
d3MgZnJvbSB0aGUgc2NyZWVuLgogKgog
KiBUaGlzIGNsYXNzIGhhcyBubyBrbm93
bGVkZ2Ugb2YgdGhlIHNjcm9sbGJhY2sg
YnVmZmVyLgogKgogKiBUaGUgbnVtYmVy
IG9mIHJvd3Mgb24gdGhlIHNjcmVlbiBp
cyBkZXRlcm1pbmVkIG9ubHkgYnkgdGhl
IG51bWJlciBvZiByb3dzCiAqIHRoYXQg
dGhlIGNhbGxlciBpbnNlcnRzIGludG8g
dGhlIHNjcmVlbi4gIElmIGEgY2FsbGVy
IHdhbnRzIHRvIGVuc3VyZSBhCiAqIGNv
bnN0YW50IG51bWJlciBvZiByb3dzIG9u
IHRoZSBzY3JlZW4sIGl0J3MgdGhlaXIg
cmVzcG9uc2liaWxpdHkgdG8gcmVtb3Zl
IGEKICogcm93IGZvciBlYWNoIHJvdyBp
bnNlcnRlZC4KICoKICogVGhlIHNjcmVl
biB3aWR0aCwgaW4gY29udHJhc3QsIGlz
IGVuZm9yY2VkIGxvY2FsbHkuCiAqCiAq
CiAqIEluIHByYWN0aWNlLi4uCiAqIC0g
VGhlIGh0ZXJtLlRlcm1pbmFsIGNsYXNz
IGhvbGRzIHR3byBodGVybS5TY3JlZW4g
aW5zdGFuY2VzLiAgT25lIGZvciB0aGUK
ICogcHJpbWFyeSBzY3JlZW4gYW5kIG9u
ZSBmb3IgdGhlIGFsdGVybmF0ZSBzY3Jl
ZW4uCiAqCiAqIC0gVGhlIGh0bWwuU2Ny
ZWVuIGNsYXNzIG9ubHkgY2FyZXMgdGhh
dCByb3dzIGFyZSBIVE1MRWxlbWVudHMu
ICBJbiB0aGUKICogbGFyZ2VyIGNvbnRl
eHQgb2YgaHRlcm0sIGhvd2V2ZXIsIHRo
ZSByb3dzIGhhcHBlbiB0byBiZSBkaXNw
bGF5ZWQgYnkgYW4KICogaHRlcm0uU2Ny
b2xsUG9ydCBhbmQgaGF2ZSB0byBmb2xs
b3cgYSBmZXcgcnVsZXMgYXMgYSByZXN1
bHQuICBFYWNoCiAqIHJvdyBtdXN0IGJl
IHJvb3RlZCBieSB0aGUgY3VzdG9tIEhU
TUwgdGFnICd4LXJvdycsIGFuZCBlYWNo
IG11c3QgaGF2ZSBhCiAqIHJvd0luZGV4
IHByb3BlcnR5IHRoYXQgY29ycmVzcG9u
ZHMgdG8gdGhlIGluZGV4IG9mIHRoZSBy
b3cgaW4gdGhlIGNvbnRleHQKICogb2Yg
dGhlIHNjcm9sbGJhY2sgYnVmZmVyLiAg
VGhlc2UgaW52YXJpYW50cyBhcmUgZW5m
b3JjZWQgYnkgaHRlcm0uVGVybWluYWwK
ICogYmVjYXVzZSB0aGF0IGlzIHRoZSBj
bGFzcyB1c2luZyB0aGUgaHRlcm0uU2Ny
ZWVuIGluIHRoZSBjb250ZXh0IG9mIGFu
CiAqIGh0ZXJtLlNjcm9sbFBvcnQuCiAq
LwoKLyoqCiAqIENyZWF0ZSBhIG5ldyBz
Y3JlZW4gaW5zdGFuY2UuCiAqCiAqIFRo
ZSBzY3JlZW4gaW5pdGlhbGx5IGhhcyBu
byByb3dzIGFuZCBhIG1heGltdW0gY29s
dW1uIGNvdW50IG9mIDAuCiAqCiAqIEBw
YXJhbSB7aW50ZWdlcn0gb3B0X2NvbHVt
bkNvdW50IFRoZSBtYXhpbXVtIG51bWJl
ciBvZiBjb2x1bW5zIGZvciB0aGlzCiAq
ICAgIHNjcmVlbi4gIFNlZSBpbnNlcnRT
dHJpbmcoKSBhbmQgb3ZlcndyaXRlU3Ry
aW5nKCkgZm9yIGluZm9ybWF0aW9uIGFi
b3V0CiAqICAgIHdoYXQgaGFwcGVucyB3
aGVuIHRvbyBtYW55IGNoYXJhY3RlcnMg
YXJlIGFkZGVkIHRvbyBhIHJvdy4gIERl
ZmF1bHRzIHRvCiAqICAgIDAgaWYgbm90
IHByb3ZpZGVkLgogKi8KaHRlcm0uU2Ny
ZWVuID0gZnVuY3Rpb24ob3B0X2NvbHVt
bkNvdW50KSB7CiAgLyoqCiAgICogUHVi
bGljLCByZWFkLW9ubHkgYWNjZXNzIHRv
IHRoZSByb3dzIGluIHRoaXMgc2NyZWVu
LgogICAqLwogIHRoaXMucm93c0FycmF5
ID0gW107CgogIC8vIFRoZSBtYXggY29s
dW1uIHdpZHRoIGZvciB0aGlzIHNjcmVl
bi4KICB0aGlzLmNvbHVtbkNvdW50XyA9
IG9wdF9jb2x1bW5Db3VudCB8fCA4MDsK
CiAgLy8gVGhlIGN1cnJlbnQgY29sb3Is
IGJvbGQsIHVuZGVybGluZSBhbmQgYmxp
bmsgYXR0cmlidXRlcy4KICB0aGlzLnRl
eHRBdHRyaWJ1dGVzID0gbmV3IGh0ZXJt
LlRleHRBdHRyaWJ1dGVzKHdpbmRvdy5k
b2N1bWVudCk7CgogIC8vIEN1cnJlbnQg
emVyby1iYXNlZCBjdXJzb3IgY29vcmRp
bmF0ZXMuCiAgdGhpcy5jdXJzb3JQb3Np
dGlvbiA9IG5ldyBodGVybS5Sb3dDb2wo
MCwgMCk7CgogIC8vIFRoZSBub2RlIGNv
bnRhaW5pbmcgdGhlIHJvdyB0aGF0IHRo
ZSBjdXJzb3IgaXMgcG9zaXRpb25lZCBv
bi4KICB0aGlzLmN1cnNvclJvd05vZGVf
ID0gbnVsbDsKCiAgLy8gVGhlIG5vZGUg
Y29udGFpbmluZyB0aGUgc3BhbiBvZiB0
ZXh0IHRoYXQgdGhlIGN1cnNvciBpcyBw
b3NpdGlvbmVkIG9uLgogIHRoaXMuY3Vy
c29yTm9kZV8gPSBudWxsOwoKICAvLyBU
aGUgb2Zmc2V0IGluIGNvbHVtbiB3aWR0
aCBpbnRvIGN1cnNvck5vZGVfIHdoZXJl
IHRoZSBjdXJzb3IgaXMgcG9zaXRpb25l
ZC4KICB0aGlzLmN1cnNvck9mZnNldF8g
PSBudWxsOwp9OwoKLyoqCiAqIFJldHVy
biB0aGUgc2NyZWVuIHNpemUgYXMgYW4g
aHRlcm0uU2l6ZSBvYmplY3QuCiAqCiAq
IEByZXR1cm4ge2h0ZXJtLlNpemV9IGh0
ZXJtLlNpemUgb2JqZWN0IHJlcHJlc2Vu
dGluZyB0aGUgY3VycmVudCBudW1iZXIK
ICogICAgIG9mIHJvd3MgYW5kIGNvbHVt
bnMgaW4gdGhpcyBzY3JlZW4uCiAqLwpo
dGVybS5TY3JlZW4ucHJvdG90eXBlLmdl
dFNpemUgPSBmdW5jdGlvbigpIHsKICBy
ZXR1cm4gbmV3IGh0ZXJtLlNpemUodGhp
cy5jb2x1bW5Db3VudF8sIHRoaXMucm93
c0FycmF5Lmxlbmd0aCk7Cn07CgovKioK
ICogUmV0dXJuIHRoZSBjdXJyZW50IG51
bWJlciBvZiByb3dzIGluIHRoaXMgc2Ny
ZWVuLgogKgogKiBAcmV0dXJuIHtpbnRl
Z2VyfSBUaGUgbnVtYmVyIG9mIHJvd3Mg
aW4gdGhpcyBzY3JlZW4uCiAqLwpodGVy
bS5TY3JlZW4ucHJvdG90eXBlLmdldEhl
aWdodCA9IGZ1bmN0aW9uKCkgewogIHJl
dHVybiB0aGlzLnJvd3NBcnJheS5sZW5n
dGg7Cn07CgovKioKICogUmV0dXJuIHRo
ZSBjdXJyZW50IG51bWJlciBvZiBjb2x1
bW5zIGluIHRoaXMgc2NyZWVuLgogKgog
KiBAcmV0dXJuIHtpbnRlZ2VyfSBUaGUg
bnVtYmVyIG9mIGNvbHVtbnMgaW4gdGhp
cyBzY3JlZW4uCiAqLwpodGVybS5TY3Jl
ZW4ucHJvdG90eXBlLmdldFdpZHRoID0g
ZnVuY3Rpb24oKSB7CiAgcmV0dXJuIHRo
aXMuY29sdW1uQ291bnRfOwp9OwoKLyoq
CiAqIFNldCB0aGUgbWF4aW11bSBudW1i
ZXIgb2YgY29sdW1ucyBwZXIgcm93Lgog
KgogKiBAcGFyYW0ge2ludGVnZXJ9IGNv
dW50IFRoZSBtYXhpbXVtIG51bWJlciBv
ZiBjb2x1bW5zIHBlciByb3cuCiAqLwpo
dGVybS5TY3JlZW4ucHJvdG90eXBlLnNl
dENvbHVtbkNvdW50ID0gZnVuY3Rpb24o
Y291bnQpIHsKICB0aGlzLmNvbHVtbkNv
dW50XyA9IGNvdW50OwoKICBpZiAodGhp
cy5jdXJzb3JQb3NpdGlvbi5jb2x1bW4g
Pj0gY291bnQpCiAgICB0aGlzLnNldEN1
cnNvclBvc2l0aW9uKHRoaXMuY3Vyc29y
UG9zaXRpb24ucm93LCBjb3VudCAtIDEp
Owp9OwoKLyoqCiAqIFJlbW92ZSB0aGUg
Zmlyc3Qgcm93IGZyb20gdGhlIHNjcmVl
biBhbmQgcmV0dXJuIGl0LgogKgogKiBA
cmV0dXJuIHtIVE1MRWxlbWVudH0gVGhl
IGZpcnN0IHJvdyBpbiB0aGlzIHNjcmVl
bi4KICovCmh0ZXJtLlNjcmVlbi5wcm90
b3R5cGUuc2hpZnRSb3cgPSBmdW5jdGlv
bigpIHsKICByZXR1cm4gdGhpcy5zaGlm
dFJvd3MoMSlbMF07Cn07CgovKioKICog
UmVtb3ZlIHJvd3MgZnJvbSB0aGUgdG9w
IG9mIHRoZSBzY3JlZW4gYW5kIHJldHVy
biB0aGVtIGFzIGFuIGFycmF5LgogKgog
KiBAcGFyYW0ge2ludGVnZXJ9IGNvdW50
IFRoZSBudW1iZXIgb2Ygcm93cyB0byBy
ZW1vdmUuCiAqIEByZXR1cm4ge0FycmF5
LjxIVE1MRWxlbWVudD59IFRoZSBzZWxl
Y3RlZCByb3dzLgogKi8KaHRlcm0uU2Ny
ZWVuLnByb3RvdHlwZS5zaGlmdFJvd3Mg
PSBmdW5jdGlvbihjb3VudCkgewogIHJl
dHVybiB0aGlzLnJvd3NBcnJheS5zcGxp
Y2UoMCwgY291bnQpOwp9OwoKLyoqCiAq
IEluc2VydCBhIHJvdyBhdCB0aGUgdG9w
IG9mIHRoZSBzY3JlZW4uCiAqCiAqIEBw
YXJhbSB7SFRNTEVsZW1lbnR9IFRoZSBy
b3cgdG8gaW5zZXJ0LgogKi8KaHRlcm0u
U2NyZWVuLnByb3RvdHlwZS51bnNoaWZ0
Um93ID0gZnVuY3Rpb24ocm93KSB7CiAg
dGhpcy5yb3dzQXJyYXkuc3BsaWNlKDAs
IDAsIHJvdyk7Cn07CgovKioKICogSW5z
ZXJ0IHJvd3MgYXQgdGhlIHRvcCBvZiB0
aGUgc2NyZWVuLgogKgogKiBAcGFyYW0g
e0FycmF5LjxIVE1MRWxlbWVudD59IFRo
ZSByb3dzIHRvIGluc2VydC4KICovCmh0
ZXJtLlNjcmVlbi5wcm90b3R5cGUudW5z
aGlmdFJvd3MgPSBmdW5jdGlvbihyb3dz
KSB7CiAgdGhpcy5yb3dzQXJyYXkudW5z
aGlmdC5hcHBseSh0aGlzLnJvd3NBcnJh
eSwgcm93cyk7Cn07CgovKioKICogUmVt
b3ZlIHRoZSBsYXN0IHJvdyBmcm9tIHRo
ZSBzY3JlZW4gYW5kIHJldHVybiBpdC4K
ICoKICogQHJldHVybiB7SFRNTEVsZW1l
bnR9IFRoZSBsYXN0IHJvdyBpbiB0aGlz
IHNjcmVlbi4KICovCmh0ZXJtLlNjcmVl
bi5wcm90b3R5cGUucG9wUm93ID0gZnVu
Y3Rpb24oKSB7CiAgcmV0dXJuIHRoaXMu
cG9wUm93cygxKVswXTsKfTsKCi8qKgog
KiBSZW1vdmUgcm93cyBmcm9tIHRoZSBi
b3R0b20gb2YgdGhlIHNjcmVlbiBhbmQg
cmV0dXJuIHRoZW0gYXMgYW4gYXJyYXku
CiAqCiAqIEBwYXJhbSB7aW50ZWdlcn0g
Y291bnQgVGhlIG51bWJlciBvZiByb3dz
IHRvIHJlbW92ZS4KICogQHJldHVybiB7
QXJyYXkuPEhUTUxFbGVtZW50Pn0gVGhl
IHNlbGVjdGVkIHJvd3MuCiAqLwpodGVy
bS5TY3JlZW4ucHJvdG90eXBlLnBvcFJv
d3MgPSBmdW5jdGlvbihjb3VudCkgewog
IHJldHVybiB0aGlzLnJvd3NBcnJheS5z
cGxpY2UodGhpcy5yb3dzQXJyYXkubGVu
Z3RoIC0gY291bnQsIGNvdW50KTsKfTsK
Ci8qKgogKiBJbnNlcnQgYSByb3cgYXQg
dGhlIGJvdHRvbSBvZiB0aGUgc2NyZWVu
LgogKgogKiBAcGFyYW0ge0hUTUxFbGVt
ZW50fSBUaGUgcm93IHRvIGluc2VydC4K
ICovCmh0ZXJtLlNjcmVlbi5wcm90b3R5
cGUucHVzaFJvdyA9IGZ1bmN0aW9uKHJv
dykgewogIHRoaXMucm93c0FycmF5LnB1
c2gocm93KTsKfTsKCi8qKgogKiBJbnNl
cnQgcm93cyBhdCB0aGUgYm90dG9tIG9m
IHRoZSBzY3JlZW4uCiAqCiAqIEBwYXJh
bSB7QXJyYXkuPEhUTUxFbGVtZW50Pn0g
VGhlIHJvd3MgdG8gaW5zZXJ0LgogKi8K
aHRlcm0uU2NyZWVuLnByb3RvdHlwZS5w
dXNoUm93cyA9IGZ1bmN0aW9uKHJvd3Mp
IHsKICByb3dzLnB1c2guYXBwbHkodGhp
cy5yb3dzQXJyYXksIHJvd3MpOwp9OwoK
LyoqCiAqIEluc2VydCBhIHJvdyBhdCB0
aGUgc3BlY2lmaWVkIGNvbHVtbiBvZiB0
aGUgc2NyZWVuLgogKgogKiBAcGFyYW0g
e0hUTUxFbGVtZW50fSBUaGUgcm93IHRv
IGluc2VydC4KICovCmh0ZXJtLlNjcmVl
bi5wcm90b3R5cGUuaW5zZXJ0Um93ID0g
ZnVuY3Rpb24oaW5kZXgsIHJvdykgewog
IHRoaXMucm93c0FycmF5LnNwbGljZShp
bmRleCwgMCwgcm93KTsKfTsKCi8qKgog
KiBJbnNlcnQgcm93cyBhdCB0aGUgc3Bl
Y2lmaWVkIGNvbHVtbiBvZiB0aGUgc2Ny
ZWVuLgogKgogKiBAcGFyYW0ge0FycmF5
LjxIVE1MRWxlbWVudD59IFRoZSByb3dz
IHRvIGluc2VydC4KICovCmh0ZXJtLlNj
cmVlbi5wcm90b3R5cGUuaW5zZXJ0Um93
cyA9IGZ1bmN0aW9uKGluZGV4LCByb3dz
KSB7CiAgZm9yICh2YXIgaSA9IDA7IGkg
PCByb3dzLmxlbmd0aDsgaSsrKSB7CiAg
ICB0aGlzLnJvd3NBcnJheS5zcGxpY2Uo
aW5kZXggKyBpLCAwLCByb3dzW2ldKTsK
ICB9Cn07CgovKioKICogUmVtb3ZlIGEg
bGFzdCByb3cgZnJvbSB0aGUgc3BlY2lm
aWVkIGNvbHVtbiBvZiB0aGUgc2NyZWVu
IGFuZCByZXR1cm4gaXQuCiAqCiAqIEBy
ZXR1cm4ge0hUTUxFbGVtZW50fSBUaGUg
c2VsZWN0ZWQgcm93LgogKi8KaHRlcm0u
U2NyZWVuLnByb3RvdHlwZS5yZW1vdmVS
b3cgPSBmdW5jdGlvbihpbmRleCkgewog
IHJldHVybiB0aGlzLnJvd3NBcnJheS5z
cGxpY2UoaW5kZXgsIDEpWzBdOwp9OwoK
LyoqCiAqIFJlbW92ZSByb3dzIGZyb20g
dGhlIGJvdHRvbSBvZiB0aGUgc2NyZWVu
IGFuZCByZXR1cm4gdGhlbSBhcyBhbiBh
cnJheS4KICoKICogQHBhcmFtIHtpbnRl
Z2VyfSBjb3VudCBUaGUgbnVtYmVyIG9m
IHJvd3MgdG8gcmVtb3ZlLgogKiBAcmV0
dXJuIHtBcnJheS48SFRNTEVsZW1lbnQ+
fSBUaGUgc2VsZWN0ZWQgcm93cy4KICov
Cmh0ZXJtLlNjcmVlbi5wcm90b3R5cGUu
cmVtb3ZlUm93cyA9IGZ1bmN0aW9uKGlu
ZGV4LCBjb3VudCkgewogIHJldHVybiB0
aGlzLnJvd3NBcnJheS5zcGxpY2UoaW5k
ZXgsIGNvdW50KTsKfTsKCi8qKgogKiBJ
bnZhbGlkYXRlIHRoZSBjdXJyZW50IGN1
cnNvciBwb3NpdGlvbi4KICoKICogVGhp
cyBzZXRzIHRoaXMuY3Vyc29yUG9zaXRp
b24gdG8gKDAsIDApIGFuZCBjbGVhcnMg
b3V0IHNvbWUgaW50ZXJuYWwKICogZGF0
YS4KICoKICogQXR0ZW1wdGluZyB0byBp
bnNlcnQgb3Igb3ZlcndyaXRlIHRleHQg
d2hpbGUgdGhlIGN1cnNvciBwb3NpdGlv
biBpcyBpbnZhbGlkCiAqIHdpbGwgcmFp
c2UgYW4gb2JzY3VyZSBleGNlcHRpb24u
CiAqLwpodGVybS5TY3JlZW4ucHJvdG90
eXBlLmludmFsaWRhdGVDdXJzb3JQb3Np
dGlvbiA9IGZ1bmN0aW9uKCkgewogIHRo
aXMuY3Vyc29yUG9zaXRpb24ubW92ZSgw
LCAwKTsKICB0aGlzLmN1cnNvclJvd05v
ZGVfID0gbnVsbDsKICB0aGlzLmN1cnNv
ck5vZGVfID0gbnVsbDsKICB0aGlzLmN1
cnNvck9mZnNldF8gPSBudWxsOwp9OwoK
LyoqCiAqIENsZWFyIHRoZSBjb250ZW50
cyBvZiB0aGUgY3Vyc29yIHJvdy4KICov
Cmh0ZXJtLlNjcmVlbi5wcm90b3R5cGUu
Y2xlYXJDdXJzb3JSb3cgPSBmdW5jdGlv
bigpIHsKICB0aGlzLmN1cnNvclJvd05v
ZGVfLmlubmVySFRNTCA9ICcnOwogIHRo
aXMuY3Vyc29yUm93Tm9kZV8ucmVtb3Zl
QXR0cmlidXRlKCdsaW5lLW92ZXJmbG93
Jyk7CiAgdGhpcy5jdXJzb3JPZmZzZXRf
ID0gMDsKICB0aGlzLmN1cnNvclBvc2l0
aW9uLmNvbHVtbiA9IDA7CiAgdGhpcy5j
dXJzb3JQb3NpdGlvbi5vdmVyZmxvdyA9
IGZhbHNlOwoKICB2YXIgdGV4dDsKICBp
ZiAodGhpcy50ZXh0QXR0cmlidXRlcy5p
c0RlZmF1bHQoKSkgewogICAgdGV4dCA9
ICcnOwogIH0gZWxzZSB7CiAgICB0ZXh0
ID0gbGliLmYuZ2V0V2hpdGVzcGFjZSh0
aGlzLmNvbHVtbkNvdW50Xyk7CiAgfQoK
ICAvLyBXZSBzaG91bGRuJ3QgaG9ub3Vy
IGludmVyc2UgY29sb3JzIHdoZW4gY2xl
YXJpbmcgYW4gYXJlYSwgdG8gbWF0Y2gK
ICAvLyB4dGVybSdzIGJhY2sgY29sb3Ig
ZXJhc2UgYmVoYXZpb3VyLgogIHZhciBp
bnZlcnNlID0gdGhpcy50ZXh0QXR0cmli
dXRlcy5pbnZlcnNlOwogIHRoaXMudGV4
dEF0dHJpYnV0ZXMuaW52ZXJzZSA9IGZh
bHNlOwogIHRoaXMudGV4dEF0dHJpYnV0
ZXMuc3luY0NvbG9ycygpOwoKICB2YXIg
bm9kZSA9IHRoaXMudGV4dEF0dHJpYnV0
ZXMuY3JlYXRlQ29udGFpbmVyKHRleHQp
OwogIHRoaXMuY3Vyc29yUm93Tm9kZV8u
YXBwZW5kQ2hpbGQobm9kZSk7CiAgdGhp
cy5jdXJzb3JOb2RlXyA9IG5vZGU7Cgog
IHRoaXMudGV4dEF0dHJpYnV0ZXMuaW52
ZXJzZSA9IGludmVyc2U7CiAgdGhpcy50
ZXh0QXR0cmlidXRlcy5zeW5jQ29sb3Jz
KCk7Cn07CgovKioKICogTWFyayB0aGUg
Y3VycmVudCByb3cgYXMgaGF2aW5nIG92
ZXJmbG93ZWQgdG8gdGhlIG5leHQgbGlu
ZS4KICoKICogVGhlIGxpbmUgb3ZlcmZs
b3cgc3RhdGUgaXMgdXNlZCB3aGVuIGNv
bnZlcnRpbmcgYSByYW5nZSBvZiByb3dz
IGludG8gdGV4dC4KICogSXQgbWFrZXMg
aXQgcG9zc2libGUgdG8gcmVjb21iaW5l
IHR3byBvciBtb3JlIG92ZXJmbG93IHRl
cm1pbmFsIHJvd3MgaW50bwogKiBhIHNp
bmdsZSBsaW5lLgogKgogKiBUaGlzIGlz
IGRpc3RpbmN0IGZyb20gdGhlIGN1cnNv
ciBiZWluZyBpbiB0aGUgb3ZlcmZsb3cg
c3RhdGUuICBDdXJzb3IKICogb3ZlcmZs
b3cgaW5kaWNhdGVzIHRoYXQgcHJpbnRp
bmcgYXQgdGhlIGN1cnNvciBwb3NpdGlv
biB3aWxsIGNvbW1pdCBhCiAqIGxpbmUg
b3ZlcmZsb3csIHVubGVzcyBpdCBpcyBw
cmVjZWRlZCBieSBhIHJlcG9zaXRpb25p
bmcgb2YgdGhlIGN1cnNvcgogKiB0byBh
IG5vbi1vdmVyZmxvdyBzdGF0ZS4KICov
Cmh0ZXJtLlNjcmVlbi5wcm90b3R5cGUu
Y29tbWl0TGluZU92ZXJmbG93ID0gZnVu
Y3Rpb24oKSB7CiAgdGhpcy5jdXJzb3JS
b3dOb2RlXy5zZXRBdHRyaWJ1dGUoJ2xp
bmUtb3ZlcmZsb3cnLCB0cnVlKTsKfTsK
Ci8qKgogKiBSZWxvY2F0ZSB0aGUgY3Vy
c29yIHRvIGEgZ2l2ZSByb3cgYW5kIGNv
bHVtbi4KICoKICogQHBhcmFtIHtpbnRl
Z2VyfSByb3cgVGhlIHplcm8gYmFzZWQg
cm93LgogKiBAcGFyYW0ge2ludGVnZXJ9
IGNvbHVtbiBUaGUgemVybyBiYXNlZCBj
b2x1bW4uCiAqLwpodGVybS5TY3JlZW4u
cHJvdG90eXBlLnNldEN1cnNvclBvc2l0
aW9uID0gZnVuY3Rpb24ocm93LCBjb2x1
bW4pIHsKICBpZiAoIXRoaXMucm93c0Fy
cmF5Lmxlbmd0aCkgewogICAgY29uc29s
ZS53YXJuKCdBdHRlbXB0IHRvIHNldCBj
dXJzb3IgcG9zaXRpb24gb24gZW1wdHkg
c2NyZWVuLicpOwogICAgcmV0dXJuOwog
IH0KCiAgaWYgKHJvdyA+PSB0aGlzLnJv
d3NBcnJheS5sZW5ndGgpIHsKICAgIGNv
bnNvbGUuZXJyb3IoJ1JvdyBvdXQgb2Yg
Ym91bmRzOiAnICsgcm93KTsKICAgIHJv
dyA9IHRoaXMucm93c0FycmF5Lmxlbmd0
aCAtIDE7CiAgfSBlbHNlIGlmIChyb3cg
PCAwKSB7CiAgICBjb25zb2xlLmVycm9y
KCdSb3cgb3V0IG9mIGJvdW5kczogJyAr
IHJvdyk7CiAgICByb3cgPSAwOwogIH0K
CiAgaWYgKGNvbHVtbiA+PSB0aGlzLmNv
bHVtbkNvdW50XykgewogICAgY29uc29s
ZS5lcnJvcignQ29sdW1uIG91dCBvZiBi
b3VuZHM6ICcgKyBjb2x1bW4pOwogICAg
Y29sdW1uID0gdGhpcy5jb2x1bW5Db3Vu
dF8gLSAxOwogIH0gZWxzZSBpZiAoY29s
dW1uIDwgMCkgewogICAgY29uc29sZS5l
cnJvcignQ29sdW1uIG91dCBvZiBib3Vu
ZHM6ICcgKyBjb2x1bW4pOwogICAgY29s
dW1uID0gMDsKICB9CgogIHRoaXMuY3Vy
c29yUG9zaXRpb24ub3ZlcmZsb3cgPSBm
YWxzZTsKCiAgdmFyIHJvd05vZGUgPSB0
aGlzLnJvd3NBcnJheVtyb3ddOwogIHZh
ciBub2RlID0gcm93Tm9kZS5maXJzdENo
aWxkOwoKICBpZiAoIW5vZGUpIHsKICAg
IG5vZGUgPSByb3dOb2RlLm93bmVyRG9j
dW1lbnQuY3JlYXRlVGV4dE5vZGUoJycp
OwogICAgcm93Tm9kZS5hcHBlbmRDaGls
ZChub2RlKTsKICB9CgogIHZhciBjdXJy
ZW50Q29sdW1uID0gMDsKCiAgaWYgKHJv
d05vZGUgPT0gdGhpcy5jdXJzb3JSb3dO
b2RlXykgewogICAgaWYgKGNvbHVtbiA+
PSB0aGlzLmN1cnNvclBvc2l0aW9uLmNv
bHVtbiAtIHRoaXMuY3Vyc29yT2Zmc2V0
XykgewogICAgICBub2RlID0gdGhpcy5j
dXJzb3JOb2RlXzsKICAgICAgY3VycmVu
dENvbHVtbiA9IHRoaXMuY3Vyc29yUG9z
aXRpb24uY29sdW1uIC0gdGhpcy5jdXJz
b3JPZmZzZXRfOwogICAgfQogIH0gZWxz
ZSB7CiAgICB0aGlzLmN1cnNvclJvd05v
ZGVfID0gcm93Tm9kZTsKICB9CgogIHRo
aXMuY3Vyc29yUG9zaXRpb24ubW92ZShy
b3csIGNvbHVtbik7CgogIHdoaWxlIChu
b2RlKSB7CiAgICB2YXIgb2Zmc2V0ID0g
Y29sdW1uIC0gY3VycmVudENvbHVtbjsK
ICAgIHZhciB3aWR0aCA9IGh0ZXJtLlRl
eHRBdHRyaWJ1dGVzLm5vZGVXaWR0aChu
b2RlKTsKICAgIGlmICghbm9kZS5uZXh0
U2libGluZyB8fCB3aWR0aCA+IG9mZnNl
dCkgewogICAgICB0aGlzLmN1cnNvck5v
ZGVfID0gbm9kZTsKICAgICAgdGhpcy5j
dXJzb3JPZmZzZXRfID0gb2Zmc2V0Owog
ICAgICByZXR1cm47CiAgICB9CgogICAg
Y3VycmVudENvbHVtbiArPSB3aWR0aDsK
ICAgIG5vZGUgPSBub2RlLm5leHRTaWJs
aW5nOwogIH0KfTsKCi8qKgogKiBTZXQg
dGhlIHByb3ZpZGVkIHNlbGVjdGlvbiBv
YmplY3QgdG8gYmUgYSBjYXJldCBzZWxl
Y3Rpb24gYXQgdGhlIGN1cnJlbnQKICog
Y3Vyc29yIHBvc2l0aW9uLgogKi8KaHRl
cm0uU2NyZWVuLnByb3RvdHlwZS5zeW5j
U2VsZWN0aW9uQ2FyZXQgPSBmdW5jdGlv
bihzZWxlY3Rpb24pIHsKICB0cnkgewog
ICAgc2VsZWN0aW9uLmNvbGxhcHNlKHRo
aXMuY3Vyc29yTm9kZV8sIHRoaXMuY3Vy
c29yT2Zmc2V0Xyk7CiAgfSBjYXRjaCAo
ZmlyZWZveElnbm9yZWRFeGNlcHRpb24p
IHsKICAgIC8vIEZGIGNhbiB0aHJvdyBh
biBleGNlcHRpb24gaWYgdGhlIHJhbmdl
IGlzIG9mZiwgcmF0aGVyIHRoYW4ganVz
dCBub3QKICAgIC8vIHBlcmZvcm1pbmcg
dGhlIGNvbGxhcHNlLgogIH0KfTsKCi8q
KgogKiBTcGxpdCBhIHNpbmdsZSBub2Rl
IGludG8gdHdvIG5vZGVzIGF0IHRoZSBn
aXZlbiBvZmZzZXQuCiAqCiAqIEZvciBl
eGFtcGxlOgogKiBHaXZlbiB0aGUgRE9N
IGZyYWdtZW50ICc8ZGl2PjxzcGFuPkhl
bGxvIFdvcmxkPC9zcGFuPjwvZGl2Pics
IGNhbGwgc3BsaXROb2RlXwogKiBwYXNz
aW5nIHRoZSBzcGFuIGFuZCBhbiBvZmZz
ZXQgb2YgNi4gIFRoaXMgd291bGQgbW9k
aWZpeSB0aGUgZnJhZ21lbnQgdG8KICog
YmVjb21lOiAnPGRpdj48c3Bhbj5IZWxs
byA8L3NwYW4+PHNwYW4+V29ybGQ8L3Nw
YW4+PC9kaXY+Jy4gIElmIHRoZSBzcGFu
CiAqIGhhZCBhbnkgYXR0cmlidXRlcyB0
aGV5IHdvdWxkIGhhdmUgYmVlbiBjb3Bp
ZWQgdG8gdGhlIG5ldyBzcGFuIGFzIHdl
bGwuCiAqCiAqIFRoZSB0by1iZS1zcGxp
dCBub2RlIG11c3QgaGF2ZSBhIGNvbnRh
aW5lciwgc28gdGhhdCB0aGUgbmV3IG5v
ZGUgY2FuIGJlCiAqIHBsYWNlZCBuZXh0
IHRvIGl0LgogKgogKiBAcGFyYW0ge0hU
TUxOb2RlfSBub2RlIFRoZSBub2RlIHRv
IHNwbGl0LgogKiBAcGFyYW0ge2ludGVn
ZXJ9IG9mZnNldCBUaGUgb2Zmc2V0IGlu
dG8gdGhlIG5vZGUgd2hlcmUgdGhlIHNw
bGl0IHNob3VsZAogKiAgICAgb2NjdXIu
CiAqLwpodGVybS5TY3JlZW4ucHJvdG90
eXBlLnNwbGl0Tm9kZV8gPSBmdW5jdGlv
bihub2RlLCBvZmZzZXQpIHsKICB2YXIg
YWZ0ZXJOb2RlID0gbm9kZS5jbG9uZU5v
ZGUoZmFsc2UpOwoKICB2YXIgdGV4dENv
bnRlbnQgPSBub2RlLnRleHRDb250ZW50
OwogIG5vZGUudGV4dENvbnRlbnQgPSBo
dGVybS5UZXh0QXR0cmlidXRlcy5ub2Rl
U3Vic3RyKG5vZGUsIDAsIG9mZnNldCk7
CiAgYWZ0ZXJOb2RlLnRleHRDb250ZW50
ID0gbGliLndjLnN1YnN0cih0ZXh0Q29u
dGVudCwgb2Zmc2V0KTsKCiAgaWYgKGFm
dGVyTm9kZS50ZXh0Q29udGVudCkKICAg
IG5vZGUucGFyZW50Tm9kZS5pbnNlcnRC
ZWZvcmUoYWZ0ZXJOb2RlLCBub2RlLm5l
eHRTaWJsaW5nKTsKICBpZiAoIW5vZGUu
dGV4dENvbnRlbnQpCiAgICBub2RlLnBh
cmVudE5vZGUucmVtb3ZlQ2hpbGQobm9k
ZSk7Cn07CgovKioKICogRW5zdXJlIHRo
YXQgdGV4dCBpcyBjbGlwcGVkIGFuZCB0
aGUgY3Vyc29yIGlzIGNsYW1wZWQgdG8g
dGhlIGNvbHVtbiBjb3VudC4KICovCmh0
ZXJtLlNjcmVlbi5wcm90b3R5cGUubWF5
YmVDbGlwQ3VycmVudFJvdyA9IGZ1bmN0
aW9uKCkgewogIHZhciB3aWR0aCA9IGh0
ZXJtLlRleHRBdHRyaWJ1dGVzLm5vZGVX
aWR0aCh0aGlzLmN1cnNvclJvd05vZGVf
KTsKCiAgaWYgKHdpZHRoIDw9IHRoaXMu
Y29sdW1uQ291bnRfKSB7CiAgICAvLyBD
dXJyZW50IHJvdyBkb2VzIG5vdCBuZWVk
IGNsaXBwaW5nLCBidXQgbWF5IG5lZWQg
Y2xhbXBpbmcuCiAgICBpZiAodGhpcy5j
dXJzb3JQb3NpdGlvbi5jb2x1bW4gPj0g
dGhpcy5jb2x1bW5Db3VudF8pIHsKICAg
ICAgdGhpcy5zZXRDdXJzb3JQb3NpdGlv
bih0aGlzLmN1cnNvclBvc2l0aW9uLnJv
dywgdGhpcy5jb2x1bW5Db3VudF8gLSAx
KTsKICAgICAgdGhpcy5jdXJzb3JQb3Np
dGlvbi5vdmVyZmxvdyA9IHRydWU7CiAg
ICB9CgogICAgcmV0dXJuOwogIH0KCiAg
Ly8gU2F2ZSBvZmYgdGhlIGN1cnJlbnQg
Y29sdW1uIHNvIHdlIGNhbiBtYXliZSBy
ZXN0b3JlIGl0IGxhdGVyLgogIHZhciBj
dXJyZW50Q29sdW1uID0gdGhpcy5jdXJz
b3JQb3NpdGlvbi5jb2x1bW47CgogIC8v
IE1vdmUgdGhlIGN1cnNvciB0byB0aGUg
ZmluYWwgY29sdW1uLgogIHRoaXMuc2V0
Q3Vyc29yUG9zaXRpb24odGhpcy5jdXJz
b3JQb3NpdGlvbi5yb3csIHRoaXMuY29s
dW1uQ291bnRfIC0gMSk7CgogIC8vIFJl
bW92ZSBhbnkgdGV4dCB0aGF0IHBhcnRp
YWxseSBvdmVyZmxvd3MuCiAgd2lkdGgg
PSBodGVybS5UZXh0QXR0cmlidXRlcy5u
b2RlV2lkdGgodGhpcy5jdXJzb3JOb2Rl
Xyk7CgogIGlmICh0aGlzLmN1cnNvck9m
ZnNldF8gPCB3aWR0aCAtIDEpIHsKICAg
IHRoaXMuY3Vyc29yTm9kZV8udGV4dENv
bnRlbnQgPSBodGVybS5UZXh0QXR0cmli
dXRlcy5ub2RlU3Vic3RyKAogICAgICAg
IHRoaXMuY3Vyc29yTm9kZV8sIDAsIHRo
aXMuY3Vyc29yT2Zmc2V0XyArIDEpOwog
IH0KCiAgLy8gUmVtb3ZlIGFsbCBub2Rl
cyBhZnRlciB0aGUgY3Vyc29yLgogIHZh
ciByb3dOb2RlID0gdGhpcy5jdXJzb3JS
b3dOb2RlXzsKICB2YXIgbm9kZSA9IHRo
aXMuY3Vyc29yTm9kZV8ubmV4dFNpYmxp
bmc7CgogIHdoaWxlIChub2RlKSB7CiAg
ICByb3dOb2RlLnJlbW92ZUNoaWxkKG5v
ZGUpOwogICAgbm9kZSA9IHRoaXMuY3Vy
c29yTm9kZV8ubmV4dFNpYmxpbmc7CiAg
fQoKICBpZiAoY3VycmVudENvbHVtbiA8
IHRoaXMuY29sdW1uQ291bnRfKSB7CiAg
ICAvLyBJZiB0aGUgY3Vyc29yIHdhcyB3
aXRoaW4gdGhlIHNjcmVlbiBiZWZvcmUg
d2Ugc3RhcnRlZCB0aGVuIHJlc3RvcmUg
aXRzCiAgICAvLyBwb3NpdGlvbi4KICAg
IHRoaXMuc2V0Q3Vyc29yUG9zaXRpb24o
dGhpcy5jdXJzb3JQb3NpdGlvbi5yb3cs
IGN1cnJlbnRDb2x1bW4pOwogIH0gZWxz
ZSB7CiAgICAvLyBPdGhlcndpc2UgbGVh
dmUgaXQgYXQgdGhlIHRoZSBsYXN0IGNv
bHVtbiBpbiB0aGUgb3ZlcmZsb3cgc3Rh
dGUuCiAgICB0aGlzLmN1cnNvclBvc2l0
aW9uLm92ZXJmbG93ID0gdHJ1ZTsKICB9
Cn07CgovKioKICogSW5zZXJ0IGEgc3Ry
aW5nIGF0IHRoZSBjdXJyZW50IGNoYXJh
Y3RlciBwb3NpdGlvbiB1c2luZyB0aGUg
Y3VycmVudAogKiB0ZXh0IGF0dHJpYnV0
ZXMuCiAqCiAqIFlvdSBtdXN0IGNhbGwg
bWF5YmVDbGlwQ3VycmVudFJvdygpIGFm
dGVyIGluIG9yZGVyIHRvIGNsaXAgb3Zl
cmZsb3dlZAogKiB0ZXh0IGFuZCBjbGFt
cCB0aGUgY3Vyc29yLgogKgogKiBJdCBp
cyBhbHNvIHVwIHRvIHRoZSBjYWxsZXIg
dG8gcHJvcGVybHkgbWFpbnRhaW4gdGhl
IGxpbmUgb3ZlcmZsb3cgc3RhdGUKICog
dXNpbmcgaHRlcm0uU2NyZWVuLi5jb21t
aXRMaW5lT3ZlcmZsb3coKS4KICovCmh0
ZXJtLlNjcmVlbi5wcm90b3R5cGUuaW5z
ZXJ0U3RyaW5nID0gZnVuY3Rpb24oc3Ry
KSB7CiAgdmFyIGN1cnNvck5vZGUgPSB0
aGlzLmN1cnNvck5vZGVfOwogIHZhciBj
dXJzb3JOb2RlVGV4dCA9IGN1cnNvck5v
ZGUudGV4dENvbnRlbnQ7CgogIHRoaXMu
Y3Vyc29yUm93Tm9kZV8ucmVtb3ZlQXR0
cmlidXRlKCdsaW5lLW92ZXJmbG93Jyk7
CgogIC8vIFdlIG1heSBhbHRlciB0aGUg
d2lkdGggb2YgdGhlIHN0cmluZyBieSBw
cmVwZW5kaW5nIHNvbWUgbWlzc2luZwog
IC8vIHdoaXRlc3BhY2VzLCBzbyB3ZSBu
ZWVkIHRvIHJlY29yZCB0aGUgc3RyaW5n
IHdpZHRoIGFoZWFkIG9mIHRpbWUuCiAg
dmFyIHN0cldpZHRoID0gbGliLndjLnN0
cldpZHRoKHN0cik7CgogIC8vIE5vIG1h
dHRlciB3aGF0LCBiZWZvcmUgdGhpcyBm
dW5jdGlvbiBleGl0cyB0aGUgY3Vyc29y
IGNvbHVtbiB3aWxsIGhhdmUKICAvLyBt
b3ZlZCB0aGlzIG11Y2guCiAgdGhpcy5j
dXJzb3JQb3NpdGlvbi5jb2x1bW4gKz0g
c3RyV2lkdGg7CgogIC8vIExvY2FsIGNh
Y2hlIG9mIHRoZSBjdXJzb3Igb2Zmc2V0
LgogIHZhciBvZmZzZXQgPSB0aGlzLmN1
cnNvck9mZnNldF87CgogIC8vIFJldmVy
c2Ugb2Zmc2V0IGlzIHRoZSBvZmZzZXQg
bWVhc3VyZWQgZnJvbSB0aGUgZW5kIG9m
IHRoZSBzdHJpbmcuCiAgLy8gWmVybyBp
bXBsaWVzIHRoYXQgdGhlIGN1cnNvciBp
cyBhdCB0aGUgZW5kIG9mIHRoZSBjdXJz
b3Igbm9kZS4KICB2YXIgcmV2ZXJzZU9m
ZnNldCA9IGh0ZXJtLlRleHRBdHRyaWJ1
dGVzLm5vZGVXaWR0aChjdXJzb3JOb2Rl
KSAtIG9mZnNldDsKCiAgaWYgKHJldmVy
c2VPZmZzZXQgPCAwKSB7CiAgICAvLyBB
IG5lZ2F0aXZlIHJldmVyc2Ugb2Zmc2V0
IG1lYW5zIHRoZSBjdXJzb3IgaXMgcG9z
aXRpb25lZCBwYXN0IHRoZSBlbmQKICAg
IC8vIG9mIHRoZSBjaGFyYWN0ZXJzIG9u
IHRoaXMgbGluZS4gIFdlJ2xsIG5lZWQg
dG8gaW5zZXJ0IHRoZSBtaXNzaW5nCiAg
ICAvLyB3aGl0ZXNwYWNlLgogICAgdmFy
IHdzID0gbGliLmYuZ2V0V2hpdGVzcGFj
ZSgtcmV2ZXJzZU9mZnNldCk7CgogICAg
Ly8gVGhpcyB3aGl0ZXNwYWNlIHNob3Vs
ZCBiZSBjb21wbGV0ZWx5IHVuc3R5bGVk
LiAgVW5kZXJsaW5lLCBiYWNrZ3JvdW5k
CiAgICAvLyBjb2xvciwgYW5kIHN0cmlr
ZXRocm91Z2ggd291bGQgYmUgdmlzaWJs
ZSBvbiB3aGl0ZXNwYWNlLCBzbyB3ZSBj
YW4ndCB1c2UKICAgIC8vIG9uZSBvZiB0
aG9zZSBzcGFucyB0byBob2xkIHRoZSB0
ZXh0LgogICAgaWYgKCEodGhpcy50ZXh0
QXR0cmlidXRlcy51bmRlcmxpbmUgfHwK
ICAgICAgICAgIHRoaXMudGV4dEF0dHJp
YnV0ZXMuc3RyaWtldGhyb3VnaCB8fAog
ICAgICAgICAgdGhpcy50ZXh0QXR0cmli
dXRlcy5iYWNrZ3JvdW5kIHx8CiAgICAg
ICAgICB0aGlzLnRleHRBdHRyaWJ1dGVz
LndjTm9kZSB8fAogICAgICAgICAgdGhp
cy50ZXh0QXR0cmlidXRlcy50aWxlRGF0
YSAhPSBudWxsKSkgewogICAgICAvLyBC
ZXN0IGNhc2Ugc2NlbmFyaW8sIHdlIGNh
biBqdXN0IHByZXRlbmQgdGhlIHNwYWNl
cyB3ZXJlIHBhcnQgb2YgdGhlCiAgICAg
IC8vIG9yaWdpbmFsIHN0cmluZy4KICAg
ICAgc3RyID0gd3MgKyBzdHI7CiAgICB9
IGVsc2UgaWYgKGN1cnNvck5vZGUubm9k
ZVR5cGUgPT0gMyB8fAogICAgICAgICAg
ICAgICAhKGN1cnNvck5vZGUud2NOb2Rl
IHx8CiAgICAgICAgICAgICAgICAgY3Vy
c29yTm9kZS50aWxlTm9kZSB8fAogICAg
ICAgICAgICAgICAgIGN1cnNvck5vZGUu
c3R5bGUudGV4dERlY29yYXRpb24gfHwK
ICAgICAgICAgICAgICAgICBjdXJzb3JO
b2RlLnN0eWxlLmJhY2tncm91bmRDb2xv
cikpIHsKICAgICAgLy8gU2Vjb25kIGJl
c3QgY2FzZSwgdGhlIGN1cnJlbnQgbm9k
ZSBpcyBhYmxlIHRvIGhvbGQgdGhlIHdo
aXRlc3BhY2UuCiAgICAgIGN1cnNvck5v
ZGUudGV4dENvbnRlbnQgPSAoY3Vyc29y
Tm9kZVRleHQgKz0gd3MpOwogICAgfSBl
bHNlIHsKICAgICAgLy8gV29yc3QgY2Fz
ZSwgd2UgaGF2ZSB0byBjcmVhdGUgYSBu
ZXcgbm9kZSB0byBob2xkIHRoZSB3aGl0
ZXNwYWNlLgogICAgICB2YXIgd3NOb2Rl
ID0gY3Vyc29yTm9kZS5vd25lckRvY3Vt
ZW50LmNyZWF0ZVRleHROb2RlKHdzKTsK
ICAgICAgdGhpcy5jdXJzb3JSb3dOb2Rl
Xy5pbnNlcnRCZWZvcmUod3NOb2RlLCBj
dXJzb3JOb2RlLm5leHRTaWJsaW5nKTsK
ICAgICAgdGhpcy5jdXJzb3JOb2RlXyA9
IGN1cnNvck5vZGUgPSB3c05vZGU7CiAg
ICAgIHRoaXMuY3Vyc29yT2Zmc2V0XyA9
IG9mZnNldCA9IC1yZXZlcnNlT2Zmc2V0
OwogICAgICBjdXJzb3JOb2RlVGV4dCA9
IHdzOwogICAgfQoKICAgIC8vIFdlIG5v
dyBrbm93IGZvciBzdXJlIHRoYXQgd2Un
cmUgYXQgdGhlIGxhc3QgY2hhcmFjdGVy
IG9mIHRoZSBjdXJzb3Igbm9kZS4KICAg
IHJldmVyc2VPZmZzZXQgPSAwOwogIH0K
CiAgaWYgKHRoaXMudGV4dEF0dHJpYnV0
ZXMubWF0Y2hlc0NvbnRhaW5lcihjdXJz
b3JOb2RlKSkgewogICAgLy8gVGhlIG5l
dyB0ZXh0IGNhbiBiZSBwbGFjZWQgZGly
ZWN0bHkgaW4gdGhlIGN1cnNvciBub2Rl
LgogICAgaWYgKHJldmVyc2VPZmZzZXQg
PT0gMCkgewogICAgICBjdXJzb3JOb2Rl
LnRleHRDb250ZW50ID0gY3Vyc29yTm9k
ZVRleHQgKyBzdHI7CiAgICB9IGVsc2Ug
aWYgKG9mZnNldCA9PSAwKSB7CiAgICAg
IGN1cnNvck5vZGUudGV4dENvbnRlbnQg
PSBzdHIgKyBjdXJzb3JOb2RlVGV4dDsK
ICAgIH0gZWxzZSB7CiAgICAgIGN1cnNv
ck5vZGUudGV4dENvbnRlbnQgPQogICAg
ICAgICAgaHRlcm0uVGV4dEF0dHJpYnV0
ZXMubm9kZVN1YnN0cihjdXJzb3JOb2Rl
LCAwLCBvZmZzZXQpICsKICAgICAgICAg
IHN0ciArIGh0ZXJtLlRleHRBdHRyaWJ1
dGVzLm5vZGVTdWJzdHIoY3Vyc29yTm9k
ZSwgb2Zmc2V0KTsKICAgIH0KCiAgICB0
aGlzLmN1cnNvck9mZnNldF8gKz0gc3Ry
V2lkdGg7CiAgICByZXR1cm47CiAgfQoK
ICAvLyBUaGUgY3Vyc29yIG5vZGUgaXMg
dGhlIHdyb25nIHN0eWxlIGZvciB0aGUg
bmV3IHRleHQuICBJZiB3ZSdyZSBhdCB0
aGUKICAvLyBiZWdpbm5pbmcgb3IgZW5k
IG9mIHRoZSBjdXJzb3Igbm9kZSwgdGhl
biB0aGUgYWRqYWNlbnQgbm9kZSBpcyBh
bHNvIGEKICAvLyBwb3RlbnRpYWwgY2Fu
ZGlkYXRlLgoKICBpZiAob2Zmc2V0ID09
IDApIHsKICAgIC8vIEF0IHRoZSBiZWdp
bm5pbmcgb2YgdGhlIGN1cnNvciBub2Rl
LCB0aGUgY2hlY2sgdGhlIHByZXZpb3Vz
IHNpYmxpbmcuCiAgICB2YXIgcHJldmlv
dXNTaWJsaW5nID0gY3Vyc29yTm9kZS5w
cmV2aW91c1NpYmxpbmc7CiAgICBpZiAo
cHJldmlvdXNTaWJsaW5nICYmCiAgICAg
ICAgdGhpcy50ZXh0QXR0cmlidXRlcy5t
YXRjaGVzQ29udGFpbmVyKHByZXZpb3Vz
U2libGluZykpIHsKICAgICAgcHJldmlv
dXNTaWJsaW5nLnRleHRDb250ZW50ICs9
IHN0cjsKICAgICAgdGhpcy5jdXJzb3JO
b2RlXyA9IHByZXZpb3VzU2libGluZzsK
ICAgICAgdGhpcy5jdXJzb3JPZmZzZXRf
ID0gbGliLndjLnN0cldpZHRoKHByZXZp
b3VzU2libGluZy50ZXh0Q29udGVudCk7
CiAgICAgIHJldHVybjsKICAgIH0KCiAg
ICB2YXIgbmV3Tm9kZSA9IHRoaXMudGV4
dEF0dHJpYnV0ZXMuY3JlYXRlQ29udGFp
bmVyKHN0cik7CiAgICB0aGlzLmN1cnNv
clJvd05vZGVfLmluc2VydEJlZm9yZShu
ZXdOb2RlLCBjdXJzb3JOb2RlKTsKICAg
IHRoaXMuY3Vyc29yTm9kZV8gPSBuZXdO
b2RlOwogICAgdGhpcy5jdXJzb3JPZmZz
ZXRfID0gc3RyV2lkdGg7CiAgICByZXR1
cm47CiAgfQoKICBpZiAocmV2ZXJzZU9m
ZnNldCA9PSAwKSB7CiAgICAvLyBBdCB0
aGUgZW5kIG9mIHRoZSBjdXJzb3Igbm9k
ZSwgdGhlIGNoZWNrIHRoZSBuZXh0IHNp
YmxpbmcuCiAgICB2YXIgbmV4dFNpYmxp
bmcgPSBjdXJzb3JOb2RlLm5leHRTaWJs
aW5nOwogICAgaWYgKG5leHRTaWJsaW5n
ICYmCiAgICAgICAgdGhpcy50ZXh0QXR0
cmlidXRlcy5tYXRjaGVzQ29udGFpbmVy
KG5leHRTaWJsaW5nKSkgewogICAgICBu
ZXh0U2libGluZy50ZXh0Q29udGVudCA9
IHN0ciArIG5leHRTaWJsaW5nLnRleHRD
b250ZW50OwogICAgICB0aGlzLmN1cnNv
ck5vZGVfID0gbmV4dFNpYmxpbmc7CiAg
ICAgIHRoaXMuY3Vyc29yT2Zmc2V0XyA9
IGxpYi53Yy5zdHJXaWR0aChzdHIpOwog
ICAgICByZXR1cm47CiAgICB9CgogICAg
dmFyIG5ld05vZGUgPSB0aGlzLnRleHRB
dHRyaWJ1dGVzLmNyZWF0ZUNvbnRhaW5l
cihzdHIpOwogICAgdGhpcy5jdXJzb3JS
b3dOb2RlXy5pbnNlcnRCZWZvcmUobmV3
Tm9kZSwgbmV4dFNpYmxpbmcpOwogICAg
dGhpcy5jdXJzb3JOb2RlXyA9IG5ld05v
ZGU7CiAgICAvLyBXZSBzcGVjaWZpY2Fs
bHkgbmVlZCB0byBpbmNsdWRlIGFueSBt
aXNzaW5nIHdoaXRlc3BhY2UgaGVyZSwg
c2luY2UgaXQncwogICAgLy8gZ29pbmcg
aW4gYSBuZXcgbm9kZS4KICAgIHRoaXMu
Y3Vyc29yT2Zmc2V0XyA9IGh0ZXJtLlRl
eHRBdHRyaWJ1dGVzLm5vZGVXaWR0aChu
ZXdOb2RlKTsKICAgIHJldHVybjsKICB9
CgogIC8vIFdvcnN0IGNhc2UsIHdlJ3Jl
IHNvbWV3aGVyZSBpbiB0aGUgbWlkZGxl
IG9mIHRoZSBjdXJzb3Igbm9kZS4gIFdl
J2xsCiAgLy8gaGF2ZSB0byBzcGxpdCBp
dCBpbnRvIHR3byBub2RlcyBhbmQgaW5z
ZXJ0IG91ciBuZXcgY29udGFpbmVyIGlu
IGJldHdlZW4uCiAgdGhpcy5zcGxpdE5v
ZGVfKGN1cnNvck5vZGUsIG9mZnNldCk7
CiAgdmFyIG5ld05vZGUgPSB0aGlzLnRl
eHRBdHRyaWJ1dGVzLmNyZWF0ZUNvbnRh
aW5lcihzdHIpOwogIHRoaXMuY3Vyc29y
Um93Tm9kZV8uaW5zZXJ0QmVmb3JlKG5l
d05vZGUsIGN1cnNvck5vZGUubmV4dFNp
YmxpbmcpOwogIHRoaXMuY3Vyc29yTm9k
ZV8gPSBuZXdOb2RlOwogIHRoaXMuY3Vy
c29yT2Zmc2V0XyA9IHN0cldpZHRoOwp9
OwoKLyoqCiAqIE92ZXJ3cml0ZSB0aGUg
dGV4dCBhdCB0aGUgY3VycmVudCBjdXJz
b3IgcG9zaXRpb24uCiAqCiAqIFlvdSBt
dXN0IGNhbGwgbWF5YmVDbGlwQ3VycmVu
dFJvdygpIGFmdGVyIGluIG9yZGVyIHRv
IGNsaXAgb3ZlcmZsb3dlZAogKiB0ZXh0
IGFuZCBjbGFtcCB0aGUgY3Vyc29yLgog
KgogKiBJdCBpcyBhbHNvIHVwIHRvIHRo
ZSBjYWxsZXIgdG8gcHJvcGVybHkgbWFp
bnRhaW4gdGhlIGxpbmUgb3ZlcmZsb3cg
c3RhdGUKICogdXNpbmcgaHRlcm0uU2Ny
ZWVuLi5jb21taXRMaW5lT3ZlcmZsb3co
KS4KICovCmh0ZXJtLlNjcmVlbi5wcm90
b3R5cGUub3ZlcndyaXRlU3RyaW5nID0g
ZnVuY3Rpb24oc3RyKSB7CiAgdmFyIG1h
eExlbmd0aCA9IHRoaXMuY29sdW1uQ291
bnRfIC0gdGhpcy5jdXJzb3JQb3NpdGlv
bi5jb2x1bW47CiAgaWYgKCFtYXhMZW5n
dGgpCiAgICByZXR1cm4gW3N0cl07Cgog
IHZhciB3aWR0aCA9IGxpYi53Yy5zdHJX
aWR0aChzdHIpOwogIGlmICh0aGlzLnRl
eHRBdHRyaWJ1dGVzLm1hdGNoZXNDb250
YWluZXIodGhpcy5jdXJzb3JOb2RlXykg
JiYKICAgICAgdGhpcy5jdXJzb3JOb2Rl
Xy50ZXh0Q29udGVudC5zdWJzdHIodGhp
cy5jdXJzb3JPZmZzZXRfKSA9PSBzdHIp
IHsKICAgIC8vIFRoaXMgb3ZlcndyaXRl
IHdvdWxkIGJlIGEgbm8tb3AsIGp1c3Qg
bW92ZSB0aGUgY3Vyc29yIGFuZCByZXR1
cm4uCiAgICB0aGlzLmN1cnNvck9mZnNl
dF8gKz0gd2lkdGg7CiAgICB0aGlzLmN1
cnNvclBvc2l0aW9uLmNvbHVtbiArPSB3
aWR0aDsKICAgIHJldHVybjsKICB9Cgog
IHRoaXMuZGVsZXRlQ2hhcnMoTWF0aC5t
aW4od2lkdGgsIG1heExlbmd0aCkpOwog
IHRoaXMuaW5zZXJ0U3RyaW5nKHN0cik7
Cn07CgovKioKICogRm9yd2FyZC1kZWxl
dGUgb25lIG9yIG1vcmUgY2hhcmFjdGVy
cyBhdCB0aGUgY3VycmVudCBjdXJzb3Ig
cG9zaXRpb24uCiAqCiAqIFRleHQgdG8g
dGhlIHJpZ2h0IG9mIHRoZSBkZWxldGVk
IGNoYXJhY3RlcnMgaXMgc2hpZnRlZCBs
ZWZ0LiAgT25seSBhZmZlY3RzCiAqIGNo
YXJhY3RlcnMgb24gdGhlIHNhbWUgcm93
IGFzIHRoZSBjdXJzb3IuCiAqCiAqIEBw
YXJhbSB7aW50ZWdlcn0gY291bnQgVGhl
IGNvbHVtbiB3aWR0aCBvZiBjaGFyYWN0
ZXJzIHRvIGRlbGV0ZS4gIFRoaXMgaXMK
ICogICAgIGNsYW1wZWQgdG8gdGhlIGNv
bHVtbiB3aWR0aCBtaW51cyB0aGUgY3Vy
c29yIGNvbHVtbi4KICogQHJldHVybiB7
aW50ZWdlcn0gVGhlIGNvbHVtbiB3aWR0
aCBvZiB0aGUgY2hhcmFjdGVycyBhY3R1
YWxseSBkZWxldGVkLgogKi8KaHRlcm0u
U2NyZWVuLnByb3RvdHlwZS5kZWxldGVD
aGFycyA9IGZ1bmN0aW9uKGNvdW50KSB7
CiAgdmFyIG5vZGUgPSB0aGlzLmN1cnNv
ck5vZGVfOwogIHZhciBvZmZzZXQgPSB0
aGlzLmN1cnNvck9mZnNldF87CgogIHZh
ciBjdXJyZW50Q3Vyc29yQ29sdW1uID0g
dGhpcy5jdXJzb3JQb3NpdGlvbi5jb2x1
bW47CiAgY291bnQgPSBNYXRoLm1pbihj
b3VudCwgdGhpcy5jb2x1bW5Db3VudF8g
LSBjdXJyZW50Q3Vyc29yQ29sdW1uKTsK
ICBpZiAoIWNvdW50KQogICAgcmV0dXJu
IDA7CgogIHZhciBydiA9IGNvdW50Owog
IHZhciBzdGFydExlbmd0aCwgZW5kTGVu
Z3RoOwoKICB3aGlsZSAobm9kZSAmJiBj
b3VudCkgewogICAgc3RhcnRMZW5ndGgg
PSBodGVybS5UZXh0QXR0cmlidXRlcy5u
b2RlV2lkdGgobm9kZSk7CiAgICBub2Rl
LnRleHRDb250ZW50ID0gaHRlcm0uVGV4
dEF0dHJpYnV0ZXMubm9kZVN1YnN0cihu
b2RlLCAwLCBvZmZzZXQpICsKICAgICAg
ICBodGVybS5UZXh0QXR0cmlidXRlcy5u
b2RlU3Vic3RyKG5vZGUsIG9mZnNldCAr
IGNvdW50KTsKICAgIGVuZExlbmd0aCA9
IGh0ZXJtLlRleHRBdHRyaWJ1dGVzLm5v
ZGVXaWR0aChub2RlKTsKICAgIGNvdW50
IC09IHN0YXJ0TGVuZ3RoIC0gZW5kTGVu
Z3RoOwogICAgaWYgKG9mZnNldCA8IHN0
YXJ0TGVuZ3RoICYmIGVuZExlbmd0aCAm
JiBzdGFydExlbmd0aCA9PSBlbmRMZW5n
dGgpIHsKICAgICAgLy8gTm8gY2hhcmFj
dGVycyB3ZXJlIGRlbGV0ZWQgd2hlbiB0
aGVyZSBzaG91bGQgYmUuICBXZSdyZSBw
cm9iYWJseSB0cnlpbmcKICAgICAgLy8g
dG8gZGVsZXRlIG9uZSBjb2x1bW4gd2lk
dGggZnJvbSBhIHdpZGUgY2hhcmFjdGVy
IG5vZGUuICBXZSByZW1vdmUgdGhlCiAg
ICAgIC8vIHdpZGUgY2hhcmFjdGVyIG5v
ZGUgaGVyZSBhbmQgcmVwbGFjZSBpdCB3
aXRoIGEgc2luZ2xlIHNwYWNlLgogICAg
ICB2YXIgc3BhY2VOb2RlID0gdGhpcy50
ZXh0QXR0cmlidXRlcy5jcmVhdGVDb250
YWluZXIoJyAnKTsKICAgICAgbm9kZS5w
YXJlbnROb2RlLmluc2VydEJlZm9yZShz
cGFjZU5vZGUsIG5vZGUubmV4dFNpYmxp
bmcpOwogICAgICBub2RlLnRleHRDb250
ZW50ID0gJyc7CiAgICAgIGVuZExlbmd0
aCA9IDA7CiAgICAgIGNvdW50IC09IDE7
CiAgICB9CgogICAgdmFyIG5leHROb2Rl
ID0gbm9kZS5uZXh0U2libGluZzsKICAg
IGlmIChlbmRMZW5ndGggPT0gMCAmJiBu
b2RlICE9IHRoaXMuY3Vyc29yTm9kZV8p
IHsKICAgICAgbm9kZS5wYXJlbnROb2Rl
LnJlbW92ZUNoaWxkKG5vZGUpOwogICAg
fQogICAgbm9kZSA9IG5leHROb2RlOwog
ICAgb2Zmc2V0ID0gMDsKICB9CgogIC8v
IFJlbW92ZSB0aGlzLmN1cnNvck5vZGVf
IGlmIGl0IGlzIGFuIGVtcHR5IG5vbi10
ZXh0IG5vZGUuCiAgaWYgKHRoaXMuY3Vy
c29yTm9kZV8ubm9kZVR5cGUgIT0gMyAm
JiAhdGhpcy5jdXJzb3JOb2RlXy50ZXh0
Q29udGVudCkgewogICAgdmFyIGN1cnNv
ck5vZGUgPSB0aGlzLmN1cnNvck5vZGVf
OwogICAgaWYgKGN1cnNvck5vZGUucHJl
dmlvdXNTaWJsaW5nKSB7CiAgICAgIHRo
aXMuY3Vyc29yTm9kZV8gPSBjdXJzb3JO
b2RlLnByZXZpb3VzU2libGluZzsKICAg
ICAgdGhpcy5jdXJzb3JPZmZzZXRfID0g
aHRlcm0uVGV4dEF0dHJpYnV0ZXMubm9k
ZVdpZHRoKAogICAgICAgICAgY3Vyc29y
Tm9kZS5wcmV2aW91c1NpYmxpbmcpOwog
ICAgfSBlbHNlIGlmIChjdXJzb3JOb2Rl
Lm5leHRTaWJsaW5nKSB7CiAgICAgIHRo
aXMuY3Vyc29yTm9kZV8gPSBjdXJzb3JO
b2RlLm5leHRTaWJsaW5nOwogICAgICB0
aGlzLmN1cnNvck9mZnNldF8gPSAwOwog
ICAgfSBlbHNlIHsKICAgICAgdmFyIGVt
cHR5Tm9kZSA9IHRoaXMuY3Vyc29yUm93
Tm9kZV8ub3duZXJEb2N1bWVudC5jcmVh
dGVUZXh0Tm9kZSgnJyk7CiAgICAgIHRo
aXMuY3Vyc29yUm93Tm9kZV8uYXBwZW5k
Q2hpbGQoZW1wdHlOb2RlKTsKICAgICAg
dGhpcy5jdXJzb3JOb2RlXyA9IGVtcHR5
Tm9kZTsKICAgICAgdGhpcy5jdXJzb3JP
ZmZzZXRfID0gMDsKICAgIH0KICAgIHRo
aXMuY3Vyc29yUm93Tm9kZV8ucmVtb3Zl
Q2hpbGQoY3Vyc29yTm9kZSk7CiAgfQoK
ICByZXR1cm4gcnY7Cn07CgovKioKICog
RmluZHMgZmlyc3QgWC1ST1cgb2YgYSBs
aW5lIGNvbnRhaW5pbmcgc3BlY2lmaWVk
IFgtUk9XLgogKiBVc2VkIHRvIHN1cHBv
cnQgbGluZSBvdmVyZmxvdy4KICoKICog
QHBhcmFtIHtOb2RlfSByb3cgWC1ST1cg
dG8gYmVnaW4gc2VhcmNoIGZvciBmaXJz
dCByb3cgb2YgbGluZS4KICogQHJldHVy
biB7Tm9kZX0gVGhlIFgtUk9XIHRoYXQg
aXMgYXQgdGhlIGJlZ2lubmluZyBvZiB0
aGUgbGluZS4KICoqLwpodGVybS5TY3Jl
ZW4ucHJvdG90eXBlLmdldExpbmVTdGFy
dFJvd18gPSBmdW5jdGlvbihyb3cpIHsK
ICB3aGlsZSAocm93LnByZXZpb3VzU2li
bGluZyAmJgogICAgICAgICByb3cucHJl
dmlvdXNTaWJsaW5nLmhhc0F0dHJpYnV0
ZSgnbGluZS1vdmVyZmxvdycpKSB7CiAg
ICByb3cgPSByb3cucHJldmlvdXNTaWJs
aW5nOwogIH0KICByZXR1cm4gcm93Owp9
OwoKLyoqCiAqIEdldHMgdGV4dCBvZiBh
IGxpbmUgYmVnaW5uaW5nIHdpdGggcm93
LgogKiBTdXBwb3J0cyBsaW5lIG92ZXJm
bG93LgogKgogKiBAcGFyYW0ge05vZGV9
IHJvdyBGaXJzdCBYLVJPVyBvZiBsaW5l
LgogKiBAcmV0dXJuIHtzdHJpbmd9IFRl
eHQgY29udGVudCBvZiBsaW5lLgogKiov
Cmh0ZXJtLlNjcmVlbi5wcm90b3R5cGUu
Z2V0TGluZVRleHRfID0gZnVuY3Rpb24o
cm93KSB7CiAgdmFyIHJvd1RleHQgPSAi
IjsKICB3aGlsZSAocm93KSB7CiAgICBy
b3dUZXh0ICs9IHJvdy50ZXh0Q29udGVu
dDsKICAgIGlmIChyb3cuaGFzQXR0cmli
dXRlKCdsaW5lLW92ZXJmbG93JykpIHsK
ICAgICAgcm93ID0gcm93Lm5leHRTaWJs
aW5nOwogICAgfSBlbHNlIHsKICAgICAg
YnJlYWs7CiAgICB9CiAgfQogIHJldHVy
biByb3dUZXh0Owp9OwoKLyoqCiAqIFJl
dHVybnMgWC1ST1cgdGhhdCBpcyBhbmNl
c3RvciBvZiB0aGUgbm9kZS4KICoKICog
QHBhcmFtIHtOb2RlfSBub2RlIE5vZGUg
dG8gZ2V0IFgtUk9XIGFuY2VzdG9yIGZv
ci4KICogQHJldHVybiB7Tm9kZX0gWC1S
T1cgYW5jZXN0b3Igb2Ygbm9kZSwgb3Ig
bnVsbCBpZiBub3QgZm91bmQuCiAqKi8K
aHRlcm0uU2NyZWVuLnByb3RvdHlwZS5n
ZXRYUm93QW5jZXN0b3JfID0gZnVuY3Rp
b24obm9kZSkgewogIHdoaWxlIChub2Rl
KSB7CiAgICBpZiAobm9kZS5ub2RlTmFt
ZSA9PT0gJ1gtUk9XJykKICAgICAgYnJl
YWs7CiAgICBub2RlID0gbm9kZS5wYXJl
bnROb2RlOwogIH0KICByZXR1cm4gbm9k
ZTsKfTsKCi8qKgogKiBSZXR1cm5zIHBv
c2l0aW9uIHdpdGhpbiBsaW5lIG9mIGNo
YXJhY3RlciBhdCBvZmZzZXQgd2l0aGlu
IG5vZGUuCiAqIFN1cHBvcnRzIGxpbmUg
b3ZlcmZsb3cuCiAqCiAqIEBwYXJhbSB7
Tm9kZX0gcm93IFgtUk9XIGF0IGJlZ2lu
bmluZyBvZiBsaW5lLgogKiBAcGFyYW0g
e05vZGV9IG5vZGUgTm9kZSB0byBnZXQg
cG9zaXRpb24gb2YuCiAqIEBwYXJhbSB7
aW50ZWdlcn0gb2Zmc2V0IE9mZnNldCBp
bnRvIG5vZGUuCiAqCiAqIEByZXR1cm4g
e2ludGVnZXJ9IFBvc2l0aW9uIHdpdGhp
biBsaW5lIG9mIGNoYXJhY3RlciBhdCBv
ZmZzZXQgd2l0aGluIG5vZGUuCiAqKi8K
aHRlcm0uU2NyZWVuLnByb3RvdHlwZS5n
ZXRQb3NpdGlvbldpdGhPdmVyZmxvd18g
PSBmdW5jdGlvbihyb3csIG5vZGUsIG9m
ZnNldCkgewogIGlmICghbm9kZSkKICAg
IHJldHVybiAtMTsKICB2YXIgYW5jZXN0
b3JSb3cgPSB0aGlzLmdldFhSb3dBbmNl
c3Rvcl8obm9kZSk7CiAgaWYgKCFhbmNl
c3RvclJvdykKICAgIHJldHVybiAtMTsK
ICB2YXIgcG9zaXRpb24gPSAwOwogIHdo
aWxlIChhbmNlc3RvclJvdyAhPSByb3cp
IHsKICAgIHBvc2l0aW9uICs9IGh0ZXJt
LlRleHRBdHRyaWJ1dGVzLm5vZGVXaWR0
aChyb3cpOwogICAgaWYgKHJvdy5oYXNB
dHRyaWJ1dGUoJ2xpbmUtb3ZlcmZsb3cn
KSAmJiByb3cubmV4dFNpYmxpbmcpIHsK
ICAgICAgcm93ID0gcm93Lm5leHRTaWJs
aW5nOwogICAgfSBlbHNlIHsKICAgICAg
cmV0dXJuIC0xOwogICAgfQogIH0KICBy
ZXR1cm4gcG9zaXRpb24gKyB0aGlzLmdl
dFBvc2l0aW9uV2l0aGluUm93Xyhyb3cs
IG5vZGUsIG9mZnNldCk7Cn07CgovKioK
ICogUmV0dXJucyBwb3NpdGlvbiB3aXRo
aW4gcm93IG9mIGNoYXJhY3RlciBhdCBv
ZmZzZXQgd2l0aGluIG5vZGUuCiAqIERv
ZXMgbm90IHN1cHBvcnQgbGluZSBvdmVy
Zmxvdy4KICoKICogQHBhcmFtIHtOb2Rl
fSByb3cgWC1ST1cgdG8gZ2V0IHBvc2l0
aW9uIHdpdGhpbi4KICogQHBhcmFtIHtO
b2RlfSBub2RlIE5vZGUgdG8gZ2V0IHBv
c2l0aW9uIGZvci4KICogQHBhcmFtIHtp
bnRlZ2VyfSBvZmZzZXQgT2Zmc2V0IHdp
dGhpbiBub2RlIHRvIGdldCBwb3NpdGlv
biBmb3IuCiAqIEByZXR1cm4ge2ludGVn
ZXJ9IFBvc2l0aW9uIHdpdGhpbiByb3cg
b2YgY2hhcmFjdGVyIGF0IG9mZnNldCB3
aXRoaW4gbm9kZS4KICoqLwpodGVybS5T
Y3JlZW4ucHJvdG90eXBlLmdldFBvc2l0
aW9uV2l0aGluUm93XyA9IGZ1bmN0aW9u
KHJvdywgbm9kZSwgb2Zmc2V0KSB7CiAg
aWYgKG5vZGUucGFyZW50Tm9kZSAhPSBy
b3cpIHsKICAgIHJldHVybiB0aGlzLmdl
dFBvc2l0aW9uV2l0aGluUm93Xyhub2Rl
LnBhcmVudE5vZGUsIG5vZGUsIG9mZnNl
dCkgKwogICAgICAgICAgIHRoaXMuZ2V0
UG9zaXRpb25XaXRoaW5Sb3dfKHJvdywg
bm9kZS5wYXJlbnROb2RlLCAwKTsKICB9
CiAgdmFyIHBvc2l0aW9uID0gMDsKICBm
b3IgKHZhciBpID0gMDsgaSA8IHJvdy5j
aGlsZE5vZGVzLmxlbmd0aDsgaSsrKSB7
CiAgICB2YXIgY3VycmVudE5vZGUgPSBy
b3cuY2hpbGROb2Rlc1tpXTsKICAgIGlm
IChjdXJyZW50Tm9kZSA9PSBub2RlKQog
ICAgICByZXR1cm4gcG9zaXRpb24gKyBv
ZmZzZXQ7CiAgICBwb3NpdGlvbiArPSBo
dGVybS5UZXh0QXR0cmlidXRlcy5ub2Rl
V2lkdGgoY3VycmVudE5vZGUpOwogIH0K
ICByZXR1cm4gLTE7Cn07CgovKioKICog
UmV0dXJucyB0aGUgbm9kZSBhbmQgb2Zm
c2V0IGNvcnJlc3BvbmRpbmcgdG8gcG9z
aXRpb24gd2l0aGluIGxpbmUuCiAqIFN1
cHBvcnRzIGxpbmUgb3ZlcmZsb3cuCiAq
CiAqIEBwYXJhbSB7Tm9kZX0gcm93IFgt
Uk9XIGF0IGJlZ2lubmluZyBvZiBsaW5l
LgogKiBAcGFyYW0ge2ludGVnZXJ9IHBv
c2l0aW9uIFBvc2l0aW9uIHdpdGhpbiBs
aW5lIHRvIHJldHJpZXZlIG5vZGUgYW5k
IG9mZnNldC4KICogQHJldHVybiB7QXJy
YXl9IFR3byBlbGVtZW50IGFycmF5IGNv
bnRhaW5pbmcgbm9kZSBhbmQgb2Zmc2V0
IHJlc3BlY3RpdmVseS4KICoqLwpodGVy
bS5TY3JlZW4ucHJvdG90eXBlLmdldE5v
ZGVBbmRPZmZzZXRXaXRoT3ZlcmZsb3df
ID0gZnVuY3Rpb24ocm93LCBwb3NpdGlv
bikgewogIHdoaWxlIChyb3cgJiYgcG9z
aXRpb24gPiBodGVybS5UZXh0QXR0cmli
dXRlcy5ub2RlV2lkdGgocm93KSkgewog
ICAgaWYgKHJvdy5oYXNBdHRyaWJ1dGUo
J2xpbmUtb3ZlcmZsb3cnKSAmJiByb3cu
bmV4dFNpYmxpbmcpIHsKICAgICAgcG9z
aXRpb24gLT0gaHRlcm0uVGV4dEF0dHJp
YnV0ZXMubm9kZVdpZHRoKHJvdyk7CiAg
ICAgIHJvdyA9IHJvdy5uZXh0U2libGlu
ZzsKICAgIH0gZWxzZSB7CiAgICAgIHJl
dHVybiAtMTsKICAgIH0KICB9CiAgcmV0
dXJuIHRoaXMuZ2V0Tm9kZUFuZE9mZnNl
dFdpdGhpblJvd18ocm93LCBwb3NpdGlv
bik7Cn07CgovKioKICogUmV0dXJucyB0
aGUgbm9kZSBhbmQgb2Zmc2V0IGNvcnJl
c3BvbmRpbmcgdG8gcG9zaXRpb24gd2l0
aGluIHJvdy4KICogRG9lcyBub3Qgc3Vw
cG9ydCBsaW5lIG92ZXJmbG93LgogKgog
KiBAcGFyYW0ge05vZGV9IHJvdyBYLVJP
VyB0byBnZXQgcG9zaXRpb24gd2l0aGlu
LgogKiBAcGFyYW0ge2ludGVnZXJ9IHBv
c2l0aW9uIFBvc2l0aW9uIHdpdGhpbiBy
b3cgdG8gcmV0cmlldmUgbm9kZSBhbmQg
b2Zmc2V0LgogKiBAcmV0dXJuIHtBcnJh
eX0gVHdvIGVsZW1lbnQgYXJyYXkgY29u
dGFpbmluZyBub2RlIGFuZCBvZmZzZXQg
cmVzcGVjdGl2ZWx5LgogKiovCmh0ZXJt
LlNjcmVlbi5wcm90b3R5cGUuZ2V0Tm9k
ZUFuZE9mZnNldFdpdGhpblJvd18gPSBm
dW5jdGlvbihyb3csIHBvc2l0aW9uKSB7
CiAgZm9yICh2YXIgaSA9IDA7IGkgPCBy
b3cuY2hpbGROb2Rlcy5sZW5ndGg7IGkr
KykgewogICAgdmFyIG5vZGUgPSByb3cu
Y2hpbGROb2Rlc1tpXTsKICAgIHZhciBu
b2RlVGV4dFdpZHRoID0gaHRlcm0uVGV4
dEF0dHJpYnV0ZXMubm9kZVdpZHRoKG5v
ZGUpOwogICAgaWYgKHBvc2l0aW9uIDw9
IG5vZGVUZXh0V2lkdGgpIHsKICAgICAg
aWYgKG5vZGUubm9kZU5hbWUgPT09ICdT
UEFOJykgewogICAgICAgIC8qKiBEcmls
bCBkb3duIHRvIG5vZGUgY29udGFpbmVk
IGJ5IFNQQU4uICoqLwogICAgICAgIHJl
dHVybiB0aGlzLmdldE5vZGVBbmRPZmZz
ZXRXaXRoaW5Sb3dfKG5vZGUsIHBvc2l0
aW9uKTsKICAgICAgfSBlbHNlIHsKICAg
ICAgICByZXR1cm4gW25vZGUsIHBvc2l0
aW9uXTsKICAgICAgfQogICAgfQogICAg
cG9zaXRpb24gLT0gbm9kZVRleHRXaWR0
aDsKICB9CiAgcmV0dXJuIG51bGw7Cn07
CgovKioKICogUmV0dXJucyB0aGUgbm9k
ZSBhbmQgb2Zmc2V0IGNvcnJlc3BvbmRp
bmcgdG8gcG9zaXRpb24gd2l0aGluIGxp
bmUuCiAqIFN1cHBvcnRzIGxpbmUgb3Zl
cmZsb3cuCiAqCiAqIEBwYXJhbSB7Tm9k
ZX0gcm93IFgtUk9XIGF0IGJlZ2lubmlu
ZyBvZiBsaW5lLgogKiBAcGFyYW0ge2lu
dGVnZXJ9IHN0YXJ0IFN0YXJ0IHBvc2l0
aW9uIG9mIHJhbmdlIHdpdGhpbiBsaW5l
LgogKiBAcGFyYW0ge2ludGVnZXJ9IGVu
ZCBFbmQgcG9zaXRpb24gb2YgcmFuZ2Ug
d2l0aGluIGxpbmUuCiAqIEBwYXJhbSB7
UmFuZ2V9IHJhbmdlIFJhbmdlIHRvIG1v
ZGlmeS4KICoqLwpodGVybS5TY3JlZW4u
cHJvdG90eXBlLnNldFJhbmdlXyA9IGZ1
bmN0aW9uKHJvdywgc3RhcnQsIGVuZCwg
cmFuZ2UpIHsKICB2YXIgc3RhcnROb2Rl
QW5kT2Zmc2V0ID0gdGhpcy5nZXROb2Rl
QW5kT2Zmc2V0V2l0aE92ZXJmbG93Xyhy
b3csIHN0YXJ0KTsKICBpZiAoc3RhcnRO
b2RlQW5kT2Zmc2V0ID09IG51bGwpCiAg
ICByZXR1cm47CiAgdmFyIGVuZE5vZGVB
bmRPZmZzZXQgPSB0aGlzLmdldE5vZGVB
bmRPZmZzZXRXaXRoT3ZlcmZsb3dfKHJv
dywgZW5kKTsKICBpZiAoZW5kTm9kZUFu
ZE9mZnNldCA9PSBudWxsKQogICAgcmV0
dXJuOwogIHJhbmdlLnNldFN0YXJ0KHN0
YXJ0Tm9kZUFuZE9mZnNldFswXSwgc3Rh
cnROb2RlQW5kT2Zmc2V0WzFdKTsKICBy
YW5nZS5zZXRFbmQoZW5kTm9kZUFuZE9m
ZnNldFswXSwgZW5kTm9kZUFuZE9mZnNl
dFsxXSk7Cn07CgovKioKICogRXhwYW5k
cyBzZWxlY3Rpb24gdG8gc3Vycm91bmQg
VVJMcy4KICoKICogQHBhcmFtIHtTZWxl
Y3Rpb259IHNlbGVjdGlvbiBTZWxlY3Rp
b24gdG8gZXhwYW5kLgogKiovCmh0ZXJt
LlNjcmVlbi5wcm90b3R5cGUuZXhwYW5k
U2VsZWN0aW9uID0gZnVuY3Rpb24oc2Vs
ZWN0aW9uKSB7CiAgaWYgKCFzZWxlY3Rp
b24pCiAgICByZXR1cm47CgogIHZhciBy
YW5nZSA9IHNlbGVjdGlvbi5nZXRSYW5n
ZUF0KDApOwogIGlmICghcmFuZ2UgfHwg
cmFuZ2UudG9TdHJpbmcoKS5tYXRjaCgv
XHMvKSkKICAgIHJldHVybjsKCiAgdmFy
IHJvdyA9IHRoaXMuZ2V0TGluZVN0YXJ0
Um93Xyh0aGlzLmdldFhSb3dBbmNlc3Rv
cl8ocmFuZ2Uuc3RhcnRDb250YWluZXIp
KTsKICBpZiAoIXJvdykKICAgIHJldHVy
bjsKCiAgdmFyIHN0YXJ0UG9zaXRpb24g
PSB0aGlzLmdldFBvc2l0aW9uV2l0aE92
ZXJmbG93Xyhyb3csCiAgICAgICAgICAg
ICAgICAgICAgICAgICAgICAgICAgICAg
ICAgICAgICAgICAgICAgICByYW5nZS5z
dGFydENvbnRhaW5lciwKICAgICAgICAg
ICAgICAgICAgICAgICAgICAgICAgICAg
ICAgICAgICAgICAgICAgICAgIHJhbmdl
LnN0YXJ0T2Zmc2V0KTsKICBpZiAoc3Rh
cnRQb3NpdGlvbiA9PSAtMSkKICAgIHJl
dHVybjsKICB2YXIgZW5kUG9zaXRpb24g
PSB0aGlzLmdldFBvc2l0aW9uV2l0aE92
ZXJmbG93Xyhyb3csCiAgICAgICAgICAg
ICAgICAgICAgICAgICAgICAgICAgICAg
ICAgICAgICAgICAgICAgcmFuZ2UuZW5k
Q29udGFpbmVyLAogICAgICAgICAgICAg
ICAgICAgICAgICAgICAgICAgICAgICAg
ICAgICAgICAgICAgIHJhbmdlLmVuZE9m
ZnNldCk7CiAgaWYgKGVuZFBvc2l0aW9u
ID09IC0xKQogICAgcmV0dXJuOwoKICAv
LyBNYXRjaGVzIGNhbiBzdGFydCB3aXRo
ICd+JyBvciAnLicsIHNpbmNlIHBhdGhz
IGZyZXF1ZW50bHkgZG8uCiAgdmFyIGxl
ZnRNYXRjaCAgID0gJ1teXFxzXFxbXFxd
KCl7fTw+IlwnXFxeIUAjJCUmKiw7OmBd
JzsKICB2YXIgcmlnaHRNYXRjaCAgPSAn
W15cXHNcXFtcXF0oKXt9PD4iXCdcXF4h
QCMkJSYqLDs6fi5gXSc7CiAgdmFyIGlu
c2lkZU1hdGNoID0gJ1teXFxzXFxbXFxd
KCl7fTw+IlwnXFxeXSonOwoKICAvL01v
dmUgc3RhcnQgdG8gdGhlIGxlZnQuCiAg
dmFyIHJvd1RleHQgPSB0aGlzLmdldExp
bmVUZXh0Xyhyb3cpOwogIHZhciBsaW5l
VXBUb1JhbmdlID0gbGliLndjLnN1YnN0
cmluZyhyb3dUZXh0LCAwLCBlbmRQb3Np
dGlvbik7CiAgdmFyIGxlZnRSZWd1bGFy
RXhwcmVzc2lvbiA9IG5ldyBSZWdFeHAo
bGVmdE1hdGNoICsgaW5zaWRlTWF0Y2gg
KyAiJCIpOwogIHZhciBleHBhbmRlZFN0
YXJ0ID0gbGluZVVwVG9SYW5nZS5zZWFy
Y2gobGVmdFJlZ3VsYXJFeHByZXNzaW9u
KTsKICBpZiAoZXhwYW5kZWRTdGFydCA9
PSAtMSB8fCBleHBhbmRlZFN0YXJ0ID4g
c3RhcnRQb3NpdGlvbikKICAgIHJldHVy
bjsKCiAgLy9Nb3ZlIGVuZCB0byB0aGUg
cmlnaHQuCiAgdmFyIGxpbmVGcm9tUmFu
Z2UgPSBsaWIud2Muc3Vic3RyaW5nKHJv
d1RleHQsIHN0YXJ0UG9zaXRpb24sCiAg
ICAgICAgICAgICAgICAgICAgICAgICAg
ICAgICAgICAgICAgIGxpYi53Yy5zdHJX
aWR0aChyb3dUZXh0KSk7CiAgdmFyIHJp
Z2h0UmVndWxhckV4cHJlc3Npb24gPSBu
ZXcgUmVnRXhwKCJeIiArIGluc2lkZU1h
dGNoICsgcmlnaHRNYXRjaCk7CiAgdmFy
IGZvdW5kID0gbGluZUZyb21SYW5nZS5t
YXRjaChyaWdodFJlZ3VsYXJFeHByZXNz
aW9uKTsKICBpZiAoIWZvdW5kKQogICAg
cmV0dXJuOwogIHZhciBleHBhbmRlZEVu
ZCA9IHN0YXJ0UG9zaXRpb24gKyBsaWIu
d2Muc3RyV2lkdGgoZm91bmRbMF0pOwog
IGlmIChleHBhbmRlZEVuZCA9PSAtMSB8
fCBleHBhbmRlZEVuZCA8IGVuZFBvc2l0
aW9uKQogICAgcmV0dXJuOwoKICB0aGlz
LnNldFJhbmdlXyhyb3csIGV4cGFuZGVk
U3RhcnQsIGV4cGFuZGVkRW5kLCByYW5n
ZSk7CiAgc2VsZWN0aW9uLmFkZFJhbmdl
KHJhbmdlKTsKfTsKLy8gU09VUkNFIEZJ
TEU6IGh0ZXJtL2pzL2h0ZXJtX3Njcm9s
bHBvcnQuanMKLy8gQ29weXJpZ2h0IChj
KSAyMDEyIFRoZSBDaHJvbWl1bSBPUyBB
dXRob3JzLiBBbGwgcmlnaHRzIHJlc2Vy
dmVkLgovLyBVc2Ugb2YgdGhpcyBzb3Vy
Y2UgY29kZSBpcyBnb3Zlcm5lZCBieSBh
IEJTRC1zdHlsZSBsaWNlbnNlIHRoYXQg
Y2FuIGJlCi8vIGZvdW5kIGluIHRoZSBM
SUNFTlNFIGZpbGUuCgondXNlIHN0cmlj
dCc7CgpsaWIucnRkZXAoJ2xpYi5mJywg
J2h0ZXJtLlB1YlN1YicsICdodGVybS5T
aXplJyk7CgovKioKICogQSAndmlld3Bv
cnQnIHZpZXcgb2YgZml4ZWQtaGVpZ2h0
IHJvd3Mgd2l0aCBzdXBwb3J0IGZvciBz
ZWxlY3Rpb24gYW5kCiAqIGNvcHktdG8t
Y2xpcGJvYXJkLgogKgogKiAnVmlld3Bv
cnQnIGluIHRoaXMgY2FzZSBtZWFucyB0
aGF0IG9ubHkgdGhlIHZpc2libGUgcm93
cyBhcmUgaW4gdGhlIERPTS4KICogSWYg
dGhlIHJvd1Byb3ZpZGVyIGhhcyAxMDAs
MDAwIHJvd3MsIGJ1dCB0aGUgU2Nyb2xs
UG9ydCBpcyBvbmx5IDI1IHJvd3MKICog
dGFsbCwgdGhlbiBvbmx5IDI1IGRvbSBu
b2RlcyBhcmUgY3JlYXRlZC4gIFRoZSBT
Y3JvbGxQb3J0IHdpbGwgYXNrIHRoZQog
KiBSb3dQcm92aWRlciB0byBjcmVhdGUg
bmV3IHZpc2libGUgcm93cyBvbiBkZW1h
bmQgYXMgdGhleSBhcmUgc2Nyb2xsZWQg
aW4KICogdG8gdGhlIHZpc2libGUgYXJl
YS4KICoKICogVGhpcyB2aWV3cG9ydCBp
cyBkZXNpZ25lZCBzbyB0aGF0IHNlbGVj
dCBhbmQgY29weS10by1jbGlwYm9hcmQg
c3RpbGwgd29ya3MsCiAqIGV2ZW4gd2hl
biBhbGwgb3IgcGFydCBvZiB0aGUgc2Vs
ZWN0aW9uIGlzIHNjcm9sbGVkIG9mZiBz
Y3JlZW4uCiAqCiAqIE5vdGUgdGhhdCB0
aGUgWDExIG1vdXNlIGNsaXBib2FyZCBk
b2VzIG5vdCB3b3JrIHByb3Blcmx5IHdo
ZW4gYWxsIG9yIHBhcnQKICogb2YgdGhl
IHNlbGVjdGlvbiBpcyBvZmYgc2NyZWVu
LiAgSXQgd291bGQgYmUgZGlmZmljdWx0
IHRvIGZpeCB0aGlzIHdpdGhvdXQKICog
YWRkaW5nIHNpZ25pZmljYW50IG92ZXJo
ZWFkIHRvIHBhdGhvbG9naWNhbGx5IGxh
cmdlIHNlbGVjdGlvbiBjYXNlcy4KICoK
ICogVGhlIFJvd1Byb3ZpZGVyIHNob3Vs
ZCByZXR1cm4gcm93cyByb290ZWQgYnkg
dGhlIGN1c3RvbSB0YWcgbmFtZSAneC1y
b3cnLgogKiBUaGlzIGVuc3VyZXMgdGhh
dCB3ZSBjYW4gcXVpY2tseSBhc3NpZ24g
dGhlIGNvcnJlY3QgZGlzcGxheSBoZWln
aHQKICogdG8gdGhlIHJvd3Mgd2l0aCBj
c3MuCiAqCiAqIEBwYXJhbSB7Um93UHJv
dmlkZXJ9IHJvd1Byb3ZpZGVyIEFuIG9i
amVjdCBjYXBhYmxlIG9mIHByb3ZpZGlu
ZyByb3dzIGFzCiAqICAgICByYXcgdGV4
dCBvciByb3cgbm9kZXMuCiAqLwpodGVy
bS5TY3JvbGxQb3J0ID0gZnVuY3Rpb24o
cm93UHJvdmlkZXIpIHsKICBodGVybS5Q
dWJTdWIuYWRkQmVoYXZpb3IodGhpcyk7
CgogIHRoaXMucm93UHJvdmlkZXJfID0g
cm93UHJvdmlkZXI7CgogIC8vIFNXQUcg
dGhlIGNoYXJhY3RlciBzaXplIHVudGls
IHdlIGNhbiBtZWFzdXJlIGl0LgogIHRo
aXMuY2hhcmFjdGVyU2l6ZSA9IG5ldyBo
dGVybS5TaXplKDEwLCAxMCk7CgogIC8v
IERPTSBub2RlIHVzZWQgZm9yIGNoYXJh
Y3RlciBtZWFzdXJlbWVudC4KICB0aGlz
LnJ1bGVyXyA9IG51bGw7CgogIHRoaXMu
c2VsZWN0aW9uID0gbmV3IGh0ZXJtLlNj
cm9sbFBvcnQuU2VsZWN0aW9uKHRoaXMp
OwoKICAvLyBBIG1hcCBvZiByb3dJbmRl
eCA9PiByb3dOb2RlIGZvciBlYWNoIHJv
dyB0aGF0IGlzIGRyYXduIGFzIHBhcnQg
b2YgYQogIC8vIHBlbmRpbmcgcmVkcmF3
XygpIGNhbGwuICBOdWxsIGlmIHRoZXJl
IGlzIG5vIHBlbmRpbmcgcmVkcmF3XyBj
YWxsLgogIHRoaXMuY3VycmVudFJvd05v
ZGVDYWNoZV8gPSBudWxsOwoKICAvLyBB
IG1hcCBvZiByb3dJbmRleCA9PiByb3dO
b2RlIGZvciBlYWNoIHJvdyB0aGF0IHdh
cyBkcmF3biBhcyBwYXJ0IG9mIHRoZQog
IC8vIHByZXZpb3VzIHJlZHJhd18oKSBj
YWxsLgogIHRoaXMucHJldmlvdXNSb3dO
b2RlQ2FjaGVfID0ge307CgogIC8vIFVz
ZWQgZHVyaW5nIHNjcm9sbCBldmVudHMg
dG8gZGV0ZWN0IHdoZW4gdGhlIHVuZGVy
bHlpbmcgY2F1c2UgaXMgYSByZXNpemUu
CiAgdGhpcy5sYXN0U2NyZWVuV2lkdGhf
ID0gbnVsbDsKICB0aGlzLmxhc3RTY3Jl
ZW5IZWlnaHRfID0gbnVsbDsKCiAgLy8g
VHJ1ZSBpZiB0aGUgdXNlciBzaG91bGQg
YmUgYWxsb3dlZCB0byBzZWxlY3QgdGV4
dCBpbiB0aGUgdGVybWluYWwuCiAgLy8g
VGhpcyBpcyBkaXNhYmxlZCB3aGVuIHRo
ZSBob3N0IHJlcXVlc3RzIG1vdXNlIGRy
YWcgZXZlbnRzIHNvIHRoYXQgd2UgZG9u
J3QKICAvLyBlbmQgdXAgd2l0aCB0d28g
bm90aW9ucyBvZiBzZWxlY3Rpb24uCiAg
dGhpcy5zZWxlY3Rpb25FbmFibGVkXyA9
IHRydWU7CgogIC8vIFRoZSBsYXN0IHJv
dyBjb3VudCByZXR1cm5lZCBieSB0aGUg
cm93IHByb3ZpZGVyLCByZS1wb3B1bGF0
ZWQgZHVyaW5nCiAgLy8gc3luY1Njcm9s
bEhlaWdodCgpLgogIHRoaXMubGFzdFJv
d0NvdW50XyA9IDA7CgogIC8vIFRoZSBz
Y3JvbGwgd2hlZWwgcGl4ZWwgZGVsdGEg
bXVsdGlwbGllciB0byBpbmNyZWFzZS9k
ZXNjcmVhc2UKICAvLyB0aGUgc2Nyb2xs
IHNwZWVkIG9mIG1vdXNlIHdoZWVsIGV2
ZW50cy4gU2VlOiBodHRwOi8vZ29vLmds
L3NYZWxucQogIHRoaXMuc2Nyb2xsV2hl
ZWxNdWx0aXBsaWVyXyA9IDE7CgogIC8q
KgogICAqIFRydWUgaWYgdGhlIGxhc3Qg
c2Nyb2xsIGNhdXNlZCB0aGUgc2Nyb2xs
cG9ydCB0byBzaG93IHRoZSBmaW5hbCBy
b3cuCiAgICovCiAgdGhpcy5pc1Njcm9s
bGVkRW5kID0gdHJ1ZTsKCiAgLy8gVGhl
IGNzcyBydWxlIHRoYXQgd2UgdXNlIHRv
IGNvbnRyb2wgdGhlIGhlaWdodCBvZiBh
IHJvdy4KICB0aGlzLnhyb3dDc3NSdWxl
XyA9IG51bGw7CgogIC8qKgogICAqIEEg
Z3Vlc3MgYXQgdGhlIGN1cnJlbnQgc2Ny
b2xsYmFyIHdpZHRoLCBmaXhlZCBpbiBy
ZXNpemUoKS4KICAgKi8KICB0aGlzLmN1
cnJlbnRTY3JvbGxiYXJXaWR0aFB4ID0g
MTY7CgogIC8qKgogICAqIFdoZXRoZXIg
dGhlIGN0cmwtdiBrZXkgb24gdGhlIHNj
cmVlbiBzaG91bGQgcGFzdGUuCiAgICov
CiAgdGhpcy5jdHJsVlBhc3RlID0gZmFs
c2U7CgogIHRoaXMuZGl2XyA9IG51bGw7
CiAgdGhpcy5kb2N1bWVudF8gPSBudWxs
OwoKICAvLyBDb2xsZWN0aW9uIG9mIGFj
dGl2ZSB0aW1lb3V0IGhhbmRsZXMuCiAg
dGhpcy50aW1lb3V0c18gPSB7fTsKCiAg
dGhpcy5vYnNlcnZlcnNfID0ge307Cgog
IHRoaXMuREVCVUdfID0gZmFsc2U7Cn0K
Ci8qKgogKiBQcm94eSBmb3IgdGhlIG5h
dGl2ZSBzZWxlY3Rpb24gb2JqZWN0IHdo
aWNoIHVuZGVyc3RhbmRzIGhvdyB0byB3
YWxrIHVwIHRoZQogKiBET00gdG8gZmlu
ZCB0aGUgY29udGFpbmluZyByb3cgbm9k
ZSBhbmQgc29ydCBvdXQgd2hpY2ggY29t
ZXMgZmlyc3QuCiAqCiAqIEBwYXJhbSB7
aHRlcm0uU2Nyb2xsUG9ydH0gc2Nyb2xs
UG9ydCBUaGUgcGFyZW50IGh0ZXJtLlNj
cm9sbFBvcnQgaW5zdGFuY2UuCiAqLwpo
dGVybS5TY3JvbGxQb3J0LlNlbGVjdGlv
biA9IGZ1bmN0aW9uKHNjcm9sbFBvcnQp
IHsKICB0aGlzLnNjcm9sbFBvcnRfID0g
c2Nyb2xsUG9ydDsKCiAgLyoqCiAgICog
VGhlIHJvdyBjb250YWluaW5nIHRoZSBz
dGFydCBvZiB0aGUgc2VsZWN0aW9uLgog
ICAqCiAgICogVGhpcyBtYXkgYmUgcGFy
dGlhbGx5IG9yIGZ1bGx5IHNlbGVjdGVk
LiAgSXQgbWF5IGJlIHRoZSBzZWxlY3Rp
b24gYW5jaG9yCiAgICogb3IgdGhlIGZv
Y3VzLCBidXQgaXRzIHJvd0luZGV4IGlz
IGd1YXJhbnRlZWQgdG8gYmUgbGVzcy10
aGFuLW9yLWVxdWFsLXRvCiAgICogdGhh
dCBvZiB0aGUgZW5kUm93LgogICAqCiAg
ICogSWYgb25seSBvbmUgcm93IGlzIHNl
bGVjdGVkIHRoZW4gc3RhcnRSb3cgPT0g
ZW5kUm93LiAgSWYgdGhlcmUgaXMgbm8K
ICAgKiBzZWxlY3Rpb24gb3IgdGhlIHNl
bGVjdGlvbiBpcyBjb2xsYXBzZWQgdGhl
biBzdGFydFJvdyA9PSBudWxsLgogICAq
LwogIHRoaXMuc3RhcnRSb3cgPSBudWxs
OwoKICAvKioKICAgKiBUaGUgcm93IGNv
bnRhaW5pbmcgdGhlIGVuZCBvZiB0aGUg
c2VsZWN0aW9uLgogICAqCiAgICogVGhp
cyBtYXkgYmUgcGFydGlhbGx5IG9yIGZ1
bGx5IHNlbGVjdGVkLiAgSXQgbWF5IGJl
IHRoZSBzZWxlY3Rpb24gYW5jaG9yCiAg
ICogb3IgdGhlIGZvY3VzLCBidXQgaXRz
IHJvd0luZGV4IGlzIGd1YXJhbnRlZWQg
dG8gYmUgZ3JlYXRlci10aGFuLW9yLWVx
dWFsLXRvCiAgICogdGhhdCBvZiB0aGUg
c3RhcnRSb3cuCiAgICoKICAgKiBJZiBv
bmx5IG9uZSByb3cgaXMgc2VsZWN0ZWQg
dGhlbiBzdGFydFJvdyA9PSBlbmRSb3cu
ICBJZiB0aGVyZSBpcyBubwogICAqIHNl
bGVjdGlvbiBvciB0aGUgc2VsZWN0aW9u
IGlzIGNvbGxhcHNlZCB0aGVuIHN0YXJ0
Um93ID09IG51bGwuCiAgICovCiAgdGhp
cy5lbmRSb3cgPSBudWxsOwoKICAvKioK
ICAgKiBUcnVlIGlmIHN0YXJ0Um93ICE9
IGVuZFJvdy4KICAgKi8KICB0aGlzLmlz
TXVsdGlsaW5lID0gbnVsbDsKCiAgLyoq
CiAgICogVHJ1ZSBpZiB0aGUgc2VsZWN0
aW9uIGlzIGp1c3QgYSBwb2ludCByYXRo
ZXIgdGhhbiBhIHJhbmdlLgogICAqLwog
IHRoaXMuaXNDb2xsYXBzZWQgPSBudWxs
Owp9OwoKLyoqCiAqIEdpdmVuIGEgbGlz
dCBvZiBET00gbm9kZXMgYW5kIGEgY29u
dGFpbmVyLCByZXR1cm4gdGhlIERPTSBu
b2RlIHRoYXQKICogaXMgZmlyc3QgYWNj
b3JkaW5nIHRvIGEgZGVwdGgtZmlyc3Qg
c2VhcmNoLgogKgogKiBSZXR1cm5zIG51
bGwgaWYgbm9uZSBvZiB0aGUgY2hpbGRy
ZW4gYXJlIGZvdW5kLgogKi8KaHRlcm0u
U2Nyb2xsUG9ydC5TZWxlY3Rpb24ucHJv
dG90eXBlLmZpbmRGaXJzdENoaWxkID0g
ZnVuY3Rpb24oCiAgICBwYXJlbnQsIGNo
aWxkQXJ5KSB7CiAgdmFyIG5vZGUgPSBw
YXJlbnQuZmlyc3RDaGlsZDsKCiAgd2hp
bGUgKG5vZGUpIHsKICAgIGlmIChjaGls
ZEFyeS5pbmRleE9mKG5vZGUpICE9IC0x
KQogICAgICByZXR1cm4gbm9kZTsKCiAg
ICBpZiAobm9kZS5jaGlsZE5vZGVzLmxl
bmd0aCkgewogICAgICB2YXIgcnYgPSB0
aGlzLmZpbmRGaXJzdENoaWxkKG5vZGUs
IGNoaWxkQXJ5KTsKICAgICAgaWYgKHJ2
KQogICAgICAgIHJldHVybiBydjsKICAg
IH0KCiAgICBub2RlID0gbm9kZS5uZXh0
U2libGluZzsKICB9CgogIHJldHVybiBu
dWxsOwp9OwoKLyoqCiAqIFN5bmNocm9u
aXplIHRoaXMgb2JqZWN0IHdpdGggdGhl
IGN1cnJlbnQgRE9NIHNlbGVjdGlvbi4K
ICoKICogVGhpcyBpcyBhIG9uZS13YXkg
c3luY2hyb25pemF0aW9uLCB0aGUgRE9N
IHNlbGVjdGlvbiBpcyBjb3BpZWQgdG8g
dGhpcwogKiBvYmplY3QsIG5vdCB0aGUg
b3RoZXIgd2F5IGFyb3VuZC4KICovCmh0
ZXJtLlNjcm9sbFBvcnQuU2VsZWN0aW9u
LnByb3RvdHlwZS5zeW5jID0gZnVuY3Rp
b24oKSB7CiAgdmFyIHNlbGYgPSB0aGlz
OwoKICAvLyBUaGUgZG9tIHNlbGVjdGlv
biBvYmplY3QgaGFzIG5vIHdheSB0byB0
ZWxsIHdoaWNoIG5vZGVzIGNvbWUgZmly
c3QgaW4KICAvLyB0aGUgZG9jdW1lbnQs
IHNvIHdlIGhhdmUgdG8gZmlndXJlIHRo
YXQgb3V0LgogIC8vCiAgLy8gVGhpcyBm
dW5jdGlvbiBpcyB1c2VkIHdoZW4gd2Ug
ZGV0ZWN0IHRoYXQgdGhlICJhbmNob3Ii
IG5vZGUgaXMgZmlyc3QuCiAgZnVuY3Rp
b24gYW5jaG9yRmlyc3QoKSB7CiAgICBz
ZWxmLnN0YXJ0Um93ID0gYW5jaG9yUm93
OwogICAgc2VsZi5zdGFydE5vZGUgPSBz
ZWxlY3Rpb24uYW5jaG9yTm9kZTsKICAg
IHNlbGYuc3RhcnRPZmZzZXQgPSBzZWxl
Y3Rpb24uYW5jaG9yT2Zmc2V0OwogICAg
c2VsZi5lbmRSb3cgPSBmb2N1c1JvdzsK
ICAgIHNlbGYuZW5kTm9kZSA9IHNlbGVj
dGlvbi5mb2N1c05vZGU7CiAgICBzZWxm
LmVuZE9mZnNldCA9IHNlbGVjdGlvbi5m
b2N1c09mZnNldDsKICB9CgogIC8vIFRo
aXMgZnVuY3Rpb24gaXMgdXNlZCB3aGVu
IHdlIGRldGVjdCB0aGF0IHRoZSAiZm9j
dXMiIG5vZGUgaXMgZmlyc3QuCiAgZnVu
Y3Rpb24gZm9jdXNGaXJzdCgpIHsKICAg
IHNlbGYuc3RhcnRSb3cgPSBmb2N1c1Jv
dzsKICAgIHNlbGYuc3RhcnROb2RlID0g
c2VsZWN0aW9uLmZvY3VzTm9kZTsKICAg
IHNlbGYuc3RhcnRPZmZzZXQgPSBzZWxl
Y3Rpb24uZm9jdXNPZmZzZXQ7CiAgICBz
ZWxmLmVuZFJvdyA9IGFuY2hvclJvdzsK
ICAgIHNlbGYuZW5kTm9kZSA9IHNlbGVj
dGlvbi5hbmNob3JOb2RlOwogICAgc2Vs
Zi5lbmRPZmZzZXQgPSBzZWxlY3Rpb24u
YW5jaG9yT2Zmc2V0OwogIH0KCiAgdmFy
IHNlbGVjdGlvbiA9IHRoaXMuc2Nyb2xs
UG9ydF8uZ2V0RG9jdW1lbnQoKS5nZXRT
ZWxlY3Rpb24oKTsKCiAgdGhpcy5zdGFy
dFJvdyA9IG51bGw7CiAgdGhpcy5lbmRS
b3cgPSBudWxsOwogIHRoaXMuaXNNdWx0
aWxpbmUgPSBudWxsOwogIHRoaXMuaXND
b2xsYXBzZWQgPSAhc2VsZWN0aW9uIHx8
IHNlbGVjdGlvbi5pc0NvbGxhcHNlZDsK
CiAgaWYgKHRoaXMuaXNDb2xsYXBzZWQp
CiAgICByZXR1cm47CgogIHZhciBhbmNo
b3JSb3cgPSBzZWxlY3Rpb24uYW5jaG9y
Tm9kZTsKICB3aGlsZSAoYW5jaG9yUm93
ICYmICEoJ3Jvd0luZGV4JyBpbiBhbmNo
b3JSb3cpKSB7CiAgICBhbmNob3JSb3cg
PSBhbmNob3JSb3cucGFyZW50Tm9kZTsK
ICB9CgogIGlmICghYW5jaG9yUm93KSB7
CiAgICBjb25zb2xlLmVycm9yKCdTZWxl
Y3Rpb24gYW5jaG9yIGlzIG5vdCByb290
ZWQgaW4gYSByb3cgbm9kZTogJyArCiAg
ICAgICAgICAgICAgICAgIHNlbGVjdGlv
bi5hbmNob3JOb2RlLm5vZGVOYW1lKTsK
ICAgIHJldHVybjsKICB9CgogIHZhciBm
b2N1c1JvdyA9IHNlbGVjdGlvbi5mb2N1
c05vZGU7CiAgd2hpbGUgKGZvY3VzUm93
ICYmICEoJ3Jvd0luZGV4JyBpbiBmb2N1
c1JvdykpIHsKICAgIGZvY3VzUm93ID0g
Zm9jdXNSb3cucGFyZW50Tm9kZTsKICB9
CgogIGlmICghZm9jdXNSb3cpIHsKICAg
IGNvbnNvbGUuZXJyb3IoJ1NlbGVjdGlv
biBmb2N1cyBpcyBub3Qgcm9vdGVkIGlu
IGEgcm93IG5vZGU6ICcgKwogICAgICAg
ICAgICAgICAgICBzZWxlY3Rpb24uZm9j
dXNOb2RlLm5vZGVOYW1lKTsKICAgIHJl
dHVybjsKICB9CgogIGlmIChhbmNob3JS
b3cucm93SW5kZXggPCBmb2N1c1Jvdy5y
b3dJbmRleCkgewogICAgYW5jaG9yRmly
c3QoKTsKCiAgfSBlbHNlIGlmIChhbmNo
b3JSb3cucm93SW5kZXggPiBmb2N1c1Jv
dy5yb3dJbmRleCkgewogICAgZm9jdXNG
aXJzdCgpOwoKICB9IGVsc2UgaWYgKHNl
bGVjdGlvbi5mb2N1c05vZGUgPT0gc2Vs
ZWN0aW9uLmFuY2hvck5vZGUpIHsKICAg
IGlmIChzZWxlY3Rpb24uYW5jaG9yT2Zm
c2V0IDwgc2VsZWN0aW9uLmZvY3VzT2Zm
c2V0KSB7CiAgICAgIGFuY2hvckZpcnN0
KCk7CiAgICB9IGVsc2UgewogICAgICBm
b2N1c0ZpcnN0KCk7CiAgICB9CgogIH0g
ZWxzZSB7CiAgICAvLyBUaGUgc2VsZWN0
aW9uIHN0YXJ0cyBhbmQgZW5kcyBpbiB0
aGUgc2FtZSByb3csIGJ1dCBpc24ndCBj
b250YWluZWQgYWxsCiAgICAvLyBpbiBh
IHNpbmdsZSBub2RlLgogICAgdmFyIGZp
cnN0Tm9kZSA9IHRoaXMuZmluZEZpcnN0
Q2hpbGQoCiAgICAgICAgYW5jaG9yUm93
LCBbc2VsZWN0aW9uLmFuY2hvck5vZGUs
IHNlbGVjdGlvbi5mb2N1c05vZGVdKTsK
CiAgICBpZiAoIWZpcnN0Tm9kZSkKICAg
ICAgdGhyb3cgbmV3IEVycm9yKCdVbmV4
cGVjdGVkIGVycm9yIHN5bmNpbmcgc2Vs
ZWN0aW9uLicpOwoKICAgIGlmIChmaXJz
dE5vZGUgPT0gc2VsZWN0aW9uLmFuY2hv
ck5vZGUpIHsKICAgICAgYW5jaG9yRmly
c3QoKTsKICAgIH0gZWxzZSB7CiAgICAg
IGZvY3VzRmlyc3QoKTsKICAgIH0KICB9
CgogIHRoaXMuaXNNdWx0aWxpbmUgPSBh
bmNob3JSb3cucm93SW5kZXggIT0gZm9j
dXNSb3cucm93SW5kZXg7Cn07CgoKLyoq
CiAqIFR1cm4gYSBkaXYgaW50byB0aGlz
IGh0ZXJtLlNjcm9sbFBvcnQuCiAqLwpo
dGVybS5TY3JvbGxQb3J0LnByb3RvdHlw
ZS5kZWNvcmF0ZSA9IGZ1bmN0aW9uKGRp
dikgewogIHRoaXMuZGl2XyA9IGRpdjsK
CiAgdGhpcy5pZnJhbWVfID0gZGl2Lm93
bmVyRG9jdW1lbnQuY3JlYXRlRWxlbWVu
dCgnaWZyYW1lJyk7CiAgdGhpcy5pZnJh
bWVfLnN0eWxlLmNzc1RleHQgPSAoCiAg
ICAgICdib3JkZXI6IDA7JyArCiAgICAg
ICdoZWlnaHQ6IDEwMCU7JyArCiAgICAg
ICdwb3NpdGlvbjogYWJzb2x1dGU7JyAr
CiAgICAgICd3aWR0aDogMTAwJScpOwoK
ICAvLyBTZXQgdGhlIGlmcmFtZSBzcmMg
dG8gIyBpbiBGRi4gIE90aGVyd2lzZSB3
aGVuIHRoZSBmcmFtZSdzCiAgLy8gbG9h
ZCBldmVudCBmaXJlcyBpbiBGRiBpdCBj
bGVhcnMgb3V0IHRoZSBjb250ZW50IG9m
IHRoZSBpZnJhbWUuCiAgaWYgKCdtb3pJ
bm5lclNjcmVlblgnIGluIHdpbmRvdykg
IC8vIGRldGVjdCBhIEZGIG9ubHkgcHJv
cGVydHkKICAgIHRoaXMuaWZyYW1lXy5z
cmMgPSAnIyc7CgogIGRpdi5hcHBlbmRD
aGlsZCh0aGlzLmlmcmFtZV8pOwoKICB0
aGlzLmlmcmFtZV8uY29udGVudFdpbmRv
dy5hZGRFdmVudExpc3RlbmVyKCdyZXNp
emUnLAogICAgICAgICAgICAgICAgICAg
ICAgICAgICAgICAgICAgICAgICAgICAg
ICAgdGhpcy5vblJlc2l6ZV8uYmluZCh0
aGlzKSk7CgogIHZhciBkb2MgPSB0aGlz
LmRvY3VtZW50XyA9IHRoaXMuaWZyYW1l
Xy5jb250ZW50RG9jdW1lbnQ7CiAgZG9j
LmJvZHkuc3R5bGUuY3NzVGV4dCA9ICgK
ICAgICAgJ21hcmdpbjogMHB4OycgKwog
ICAgICAncGFkZGluZzogMHB4OycgKwog
ICAgICAnaGVpZ2h0OiAxMDAlOycgKwog
ICAgICAnd2lkdGg6IDEwMCU7JyArCiAg
ICAgICdvdmVyZmxvdzogaGlkZGVuOycg
KwogICAgICAnLXdlYmtpdC11c2VyLXNl
bGVjdDogbm9uZTsnICsKICAgICAgJy1t
b3otdXNlci1zZWxlY3Q6IG5vbmU7Jyk7
CgogIHZhciBzdHlsZSA9IGRvYy5jcmVh
dGVFbGVtZW50KCdzdHlsZScpOwogIHN0
eWxlLnRleHRDb250ZW50ID0gJ3gtcm93
IHt9JzsKICBkb2MuaGVhZC5hcHBlbmRD
aGlsZChzdHlsZSk7CgogIHRoaXMueHJv
d0Nzc1J1bGVfID0gZG9jLnN0eWxlU2hl
ZXRzWzBdLmNzc1J1bGVzWzBdOwogIHRo
aXMueHJvd0Nzc1J1bGVfLnN0eWxlLmRp
c3BsYXkgPSAnYmxvY2snOwoKICB0aGlz
LnVzZXJDc3NMaW5rXyA9IGRvYy5jcmVh
dGVFbGVtZW50KCdsaW5rJyk7CiAgdGhp
cy51c2VyQ3NzTGlua18uc2V0QXR0cmli
dXRlKCdyZWwnLCAnc3R5bGVzaGVldCcp
OwoKICAvLyBUT0RPKHJnaW5kYSk6IFNv
cnJ5LCB0aGlzICdzY3JlZW5fJyBpc24n
dCB0aGUgc2FtZSB0aGluZyBhcyBodGVy
bS5TY3JlZW4KICAvLyBmcm9tIHNjcmVl
bi5qcy4gIEkgbmVlZCB0byBwaWNrIGEg
YmV0dGVyIG5hbWUgZm9yIG9uZSBvZiB0
aGVtIHRvIGF2b2lkCiAgLy8gdGhlIGNv
bGxpc2lvbi4KICB0aGlzLnNjcmVlbl8g
PSBkb2MuY3JlYXRlRWxlbWVudCgneC1z
Y3JlZW4nKTsKICB0aGlzLnNjcmVlbl8u
c2V0QXR0cmlidXRlKCdyb2xlJywgJ3Rl
eHRib3gnKTsKICB0aGlzLnNjcmVlbl8u
c2V0QXR0cmlidXRlKCd0YWJpbmRleCcs
ICctMScpOwogIHRoaXMuc2NyZWVuXy5z
dHlsZS5jc3NUZXh0ID0gKAogICAgICAn
ZGlzcGxheTogYmxvY2s7JyArCiAgICAg
ICdmb250LWZhbWlseTogbW9ub3NwYWNl
OycgKwogICAgICAnZm9udC1zaXplOiAx
NXB4OycgKwogICAgICAnaGVpZ2h0OiAx
MDAlOycgKwogICAgICAnb3ZlcmZsb3ct
eTogc2Nyb2xsOyBvdmVyZmxvdy14OiBo
aWRkZW47JyArCiAgICAgICd3aGl0ZS1z
cGFjZTogcHJlOycgKwogICAgICAnd2lk
dGg6IDEwMCU7JyArCiAgICAgICdvdXRs
aW5lOiBub25lICFpbXBvcnRhbnQnKTsK
CiAgZG9jLmJvZHkuYXBwZW5kQ2hpbGQo
dGhpcy5zY3JlZW5fKTsKCiAgdGhpcy5z
Y3JlZW5fLmFkZEV2ZW50TGlzdGVuZXIo
J3Njcm9sbCcsIHRoaXMub25TY3JvbGxf
LmJpbmQodGhpcykpOwogIHRoaXMuc2Ny
ZWVuXy5hZGRFdmVudExpc3RlbmVyKCdt
b3VzZXdoZWVsJywgdGhpcy5vblNjcm9s
bFdoZWVsXy5iaW5kKHRoaXMpKTsKICB0
aGlzLnNjcmVlbl8uYWRkRXZlbnRMaXN0
ZW5lcigKICAgICAgJ0RPTU1vdXNlU2Ny
b2xsJywgdGhpcy5vblNjcm9sbFdoZWVs
Xy5iaW5kKHRoaXMpKTsKICB0aGlzLnNj
cmVlbl8uYWRkRXZlbnRMaXN0ZW5lcign
Y29weScsIHRoaXMub25Db3B5Xy5iaW5k
KHRoaXMpKTsKICB0aGlzLnNjcmVlbl8u
YWRkRXZlbnRMaXN0ZW5lcigncGFzdGUn
LCB0aGlzLm9uUGFzdGVfLmJpbmQodGhp
cykpOwoKICBkb2MuYm9keS5hZGRFdmVu
dExpc3RlbmVyKCdrZXlkb3duJywgdGhp
cy5vbkJvZHlLZXlEb3duXy5iaW5kKHRo
aXMpKTsKCiAgLy8gVGhpcyBpcyB0aGUg
bWFpbiBjb250YWluZXIgZm9yIHRoZSBm
aXhlZCByb3dzLgogIHRoaXMucm93Tm9k
ZXNfID0gZG9jLmNyZWF0ZUVsZW1lbnQo
J2RpdicpOwogIHRoaXMucm93Tm9kZXNf
LnN0eWxlLmNzc1RleHQgPSAoCiAgICAg
ICdkaXNwbGF5OiBibG9jazsnICsKICAg
ICAgJ3Bvc2l0aW9uOiBmaXhlZDsnICsK
ICAgICAgJ292ZXJmbG93OiBoaWRkZW47
JyArCiAgICAgICctd2Via2l0LXVzZXIt
c2VsZWN0OiB0ZXh0OycgKwogICAgICAn
LW1vei11c2VyLXNlbGVjdDogdGV4dDsn
KTsKICB0aGlzLnNjcmVlbl8uYXBwZW5k
Q2hpbGQodGhpcy5yb3dOb2Rlc18pOwoK
ICAvLyBUd28gbm9kZXMgdG8gaG9sZCBv
ZmZzY3JlZW4gdGV4dCBkdXJpbmcgdGhl
IGNvcHkgZXZlbnQuCiAgdGhpcy50b3BT
ZWxlY3RCYWdfID0gZG9jLmNyZWF0ZUVs
ZW1lbnQoJ3gtc2VsZWN0LWJhZycpOwog
IHRoaXMudG9wU2VsZWN0QmFnXy5zdHls
ZS5jc3NUZXh0ID0gKAogICAgICAnZGlz
cGxheTogYmxvY2s7JyArCiAgICAgICdv
dmVyZmxvdzogaGlkZGVuOycgKwogICAg
ICAnd2hpdGUtc3BhY2U6IHByZTsnKTsK
CiAgdGhpcy5ib3R0b21TZWxlY3RCYWdf
ID0gdGhpcy50b3BTZWxlY3RCYWdfLmNs
b25lTm9kZSgpOwoKICAvLyBOb2RlcyBh
Ym92ZSB0aGUgdG9wIGZvbGQgYW5kIGJl
bG93IHRoZSBib3R0b20gZm9sZCBhcmUg
aGlkZGVuLiAgVGhleSBhcmUKICAvLyBv
bmx5IHVzZWQgdG8gaG9sZCByb3dzIHRo
YXQgYXJlIHBhcnQgb2YgdGhlIHNlbGVj
dGlvbiBidXQgYXJlIGN1cnJlbnRseQog
IC8vIHNjcm9sbGVkIG9mZiB0aGUgdG9w
IG9yIGJvdHRvbSBvZiB0aGUgdmlzaWJs
ZSByYW5nZS4KICB0aGlzLnRvcEZvbGRf
ID0gZG9jLmNyZWF0ZUVsZW1lbnQoJ3gt
Zm9sZCcpOwogIHRoaXMudG9wRm9sZF8u
c3R5bGUuY3NzVGV4dCA9ICdkaXNwbGF5
OiBibG9jazsnOwogIHRoaXMucm93Tm9k
ZXNfLmFwcGVuZENoaWxkKHRoaXMudG9w
Rm9sZF8pOwoKICB0aGlzLmJvdHRvbUZv
bGRfID0gdGhpcy50b3BGb2xkXy5jbG9u
ZU5vZGUoKTsKICB0aGlzLnJvd05vZGVz
Xy5hcHBlbmRDaGlsZCh0aGlzLmJvdHRv
bUZvbGRfKTsKCiAgLy8gVGhpcyBoaWRk
ZW4gZGl2IGFjY291bnRzIGZvciB0aGUg
dmVydGljYWwgc3BhY2UgdGhhdCB3b3Vs
ZCBiZSBjb25zdW1lZCBieQogIC8vIGFs
bCB0aGUgcm93cyBpbiB0aGUgYnVmZmVy
IGlmIHRoZXkgd2VyZSB2aXNpYmxlLiAg
SXQncyB3aGF0IGNhdXNlcyB0aGUKICAv
LyBzY3JvbGxiYXIgdG8gYXBwZWFyIG9u
IHRoZSAneC1zY3JlZW4nLCBhbmQgaXQg
bW92ZXMgd2l0aGluIHRoZSBzY3JlZW4g
d2hlbgogIC8vIHRoZSBzY3JvbGxiYXIg
aXMgbW92ZWQuCiAgLy8KICAvLyBJdCBp
cyBzZXQgJ3Zpc2liaWxpdHk6IGhpZGRl
bicgdG8ga2VlcCB0aGUgYnJvd3NlciBm
cm9tIHRyeWluZyB0byBpbmNsdWRlCiAg
Ly8gaXQgaW4gdGhlIHNlbGVjdGlvbiB3
aGVuIGEgdXNlciAnZHJhZyBzZWxlY3Rz
JyB1cHdhcmRzIChkcmFnIHRoZSBtb3Vz
ZSB0bwogIC8vIHNlbGVjdCBhbmQgc2Ny
b2xsIGF0IHRoZSBzYW1lIHRpbWUpLiAg
V2l0aG91dCB0aGlzLCB0aGUgc2VsZWN0
aW9uIGdldHMKICAvLyBvdXQgb2Ygd2hh
Y2suCiAgdGhpcy5zY3JvbGxBcmVhXyA9
IGRvYy5jcmVhdGVFbGVtZW50KCdkaXYn
KTsKICB0aGlzLnNjcm9sbEFyZWFfLnN0
eWxlLmNzc1RleHQgPSAndmlzaWJpbGl0
eTogaGlkZGVuJzsKICB0aGlzLnNjcmVl
bl8uYXBwZW5kQ2hpbGQodGhpcy5zY3Jv
bGxBcmVhXyk7CgogIC8vIFRoaXMgc3Zn
IGVsZW1lbnQgaXMgdXNlZCB0byBkZXRl
Y3Qgd2hlbiB0aGUgYnJvd3NlciBpcyB6
b29tZWQuICBJdCBtdXN0IGJlCiAgLy8g
cGxhY2VkIGluIHRoZSBvdXRlcm1vc3Qg
ZG9jdW1lbnQgZm9yIGN1cnJlbnRTY2Fs
ZSB0byBiZSBjb3JyZWN0LgogIC8vIFRP
RE8ocmdpbmRhKTogVGhpcyBtZWFucyB0
aGF0IGh0ZXJtIG5lc3RlZCBpbiBhbiBp
ZnJhbWUgd2lsbCBub3QgY29ycmVjdGx5
CiAgLy8gZGV0ZWN0IGJyb3dzZXIgem9v
bSBsZXZlbC4gIFdlIHNob3VsZCBjb21l
IHVwIHdpdGggYSBiZXR0ZXIgc29sdXRp
b24uCiAgdGhpcy5zdmdfID0gdGhpcy5k
aXZfLm93bmVyRG9jdW1lbnQuY3JlYXRl
RWxlbWVudE5TKAogICAgICAnaHR0cDov
L3d3dy53My5vcmcvMjAwMC9zdmcnLCAn
c3ZnJyk7CiAgdGhpcy5zdmdfLnNldEF0
dHJpYnV0ZSgneG1sbnMnLCAnaHR0cDov
L3d3dy53My5vcmcvMjAwMC9zdmcnKTsK
ICB0aGlzLnN2Z18uc2V0QXR0cmlidXRl
KCd2ZXJzaW9uJywgJzEuMScpOwogIHRo
aXMuc3ZnXy5zdHlsZS5jc3NUZXh0ID0g
KAogICAgICAncG9zaXRpb246IGFic29s
dXRlOycgKwogICAgICAndG9wOiAwOycg
KwogICAgICAnbGVmdDogMDsnICsKICAg
ICAgJ3Zpc2liaWxpdHk6IGhpZGRlbicp
OwoKCiAgLy8gV2Ugc2VuZCBmb2N1cyB0
byB0aGlzIGVsZW1lbnQganVzdCBiZWZv
cmUgYSBwYXN0ZSBoYXBwZW5zLCBzbyB3
ZSBjYW4KICAvLyBjYXB0dXJlIHRoZSBw
YXN0ZWQgdGV4dCBhbmQgZm9yd2FyZCBp
dCBvbiB0byBzb21lb25lIHdobyBjYXJl
cy4KICB0aGlzLnBhc3RlVGFyZ2V0XyA9
IGRvYy5jcmVhdGVFbGVtZW50KCd0ZXh0
YXJlYScpOwogIHRoaXMucGFzdGVUYXJn
ZXRfLnNldEF0dHJpYnV0ZSgndGFiaW5k
ZXgnLCAnLTEnKTsKICB0aGlzLnBhc3Rl
VGFyZ2V0Xy5zdHlsZS5jc3NUZXh0ID0g
KAogICAgJ3Bvc2l0aW9uOiBhYnNvbHV0
ZTsnICsKICAgICdoZWlnaHQ6IDFweDsn
ICsKICAgICd3aWR0aDogMXB4OycgKwog
ICAgJ2xlZnQ6IDBweDsgJyArCiAgICAn
Ym90dG9tOiAwcHg7JyArCiAgICAnb3Bh
Y2l0eTogMCcpOwogIHRoaXMucGFzdGVU
YXJnZXRfLmNvbnRlbnRFZGl0YWJsZSA9
IHRydWU7CgogIHRoaXMuc2NyZWVuXy5h
cHBlbmRDaGlsZCh0aGlzLnBhc3RlVGFy
Z2V0Xyk7CiAgdGhpcy5wYXN0ZVRhcmdl
dF8uYWRkRXZlbnRMaXN0ZW5lcigKICAg
ICAgJ3RleHRJbnB1dCcsIHRoaXMuaGFu
ZGxlUGFzdGVUYXJnZXRUZXh0SW5wdXRf
LmJpbmQodGhpcykpOwoKICB0aGlzLnJl
c2l6ZSgpOwp9OwoKLyoqCiAqIFNlbGVj
dCB0aGUgZm9udC1mYW1pbHkgYW5kIGZv
bnQtc21vb3RoaW5nIGZvciB0aGlzIHNj
cm9sbHBvcnQuCiAqCiAqIEBwYXJhbSB7
c3RyaW5nfSBmb250RmFtaWx5IFZhbHVl
IG9mIHRoZSBDU1MgJ2ZvbnQtZmFtaWx5
JyB0byB1c2UgZm9yIHRoaXMKICogICAg
IHNjcm9sbHBvcnQuICBTaG91bGQgYmUg
YSBtb25vc3BhY2UgZm9udC4KICogQHBh
cmFtIHtzdHJpbmd9IG9wdF9zbW9vdGhp
bmcgT3B0aW9uYWwgdmFsdWUgZm9yICct
d2Via2l0LWZvbnQtc21vb3RoaW5nJy4K
ICogICAgIERlZmF1bHRzIHRvIGFuIGVt
cHR5IHN0cmluZyBpZiBub3Qgc3BlY2lm
aWVkLgogKi8KaHRlcm0uU2Nyb2xsUG9y
dC5wcm90b3R5cGUuc2V0Rm9udEZhbWls
eSA9IGZ1bmN0aW9uKGZvbnRGYW1pbHks
IG9wdF9zbW9vdGhpbmcpIHsKICB0aGlz
LnNjcmVlbl8uc3R5bGUuZm9udEZhbWls
eSA9IGZvbnRGYW1pbHk7CiAgaWYgKG9w
dF9zbW9vdGhpbmcpIHsKICAgIHRoaXMu
c2NyZWVuXy5zdHlsZS53ZWJraXRGb250
U21vb3RoaW5nID0gb3B0X3Ntb290aGlu
ZzsKICB9IGVsc2UgewogICAgdGhpcy5z
Y3JlZW5fLnN0eWxlLndlYmtpdEZvbnRT
bW9vdGhpbmcgPSAnJzsKICB9CgogIHRo
aXMuc3luY0NoYXJhY3RlclNpemUoKTsK
fTsKCmh0ZXJtLlNjcm9sbFBvcnQucHJv
dG90eXBlLmdldEZvbnRGYW1pbHkgPSBm
dW5jdGlvbigpIHsKICByZXR1cm4gdGhp
cy5zY3JlZW5fLnN0eWxlLmZvbnRGYW1p
bHk7Cn07CgovKioKICogU2V0IGEgY3Vz
dG9tIHN0eWxlc2hlZXQgdG8gaW5jbHVk
ZSBpbiB0aGUgc2Nyb2xscG9ydC4KICoK
ICogRGVmYXVsdHMgdG8gbnVsbCwgbWVh
bmluZyBubyBjdXN0b20gY3NzIGlzIGxv
YWRlZC4gIFNldCBpdCBiYWNrIHRvIG51
bGwgb3IKICogdGhlIGVtcHR5IHN0cmlu
ZyB0byByZW1vdmUgYSBwcmV2aW91c2x5
IGFwcGxpZWQgY3VzdG9tIGNzcy4KICov
Cmh0ZXJtLlNjcm9sbFBvcnQucHJvdG90
eXBlLnNldFVzZXJDc3MgPSBmdW5jdGlv
bih1cmwpIHsKICBpZiAodXJsKSB7CiAg
ICB0aGlzLnVzZXJDc3NMaW5rXy5zZXRB
dHRyaWJ1dGUoJ2hyZWYnLCB1cmwpOwoK
ICAgIGlmICghdGhpcy51c2VyQ3NzTGlu
a18ucGFyZW50Tm9kZSkKICAgICAgdGhp
cy5kb2N1bWVudF8uaGVhZC5hcHBlbmRD
aGlsZCh0aGlzLnVzZXJDc3NMaW5rXyk7
CiAgfSBlbHNlIGlmICh0aGlzLnVzZXJD
c3NMaW5rXy5wYXJlbnROb2RlKSB7CiAg
ICB0aGlzLmRvY3VtZW50Xy5oZWFkLnJl
bW92ZUNoaWxkKHRoaXMudXNlckNzc0xp
bmtfKTsKICB9Cn07CgpodGVybS5TY3Jv
bGxQb3J0LnByb3RvdHlwZS5mb2N1cyA9
IGZ1bmN0aW9uKCkgewogIHRoaXMuaWZy
YW1lXy5mb2N1cygpOwogIHRoaXMuc2Ny
ZWVuXy5mb2N1cygpOwp9OwoKaHRlcm0u
U2Nyb2xsUG9ydC5wcm90b3R5cGUuZ2V0
Rm9yZWdyb3VuZENvbG9yID0gZnVuY3Rp
b24oKSB7CiAgcmV0dXJuIHRoaXMuc2Ny
ZWVuXy5zdHlsZS5jb2xvcjsKfTsKCmh0
ZXJtLlNjcm9sbFBvcnQucHJvdG90eXBl
LnNldEZvcmVncm91bmRDb2xvciA9IGZ1
bmN0aW9uKGNvbG9yKSB7CiAgdGhpcy5z
Y3JlZW5fLnN0eWxlLmNvbG9yID0gY29s
b3I7Cn07CgpodGVybS5TY3JvbGxQb3J0
LnByb3RvdHlwZS5nZXRCYWNrZ3JvdW5k
Q29sb3IgPSBmdW5jdGlvbigpIHsKICBy
ZXR1cm4gdGhpcy5zY3JlZW5fLnN0eWxl
LmJhY2tncm91bmRDb2xvcjsKfTsKCmh0
ZXJtLlNjcm9sbFBvcnQucHJvdG90eXBl
LnNldEJhY2tncm91bmRDb2xvciA9IGZ1
bmN0aW9uKGNvbG9yKSB7CiAgdGhpcy5z
Y3JlZW5fLnN0eWxlLmJhY2tncm91bmRD
b2xvciA9IGNvbG9yOwp9OwoKaHRlcm0u
U2Nyb2xsUG9ydC5wcm90b3R5cGUuc2V0
QmFja2dyb3VuZEltYWdlID0gZnVuY3Rp
b24oaW1hZ2UpIHsKICB0aGlzLnNjcmVl
bl8uc3R5bGUuYmFja2dyb3VuZEltYWdl
ID0gaW1hZ2U7Cn07CgpodGVybS5TY3Jv
bGxQb3J0LnByb3RvdHlwZS5zZXRCYWNr
Z3JvdW5kU2l6ZSA9IGZ1bmN0aW9uKHNp
emUpIHsKICB0aGlzLnNjcmVlbl8uc3R5
bGUuYmFja2dyb3VuZFNpemUgPSBzaXpl
Owp9OwoKaHRlcm0uU2Nyb2xsUG9ydC5w
cm90b3R5cGUuc2V0QmFja2dyb3VuZFBv
c2l0aW9uID0gZnVuY3Rpb24ocG9zaXRp
b24pIHsKICB0aGlzLnNjcmVlbl8uc3R5
bGUuYmFja2dyb3VuZFBvc2l0aW9uID0g
cG9zaXRpb247Cn07CgpodGVybS5TY3Jv
bGxQb3J0LnByb3RvdHlwZS5zZXRDdHJs
VlBhc3RlID0gZnVuY3Rpb24oY3RybFZQ
YXN0ZSkgewogIHRoaXMuY3RybFZQYXN0
ZSA9IGN0cmxWUGFzdGU7Cn07CgovKioK
ICogR2V0IHRoZSB1c2FibGUgc2l6ZSBv
ZiB0aGUgc2Nyb2xscG9ydCBzY3JlZW4u
CiAqCiAqIFRoZSB3aWR0aCB3aWxsIG5v
dCBpbmNsdWRlIHRoZSBzY3JvbGxiYXIg
d2lkdGguCiAqLwpodGVybS5TY3JvbGxQ
b3J0LnByb3RvdHlwZS5nZXRTY3JlZW5T
aXplID0gZnVuY3Rpb24oKSB7CiAgdmFy
IHNpemUgPSBodGVybS5nZXRDbGllbnRT
aXplKHRoaXMuc2NyZWVuXyk7CiAgcmV0
dXJuIHsKICAgIGhlaWdodDogc2l6ZS5o
ZWlnaHQsCiAgICB3aWR0aDogc2l6ZS53
aWR0aCAtIHRoaXMuY3VycmVudFNjcm9s
bGJhcldpZHRoUHgKICB9Owp9OwoKLyoq
CiAqIEdldCB0aGUgdXNhYmxlIHdpZHRo
IG9mIHRoZSBzY3JvbGxwb3J0IHNjcmVl
bi4KICoKICogVGhpcyB0aGUgd2lkZ2V0
IHdpZHRoIG1pbnVzIHNjcm9sbGJhciB3
aWR0aC4KICovCmh0ZXJtLlNjcm9sbFBv
cnQucHJvdG90eXBlLmdldFNjcmVlbldp
ZHRoID0gZnVuY3Rpb24oKSB7CiAgcmV0
dXJuIHRoaXMuZ2V0U2NyZWVuU2l6ZSgp
LndpZHRoIDsKfTsKCi8qKgogKiBHZXQg
dGhlIHVzYWJsZSBoZWlnaHQgb2YgdGhl
IHNjcm9sbHBvcnQgc2NyZWVuLgogKi8K
aHRlcm0uU2Nyb2xsUG9ydC5wcm90b3R5
cGUuZ2V0U2NyZWVuSGVpZ2h0ID0gZnVu
Y3Rpb24oKSB7CiAgcmV0dXJuIHRoaXMu
Z2V0U2NyZWVuU2l6ZSgpLmhlaWdodDsK
fTsKCi8qKgogKiBSZXR1cm4gdGhlIGRv
Y3VtZW50IHRoYXQgaG9sZHMgdGhlIHZp
c2libGUgcm93cyBvZiB0aGlzIGh0ZXJt
LlNjcm9sbFBvcnQuCiAqLwpodGVybS5T
Y3JvbGxQb3J0LnByb3RvdHlwZS5nZXRE
b2N1bWVudCA9IGZ1bmN0aW9uKCkgewog
IHJldHVybiB0aGlzLmRvY3VtZW50XzsK
fTsKCi8qKgogKiBSZXR1cm5zIHRoZSB4
LXNjcmVlbiBlbGVtZW50IHRoYXQgaG9s
ZHMgdGhlIHJvd3Mgb2YgdGhpcyBodGVy
bS5TY3JvbGxQb3J0LgogKi8KaHRlcm0u
U2Nyb2xsUG9ydC5wcm90b3R5cGUuZ2V0
U2NyZWVuTm9kZSA9IGZ1bmN0aW9uKCkg
ewogIHJldHVybiB0aGlzLnNjcmVlbl87
Cn07CgovKioKICogQ2xlYXIgb3V0IGFu
eSBjYWNoZWQgcm93Tm9kZXMuCiAqLwpo
dGVybS5TY3JvbGxQb3J0LnByb3RvdHlw
ZS5yZXNldENhY2hlID0gZnVuY3Rpb24o
KSB7CiAgdGhpcy5jdXJyZW50Um93Tm9k
ZUNhY2hlXyA9IG51bGw7CiAgdGhpcy5w
cmV2aW91c1Jvd05vZGVDYWNoZV8gPSB7
fTsKfTsKCi8qKgogKiBDaGFuZ2UgdGhl
IGN1cnJlbnQgcm93UHJvdmlkZXIuCiAq
CiAqIFRoaXMgd2lsbCBjbGVhciB0aGUg
cm93IGNhY2hlIGFuZCBjYXVzZSBhIHJl
ZHJhdy4KICoKICogQHBhcmFtIHtPYmpl
Y3R9IHJvd1Byb3ZpZGVyIEFuIG9iamVj
dCBjYXBhYmxlIG9mIHByb3ZpZGluZyB0
aGUgcm93cwogKiAgICAgaW4gdGhpcyBo
dGVybS5TY3JvbGxQb3J0LgogKi8KaHRl
cm0uU2Nyb2xsUG9ydC5wcm90b3R5cGUu
c2V0Um93UHJvdmlkZXIgPSBmdW5jdGlv
bihyb3dQcm92aWRlcikgewogIHRoaXMu
cmVzZXRDYWNoZSgpOwogIHRoaXMucm93
UHJvdmlkZXJfID0gcm93UHJvdmlkZXI7
CiAgdGhpcy5zY2hlZHVsZVJlZHJhdygp
Owp9OwoKLyoqCiAqIEluZm9ybSB0aGUg
U2Nyb2xsUG9ydCB0aGF0IHRoZSByb290
IERPTSBub2RlcyBmb3Igc29tZSBvciBh
bGwgb2YgdGhlIHZpc2libGUKICogcm93
cyBhcmUgbm8gbG9uZ2VyIHZhbGlkLgog
KgogKiBTcGVjaWZpY2FsbHksIHRoaXMg
c2hvdWxkIGJlIGNhbGxlZCBpZiB0aGlz
LnJvd1Byb3ZpZGVyXy5nZXRSb3dOb2Rl
KCkgbm93CiAqIHJldHVybnMgYW4gZW50
aXJlbHkgZGlmZmVyZW50IG5vZGUgdGhh
biBpdCBkaWQgYmVmb3JlLiAgSXQgZG9l
cyBub3QKICogbmVlZCB0byBiZSBjYWxs
ZWQgaWYgdGhlIGNvbnRlbnQgb2YgYSBy
b3cgbm9kZSBpcyB0aGUgb25seSB0aGlu
ZyB0aGF0CiAqIGNoYW5nZWQuCiAqCiAq
IFRoaXMgc2tpcHMgc29tZSBvZiB0aGUg
b3ZlcmhlYWQgb2YgYSBmdWxsIHJlZHJh
dywgYnV0IHNob3VsZCBub3QgYmUgdXNl
ZAogKiBpbiBjYXNlcyB3aGVyZSB0aGUg
c2Nyb2xscG9ydCBoYXMgYmVlbiBzY3Jv
bGxlZCwgb3Igd2hlbiB0aGUgcm93IGNv
dW50IGhhcwogKiBjaGFuZ2VkLgogKi8K
aHRlcm0uU2Nyb2xsUG9ydC5wcm90b3R5
cGUuaW52YWxpZGF0ZSA9IGZ1bmN0aW9u
KCkgewogIHZhciBub2RlID0gdGhpcy50
b3BGb2xkXy5uZXh0U2libGluZzsKICB3
aGlsZSAobm9kZSAhPSB0aGlzLmJvdHRv
bUZvbGRfKSB7CiAgICB2YXIgbmV4dFNp
YmxpbmcgPSBub2RlLm5leHRTaWJsaW5n
OwogICAgbm9kZS5wYXJlbnRFbGVtZW50
LnJlbW92ZUNoaWxkKG5vZGUpOwogICAg
bm9kZSA9IG5leHRTaWJsaW5nOwogIH0K
CiAgdGhpcy5wcmV2aW91c1Jvd05vZGVD
YWNoZV8gPSBudWxsOwogIHZhciB0b3BS
b3dJbmRleCA9IHRoaXMuZ2V0VG9wUm93
SW5kZXgoKTsKICB2YXIgYm90dG9tUm93
SW5kZXggPSB0aGlzLmdldEJvdHRvbVJv
d0luZGV4KHRvcFJvd0luZGV4KTsKCiAg
dGhpcy5kcmF3VmlzaWJsZVJvd3NfKHRv
cFJvd0luZGV4LCBib3R0b21Sb3dJbmRl
eCk7Cn07CgpodGVybS5TY3JvbGxQb3J0
LnByb3RvdHlwZS5zY2hlZHVsZUludmFs
aWRhdGUgPSBmdW5jdGlvbigpIHsKICBp
ZiAodGhpcy50aW1lb3V0c18uaW52YWxp
ZGF0ZSkKICAgIHJldHVybjsKCiAgdmFy
IHNlbGYgPSB0aGlzOwogIHRoaXMudGlt
ZW91dHNfLmludmFsaWRhdGUgPSBzZXRU
aW1lb3V0KGZ1bmN0aW9uICgpIHsKICAg
ICAgZGVsZXRlIHNlbGYudGltZW91dHNf
LmludmFsaWRhdGU7CiAgICAgIHNlbGYu
aW52YWxpZGF0ZSgpOwogICAgfSwgMCk7
Cn07CgovKioKICogU2V0IHRoZSBmb250
IHNpemUgb2YgdGhlIFNjcm9sbFBvcnQu
CiAqLwpodGVybS5TY3JvbGxQb3J0LnBy
b3RvdHlwZS5zZXRGb250U2l6ZSA9IGZ1
bmN0aW9uKHB4KSB7CiAgdGhpcy5zY3Jl
ZW5fLnN0eWxlLmZvbnRTaXplID0gcHgg
KyAncHgnOwogIHRoaXMuc3luY0NoYXJh
Y3RlclNpemUoKTsKfTsKCi8qKgogKiBS
ZXR1cm4gdGhlIGN1cnJlbnQgZm9udCBz
aXplIG9mIHRoZSBTY3JvbGxQb3J0Lgog
Ki8KaHRlcm0uU2Nyb2xsUG9ydC5wcm90
b3R5cGUuZ2V0Rm9udFNpemUgPSBmdW5j
dGlvbigpIHsKICByZXR1cm4gcGFyc2VJ
bnQodGhpcy5zY3JlZW5fLnN0eWxlLmZv
bnRTaXplKTsKfTsKCi8qKgogKiBNZWFz
dXJlIHRoZSBzaXplIG9mIGEgc2luZ2xl
IGNoYXJhY3RlciBpbiBwaXhlbHMuCiAq
CiAqIEBwYXJhbSB7c3RyaW5nfSBvcHRf
d2VpZ2h0IFRoZSBmb250IHdlaWdodCB0
byBtZWFzdXJlLCBvciAnbm9ybWFsJyBp
ZgogKiAgICAgb21pdHRlZC4KICogQHJl
dHVybiB7aHRlcm0uU2l6ZX0gQSBuZXcg
aHRlcm0uU2l6ZSBvYmplY3QuCiAqLwpo
dGVybS5TY3JvbGxQb3J0LnByb3RvdHlw
ZS5tZWFzdXJlQ2hhcmFjdGVyU2l6ZSA9
IGZ1bmN0aW9uKG9wdF93ZWlnaHQpIHsK
ICBpZiAoIXRoaXMucnVsZXJfKSB7CiAg
ICB0aGlzLnJ1bGVyXyA9IHRoaXMuZG9j
dW1lbnRfLmNyZWF0ZUVsZW1lbnQoJ2Rp
dicpOwogICAgdGhpcy5ydWxlcl8uc3R5
bGUuY3NzVGV4dCA9ICgKICAgICAgICAn
cG9zaXRpb246IGFic29sdXRlOycgKwog
ICAgICAgICd0b3A6IDA7JyArCiAgICAg
ICAgJ2xlZnQ6IDA7JyArCiAgICAgICAg
J3Zpc2liaWxpdHk6IGhpZGRlbjsnICsK
ICAgICAgICAnaGVpZ2h0OiBhdXRvICFp
bXBvcnRhbnQ7JyArCiAgICAgICAgJ3dp
ZHRoOiBhdXRvICFpbXBvcnRhbnQ7Jyk7
CgogICAgLy8gV2UgbmVlZCB0byBwdXQg
dGhlIHRleHQgaW4gYSBzcGFuIHRvIG1h
a2UgdGhlIHNpemUgY2FsY3VsYXRpb24K
ICAgIC8vIHdvcmsgcHJvcGVybHkgaW4g
RmlyZWZveAogICAgdGhpcy5ydWxlclNw
YW5fID0gdGhpcy5kb2N1bWVudF8uY3Jl
YXRlRWxlbWVudCgnc3BhbicpOwogICAg
dGhpcy5ydWxlclNwYW5fLnRleHRDb250
ZW50ID0gKCdYWFhYWFhYWFhYWFhYWFhY
WFhYWCcgKwogICAgICAgICAgICAgICAg
ICAgICAgICAgICAgICAgICAgICdYWFhY
WFhYWFhYWFhYWFhYWFhYWCcgKwogICAg
ICAgICAgICAgICAgICAgICAgICAgICAg
ICAgICAgICdYWFhYWFhYWFhYWFhYWFhY
WFhYWCcgKwogICAgICAgICAgICAgICAg
ICAgICAgICAgICAgICAgICAgICdYWFhY
WFhYWFhYWFhYWFhYWFhYWCcgKwogICAg
ICAgICAgICAgICAgICAgICAgICAgICAg
ICAgICAgICdYWFhYWFhYWFhYWFhYWFhY
WFhYWCcpOwogICAgdGhpcy5ydWxlcl8u
YXBwZW5kQ2hpbGQodGhpcy5ydWxlclNw
YW5fKTsKCiAgICB0aGlzLnJ1bGVyQmFz
ZWxpbmVfID0gdGhpcy5kb2N1bWVudF8u
Y3JlYXRlRWxlbWVudCgnc3BhbicpOwog
ICAgLy8gV2Ugd2FudCB0byBjb2xsYXBz
ZSBpdCBvbiB0aGUgYmFzZWxpbmUKICAg
IHRoaXMucnVsZXJCYXNlbGluZV8uc3R5
bGUuZm9udFNpemUgPSAnMHB4JzsKICAg
IHRoaXMucnVsZXJCYXNlbGluZV8udGV4
dENvbnRlbnQgPSAnWCc7CiAgfQoKICB0
aGlzLnJ1bGVyU3Bhbl8uc3R5bGUuZm9u
dFdlaWdodCA9IG9wdF93ZWlnaHQgfHwg
Jyc7CgogIHRoaXMucm93Tm9kZXNfLmFw
cGVuZENoaWxkKHRoaXMucnVsZXJfKTsK
ICB2YXIgcnVsZXJTaXplID0gaHRlcm0u
Z2V0Q2xpZW50U2l6ZSh0aGlzLnJ1bGVy
U3Bhbl8pOwoKICB2YXIgc2l6ZSA9IG5l
dyBodGVybS5TaXplKHJ1bGVyU2l6ZS53
aWR0aCAvIHRoaXMucnVsZXJfLnRleHRD
b250ZW50Lmxlbmd0aCwKICAgICAgICAg
ICAgICAgICAgICAgICAgICAgIHJ1bGVy
U2l6ZS5oZWlnaHQpOwoKICB0aGlzLnJ1
bGVyXy5hcHBlbmRDaGlsZCh0aGlzLnJ1
bGVyQmFzZWxpbmVfKTsKICBzaXplLmJh
c2VsaW5lID0gdGhpcy5ydWxlckJhc2Vs
aW5lXy5vZmZzZXRUb3A7CiAgdGhpcy5y
dWxlcl8ucmVtb3ZlQ2hpbGQodGhpcy5y
dWxlckJhc2VsaW5lXyk7CgogIHRoaXMu
cm93Tm9kZXNfLnJlbW92ZUNoaWxkKHRo
aXMucnVsZXJfKTsKCiAgdGhpcy5kaXZf
Lm93bmVyRG9jdW1lbnQuYm9keS5hcHBl
bmRDaGlsZCh0aGlzLnN2Z18pOwogIHNp
emUuem9vbUZhY3RvciA9IHRoaXMuc3Zn
Xy5jdXJyZW50U2NhbGU7CiAgdGhpcy5k
aXZfLm93bmVyRG9jdW1lbnQuYm9keS5y
ZW1vdmVDaGlsZCh0aGlzLnN2Z18pOwoK
ICByZXR1cm4gc2l6ZTsKfTsKCi8qKgog
KiBTeW5jaHJvbml6ZSB0aGUgY2hhcmFj
dGVyIHNpemUuCiAqCiAqIFRoaXMgd2ls
bCByZS1tZWFzdXJlIHRoZSBjdXJyZW50
IGNoYXJhY3RlciBzaXplIGFuZCBhZGp1
c3QgdGhlIGhlaWdodAogKiBvZiBhbiB4
LXJvdyB0byBtYXRjaC4KICovCmh0ZXJt
LlNjcm9sbFBvcnQucHJvdG90eXBlLnN5
bmNDaGFyYWN0ZXJTaXplID0gZnVuY3Rp
b24oKSB7CiAgdGhpcy5jaGFyYWN0ZXJT
aXplID0gdGhpcy5tZWFzdXJlQ2hhcmFj
dGVyU2l6ZSgpOwoKICB2YXIgbGluZUhl
aWdodCA9IHRoaXMuY2hhcmFjdGVyU2l6
ZS5oZWlnaHQgKyAncHgnOwogIHRoaXMu
eHJvd0Nzc1J1bGVfLnN0eWxlLmhlaWdo
dCA9IGxpbmVIZWlnaHQ7CiAgdGhpcy50
b3BTZWxlY3RCYWdfLnN0eWxlLmhlaWdo
dCA9IGxpbmVIZWlnaHQ7CiAgdGhpcy5i
b3R0b21TZWxlY3RCYWdfLnN0eWxlLmhl
aWdodCA9IGxpbmVIZWlnaHQ7CgogIHRo
aXMucmVzaXplKCk7CgogIGlmICh0aGlz
LkRFQlVHXykgewogICAgLy8gV2hlbiB3
ZSdyZSBkZWJ1Z2dpbmcgd2UgYWRkIHBh
ZGRpbmcgdG8gdGhlIGJvZHkgc28gdGhh
dCB0aGUgb2Zmc2NyZWVuCiAgICAvLyBl
bGVtZW50cyBhcmUgdmlzaWJsZS4KICAg
IHRoaXMuZG9jdW1lbnRfLmJvZHkuc3R5
bGUucGFkZGluZ1RvcCA9CiAgICAgICAg
dGhpcy5kb2N1bWVudF8uYm9keS5zdHls
ZS5wYWRkaW5nQm90dG9tID0KICAgICAg
ICAzICogdGhpcy5jaGFyYWN0ZXJTaXpl
LmhlaWdodCArICdweCc7CiAgfQp9OwoK
aHRlcm0uU2Nyb2xsUG9ydC5wcm90b3R5
cGUuc2V0Q2hhcmFjdGVyU2l6ZSA9IGZ1
bmN0aW9uKHIsIGMpIHsKICB0aGlzLmNo
YXJhY3RlclNpemUgPSB0aGlzLm1lYXN1
cmVDaGFyYWN0ZXJTaXplKCk7CiAgLy9k
ZWJ1Z2dlcjsKICAvL3RoaXMuY2hhcmFj
dGVyU2l6ZS53aWR0aCA9IGM7CiAgLy90
aGlzLmNoYXJhY3RlclNpemUuaGVpZ2h0
ID0gcjsKCiAgdmFyIGxpbmVIZWlnaHQg
PSB0aGlzLmNoYXJhY3RlclNpemUuaGVp
Z2h0ICsgJ3B4JzsKICB0aGlzLnhyb3dD
c3NSdWxlXy5zdHlsZS5oZWlnaHQgPSBs
aW5lSGVpZ2h0OwogIHRoaXMudG9wU2Vs
ZWN0QmFnXy5zdHlsZS5oZWlnaHQgPSBs
aW5lSGVpZ2h0OwogIHRoaXMuYm90dG9t
U2VsZWN0QmFnXy5zdHlsZS5oZWlnaHQg
PSBsaW5lSGVpZ2h0OwoKICB0aGlzLnJl
c2l6ZSgpOwoKICBpZiAodGhpcy5ERUJV
R18pIHsKICAgIC8vIFdoZW4gd2UncmUg
ZGVidWdnaW5nIHdlIGFkZCBwYWRkaW5n
IHRvIHRoZSBib2R5IHNvIHRoYXQgdGhl
IG9mZnNjcmVlbgogICAgLy8gZWxlbWVu
dHMgYXJlIHZpc2libGUuCiAgICB0aGlz
LmRvY3VtZW50Xy5ib2R5LnN0eWxlLnBh
ZGRpbmdUb3AgPQogICAgICAgIHRoaXMu
ZG9jdW1lbnRfLmJvZHkuc3R5bGUucGFk
ZGluZ0JvdHRvbSA9CiAgICAgICAgMyAq
IHRoaXMuY2hhcmFjdGVyU2l6ZS5oZWln
aHQgKyAncHgnOwogIH0KfTsKCi8qKgog
KiBSZXNldCBkaW1lbnNpb25zIGFuZCB2
aXNpYmxlIHJvdyBjb3VudCB0byBhY2Nv
dW50IGZvciBhIGNoYW5nZSBpbiB0aGUK
ICogZGltZW5zaW9ucyBvZiB0aGUgJ3gt
c2NyZWVuJy4KICovCmh0ZXJtLlNjcm9s
bFBvcnQucHJvdG90eXBlLnJlc2l6ZSA9
IGZ1bmN0aW9uKCkgewogIHRoaXMuY3Vy
cmVudFNjcm9sbGJhcldpZHRoUHggPSBo
dGVybS5nZXRDbGllbnRXaWR0aCh0aGlz
LnNjcmVlbl8pIC0KICAgIHRoaXMuc2Ny
ZWVuXy5jbGllbnRXaWR0aDsKCiAgdGhp
cy5zeW5jU2Nyb2xsSGVpZ2h0KCk7CiAg
dGhpcy5zeW5jUm93Tm9kZXNEaW1lbnNp
b25zXygpOwoKICB2YXIgc2VsZiA9IHRo
aXM7CiAgdGhpcy5wdWJsaXNoKAogICAg
ICAncmVzaXplJywgeyBzY3JvbGxQb3J0
OiB0aGlzIH0sCiAgICAgIGZ1bmN0aW9u
KCkgewogICAgICAgIHNlbGYuc2Nyb2xs
Um93VG9Cb3R0b20oc2VsZi5yb3dQcm92
aWRlcl8uZ2V0Um93Q291bnQoKSk7CiAg
ICAgICAgc2VsZi5zY2hlZHVsZVJlZHJh
dygpOwogICAgICB9KTsKfTsKCi8qKgog
KiBTZXQgdGhlIHBvc2l0aW9uIGFuZCBz
aXplIG9mIHRoZSByb3cgbm9kZXMgZWxl
bWVudC4KICovCmh0ZXJtLlNjcm9sbFBv
cnQucHJvdG90eXBlLnN5bmNSb3dOb2Rl
c0RpbWVuc2lvbnNfID0gZnVuY3Rpb24o
KSB7CiAgdmFyIHNjcmVlblNpemUgPSB0
aGlzLmdldFNjcmVlblNpemUoKTsKCiAg
dGhpcy5sYXN0U2NyZWVuV2lkdGhfID0g
c2NyZWVuU2l6ZS53aWR0aDsKICB0aGlz
Lmxhc3RTY3JlZW5IZWlnaHRfID0gc2Ny
ZWVuU2l6ZS5oZWlnaHQ7CgogIC8vIFdl
IGRvbid0IHdhbnQgdG8gc2hvdyBhIHBh
cnRpYWwgcm93IGJlY2F1c2UgaXQgd291
bGQgYmUgZGlzdHJhY3RpbmcKICAvLyBp
biBhIHRlcm1pbmFsLCBzbyB3ZSBmbG9v
ciBhbnkgZnJhY3Rpb25hbCByb3cgY291
bnQuCiAgdGhpcy52aXNpYmxlUm93Q291
bnQgPSBsaWIuZi5zbWFydEZsb29yRGl2
aWRlKAogICAgICBzY3JlZW5TaXplLmhl
aWdodCwgdGhpcy5jaGFyYWN0ZXJTaXpl
LmhlaWdodCk7CgogIC8vIFRoZW4gY29t
cHV0ZSB0aGUgaGVpZ2h0IG9mIG91ciBp
bnRlZ3JhbCBudW1iZXIgb2Ygcm93cy4K
ICB2YXIgdmlzaWJsZVJvd3NIZWlnaHQg
PSB0aGlzLnZpc2libGVSb3dDb3VudCAq
IHRoaXMuY2hhcmFjdGVyU2l6ZS5oZWln
aHQ7CgogIC8vIFRoZW4gdGhlIGRpZmZl
cmVuY2UgYmV0d2VlbiB0aGUgc2NyZWVu
IGhlaWdodCBhbmQgdG90YWwgcm93IGhl
aWdodCBuZWVkcyB0bwogIC8vIGJlIG1h
ZGUgdXAgZm9yIGFzIHRvcCBtYXJnaW4u
ICBXZSBuZWVkIHRvIHJlY29yZCB0aGlz
IHZhbHVlIHNvIGl0CiAgLy8gY2FuIGJl
IHVzZWQgbGF0ZXIgdG8gZGV0ZXJtaW5l
IHRoZSB0b3BSb3dJbmRleC4KICB0aGlz
LnZpc2libGVSb3dUb3BNYXJnaW4gPSAw
OwogIHRoaXMudmlzaWJsZVJvd0JvdHRv
bU1hcmdpbiA9IHNjcmVlblNpemUuaGVp
Z2h0IC0gdmlzaWJsZVJvd3NIZWlnaHQ7
CgogIHRoaXMudG9wRm9sZF8uc3R5bGUu
bWFyZ2luQm90dG9tID0gdGhpcy52aXNp
YmxlUm93VG9wTWFyZ2luICsgJ3B4JzsK
CgogIHZhciB0b3BGb2xkT2Zmc2V0ID0g
MDsKICB2YXIgbm9kZSA9IHRoaXMudG9w
Rm9sZF8ucHJldmlvdXNTaWJsaW5nOwog
IHdoaWxlIChub2RlKSB7CiAgICB0b3BG
b2xkT2Zmc2V0ICs9IGh0ZXJtLmdldENs
aWVudEhlaWdodChub2RlKTsKICAgIG5v
ZGUgPSBub2RlLnByZXZpb3VzU2libGlu
ZzsKICB9CgogIC8vIFNldCB0aGUgZGlt
ZW5zaW9ucyBvZiB0aGUgdmlzaWJsZSBy
b3dzIGNvbnRhaW5lci4KICB0aGlzLnJv
d05vZGVzXy5zdHlsZS53aWR0aCA9IHNj
cmVlblNpemUud2lkdGggKyAncHgnOwog
IHRoaXMucm93Tm9kZXNfLnN0eWxlLmhl
aWdodCA9IHZpc2libGVSb3dzSGVpZ2h0
ICsgdG9wRm9sZE9mZnNldCArICdweCc7
CiAgdGhpcy5yb3dOb2Rlc18uc3R5bGUu
bGVmdCA9IHRoaXMuc2NyZWVuXy5vZmZz
ZXRMZWZ0ICsgJ3B4JzsKICB0aGlzLnJv
d05vZGVzXy5zdHlsZS50b3AgPSB0aGlz
LnNjcmVlbl8ub2Zmc2V0VG9wIC0gdG9w
Rm9sZE9mZnNldCArICdweCc7Cn07Cgpo
dGVybS5TY3JvbGxQb3J0LnByb3RvdHlw
ZS5zeW5jU2Nyb2xsSGVpZ2h0ID0gZnVu
Y3Rpb24oKSB7CiAgLy8gUmVzaXplIHRo
ZSBzY3JvbGwgYXJlYSB0byBhcHBlYXIg
YXMgdGhvdWdoIGl0IGNvbnRhaW5zIGV2
ZXJ5IHJvdy4KICB0aGlzLmxhc3RSb3dD
b3VudF8gPSB0aGlzLnJvd1Byb3ZpZGVy
Xy5nZXRSb3dDb3VudCgpOwogIHRoaXMu
c2Nyb2xsQXJlYV8uc3R5bGUuaGVpZ2h0
ID0gKHRoaXMuY2hhcmFjdGVyU2l6ZS5o
ZWlnaHQgKgogICAgICAgICAgICAgICAg
ICAgICAgICAgICAgICAgICAgIHRoaXMu
bGFzdFJvd0NvdW50XyArCiAgICAgICAg
ICAgICAgICAgICAgICAgICAgICAgICAg
ICAgdGhpcy52aXNpYmxlUm93VG9wTWFy
Z2luICsKICAgICAgICAgICAgICAgICAg
ICAgICAgICAgICAgICAgICB0aGlzLnZp
c2libGVSb3dCb3R0b21NYXJnaW4gKwog
ICAgICAgICAgICAgICAgICAgICAgICAg
ICAgICAgICAgICdweCcpOwp9OwoKLyoq
CiAqIFNjaGVkdWxlIGEgcmVkcmF3IHRv
IGhhcHBlbiBhc3luY2hyb25vdXNseS4K
ICoKICogSWYgdGhpcyBtZXRob2QgaXMg
Y2FsbGVkIG11bHRpcGxlIHRpbWVzIGJl
Zm9yZSB0aGUgcmVkcmF3IGhhcyBhIGNo
YW5jZSB0bwogKiBydW4gb25seSBvbmUg
cmVkcmF3IG9jY3Vycy4KICovCmh0ZXJt
LlNjcm9sbFBvcnQucHJvdG90eXBlLnNj
aGVkdWxlUmVkcmF3ID0gZnVuY3Rpb24o
KSB7CiAgaWYgKHRoaXMudGltZW91dHNf
LnJlZHJhdykKICAgIHJldHVybjsKCiAg
dmFyIHNlbGYgPSB0aGlzOwogIHRoaXMu
dGltZW91dHNfLnJlZHJhdyA9IHNldFRp
bWVvdXQoZnVuY3Rpb24gKCkgewogICAg
ICBkZWxldGUgc2VsZi50aW1lb3V0c18u
cmVkcmF3OwogICAgICBzZWxmLnJlZHJh
d18oKTsKICAgIH0sIDApOwp9OwoKLyoq
CiAqIFJlZHJhdyB0aGUgY3VycmVudCBo
dGVybS5TY3JvbGxQb3J0IGJhc2VkIG9u
IHRoZSBjdXJyZW50IHNjcm9sbGJhciBw
b3NpdGlvbi4KICoKICogV2hlbiByZWRy
YXdpbmcsIHdlIGFyZSBjYXJlZnVsIHRv
IG1ha2Ugc3VyZSB0aGF0IHRoZSByb3dz
IHRoYXQgc3RhcnQgb3IgZW5kCiAqIHRo
ZSBjdXJyZW50IHNlbGVjdGlvbiBhcmUg
bm90IHRvdWNoZWQgaW4gYW55IHdheS4g
IERvaW5nIHNvIHdvdWxkIGRpc3R1cmIK
ICogdGhlIHNlbGVjdGlvbiwgYW5kIGNs
ZWFuaW5nIHVwIGFmdGVyIHRoYXQgd291
bGQgY2F1c2UgZmxhc2hlcyBhdCBiZXN0
IGFuZAogKiBpbmNvcnJlY3Qgc2VsZWN0
aW9uIGF0IHdvcnN0LiAgSW5zdGVhZCwg
d2UgbW9kaWZ5IHRoZSBET00gYXJvdW5k
IHRoZXNlIG5vZGVzLgogKiBXZSBldmVu
IHN0YXNoIHRoZSBzZWxlY3Rpb24gc3Rh
cnQvZW5kIG91dHNpZGUgb2YgdGhlIHZp
c2libGUgYXJlYSBpZgogKiB0aGV5IGFy
ZSBub3Qgc3VwcG9zZWQgdG8gYmUgdmlz
aWJsZSBpbiB0aGUgaHRlcm0uU2Nyb2xs
UG9ydC4KICovCmh0ZXJtLlNjcm9sbFBv
cnQucHJvdG90eXBlLnJlZHJhd18gPSBm
dW5jdGlvbigpIHsKICB0aGlzLnJlc2V0
U2VsZWN0QmFnc18oKTsKICB0aGlzLnNl
bGVjdGlvbi5zeW5jKCk7CgogIHRoaXMu
c3luY1Njcm9sbEhlaWdodCgpOwoKICB0
aGlzLmN1cnJlbnRSb3dOb2RlQ2FjaGVf
ID0ge307CgogIHZhciB0b3BSb3dJbmRl
eCA9IHRoaXMuZ2V0VG9wUm93SW5kZXgo
KTsKICB2YXIgYm90dG9tUm93SW5kZXgg
PSB0aGlzLmdldEJvdHRvbVJvd0luZGV4
KHRvcFJvd0luZGV4KTsKCiAgdGhpcy5k
cmF3VG9wRm9sZF8odG9wUm93SW5kZXgp
OwogIHRoaXMuZHJhd0JvdHRvbUZvbGRf
KGJvdHRvbVJvd0luZGV4KTsKICB0aGlz
LmRyYXdWaXNpYmxlUm93c18odG9wUm93
SW5kZXgsIGJvdHRvbVJvd0luZGV4KTsK
CiAgdGhpcy5zeW5jUm93Tm9kZXNEaW1l
bnNpb25zXygpOwoKICB0aGlzLnByZXZp
b3VzUm93Tm9kZUNhY2hlXyA9IHRoaXMu
Y3VycmVudFJvd05vZGVDYWNoZV87CiAg
dGhpcy5jdXJyZW50Um93Tm9kZUNhY2hl
XyA9IG51bGw7CgogIHRoaXMuaXNTY3Jv
bGxlZEVuZCA9ICgKICAgIHRoaXMuZ2V0
VG9wUm93SW5kZXgoKSArIHRoaXMudmlz
aWJsZVJvd0NvdW50ID49IHRoaXMubGFz
dFJvd0NvdW50Xyk7Cn07CgovKioKICog
RW5zdXJlIHRoYXQgdGhlIG5vZGVzIGFi
b3ZlIHRoZSB0b3AgZm9sZCBhcmUgYXMg
dGhleSBzaG91bGQgYmUuCiAqCiAqIElm
IHRoZSBzZWxlY3Rpb24gc3RhcnQgYW5k
L29yIGVuZCBub2RlcyBhcmUgYWJvdmUg
dGhlIHZpc2libGUgcmFuZ2UKICogb2Yg
dGhpcyBodGVybS5TY3JvbGxQb3J0IHRo
ZW4gdGhlIGRvbSB3aWxsIGJlIGFkanVz
dGVkIHNvIHRoYXQgdGhleSBhcHBlYXIK
ICogYmVmb3JlIHRoZSB0b3AgZm9sZCAo
dGhlIGZpcnN0IHgtZm9sZCBlbGVtZW50
LCBha2EgdGhpcy50b3BGb2xkKS4KICoK
ICogSWYgbm90LCB0aGUgdG9wIGZvbGQg
d2lsbCBiZSB0aGUgZmlyc3QgZWxlbWVu
dC4KICoKICogSXQgaXMgY3JpdGljYWwg
dGhhdCB0aGlzIG1ldGhvZCBkb2VzIG5v
dCBtb3ZlIHRoZSBzZWxlY3Rpb24gbm9k
ZXMuICBEb2luZwogKiBzbyB3b3VsZCBj
bGVhciB0aGUgY3VycmVudCBzZWxlY3Rp
b24uICBJbnN0ZWFkLCB0aGUgcmVzdCBv
ZiB0aGUgRE9NIGlzCiAqIGFkanVzdGVk
IGFyb3VuZCB0aGVtLgogKi8KaHRlcm0u
U2Nyb2xsUG9ydC5wcm90b3R5cGUuZHJh
d1RvcEZvbGRfID0gZnVuY3Rpb24odG9w
Um93SW5kZXgpIHsKICBpZiAoIXRoaXMu
c2VsZWN0aW9uLnN0YXJ0Um93IHx8CiAg
ICAgIHRoaXMuc2VsZWN0aW9uLnN0YXJ0
Um93LnJvd0luZGV4ID49IHRvcFJvd0lu
ZGV4KSB7CiAgICAvLyBTZWxlY3Rpb24g
aXMgZW50aXJlbHkgYmVsb3cgdGhlIHRv
cCBmb2xkLCBqdXN0IG1ha2Ugc3VyZSB0
aGUgZm9sZCBpcwogICAgLy8gdGhlIGZp
cnN0IGNoaWxkLgogICAgaWYgKHRoaXMu
cm93Tm9kZXNfLmZpcnN0Q2hpbGQgIT0g
dGhpcy50b3BGb2xkXykKICAgICAgdGhp
cy5yb3dOb2Rlc18uaW5zZXJ0QmVmb3Jl
KHRoaXMudG9wRm9sZF8sIHRoaXMucm93
Tm9kZXNfLmZpcnN0Q2hpbGQpOwoKICAg
IHJldHVybjsKICB9CgogIGlmICghdGhp
cy5zZWxlY3Rpb24uaXNNdWx0aWxpbmUg
fHwKICAgICAgdGhpcy5zZWxlY3Rpb24u
ZW5kUm93LnJvd0luZGV4ID49IHRvcFJv
d0luZGV4KSB7CiAgICAvLyBPbmx5IHRo
ZSBzdGFydFJvdyBpcyBhYm92ZSB0aGUg
Zm9sZC4KICAgIGlmICh0aGlzLnNlbGVj
dGlvbi5zdGFydFJvdy5uZXh0U2libGlu
ZyAhPSB0aGlzLnRvcEZvbGRfKQogICAg
ICB0aGlzLnJvd05vZGVzXy5pbnNlcnRC
ZWZvcmUodGhpcy50b3BGb2xkXywKICAg
ICAgICAgICAgICAgICAgICAgICAgICAg
ICAgICAgIHRoaXMuc2VsZWN0aW9uLnN0
YXJ0Um93Lm5leHRTaWJsaW5nKTsKICB9
IGVsc2UgewogICAgLy8gQm90aCByb3dz
IGFyZSBhYm92ZSB0aGUgZm9sZC4KICAg
IGlmICh0aGlzLnNlbGVjdGlvbi5lbmRS
b3cubmV4dFNpYmxpbmcgIT0gdGhpcy50
b3BGb2xkXykgewogICAgICB0aGlzLnJv
d05vZGVzXy5pbnNlcnRCZWZvcmUodGhp
cy50b3BGb2xkXywKICAgICAgICAgICAg
ICAgICAgICAgICAgICAgICAgICAgIHRo
aXMuc2VsZWN0aW9uLmVuZFJvdy5uZXh0
U2libGluZyk7CiAgICB9CgogICAgLy8g
VHJpbSBhbnkgaW50ZXJtZWRpYXRlIGxp
bmVzLgogICAgd2hpbGUgKHRoaXMuc2Vs
ZWN0aW9uLnN0YXJ0Um93Lm5leHRTaWJs
aW5nICE9CiAgICAgICAgICAgdGhpcy5z
ZWxlY3Rpb24uZW5kUm93KSB7CiAgICAg
IHRoaXMucm93Tm9kZXNfLnJlbW92ZUNo
aWxkKHRoaXMuc2VsZWN0aW9uLnN0YXJ0
Um93Lm5leHRTaWJsaW5nKTsKICAgIH0K
ICB9CgogIHdoaWxlKHRoaXMucm93Tm9k
ZXNfLmZpcnN0Q2hpbGQgIT0gdGhpcy5z
ZWxlY3Rpb24uc3RhcnRSb3cpIHsKICAg
IHRoaXMucm93Tm9kZXNfLnJlbW92ZUNo
aWxkKHRoaXMucm93Tm9kZXNfLmZpcnN0
Q2hpbGQpOwogIH0KfTsKCi8qKgogKiBF
bnN1cmUgdGhhdCB0aGUgbm9kZXMgYmVs
b3cgdGhlIGJvdHRvbSBmb2xkIGFyZSBh
cyB0aGV5IHNob3VsZCBiZS4KICoKICog
SWYgdGhlIHNlbGVjdGlvbiBzdGFydCBh
bmQvb3IgZW5kIG5vZGVzIGFyZSBiZWxv
dyB0aGUgdmlzaWJsZSByYW5nZQogKiBv
ZiB0aGlzIGh0ZXJtLlNjcm9sbFBvcnQg
dGhlbiB0aGUgZG9tIHdpbGwgYmUgYWRq
dXN0ZWQgc28gdGhhdCB0aGV5IGFwcGVh
cgogKiBhZnRlciB0aGUgYm90dG9tIGZv
bGQgKHRoZSBzZWNvbmQgeC1mb2xkIGVs
ZW1lbnQsIGFrYSB0aGlzLmJvdHRvbUZv
bGQpLgogKgogKiBJZiBub3QsIHRoZSBi
b3R0b20gZm9sZCB3aWxsIGJlIHRoZSBs
YXN0IGVsZW1lbnQuCiAqCiAqIEl0IGlz
IGNyaXRpY2FsIHRoYXQgdGhpcyBtZXRo
b2QgZG9lcyBub3QgbW92ZSB0aGUgc2Vs
ZWN0aW9uIG5vZGVzLiAgRG9pbmcKICog
c28gd291bGQgY2xlYXIgdGhlIGN1cnJl
bnQgc2VsZWN0aW9uLiAgSW5zdGVhZCwg
dGhlIHJlc3Qgb2YgdGhlIERPTSBpcwog
KiBhZGp1c3RlZCBhcm91bmQgdGhlbS4K
ICovCmh0ZXJtLlNjcm9sbFBvcnQucHJv
dG90eXBlLmRyYXdCb3R0b21Gb2xkXyA9
IGZ1bmN0aW9uKGJvdHRvbVJvd0luZGV4
KSB7CiAgaWYgKCF0aGlzLnNlbGVjdGlv
bi5lbmRSb3cgfHwKICAgICAgdGhpcy5z
ZWxlY3Rpb24uZW5kUm93LnJvd0luZGV4
IDw9IGJvdHRvbVJvd0luZGV4KSB7CiAg
ICAvLyBTZWxlY3Rpb24gaXMgZW50aXJl
bHkgYWJvdmUgdGhlIGJvdHRvbSBmb2xk
LCBqdXN0IG1ha2Ugc3VyZSB0aGUgZm9s
ZCBpcwogICAgLy8gdGhlIGxhc3QgY2hp
bGQuCiAgICBpZiAodGhpcy5yb3dOb2Rl
c18ubGFzdENoaWxkICE9IHRoaXMuYm90
dG9tRm9sZF8pCiAgICAgIHRoaXMucm93
Tm9kZXNfLmFwcGVuZENoaWxkKHRoaXMu
Ym90dG9tRm9sZF8pOwoKICAgIHJldHVy
bjsKICB9CgogIGlmICghdGhpcy5zZWxl
Y3Rpb24uaXNNdWx0aWxpbmUgfHwKICAg
ICAgdGhpcy5zZWxlY3Rpb24uc3RhcnRS
b3cucm93SW5kZXggPD0gYm90dG9tUm93
SW5kZXgpIHsKICAgIC8vIE9ubHkgdGhl
IGVuZFJvdyBpcyBiZWxvdyB0aGUgZm9s
ZC4KICAgIGlmICh0aGlzLmJvdHRvbUZv
bGRfLm5leHRTaWJsaW5nICE9IHRoaXMu
c2VsZWN0aW9uLmVuZFJvdykKICAgICAg
dGhpcy5yb3dOb2Rlc18uaW5zZXJ0QmVm
b3JlKHRoaXMuYm90dG9tRm9sZF8sCiAg
ICAgICAgICAgICAgICAgICAgICAgICAg
ICAgICAgICB0aGlzLnNlbGVjdGlvbi5l
bmRSb3cpOwogIH0gZWxzZSB7CiAgICAv
LyBCb3RoIHJvd3MgYXJlIGJlbG93IHRo
ZSBmb2xkLgogICAgaWYgKHRoaXMuYm90
dG9tRm9sZF8ubmV4dFNpYmxpbmcgIT0g
dGhpcy5zZWxlY3Rpb24uc3RhcnRSb3cp
IHsKICAgICAgdGhpcy5yb3dOb2Rlc18u
aW5zZXJ0QmVmb3JlKHRoaXMuYm90dG9t
Rm9sZF8sCiAgICAgICAgICAgICAgICAg
ICAgICAgICAgICAgICAgICB0aGlzLnNl
bGVjdGlvbi5zdGFydFJvdyk7CiAgICB9
CgogICAgLy8gVHJpbSBhbnkgaW50ZXJt
ZWRpYXRlIGxpbmVzLgogICAgd2hpbGUg
KHRoaXMuc2VsZWN0aW9uLnN0YXJ0Um93
Lm5leHRTaWJsaW5nICE9CiAgICAgICAg
ICAgdGhpcy5zZWxlY3Rpb24uZW5kUm93
KSB7CiAgICAgIHRoaXMucm93Tm9kZXNf
LnJlbW92ZUNoaWxkKHRoaXMuc2VsZWN0
aW9uLnN0YXJ0Um93Lm5leHRTaWJsaW5n
KTsKICAgIH0KICB9CgogIHdoaWxlKHRo
aXMucm93Tm9kZXNfLmxhc3RDaGlsZCAh
PSB0aGlzLnNlbGVjdGlvbi5lbmRSb3cp
IHsKICAgIHRoaXMucm93Tm9kZXNfLnJl
bW92ZUNoaWxkKHRoaXMucm93Tm9kZXNf
Lmxhc3RDaGlsZCk7CiAgfQp9OwoKLyoq
CiAqIEVuc3VyZSB0aGF0IHRoZSByb3dz
IGJldHdlZW4gdGhlIHRvcCBhbmQgYm90
dG9tIGZvbGRzIGFyZSBhcyB0aGV5IHNo
b3VsZCBiZS4KICoKICogVGhpcyBtZXRo
b2QgYXNzdW1lcyB0aGF0IGRyYXdUb3BG
b2xkXygpIGFuZCBkcmF3Qm90dG9tRm9s
ZF8oKSBoYXZlIGFscmVhZHkKICogcnVu
LCBhbmQgdGhhdCB0aGV5IGhhdmUgbGVm
dCBhbnkgdmlzaWJsZSBzZWxlY3Rpb24g
cm93IChzZWxlY3Rpb24gc3RhcnQKICog
b3Igc2VsZWN0aW9uIGVuZCkgYmV0d2Vl
biB0aGUgZm9sZHMuCiAqCiAqIEl0IHJl
Y3ljbGVzIERPTSBub2RlcyBmcm9tIHRo
ZSBwcmV2aW91cyByZWRyYXcgd2hlcmUg
cG9zc2libGUsIGJ1dCB3aWxsIGFzawog
KiB0aGUgcm93U291cmNlIHRvIG1ha2Ug
bmV3IG5vZGVzIGlmIG5lY2Vzc2FyeS4K
ICoKICogSXQgaXMgY3JpdGljYWwgdGhh
dCB0aGlzIG1ldGhvZCBkb2VzIG5vdCBt
b3ZlIHRoZSBzZWxlY3Rpb24gbm9kZXMu
ICBEb2luZwogKiBzbyB3b3VsZCBjbGVh
ciB0aGUgY3VycmVudCBzZWxlY3Rpb24u
ICBJbnN0ZWFkLCB0aGUgcmVzdCBvZiB0
aGUgRE9NIGlzCiAqIGFkanVzdGVkIGFy
b3VuZCB0aGVtLgogKi8KaHRlcm0uU2Ny
b2xsUG9ydC5wcm90b3R5cGUuZHJhd1Zp
c2libGVSb3dzXyA9IGZ1bmN0aW9uKAog
ICAgdG9wUm93SW5kZXgsIGJvdHRvbVJv
d0luZGV4KSB7CiAgdmFyIHNlbGYgPSB0
aGlzOwoKICAvLyBLZWVwIHJlbW92aW5n
IG5vZGVzLCBzdGFydGluZyB3aXRoIGN1
cnJlbnROb2RlLCB1bnRpbCB3ZSBlbmNv
dW50ZXIKICAvLyB0YXJnZXROb2RlLiAg
VGhyb3dzIG9uIGZhaWx1cmUuCiAgZnVu
Y3Rpb24gcmVtb3ZlVW50aWxOb2RlKGN1
cnJlbnROb2RlLCB0YXJnZXROb2RlKSB7
CiAgICB3aGlsZSAoY3VycmVudE5vZGUg
IT0gdGFyZ2V0Tm9kZSkgewogICAgICBp
ZiAoIWN1cnJlbnROb2RlKQogICAgICAg
IHRocm93ICdEaWQgbm90IGVuY291bnRl
ciB0YXJnZXQgbm9kZSc7CgogICAgICBp
ZiAoY3VycmVudE5vZGUgPT0gc2VsZi5i
b3R0b21Gb2xkXykKICAgICAgICB0aHJv
dyAnRW5jb3VudGVyZWQgYm90dG9tIGZv
bGQgYmVmb3JlIHRhcmdldCBub2RlJzsK
CiAgICAgIHZhciBkZWFkTm9kZSA9IGN1
cnJlbnROb2RlOwogICAgICBjdXJyZW50
Tm9kZSA9IGN1cnJlbnROb2RlLm5leHRT
aWJsaW5nOwogICAgICBkZWFkTm9kZS5w
YXJlbnROb2RlLnJlbW92ZUNoaWxkKGRl
YWROb2RlKTsKICAgIH0KICB9CgogIC8v
IFNob3J0aGFuZCBmb3IgdGhpbmdzIHdl
J3JlIGdvaW5nIHRvIHVzZSBhIGxvdC4K
ICB2YXIgc2VsZWN0aW9uU3RhcnRSb3cg
PSB0aGlzLnNlbGVjdGlvbi5zdGFydFJv
dzsKICB2YXIgc2VsZWN0aW9uRW5kUm93
ID0gdGhpcy5zZWxlY3Rpb24uZW5kUm93
OwogIHZhciBib3R0b21Gb2xkID0gdGhp
cy5ib3R0b21Gb2xkXzsKCiAgLy8gVGhl
IG5vZGUgd2UncmUgZXhhbWluaW5nIGR1
cmluZyB0aGUgY3VycmVudCBpdGVyYXRp
b24uCiAgdmFyIG5vZGUgPSB0aGlzLnRv
cEZvbGRfLm5leHRTaWJsaW5nOwoKICB2
YXIgdGFyZ2V0RHJhd0NvdW50ID0gTWF0
aC5taW4odGhpcy52aXNpYmxlUm93Q291
bnQsCiAgICAgICAgICAgICAgICAgICAg
ICAgICAgICAgICAgIHRoaXMucm93UHJv
dmlkZXJfLmdldFJvd0NvdW50KCkpOwoK
ICBmb3IgKHZhciBkcmF3Q291bnQgPSAw
OyBkcmF3Q291bnQgPCB0YXJnZXREcmF3
Q291bnQ7IGRyYXdDb3VudCsrKSB7CiAg
ICB2YXIgcm93SW5kZXggPSB0b3BSb3dJ
bmRleCArIGRyYXdDb3VudDsKCiAgICBp
ZiAobm9kZSA9PSBib3R0b21Gb2xkKSB7
CiAgICAgIC8vIFdlJ3ZlIGhpdCB0aGUg
Ym90dG9tIGZvbGQsIHdlIG5lZWQgdG8g
aW5zZXJ0IGEgbmV3IHJvdy4KICAgICAg
dmFyIG5ld05vZGUgPSB0aGlzLmZldGNo
Um93Tm9kZV8ocm93SW5kZXgpOwogICAg
ICBpZiAoIW5ld05vZGUpIHsKICAgICAg
ICBjb25zb2xlLmxvZygiQ291bGRuJ3Qg
ZmV0Y2ggcm93IGluZGV4OiAiICsgcm93
SW5kZXgpOwogICAgICAgIGJyZWFrOwog
ICAgICB9CgogICAgICB0aGlzLnJvd05v
ZGVzXy5pbnNlcnRCZWZvcmUobmV3Tm9k
ZSwgbm9kZSk7CiAgICAgIGNvbnRpbnVl
OwogICAgfQoKICAgIGlmIChub2RlLnJv
d0luZGV4ID09IHJvd0luZGV4KSB7CiAg
ICAgIC8vIFRoaXMgbm9kZSBpcyBpbiB0
aGUgcmlnaHQgcGxhY2UsIG1vdmUgYWxv
bmcuCiAgICAgIG5vZGUgPSBub2RlLm5l
eHRTaWJsaW5nOwogICAgICBjb250aW51
ZTsKICAgIH0KCiAgICBpZiAoc2VsZWN0
aW9uU3RhcnRSb3cgJiYgc2VsZWN0aW9u
U3RhcnRSb3cucm93SW5kZXggPT0gcm93
SW5kZXgpIHsKICAgICAgLy8gVGhlIHNl
bGVjdGlvbiBzdGFydCByb3cgaXMgc3Vw
cG9zZWQgdG8gYmUgaGVyZSwgcmVtb3Zl
IG5vZGVzIHVudGlsCiAgICAgIC8vIHdl
IGZpbmQgaXQuCiAgICAgIHJlbW92ZVVu
dGlsTm9kZShub2RlLCBzZWxlY3Rpb25T
dGFydFJvdyk7CiAgICAgIG5vZGUgPSBz
ZWxlY3Rpb25TdGFydFJvdy5uZXh0U2li
bGluZzsKICAgICAgY29udGludWU7CiAg
ICB9CgogICAgaWYgKHNlbGVjdGlvbkVu
ZFJvdyAmJiBzZWxlY3Rpb25FbmRSb3cu
cm93SW5kZXggPT0gcm93SW5kZXgpIHsK
ICAgICAgLy8gVGhlIHNlbGVjdGlvbiBl
bmQgcm93IGlzIHN1cHBvc2VkIHRvIGJl
IGhlcmUsIHJlbW92ZSBub2RlcyB1bnRp
bAogICAgICAvLyB3ZSBmaW5kIGl0Lgog
ICAgICByZW1vdmVVbnRpbE5vZGUobm9k
ZSwgc2VsZWN0aW9uRW5kUm93KTsKICAg
ICAgbm9kZSA9IHNlbGVjdGlvbkVuZFJv
dy5uZXh0U2libGluZzsKICAgICAgY29u
dGludWU7CiAgICB9CgogICAgaWYgKG5v
ZGUgPT0gc2VsZWN0aW9uU3RhcnRSb3cg
fHwgbm9kZSA9PSBzZWxlY3Rpb25FbmRS
b3cpIHsKICAgICAgLy8gV2UgZW5jb3Vu
dGVyZWQgdGhlIHN0YXJ0L2VuZCBvZiB0
aGUgc2VsZWN0aW9uLCBidXQgd2UgZG9u
J3Qgd2FudCBpdAogICAgICAvLyB5ZXQu
ICBJbnNlcnQgYSBuZXcgcm93IGluc3Rl
YWQuCiAgICAgIHZhciBuZXdOb2RlID0g
dGhpcy5mZXRjaFJvd05vZGVfKHJvd0lu
ZGV4KTsKICAgICAgaWYgKCFuZXdOb2Rl
KSB7CiAgICAgICAgY29uc29sZS5sb2co
IkNvdWxkbid0IGZldGNoIHJvdyBpbmRl
eDogIiArIHJvd0luZGV4KTsKICAgICAg
ICBicmVhazsKICAgICAgfQoKICAgICAg
dGhpcy5yb3dOb2Rlc18uaW5zZXJ0QmVm
b3JlKG5ld05vZGUsIG5vZGUpOwogICAg
ICBjb250aW51ZTsKICAgIH0KCiAgICAv
LyBUaGVyZSBpcyBub3RoaW5nIHNwZWNp
YWwgYWJvdXQgdGhpcyBub2RlLCBidXQg
aXQncyBpbiBvdXIgd2F5LiAgUmVwbGFj
ZQogICAgLy8gaXQgd2l0aCB0aGUgbm9k
ZSB0aGF0IHNob3VsZCBiZSBoZXJlLgog
ICAgdmFyIG5ld05vZGUgPSB0aGlzLmZl
dGNoUm93Tm9kZV8ocm93SW5kZXgpOwog
ICAgaWYgKCFuZXdOb2RlKSB7CiAgICAg
IGNvbnNvbGUubG9nKCJDb3VsZG4ndCBm
ZXRjaCByb3cgaW5kZXg6ICIgKyByb3dJ
bmRleCk7CiAgICAgIGJyZWFrOwogICAg
fQoKICAgIGlmIChub2RlID09IG5ld05v
ZGUpIHsKICAgICAgbm9kZSA9IG5vZGUu
bmV4dFNpYmxpbmc7CiAgICAgIGNvbnRp
bnVlOwogICAgfQoKICAgIHRoaXMucm93
Tm9kZXNfLmluc2VydEJlZm9yZShuZXdO
b2RlLCBub2RlKTsKICAgIGlmICghbmV3
Tm9kZS5uZXh0U2libGluZykKICAgICAg
ZGVidWdnZXI7CiAgICB0aGlzLnJvd05v
ZGVzXy5yZW1vdmVDaGlsZChub2RlKTsK
ICAgIG5vZGUgPSBuZXdOb2RlLm5leHRT
aWJsaW5nOwogIH0KCiAgaWYgKG5vZGUg
IT0gdGhpcy5ib3R0b21Gb2xkXykKICAg
IHJlbW92ZVVudGlsTm9kZShub2RlLCBi
b3R0b21Gb2xkKTsKfTsKCi8qKgogKiBF
bXB0eSBvdXQgYm90aCBzZWxlY3QgYmFn
cyBhbmQgcmVtb3ZlIHRoZW0gZnJvbSB0
aGUgZG9jdW1lbnQuCiAqCiAqIFRoZXNl
IG5vZGVzIGhvbGQgdGhlIHRleHQgYmV0
d2VlbiB0aGUgc3RhcnQgYW5kIGVuZCBv
ZiB0aGUgc2VsZWN0aW9uCiAqIHdoZW4g
dGhhdCB0ZXh0IGlzIG90aGVyd2lzZSBv
ZmYgc2NyZWVuLiAgVGhleSBhcmUgZmls
bGVkIG91dCBpbiB0aGUKICogb25Db3B5
XyBldmVudC4KICovCmh0ZXJtLlNjcm9s
bFBvcnQucHJvdG90eXBlLnJlc2V0U2Vs
ZWN0QmFnc18gPSBmdW5jdGlvbigpIHsK
ICBpZiAodGhpcy50b3BTZWxlY3RCYWdf
LnBhcmVudE5vZGUpIHsKICAgIHRoaXMu
dG9wU2VsZWN0QmFnXy50ZXh0Q29udGVu
dCA9ICcnOwogICAgdGhpcy50b3BTZWxl
Y3RCYWdfLnBhcmVudE5vZGUucmVtb3Zl
Q2hpbGQodGhpcy50b3BTZWxlY3RCYWdf
KTsKICB9CgogIGlmICh0aGlzLmJvdHRv
bVNlbGVjdEJhZ18ucGFyZW50Tm9kZSkg
ewogICAgdGhpcy5ib3R0b21TZWxlY3RC
YWdfLnRleHRDb250ZW50ID0gJyc7CiAg
ICB0aGlzLmJvdHRvbVNlbGVjdEJhZ18u
cGFyZW50Tm9kZS5yZW1vdmVDaGlsZCh0
aGlzLmJvdHRvbVNlbGVjdEJhZ18pOwog
IH0KfTsKCi8qKgogKiBQbGFjZSBhIHJv
dyBub2RlIGluIHRoZSBjYWNoZSBvZiB2
aXNpYmxlIG5vZGVzLgogKgogKiBUaGlz
IG1ldGhvZCBtYXkgb25seSBiZSB1c2Vk
IGR1cmluZyBhIHJlZHJhd18uCiAqLwpo
dGVybS5TY3JvbGxQb3J0LnByb3RvdHlw
ZS5jYWNoZVJvd05vZGVfID0gZnVuY3Rp
b24ocm93Tm9kZSkgewogIHRoaXMuY3Vy
cmVudFJvd05vZGVDYWNoZV9bcm93Tm9k
ZS5yb3dJbmRleF0gPSByb3dOb2RlOwp9
OwoKLyoqCiAqIEZldGNoIHRoZSByb3cg
bm9kZSBmb3IgdGhlIGdpdmVuIGluZGV4
LgogKgogKiBUaGlzIHdpbGwgcmV0dXJu
IGEgbm9kZSBmcm9tIHRoZSBjYWNoZSBp
ZiBwb3NzaWJsZSwgb3Igd2lsbCByZXF1
ZXN0IG9uZQogKiBmcm9tIHRoZSBSb3dQ
cm92aWRlciBpZiBub3QuCiAqCiAqIElm
IGEgcmVkcmF3XyBpcyBpbiBwcm9ncmVz
cyB0aGUgcm93IHdpbGwgYmUgYWRkZWQg
dG8gdGhlIGN1cnJlbnQgY2FjaGUuCiAq
LwpodGVybS5TY3JvbGxQb3J0LnByb3Rv
dHlwZS5mZXRjaFJvd05vZGVfID0gZnVu
Y3Rpb24ocm93SW5kZXgpIHsKICB2YXIg
bm9kZTsKCiAgaWYgKHRoaXMucHJldmlv
dXNSb3dOb2RlQ2FjaGVfICYmIHJvd0lu
ZGV4IGluIHRoaXMucHJldmlvdXNSb3dO
b2RlQ2FjaGVfKSB7CiAgICBub2RlID0g
dGhpcy5wcmV2aW91c1Jvd05vZGVDYWNo
ZV9bcm93SW5kZXhdOwogIH0gZWxzZSB7
CiAgICBub2RlID0gdGhpcy5yb3dQcm92
aWRlcl8uZ2V0Um93Tm9kZShyb3dJbmRl
eCk7CiAgfQoKICBpZiAodGhpcy5jdXJy
ZW50Um93Tm9kZUNhY2hlXykKICAgIHRo
aXMuY2FjaGVSb3dOb2RlXyhub2RlKTsK
CiAgcmV0dXJuIG5vZGU7Cn07CgovKioK
ICogU2VsZWN0IGFsbCByb3dzIGluIHRo
ZSB2aWV3cG9ydC4KICovCmh0ZXJtLlNj
cm9sbFBvcnQucHJvdG90eXBlLnNlbGVj
dEFsbCA9IGZ1bmN0aW9uKCkgewogIHZh
ciBmaXJzdFJvdzsKCiAgaWYgKHRoaXMu
dG9wRm9sZF8ubmV4dFNpYmxpbmcucm93
SW5kZXggIT0gMCkgewogICAgd2hpbGUg
KHRoaXMudG9wRm9sZF8ucHJldmlvdXNT
aWJsaW5nKSB7CiAgICAgIHRoaXMucm93
Tm9kZXNfLnJlbW92ZUNoaWxkKHRoaXMu
dG9wRm9sZF8ucHJldmlvdXNTaWJsaW5n
KTsKICAgIH0KCiAgICBmaXJzdFJvdyA9
IHRoaXMuZmV0Y2hSb3dOb2RlXygwKTsK
ICAgIHRoaXMucm93Tm9kZXNfLmluc2Vy
dEJlZm9yZShmaXJzdFJvdywgdGhpcy50
b3BGb2xkXyk7CiAgICB0aGlzLnN5bmNS
b3dOb2Rlc0RpbWVuc2lvbnNfKCk7CiAg
fSBlbHNlIHsKICAgIGZpcnN0Um93ID0g
dGhpcy50b3BGb2xkXy5uZXh0U2libGlu
ZzsKICB9CgogIHZhciBsYXN0Um93SW5k
ZXggPSB0aGlzLnJvd1Byb3ZpZGVyXy5n
ZXRSb3dDb3VudCgpIC0gMTsKICB2YXIg
bGFzdFJvdzsKCiAgaWYgKHRoaXMuYm90
dG9tRm9sZF8ucHJldmlvdXNTaWJsaW5n
LnJvd0luZGV4ICE9IGxhc3RSb3dJbmRl
eCkgewogICAgd2hpbGUgKHRoaXMuYm90
dG9tRm9sZF8ubmV4dFNpYmxpbmcpIHsK
ICAgICAgdGhpcy5yb3dOb2Rlc18ucmVt
b3ZlQ2hpbGQodGhpcy5ib3R0b21Gb2xk
Xy5uZXh0U2libGluZyk7CiAgICB9Cgog
ICAgbGFzdFJvdyA9IHRoaXMuZmV0Y2hS
b3dOb2RlXyhsYXN0Um93SW5kZXgpOwog
ICAgdGhpcy5yb3dOb2Rlc18uYXBwZW5k
Q2hpbGQobGFzdFJvdyk7CiAgfSBlbHNl
IHsKICAgIGxhc3RSb3cgPSB0aGlzLmJv
dHRvbUZvbGRfLnByZXZpb3VzU2libGlu
Zy5yb3dJbmRleDsKICB9CgogIHZhciBz
ZWxlY3Rpb24gPSB0aGlzLmRvY3VtZW50
Xy5nZXRTZWxlY3Rpb24oKTsKICBzZWxl
Y3Rpb24uY29sbGFwc2UoZmlyc3RSb3cs
IDApOwogIHNlbGVjdGlvbi5leHRlbmQo
bGFzdFJvdywgbGFzdFJvdy5jaGlsZE5v
ZGVzLmxlbmd0aCk7CgogIHRoaXMuc2Vs
ZWN0aW9uLnN5bmMoKTsKfTsKCi8qKgog
KiBSZXR1cm4gdGhlIG1heGltdW0gc2Ny
b2xsIHBvc2l0aW9uIGluIHBpeGVscy4K
ICovCmh0ZXJtLlNjcm9sbFBvcnQucHJv
dG90eXBlLmdldFNjcm9sbE1heF8gPSBm
dW5jdGlvbihlKSB7CiAgcmV0dXJuICho
dGVybS5nZXRDbGllbnRIZWlnaHQodGhp
cy5zY3JvbGxBcmVhXykgKwogICAgICAg
ICAgdGhpcy52aXNpYmxlUm93VG9wTWFy
Z2luICsgdGhpcy52aXNpYmxlUm93Qm90
dG9tTWFyZ2luIC0KICAgICAgICAgIGh0
ZXJtLmdldENsaWVudEhlaWdodCh0aGlz
LnNjcmVlbl8pKTsKfTsKCi8qKgogKiBT
Y3JvbGwgdGhlIGdpdmVuIHJvd0luZGV4
IHRvIHRoZSB0b3Agb2YgdGhlIGh0ZXJt
LlNjcm9sbFBvcnQuCiAqCiAqIEBwYXJh
bSB7aW50ZWdlcn0gcm93SW5kZXggSW5k
ZXggb2YgdGhlIHRhcmdldCByb3cuCiAq
LwpodGVybS5TY3JvbGxQb3J0LnByb3Rv
dHlwZS5zY3JvbGxSb3dUb1RvcCA9IGZ1
bmN0aW9uKHJvd0luZGV4KSB7CiAgdGhp
cy5zeW5jU2Nyb2xsSGVpZ2h0KCk7Cgog
IHRoaXMuaXNTY3JvbGxlZEVuZCA9ICgK
ICAgIHJvd0luZGV4ICsgdGhpcy52aXNp
YmxlUm93Q291bnQgPj0gdGhpcy5sYXN0
Um93Q291bnRfKTsKCiAgdmFyIHNjcm9s
bFRvcCA9IHJvd0luZGV4ICogdGhpcy5j
aGFyYWN0ZXJTaXplLmhlaWdodCArCiAg
ICAgIHRoaXMudmlzaWJsZVJvd1RvcE1h
cmdpbjsKCiAgdmFyIHNjcm9sbE1heCA9
IHRoaXMuZ2V0U2Nyb2xsTWF4XygpOwog
IGlmIChzY3JvbGxUb3AgPiBzY3JvbGxN
YXgpCiAgICBzY3JvbGxUb3AgPSBzY3Jv
bGxNYXg7CgogIGlmICh0aGlzLnNjcmVl
bl8uc2Nyb2xsVG9wID09IHNjcm9sbFRv
cCkKICAgIHJldHVybjsKCiAgdGhpcy5z
Y3JlZW5fLnNjcm9sbFRvcCA9IHNjcm9s
bFRvcDsKICB0aGlzLnNjaGVkdWxlUmVk
cmF3KCk7Cn07CgovKioKICogU2Nyb2xs
IHRoZSBnaXZlbiByb3dJbmRleCB0byB0
aGUgYm90dG9tIG9mIHRoZSBodGVybS5T
Y3JvbGxQb3J0LgogKgogKiBAcGFyYW0g
e2ludGVnZXJ9IHJvd0luZGV4IEluZGV4
IG9mIHRoZSB0YXJnZXQgcm93LgogKi8K
aHRlcm0uU2Nyb2xsUG9ydC5wcm90b3R5
cGUuc2Nyb2xsUm93VG9Cb3R0b20gPSBm
dW5jdGlvbihyb3dJbmRleCkgewogIHRo
aXMuc3luY1Njcm9sbEhlaWdodCgpOwoK
ICB0aGlzLmlzU2Nyb2xsZWRFbmQgPSAo
CiAgICByb3dJbmRleCArIHRoaXMudmlz
aWJsZVJvd0NvdW50ID49IHRoaXMubGFz
dFJvd0NvdW50Xyk7CgogIHZhciBzY3Jv
bGxUb3AgPSByb3dJbmRleCAqIHRoaXMu
Y2hhcmFjdGVyU2l6ZS5oZWlnaHQgKwog
ICAgICB0aGlzLnZpc2libGVSb3dUb3BN
YXJnaW4gKyB0aGlzLnZpc2libGVSb3dC
b3R0b21NYXJnaW47CiAgc2Nyb2xsVG9w
IC09IHRoaXMudmlzaWJsZVJvd0NvdW50
ICogdGhpcy5jaGFyYWN0ZXJTaXplLmhl
aWdodDsKCiAgaWYgKHNjcm9sbFRvcCA8
IDApCiAgICBzY3JvbGxUb3AgPSAwOwoK
ICBpZiAodGhpcy5zY3JlZW5fLnNjcm9s
bFRvcCA9PSBzY3JvbGxUb3ApCiAgICBy
ZXR1cm47CgogIHRoaXMuc2NyZWVuXy5z
Y3JvbGxUb3AgPSBzY3JvbGxUb3A7Cn07
CgovKioKICogUmV0dXJuIHRoZSByb3cg
aW5kZXggb2YgdGhlIGZpcnN0IHZpc2li
bGUgcm93LgogKgogKiBUaGlzIGlzIGJh
c2VkIG9uIHRoZSBzY3JvbGwgcG9zaXRp
b24uICBJZiBhIHJlZHJhd18gaXMgaW4g
cHJvZ3Jlc3MgdGhpcwogKiByZXR1cm5z
IHRoZSByb3cgdGhhdCAqc2hvdWxkKiBi
ZSBhdCB0aGUgdG9wLgogKi8KaHRlcm0u
U2Nyb2xsUG9ydC5wcm90b3R5cGUuZ2V0
VG9wUm93SW5kZXggPSBmdW5jdGlvbigp
IHsKICByZXR1cm4gbGliLmYuc21hcnRG
bG9vckRpdmlkZSgKICAgICAgdGhpcy5z
Y3JlZW5fLnNjcm9sbFRvcCwgdGhpcy5j
aGFyYWN0ZXJTaXplLmhlaWdodCk7Cn07
CgovKioKICogUmV0dXJuIHRoZSByb3cg
aW5kZXggb2YgdGhlIGxhc3QgdmlzaWJs
ZSByb3cuCiAqCiAqIFRoaXMgaXMgYmFz
ZWQgb24gdGhlIHNjcm9sbCBwb3NpdGlv
bi4gIElmIGEgcmVkcmF3XyBpcyBpbiBw
cm9ncmVzcyB0aGlzCiAqIHJldHVybnMg
dGhlIHJvdyB0aGF0ICpzaG91bGQqIGJl
IGF0IHRoZSBib3R0b20uCiAqLwpodGVy
bS5TY3JvbGxQb3J0LnByb3RvdHlwZS5n
ZXRCb3R0b21Sb3dJbmRleCA9IGZ1bmN0
aW9uKHRvcFJvd0luZGV4KSB7CiAgcmV0
dXJuIHRvcFJvd0luZGV4ICsgdGhpcy52
aXNpYmxlUm93Q291bnQgLSAxOwp9OwoK
LyoqCiAqIEhhbmRsZXIgZm9yIHNjcm9s
bCBldmVudHMuCiAqCiAqIFRoZSBvblNj
cm9sbCBldmVudCBmaXJlcyB3aGVuIHNj
cm9sbEFyZWEncyBzY3JvbGxUb3AgcHJv
cGVydHkgY2hhbmdlcy4gIFRoaXMKICog
bWF5IGJlIGR1ZSB0byB0aGUgdXNlciBt
YW51YWxseSBtb3ZlIHRoZSBzY3JvbGxi
YXIsIG9yIGEgcHJvZ3JhbW1hdGljIGNo
YW5nZS4KICovCmh0ZXJtLlNjcm9sbFBv
cnQucHJvdG90eXBlLm9uU2Nyb2xsXyA9
IGZ1bmN0aW9uKGUpIHsKICB2YXIgc2Ny
ZWVuU2l6ZSA9IHRoaXMuZ2V0U2NyZWVu
U2l6ZSgpOwogIGlmIChzY3JlZW5TaXpl
LndpZHRoICE9IHRoaXMubGFzdFNjcmVl
bldpZHRoXyB8fAogICAgICBzY3JlZW5T
aXplLmhlaWdodCAhPSB0aGlzLmxhc3RT
Y3JlZW5IZWlnaHRfKSB7CiAgICAvLyBU
aGlzIGV2ZW50IG1heSBhbHNvIGZpcmUg
ZHVyaW5nIGEgcmVzaXplIChidXQgYmVm
b3JlIHRoZSByZXNpemUgZXZlbnQhKS4K
ICAgIC8vIFRoaXMgaGFwcGVucyB3aGVu
IHRoZSBicm93c2VyIG1vdmVzIHRoZSBz
Y3JvbGxiYXIgYXMgcGFydCBvZiB0aGUg
cmVzaXplLgogICAgLy8gSW4gdGhlc2Ug
Y2FzZXMsIHdlIHdhbnQgdG8gaWdub3Jl
IHRoZSBzY3JvbGwgZXZlbnQgYW5kIGxl
dCBvblJlc2l6ZQogICAgLy8gaGFuZGxl
IHRoaW5ncy4gIElmIHdlIGRvbid0LCB0
aGVuIHdlIGVuZCB1cCBzY3JvbGxpbmcg
dG8gdGhlIHdyb25nCiAgICAvLyBwb3Np
dGlvbiBhZnRlciBhIHJlc2l6ZS4KICAg
IHRoaXMucmVzaXplKCk7CiAgICByZXR1
cm47CiAgfQoKICB0aGlzLnJlZHJhd18o
KTsKICB0aGlzLnB1Ymxpc2goJ3Njcm9s
bCcsIHsgc2Nyb2xsUG9ydDogdGhpcyB9
KTsKfTsKCi8qKgogKiBDbGllbnRzIGNh
biBvdmVycmlkZSB0aGlzIGlmIHRoZXkg
d2FudCB0byBoZWFyIHNjcm9sbHdoZWVs
IGV2ZW50cy4KICoKICogQ2xpZW50cyBt
YXkgY2FsbCBldmVudC5wcmV2ZW50RGVm
YXVsdCgpIGlmIHRoZXkgd2FudCB0byBr
ZWVwIHRoZSBzY3JvbGxwb3J0CiAqIGZy
b20gYWxzbyBoYW5kbGluZyB0aGUgZXZl
bnRzLgogKi8KaHRlcm0uU2Nyb2xsUG9y
dC5wcm90b3R5cGUub25TY3JvbGxXaGVl
bCA9IGZ1bmN0aW9uKGUpIHt9OwoKLyoq
CiAqIEhhbmRsZXIgZm9yIHNjcm9sbC13
aGVlbCBldmVudHMuCiAqCiAqIFRoZSBv
blNjcm9sbFdoZWVsIGV2ZW50IGZpcmVz
IHdoZW4gdGhlIHVzZXIgbW92ZXMgdGhl
aXIgc2Nyb2xsd2hlZWwgb3ZlciB0aGlz
CiAqIGh0ZXJtLlNjcm9sbFBvcnQuICBC
ZWNhdXNlIHRoZSBmcm9udG1vc3QgZWxl
bWVudCBpbiB0aGUgaHRlcm0uU2Nyb2xs
UG9ydCBpcwogKiBhIGZpeGVkIHBvc2l0
aW9uIERJViwgdGhlIHNjcm9sbCB3aGVl
bCBkb2VzIG5vdGhpbmcgYnkgZGVmYXVs
dC4gIEluc3RlYWQsIHdlCiAqIGhhdmUg
dG8gaGFuZGxlIGl0IG1hbnVhbGx5Lgog
Ki8KaHRlcm0uU2Nyb2xsUG9ydC5wcm90
b3R5cGUub25TY3JvbGxXaGVlbF8gPSBm
dW5jdGlvbihlKSB7CiAgdGhpcy5vblNj
cm9sbFdoZWVsKGUpOwoKICBpZiAoZS5k
ZWZhdWx0UHJldmVudGVkKQogICAgcmV0
dXJuOwoKICAvLyBJbiBGRiwgdGhlIGV2
ZW50IGlzIERPTU1vdXNlU2Nyb2xsIGFu
ZCBwdXRzIHRoZSBzY3JvbGwgcGl4ZWwg
ZGVsdGEgaW4gdGhlCiAgLy8gJ2RldGFp
bCcgZmllbGQgb2YgdGhlIGV2ZW50LiAg
SXQgYWxzbyBmbGlwcyB0aGUgbWFwcGlu
ZyBvZiB3aGljaCBkaXJlY3Rpb24KICAv
LyBhIG5lZ2F0aXZlIG51bWJlciBtZWFu
cyBpbiB0aGUgc2Nyb2xsLgogIHZhciBk
ZWx0YSA9IGUudHlwZSA9PSAnRE9NTW91
c2VTY3JvbGwnID8gKC0xICogZS5kZXRh
aWwpIDogZS53aGVlbERlbHRhWTsKICBk
ZWx0YSAqPSB0aGlzLnNjcm9sbFdoZWVs
TXVsdGlwbGllcl87CgogIHZhciB0b3Ag
PSB0aGlzLnNjcmVlbl8uc2Nyb2xsVG9w
IC0gZGVsdGE7CiAgaWYgKHRvcCA8IDAp
CiAgICB0b3AgPSAwOwoKICB2YXIgc2Ny
b2xsTWF4ID0gdGhpcy5nZXRTY3JvbGxN
YXhfKCk7CiAgaWYgKHRvcCA+IHNjcm9s
bE1heCkKICAgIHRvcCA9IHNjcm9sbE1h
eDsKCiAgaWYgKHRvcCAhPSB0aGlzLnNj
cmVlbl8uc2Nyb2xsVG9wKSB7CiAgICAv
LyBNb3Zpbmcgc2Nyb2xsVG9wIGNhdXNl
cyBhIHNjcm9sbCBldmVudCwgd2hpY2gg
dHJpZ2dlcnMgdGhlIHJlZHJhdy4KICAg
IHRoaXMuc2NyZWVuXy5zY3JvbGxUb3Ag
PSB0b3A7CgogICAgLy8gT25seSBwcmV2
ZW50RGVmYXVsdCB3aGVuIHdlJ3ZlIGFj
dHVhbGx5IHNjcm9sbGVkLiAgSWYgdGhl
cmUncyBub3RoaW5nCiAgICAvLyB0byBz
Y3JvbGwgd2Ugd2FudCB0byBwYXNzIHRo
ZSBldmVudCB0aHJvdWdoIHNvIENocm9t
ZSBjYW4gZGV0ZWN0IHRoZQogICAgLy8g
b3ZlcnNjcm9sbC4KICAgIGUucHJldmVu
dERlZmF1bHQoKTsKICB9Cn07CgovKioK
ICogSGFuZGxlciBmb3IgcmVzaXplIGV2
ZW50cy4KICoKICogVGhlIGJyb3dzZXIg
d2lsbCByZXNpemUgdXMgc3VjaCB0aGF0
IHRoZSB0b3Agcm93IHN0YXlzIGF0IHRo
ZSB0b3AsIGJ1dCB3ZQogKiBwcmVmZXIg
dG8gdGhlIGJvdHRvbSByb3cgdG8gc3Rh
eSBhdCB0aGUgYm90dG9tLgogKi8KaHRl
cm0uU2Nyb2xsUG9ydC5wcm90b3R5cGUu
b25SZXNpemVfID0gZnVuY3Rpb24oZSkg
ewogIC8vIFJlLW1lYXN1cmUsIHNpbmNl
IG9uUmVzaXplIGFsc28gaGFwcGVucyBm
b3IgYnJvd3NlciB6b29tIGNoYW5nZXMu
CiAgdGhpcy5zeW5jQ2hhcmFjdGVyU2l6
ZSgpOwogIHRoaXMucmVzaXplKCk7Cn07
CgovKioKICogQ2xpZW50cyBjYW4gb3Zl
cnJpZGUgdGhpcyBpZiB0aGV5IHdhbnQg
dG8gaGVhciBjb3B5IGV2ZW50cy4KICoK
ICogQ2xpZW50cyBtYXkgY2FsbCBldmVu
dC5wcmV2ZW50RGVmYXVsdCgpIGlmIHRo
ZXkgd2FudCB0byBrZWVwIHRoZSBzY3Jv
bGxwb3J0CiAqIGZyb20gYWxzbyBoYW5k
bGluZyB0aGUgZXZlbnRzLgogKi8KaHRl
cm0uU2Nyb2xsUG9ydC5wcm90b3R5cGUu
b25Db3B5ID0gZnVuY3Rpb24oZSkgeyB9
OwoKLyoqCiAqIEhhbmRsZXIgZm9yIGNv
cHktdG8tY2xpcGJvYXJkIGV2ZW50cy4K
ICoKICogSWYgc29tZSBvciBhbGwgb2Yg
dGhlIHNlbGVjdGVkIHJvd3MgYXJlIG9m
ZiBzY3JlZW4gd2UgbWF5IG5lZWQgdG8g
ZmlsbCBpbgogKiB0aGUgcm93cyBiZXR3
ZWVuIHNlbGVjdGlvbiBzdGFydCBhbmQg
c2VsZWN0aW9uIGVuZC4gIFRoaXMgaGFu
ZGxlciBkZXRlcm1pbmVzCiAqIGlmIHdl
J3JlIG1pc3Npbmcgc29tZSBvZiB0aGUg
c2VsZWN0ZWQgdGV4dCwgYW5kIGlmIHNv
IHBvcHVsYXRlcyBvbmUgb3IgYm90aAog
KiBvZiB0aGUgInNlbGVjdCBiYWdzIiB3
aXRoIHRoZSBtaXNzaW5nIHRleHQuCiAq
LwpodGVybS5TY3JvbGxQb3J0LnByb3Rv
dHlwZS5vbkNvcHlfID0gZnVuY3Rpb24o
ZSkgewogIHRoaXMub25Db3B5KGUpOwoK
ICBpZiAoZS5kZWZhdWx0UHJldmVudGVk
KQogICAgcmV0dXJuOwoKICB0aGlzLnJl
c2V0U2VsZWN0QmFnc18oKTsKICB0aGlz
LnNlbGVjdGlvbi5zeW5jKCk7CgogIGlm
ICghdGhpcy5zZWxlY3Rpb24uc3RhcnRS
b3cgfHwKICAgICAgdGhpcy5zZWxlY3Rp
b24uZW5kUm93LnJvd0luZGV4IC0gdGhp
cy5zZWxlY3Rpb24uc3RhcnRSb3cucm93
SW5kZXggPCAyKSB7CiAgICByZXR1cm47
CiAgfQoKICB2YXIgdG9wUm93SW5kZXgg
PSB0aGlzLmdldFRvcFJvd0luZGV4KCk7
CiAgdmFyIGJvdHRvbVJvd0luZGV4ID0g
dGhpcy5nZXRCb3R0b21Sb3dJbmRleCh0
b3BSb3dJbmRleCk7CgogIGlmICh0aGlz
LnNlbGVjdGlvbi5zdGFydFJvdy5yb3dJ
bmRleCA8IHRvcFJvd0luZGV4KSB7CiAg
ICAvLyBTdGFydCBvZiBzZWxlY3Rpb24g
aXMgYWJvdmUgdGhlIHRvcCBmb2xkLgog
ICAgdmFyIGVuZEJhY2tmaWxsSW5kZXg7
CgogICAgaWYgKHRoaXMuc2VsZWN0aW9u
LmVuZFJvdy5yb3dJbmRleCA8IHRvcFJv
d0luZGV4KSB7CiAgICAgIC8vIEVudGly
ZSBzZWxlY3Rpb24gaXMgYWJvdmUgdGhl
IHRvcCBmb2xkLgogICAgICBlbmRCYWNr
ZmlsbEluZGV4ID0gdGhpcy5zZWxlY3Rp
b24uZW5kUm93LnJvd0luZGV4OwogICAg
fSBlbHNlIHsKICAgICAgLy8gU2VsZWN0
aW9uIGV4dGVuZHMgYmVsb3cgdGhlIHRv
cCBmb2xkLgogICAgICBlbmRCYWNrZmls
bEluZGV4ID0gdGhpcy50b3BGb2xkXy5u
ZXh0U2libGluZy5yb3dJbmRleDsKICAg
IH0KCiAgICB0aGlzLnRvcFNlbGVjdEJh
Z18udGV4dENvbnRlbnQgPSB0aGlzLnJv
d1Byb3ZpZGVyXy5nZXRSb3dzVGV4dCgK
ICAgICAgICB0aGlzLnNlbGVjdGlvbi5z
dGFydFJvdy5yb3dJbmRleCArIDEsIGVu
ZEJhY2tmaWxsSW5kZXgpOwogICAgdGhp
cy5yb3dOb2Rlc18uaW5zZXJ0QmVmb3Jl
KHRoaXMudG9wU2VsZWN0QmFnXywKICAg
ICAgICAgICAgICAgICAgICAgICAgICAg
ICAgICB0aGlzLnNlbGVjdGlvbi5zdGFy
dFJvdy5uZXh0U2libGluZyk7CiAgICB0
aGlzLnN5bmNSb3dOb2Rlc0RpbWVuc2lv
bnNfKCk7CiAgfQoKICBpZiAodGhpcy5z
ZWxlY3Rpb24uZW5kUm93LnJvd0luZGV4
ID4gYm90dG9tUm93SW5kZXgpIHsKICAg
IC8vIFNlbGVjdGlvbiBlbmRzIGJlbG93
IHRoZSBib3R0b20gZm9sZC4KICAgIHZh
ciBzdGFydEJhY2tmaWxsSW5kZXg7Cgog
ICAgaWYgKHRoaXMuc2VsZWN0aW9uLnN0
YXJ0Um93LnJvd0luZGV4ID4gYm90dG9t
Um93SW5kZXgpIHsKICAgICAgLy8gRW50
aXJlIHNlbGVjdGlvbiBpcyBiZWxvdyB0
aGUgYm90dG9tIGZvbGQuCiAgICAgIHN0
YXJ0QmFja2ZpbGxJbmRleCA9IHRoaXMu
c2VsZWN0aW9uLnN0YXJ0Um93LnJvd0lu
ZGV4ICsgMTsKICAgIH0gZWxzZSB7CiAg
ICAgIC8vIFNlbGVjdGlvbiBzdGFydHMg
YWJvdmUgdGhlIGJvdHRvbSBmb2xkLgog
ICAgICBzdGFydEJhY2tmaWxsSW5kZXgg
PSB0aGlzLmJvdHRvbUZvbGRfLnByZXZp
b3VzU2libGluZy5yb3dJbmRleCArIDE7
CiAgICB9CgogICAgdGhpcy5ib3R0b21T
ZWxlY3RCYWdfLnRleHRDb250ZW50ID0g
dGhpcy5yb3dQcm92aWRlcl8uZ2V0Um93
c1RleHQoCiAgICAgICAgc3RhcnRCYWNr
ZmlsbEluZGV4LCB0aGlzLnNlbGVjdGlv
bi5lbmRSb3cucm93SW5kZXgpOwogICAg
dGhpcy5yb3dOb2Rlc18uaW5zZXJ0QmVm
b3JlKHRoaXMuYm90dG9tU2VsZWN0QmFn
XywgdGhpcy5zZWxlY3Rpb24uZW5kUm93
KTsKICB9Cn07CgovKioKICogRm9jdXNl
cyBvbiB0aGUgcGFzdGUgdGFyZ2V0IG9u
IGEgY3RybC12IGtleWRvd24gZXZlbnQs
IGFzIGluCiAqIEZGIGEgY29udGVudCBl
ZGl0YWJsZSBlbGVtZW50IG11c3QgYmUg
Zm9jdXNlZCBiZWZvcmUgdGhlIHBhc3Rl
IGV2ZW50LgogKi8KaHRlcm0uU2Nyb2xs
UG9ydC5wcm90b3R5cGUub25Cb2R5S2V5
RG93bl8gPSBmdW5jdGlvbihlKSB7CiAg
aWYgKCF0aGlzLmN0cmxWUGFzdGUpCiAg
ICByZXR1cm47CgogIHZhciBrZXkgPSBT
dHJpbmcuZnJvbUNoYXJDb2RlKGUud2hp
Y2gpOwogIHZhciBsb3dlcktleSA9IGtl
eS50b0xvd2VyQ2FzZSgpOwogIGlmICgo
ZS5jdHJsS2V5IHx8IGUubWV0YUtleSkg
JiYgbG93ZXJLZXkgPT0gInYiKQogICAg
dGhpcy5wYXN0ZVRhcmdldF8uZm9jdXMo
KTsKfTsKCi8qKgogKiBIYW5kbGUgYSBw
YXN0ZSBldmVudCBvbiB0aGUgdGhlIFNj
cm9sbFBvcnQncyBzY3JlZW4gZWxlbWVu
dC4KICovCmh0ZXJtLlNjcm9sbFBvcnQu
cHJvdG90eXBlLm9uUGFzdGVfID0gZnVu
Y3Rpb24oZSkgewogIHRoaXMucGFzdGVU
YXJnZXRfLmZvY3VzKCk7CgogIHZhciBz
ZWxmID0gdGhpczsKICBzZXRUaW1lb3V0
KGZ1bmN0aW9uKCkgewogICAgICBzZWxm
LnB1Ymxpc2goJ3Bhc3RlJywgeyB0ZXh0
OiBzZWxmLnBhc3RlVGFyZ2V0Xy52YWx1
ZSB9KTsKICAgICAgc2VsZi5wYXN0ZVRh
cmdldF8udmFsdWUgPSAnJzsKICAgICAg
c2VsZi5zY3JlZW5fLmZvY3VzKCk7CiAg
ICB9LCAwKTsKfTsKCi8qKgogKiBIYW5k
bGVzIGEgdGV4dElucHV0IGV2ZW50IG9u
IHRoZSBwYXN0ZSB0YXJnZXQuIFN0b3Bz
IHRoaXMgZnJvbQogKiBwcm9wYWdhdGlu
ZyBhcyB3ZSB3YW50IHRoaXMgdG8gYmUg
aGFuZGxlZCBpbiB0aGUgb25QYXN0ZV8g
bWV0aG9kLgogKi8KaHRlcm0uU2Nyb2xs
UG9ydC5wcm90b3R5cGUuaGFuZGxlUGFz
dGVUYXJnZXRUZXh0SW5wdXRfID0gZnVu
Y3Rpb24oZSkgewogIGUuc3RvcFByb3Bh
Z2F0aW9uKCk7Cn07CgovKioKICogU2V0
IHRoZSB2ZXJ0aWNhbCBzY3JvbGxiYXIg
bW9kZSBvZiB0aGUgU2Nyb2xsUG9ydC4K
ICovCmh0ZXJtLlNjcm9sbFBvcnQucHJv
dG90eXBlLnNldFNjcm9sbGJhclZpc2li
bGUgPSBmdW5jdGlvbihzdGF0ZSkgewog
IHRoaXMuc2NyZWVuXy5zdHlsZS5vdmVy
Zmxvd1kgPSBzdGF0ZSA/ICdzY3JvbGwn
IDogJ2hpZGRlbic7Cn07CgovKioKICog
U2V0IHNjcm9sbCB3aGVlbCBtdWx0aXBs
aWVyLiBUaGlzIGFsdGVycyBob3cgbXVj
aCB0aGUgc2NyZWVuIHNjcm9sbHMgb24K
ICogbW91c2Ugd2hlZWwgZXZlbnRzLgog
Ki8KaHRlcm0uU2Nyb2xsUG9ydC5wcm90
b3R5cGUuc2V0U2Nyb2xsV2hlZWxNb3Zl
TXVsdGlwbGVyID0gZnVuY3Rpb24obXVs
dGlwbGllcikgewogIHRoaXMuc2Nyb2xs
V2hlZWxNdWx0aXBsaWVyXyA9IG11bHRp
cGxpZXI7Cn07Ci8vIFNPVVJDRSBGSUxF
OiBodGVybS9qcy9odGVybV90ZXJtaW5h
bC5qcwovLyBDb3B5cmlnaHQgKGMpIDIw
MTIgVGhlIENocm9taXVtIE9TIEF1dGhv
cnMuIEFsbCByaWdodHMgcmVzZXJ2ZWQu
Ci8vIFVzZSBvZiB0aGlzIHNvdXJjZSBj
b2RlIGlzIGdvdmVybmVkIGJ5IGEgQlNE
LXN0eWxlIGxpY2Vuc2UgdGhhdCBjYW4g
YmUKLy8gZm91bmQgaW4gdGhlIExJQ0VO
U0UgZmlsZS4KCid1c2Ugc3RyaWN0JzsK
CmxpYi5ydGRlcCgnbGliLmNvbG9ycycs
ICdsaWIuUHJlZmVyZW5jZU1hbmFnZXIn
LCAnbGliLnJlc291cmNlJywgJ2xpYi53
YycsCiAgICAgICAgICAnbGliLmYnLCAn
aHRlcm0uS2V5Ym9hcmQnLCAnaHRlcm0u
T3B0aW9ucycsICdodGVybS5QcmVmZXJl
bmNlTWFuYWdlcicsCiAgICAgICAgICAn
aHRlcm0uU2NyZWVuJywgJ2h0ZXJtLlNj
cm9sbFBvcnQnLCAnaHRlcm0uU2l6ZScs
CiAgICAgICAgICAnaHRlcm0uVGV4dEF0
dHJpYnV0ZXMnLCAnaHRlcm0uVlQnKTsK
Ci8qKgogKiBDb25zdHJ1Y3RvciBmb3Ig
dGhlIFRlcm1pbmFsIGNsYXNzLgogKgog
KiBBIFRlcm1pbmFsIHB1bGxzIHRvZ2V0
aGVyIHRoZSBodGVybS5TY3JvbGxQb3J0
LCBodGVybS5TY3JlZW4gYW5kIGh0ZXJt
LlZUMTAwCiAqIGNsYXNzZXMgdG8gcHJv
dmlkZSB0aGUgY29tcGxldGUgdGVybWlu
YWwgZnVuY3Rpb25hbGl0eS4KICoKICog
VGhlcmUgYXJlIGEgbnVtYmVyIG9mIGxv
d2VyLWxldmVsIFRlcm1pbmFsIG1ldGhv
ZHMgdGhhdCBjYW4gYmUgY2FsbGVkCiAq
IGRpcmVjdGx5IHRvIG1hbmlwdWxhdGUg
dGhlIGN1cnNvciwgdGV4dCwgc2Nyb2xs
IHJlZ2lvbiwgYW5kIG90aGVyIHRlcm1p
bmFsCiAqIGF0dHJpYnV0ZXMuICBIb3dl
dmVyLCB0aGUgcHJpbWFyeSBtZXRob2Qg
aXMgaW50ZXJwcmV0KCksIHdoaWNoIHBh
cnNlcyBWVAogKiBlc2NhcGUgc2VxdWVu
Y2VzIGFuZCBpbnZva2VzIHRoZSBhcHBy
b3ByaWF0ZSBUZXJtaW5hbCBtZXRob2Rz
LgogKgogKiBUaGlzIGNsYXNzIHdhcyBo
ZWF2aWx5IGluZmx1ZW5jZWQgYnkgQ29y
eSBNYWNjYXJyb25lJ3MgRnJhbWVidWZm
ZXIgY2xhc3MuCiAqCiAqIFRPRE8ocmdp
bmRhKTogRXZlbnR1YWxseSB3ZSdyZSBn
b2luZyB0byBuZWVkIHRvIHN1cHBvcnQg
Y2hhcmFjdGVycyB3aGljaCBhcmUKICog
ZGlzcGxheWVkIHR3aWNlIGFzIHdpZGUg
YXMgc3RhbmRhcmQgbGF0aW4gY2hhcmFj
dGVycy4gIFRoaXMgaXMgdG8gc3VwcG9y
dAogKiBDSksgKGFuZCBwb3NzaWJseSBv
dGhlciBjaGFyYWN0ZXIgc2V0cykuCiAq
CiAqIEBwYXJhbSB7c3RyaW5nfSBvcHRf
cHJvZmlsZUlkIE9wdGlvbmFsIHByZWZl
cmVuY2UgcHJvZmlsZSBuYW1lLiAgSWYg
bm90CiAqICAgICBwcm92aWRlZCwgZGVm
YXVsdHMgdG8gJ2RlZmF1bHQnLgogKi8K
aHRlcm0uVGVybWluYWwgPSBmdW5jdGlv
bihvcHRfcHJvZmlsZUlkKSB7CiAgdGhp
cy5wcm9maWxlSWRfID0gbnVsbDsKCiAg
Ly8gVHdvIHNjcmVlbiBpbnN0YW5jZXMu
CiAgdGhpcy5wcmltYXJ5U2NyZWVuXyA9
IG5ldyBodGVybS5TY3JlZW4oKTsKICB0
aGlzLmFsdGVybmF0ZVNjcmVlbl8gPSBu
ZXcgaHRlcm0uU2NyZWVuKCk7CgogIC8v
IFRoZSAiY3VycmVudCIgc2NyZWVuLgog
IHRoaXMuc2NyZWVuXyA9IHRoaXMucHJp
bWFyeVNjcmVlbl87CgogIC8vIFRoZSBs
b2NhbCBub3Rpb24gb2YgdGhlIHNjcmVl
biBzaXplLiAgU2NyZWVuQnVmZmVycyBh
bHNvIGhhdmUgYSBzaXplIHdoaWNoCiAg
Ly8gaW5kaWNhdGVzIHRoZWlyIHByZXNl
bnQgc2l6ZS4gIER1cmluZyBzaXplIGNo
YW5nZXMsIHRoZSB0d28gbWF5IGRpc2Fn
cmVlLgogIC8vIEFsc28sIHRoZSBpbmFj
dGl2ZSBzY3JlZW4ncyBzaXplIGlzIG5v
dCBhbHRlcmVkIHVudGlsIGl0IGlzIG1h
ZGUgdGhlIGFjdGl2ZQogIC8vIHNjcmVl
bi4KICB0aGlzLnNjcmVlblNpemUgPSBu
ZXcgaHRlcm0uU2l6ZSgwLCAwKTsKCiAg
Ly8gVGhlIHNjcm9sbCBwb3J0IHdlJ2xs
IGJlIHVzaW5nIHRvIGRpc3BsYXkgdGhl
IHZpc2libGUgcm93cy4KICB0aGlzLnNj
cm9sbFBvcnRfID0gbmV3IGh0ZXJtLlNj
cm9sbFBvcnQodGhpcyk7CiAgdGhpcy5z
Y3JvbGxQb3J0Xy5zdWJzY3JpYmUoJ3Jl
c2l6ZScsIHRoaXMub25SZXNpemVfLmJp
bmQodGhpcykpOwogIHRoaXMuc2Nyb2xs
UG9ydF8uc3Vic2NyaWJlKCdzY3JvbGwn
LCB0aGlzLm9uU2Nyb2xsXy5iaW5kKHRo
aXMpKTsKICB0aGlzLnNjcm9sbFBvcnRf
LnN1YnNjcmliZSgncGFzdGUnLCB0aGlz
Lm9uUGFzdGVfLmJpbmQodGhpcykpOwog
IHRoaXMuc2Nyb2xsUG9ydF8ub25Db3B5
ID0gdGhpcy5vbkNvcHlfLmJpbmQodGhp
cyk7CgogIC8vIFRoZSBkaXYgdGhhdCBj
b250YWlucyB0aGlzIHRlcm1pbmFsLgog
IHRoaXMuZGl2XyA9IG51bGw7CgogIC8v
IFRoZSBkb2N1bWVudCB0aGF0IGNvbnRh
aW5zIHRoZSBzY3JvbGxQb3J0LiAgRGVm
YXVsdGVkIHRvIHRoZSBnbG9iYWwKICAv
LyBkb2N1bWVudCBoZXJlIHNvIHRoYXQg
dGhlIHRlcm1pbmFsIGlzIGZ1bmN0aW9u
YWwgZXZlbiBpZiBpdCBoYXNuJ3QgYmVl
bgogIC8vIGluc2VydGVkIGludG8gYSBk
b2N1bWVudCB5ZXQsIGJ1dCByZS1zZXQg
aW4gZGVjb3JhdGUoKS4KICB0aGlzLmRv
Y3VtZW50XyA9IHdpbmRvdy5kb2N1bWVu
dDsKCiAgLy8gVGhlIHJvd3MgdGhhdCBo
YXZlIHNjcm9sbGVkIG9mZiBzY3JlZW4g
YW5kIGFyZSBubyBsb25nZXIgYWRkcmVz
c2FibGUuCiAgdGhpcy5zY3JvbGxiYWNr
Um93c18gPSBbXTsKCiAgLy8gU2F2ZWQg
dGFiIHN0b3BzLgogIHRoaXMudGFiU3Rv
cHNfID0gW107CgogIC8vIEtlZXAgdHJh
Y2sgb2Ygd2hldGhlciBkZWZhdWx0IHRh
YiBzdG9wcyBoYXZlIGJlZW4gZXJhc2Vk
OyBhZnRlciBhIFRCQwogIC8vIGNsZWFy
cyBhbGwgdGFiIHN0b3BzLCBkZWZhdWx0
cyBhcmVuJ3QgcmVzdG9yZWQgb24gcmVz
aXplIHVudGlsIGEgcmVzZXQuCiAgdGhp
cy5kZWZhdWx0VGFiU3RvcHMgPSB0cnVl
OwoKICAvLyBUaGUgVlQncyBub3Rpb24g
b2YgdGhlIHRvcCBhbmQgYm90dG9tIHJv
d3MuICBVc2VkIGR1cmluZyBzb21lIFZU
CiAgLy8gY3Vyc29yIHBvc2l0aW9uaW5n
IGFuZCBzY3JvbGxpbmcgY29tbWFuZHMu
CiAgdGhpcy52dFNjcm9sbFRvcF8gPSBu
dWxsOwogIHRoaXMudnRTY3JvbGxCb3R0
b21fID0gbnVsbDsKCiAgLy8gVGhlIERJ
ViBlbGVtZW50IGZvciB0aGUgdmlzaWJs
ZSBjdXJzb3IuCiAgdGhpcy5jdXJzb3JO
b2RlXyA9IG51bGw7CgogIC8vIFRoZSBj
dXJyZW50IGN1cnNvciBzaGFwZSBvZiB0
aGUgdGVybWluYWwuCiAgdGhpcy5jdXJz
b3JTaGFwZV8gPSBodGVybS5UZXJtaW5h
bC5jdXJzb3JTaGFwZS5CTE9DSzsKCiAg
Ly8gVGhlIGN1cnJlbnQgY29sb3Igb2Yg
dGhlIGN1cnNvci4KICB0aGlzLmN1cnNv
ckNvbG9yXyA9IG51bGw7CgogIC8vIEN1
cnNvciBibGluayBvbi9vZmYgY3ljbGUg
aW4gbXMsIG92ZXJ3cml0dGVuIGJ5IHBy
ZWZzIG9uY2UgdGhleSdyZSBsb2FkZWQu
CiAgdGhpcy5jdXJzb3JCbGlua0N5Y2xl
XyA9IFsxMDAsIDEwMF07CgogIC8vIFBy
ZS1ib3VuZCBvbkN1cnNvckJsaW5rXyBo
YW5kbGVyLCBzbyB3ZSBkb24ndCBoYXZl
IHRvIGRvIHRoaXMgZm9yIGVhY2gKICAv
LyBjdXJzb3Igb24vb2ZmIHNlcnZpY2lu
Zy4KICB0aGlzLm15T25DdXJzb3JCbGlu
a18gPSB0aGlzLm9uQ3Vyc29yQmxpbmtf
LmJpbmQodGhpcyk7CgogIC8vIFRoZXNl
IHByZWZzIGFyZSBjYWNoZWQgc28gd2Ug
ZG9uJ3QgaGF2ZSB0byByZWFkIGZyb20g
bG9jYWwgc3RvcmFnZSB3aXRoCiAgLy8g
ZWFjaCBvdXRwdXQgYW5kIGtleXN0cm9r
ZS4gIFRoZXkgYXJlIGluaXRpYWxpemVk
IGJ5IHRoZSBwcmVmZXJlbmNlIG1hbmFn
ZXIuCiAgdGhpcy5iYWNrZ3JvdW5kQ29s
b3JfID0gbnVsbDsKICB0aGlzLmZvcmVn
cm91bmRDb2xvcl8gPSBudWxsOwogIHRo
aXMuc2Nyb2xsT25PdXRwdXRfID0gbnVs
bDsKICB0aGlzLnNjcm9sbE9uS2V5c3Ry
b2tlXyA9IG51bGw7CgogIC8vIFRydWUg
aWYgd2Ugc2hvdWxkIHNlbmQgbW91c2Ug
ZXZlbnRzIHRvIHRoZSB2dCwgZmFsc2Ug
aWYgd2Ugd2FudCB0aGVtCiAgLy8gdG8g
bWFuYWdlIHRoZSBsb2NhbCB0ZXh0IHNl
bGVjdGlvbi4KICB0aGlzLnJlcG9ydE1v
dXNlRXZlbnRzXyA9IGZhbHNlOwoKICAv
LyBUZXJtaW5hbCBiZWxsIHNvdW5kLgog
IHRoaXMuYmVsbEF1ZGlvXyA9IHRoaXMu
ZG9jdW1lbnRfLmNyZWF0ZUVsZW1lbnQo
J2F1ZGlvJyk7CiAgdGhpcy5iZWxsQXVk
aW9fLnNldEF0dHJpYnV0ZSgncHJlbG9h
ZCcsICdhdXRvJyk7CgogIC8vIEFsbCB0
ZXJtaW5hbCBiZWxsIG5vdGlmaWNhdGlv
bnMgdGhhdCBoYXZlIGJlZW4gZ2VuZXJh
dGVkIChub3QgbmVjZXNzYXJpbHkKICAv
LyBzaG93bikuCiAgdGhpcy5iZWxsTm90
aWZpY2F0aW9uTGlzdF8gPSBbXTsKCiAg
Ly8gV2hldGhlciB3ZSBoYXZlIHBlcm1p
c3Npb24gdG8gZGlzcGxheSBub3RpZmlj
YXRpb25zLgogIHRoaXMuZGVza3RvcE5v
dGlmaWNhdGlvbkJlbGxfID0gZmFsc2U7
CgogIC8vIEN1cnNvciBwb3NpdGlvbiBh
bmQgYXR0cmlidXRlcyBzYXZlZCB3aXRo
IERFQ1NDLgogIHRoaXMuc2F2ZWRPcHRp
b25zXyA9IHt9OwoKICAvLyBUaGUgY3Vy
cmVudCBtb2RlIGJpdHMgZm9yIHRoZSB0
ZXJtaW5hbC4KICB0aGlzLm9wdGlvbnNf
ID0gbmV3IGh0ZXJtLk9wdGlvbnMoKTsK
CiAgLy8gVGltZW91dHMgd2UgbWlnaHQg
bmVlZCB0byBjbGVhci4KICB0aGlzLnRp
bWVvdXRzXyA9IHt9OwoKICAvLyBUaGUg
VlQgZXNjYXBlIHNlcXVlbmNlIGludGVy
cHJldGVyLgogIHRoaXMudnQgPSBuZXcg
aHRlcm0uVlQodGhpcyk7CgogIC8vIFRo
ZSBrZXlib2FyZCBoYW5kZXIuCiAgdGhp
cy5rZXlib2FyZCA9IG5ldyBodGVybS5L
ZXlib2FyZCh0aGlzKTsKCiAgLy8gR2Vu
ZXJhbCBJTyBpbnRlcmZhY2UgdGhhdCBj
YW4gYmUgZ2l2ZW4gdG8gdGhpcmQgcGFy
dGllcyB3aXRob3V0IGV4cG9zaW5nCiAg
Ly8gdGhlIGVudGlyZSB0ZXJtaW5hbCBv
YmplY3QuCiAgdGhpcy5pbyA9IG5ldyBo
dGVybS5UZXJtaW5hbC5JTyh0aGlzKTsK
CiAgLy8gVHJ1ZSBpZiBtb3VzZS1jbGlj
ay1kcmFnIHNob3VsZCBzY3JvbGwgdGhl
IHRlcm1pbmFsLgogIHRoaXMuZW5hYmxl
TW91c2VEcmFnU2Nyb2xsID0gdHJ1ZTsK
CiAgdGhpcy5jb3B5T25TZWxlY3QgPSBu
dWxsOwogIHRoaXMubW91c2VQYXN0ZUJ1
dHRvbiA9IG51bGw7CgogIC8vIFdoZXRo
ZXIgdG8gdXNlIHRoZSBkZWZhdWx0IHdp
bmRvdyBjb3B5IGJlaGF2aW91ci4KICB0
aGlzLnVzZURlZmF1bHRXaW5kb3dDb3B5
ID0gZmFsc2U7CgogIHRoaXMuY2xlYXJT
ZWxlY3Rpb25BZnRlckNvcHkgPSB0cnVl
OwoKICB0aGlzLnJlYWxpemVTaXplXyg4
MCwgMjQpOwogIHRoaXMuc2V0RGVmYXVs
dFRhYlN0b3BzKCk7CgogIHRoaXMuc2V0
UHJvZmlsZShvcHRfcHJvZmlsZUlkIHx8
ICdkZWZhdWx0JywKICAgICAgICAgICAg
ICAgICAgZnVuY3Rpb24oKSB7IHRoaXMu
b25UZXJtaW5hbFJlYWR5KCkgfS5iaW5k
KHRoaXMpKTsKfTsKCi8qKgogKiBQb3Nz
aWJsZSBjdXJzb3Igc2hhcGVzLgogKi8K
aHRlcm0uVGVybWluYWwuY3Vyc29yU2hh
cGUgPSB7CiAgQkxPQ0s6ICdCTE9DSycs
CiAgQkVBTTogJ0JFQU0nLAogIFVOREVS
TElORTogJ1VOREVSTElORScKfTsKCi8q
KgogKiBDbGllbnRzIHNob3VsZCBvdmVy
cmlkZSB0aGlzIHRvIGJlIG5vdGlmaWVk
IHdoZW4gdGhlIHRlcm1pbmFsIGlzIHJl
YWR5CiAqIGZvciB1c2UuCiAqCiAqIFRo
ZSB0ZXJtaW5hbCBpbml0aWFsaXphdGlv
biBpcyBhc3luY2hyb25vdXMsIGFuZCBz
aG91bGRuJ3QgYmUgdXNlZCBiZWZvcmUK
ICogdGhpcyBtZXRob2QgaXMgY2FsbGVk
LgogKi8KaHRlcm0uVGVybWluYWwucHJv
dG90eXBlLm9uVGVybWluYWxSZWFkeSA9
IGZ1bmN0aW9uKCkgeyB9OwoKLyoqCiAq
IERlZmF1bHQgdGFiIHdpdGggb2YgOCB0
byBtYXRjaCB4dGVybS4KICovCmh0ZXJt
LlRlcm1pbmFsLnByb3RvdHlwZS50YWJX
aWR0aCA9IDg7CgovKioKICogU2VsZWN0
IGEgcHJlZmVyZW5jZSBwcm9maWxlLgog
KgogKiBUaGlzIHdpbGwgbG9hZCB0aGUg
dGVybWluYWwgcHJlZmVyZW5jZXMgZm9y
IHRoZSBnaXZlbiBwcm9maWxlIG5hbWUg
YW5kCiAqIGFzc29jaWF0ZSBzdWJzZXF1
ZW50IHByZWZlcmVuY2UgY2hhbmdlcyB3
aXRoIHRoZSBuZXcgcHJlZmVyZW5jZSBw
cm9maWxlLgogKgogKiBAcGFyYW0ge3N0
cmluZ30gbmV3TmFtZSBUaGUgbmFtZSBv
ZiB0aGUgcHJlZmVyZW5jZSBwcm9maWxl
LiAgRm9yd2FyZCBzbGFzaAogKiAgICAg
Y2hhcmFjdGVycyB3aWxsIGJlIHJlbW92
ZWQgZnJvbSB0aGUgbmFtZS4KICogQHBh
cmFtIHtmdW5jdGlvbn0gb3B0X2NhbGxi
YWNrIE9wdGlvbmFsIGNhbGxiYWNrIHRv
IGludm9rZSB3aGVuIHRoZSBwcm9maWxl
CiAqICAgICB0cmFuc2l0aW9uIGlzIGNv
bXBsZXRlLgogKi8KaHRlcm0uVGVybWlu
YWwucHJvdG90eXBlLnNldFByb2ZpbGUg
PSBmdW5jdGlvbihwcm9maWxlSWQsIG9w
dF9jYWxsYmFjaykgewogIHRoaXMucHJv
ZmlsZUlkXyA9IHByb2ZpbGVJZC5yZXBs
YWNlKC9cLy9nLCAnJyk7CgogIHZhciB0
ZXJtaW5hbCA9IHRoaXM7CgogIGlmICh0
aGlzLnByZWZzXykKICAgIHRoaXMucHJl
ZnNfLmRlYWN0aXZhdGUoKTsKCiAgdGhp
cy5wcmVmc18gPSBuZXcgaHRlcm0uUHJl
ZmVyZW5jZU1hbmFnZXIodGhpcy5wcm9m
aWxlSWRfKTsKICB0aGlzLnByZWZzXy5h
ZGRPYnNlcnZlcnMobnVsbCwgewogICAg
J2FsdC1nci1tb2RlJzogZnVuY3Rpb24o
dikgewogICAgICBpZiAodiA9PSBudWxs
KSB7CiAgICAgICAgaWYgKG5hdmlnYXRv
ci5sYW5ndWFnZS50b0xvd2VyQ2FzZSgp
ID09ICdlbi11cycpIHsKICAgICAgICAg
IHYgPSAnbm9uZSc7CiAgICAgICAgfSBl
bHNlIHsKICAgICAgICAgIHYgPSAncmln
aHQtYWx0JzsKICAgICAgICB9CiAgICAg
IH0gZWxzZSBpZiAodHlwZW9mIHYgPT0g
J3N0cmluZycpIHsKICAgICAgICB2ID0g
di50b0xvd2VyQ2FzZSgpOwogICAgICB9
IGVsc2UgewogICAgICAgIHYgPSAnbm9u
ZSc7CiAgICAgIH0KCiAgICAgIGlmICgh
L14obm9uZXxjdHJsLWFsdHxsZWZ0LWFs
dHxyaWdodC1hbHQpJC8udGVzdCh2KSkK
ICAgICAgICB2ID0gJ25vbmUnOwoKICAg
ICAgdGVybWluYWwua2V5Ym9hcmQuYWx0
R3JNb2RlID0gdjsKICAgIH0sCgogICAg
J2FsdC1iYWNrc3BhY2UtaXMtbWV0YS1i
YWNrc3BhY2UnOiBmdW5jdGlvbih2KSB7
CiAgICAgIHRlcm1pbmFsLmtleWJvYXJk
LmFsdEJhY2tzcGFjZUlzTWV0YUJhY2tz
cGFjZSA9IHY7CiAgICB9LAoKICAgICdh
bHQtaXMtbWV0YSc6IGZ1bmN0aW9uKHYp
IHsKICAgICAgdGVybWluYWwua2V5Ym9h
cmQuYWx0SXNNZXRhID0gdjsKICAgIH0s
CgogICAgJ2FsdC1zZW5kcy13aGF0Jzog
ZnVuY3Rpb24odikgewogICAgICBpZiAo
IS9eKGVzY2FwZXw4LWJpdHxicm93c2Vy
LWtleSkkLy50ZXN0KHYpKQogICAgICAg
IHYgPSAnZXNjYXBlJzsKCiAgICAgIHRl
cm1pbmFsLmtleWJvYXJkLmFsdFNlbmRz
V2hhdCA9IHY7CiAgICB9LAoKICAgICdh
dWRpYmxlLWJlbGwtc291bmQnOiBmdW5j
dGlvbih2KSB7CiAgICAgIHZhciBhcnkg
PSB2Lm1hdGNoKC9ebGliLXJlc291cmNl
OihcUyspLyk7CiAgICAgIGlmIChhcnkp
IHsKICAgICAgICB0ZXJtaW5hbC5iZWxs
QXVkaW9fLnNldEF0dHJpYnV0ZSgnc3Jj
JywKICAgICAgICAgICAgICAgICAgICAg
ICAgICAgICAgICAgICAgICAgICBsaWIu
cmVzb3VyY2UuZ2V0RGF0YVVybChhcnlb
MV0pKTsKICAgICAgfSBlbHNlIHsKICAg
ICAgICB0ZXJtaW5hbC5iZWxsQXVkaW9f
LnNldEF0dHJpYnV0ZSgnc3JjJywgdik7
CiAgICAgIH0KICAgIH0sCgogICAgJ2Rl
c2t0b3Atbm90aWZpY2F0aW9uLWJlbGwn
OiBmdW5jdGlvbih2KSB7CiAgICAgIGlm
ICh2ICYmIE5vdGlmaWNhdGlvbikgewog
ICAgICAgIHRlcm1pbmFsLmRlc2t0b3BO
b3RpZmljYXRpb25CZWxsXyA9CiAgICAg
ICAgICAgIE5vdGlmaWNhdGlvbi5wZXJt
aXNzaW9uID09PSAnZ3JhbnRlZCc7CiAg
ICAgICAgaWYgKCF0ZXJtaW5hbC5kZXNr
dG9wTm90aWZpY2F0aW9uQmVsbF8pIHsK
ICAgICAgICAgIC8vIE5vdGU6IFdlIGRv
bid0IGNhbGwgTm90aWZpY2F0aW9uLnJl
cXVlc3RQZXJtaXNzaW9uIGhlcmUgYmVj
YXVzZQogICAgICAgICAgLy8gQ2hyb21l
IHJlcXVpcmVzIHRoZSBjYWxsIGJlIHRo
ZSByZXN1bHQgb2YgYSB1c2VyIGFjdGlv
biAoc3VjaCBhcyBhbgogICAgICAgICAg
Ly8gb25jbGljayBoYW5kbGVyKSwgYW5k
IHByZWYgbGlzdGVuZXJzIGFyZSBydW4g
YXN5bmNocm9ub3VzbHkuCiAgICAgICAg
ICAvLwogICAgICAgICAgLy8gQSB3YXkg
b2Ygd29ya2luZyBhcm91bmQgdGhpcyB3
b3VsZCBiZSB0byBkaXNwbGF5IGEgZGlh
bG9nIGluIHRoZQogICAgICAgICAgLy8g
dGVybWluYWwgd2l0aCBhICJjbGljay10
by1yZXF1ZXN0LXBlcm1pc3Npb24iIGJ1
dHRvbi4KICAgICAgICAgIGNvbnNvbGUu
d2FybignZGVza3RvcC1ub3RpZmljYXRp
b24tYmVsbCBpcyB0cnVlIGJ1dCB3ZSBk
byBub3QgaGF2ZSAnICsKICAgICAgICAg
ICAgICAgICAgICAgICAncGVybWlzc2lv
biB0byBkaXNwbGF5IG5vdGlmaWNhdGlv
bnMuJyk7CiAgICAgICAgfQogICAgICB9
IGVsc2UgewogICAgICAgIHRlcm1pbmFs
LmRlc2t0b3BOb3RpZmljYXRpb25CZWxs
XyA9IGZhbHNlOwogICAgICB9CiAgICB9
LAoKICAgICdiYWNrZ3JvdW5kLWNvbG9y
JzogZnVuY3Rpb24odikgewogICAgICB0
ZXJtaW5hbC5zZXRCYWNrZ3JvdW5kQ29s
b3Iodik7CiAgICB9LAoKICAgICdiYWNr
Z3JvdW5kLWltYWdlJzogZnVuY3Rpb24o
dikgewogICAgICB0ZXJtaW5hbC5zY3Jv
bGxQb3J0Xy5zZXRCYWNrZ3JvdW5kSW1h
Z2Uodik7CiAgICB9LAoKICAgICdiYWNr
Z3JvdW5kLXNpemUnOiBmdW5jdGlvbih2
KSB7CiAgICAgIHRlcm1pbmFsLnNjcm9s
bFBvcnRfLnNldEJhY2tncm91bmRTaXpl
KHYpOwogICAgfSwKCiAgICAnYmFja2dy
b3VuZC1wb3NpdGlvbic6IGZ1bmN0aW9u
KHYpIHsKICAgICAgdGVybWluYWwuc2Ny
b2xsUG9ydF8uc2V0QmFja2dyb3VuZFBv
c2l0aW9uKHYpOwogICAgfSwKCiAgICAn
YmFja3NwYWNlLXNlbmRzLWJhY2tzcGFj
ZSc6IGZ1bmN0aW9uKHYpIHsKICAgICAg
dGVybWluYWwua2V5Ym9hcmQuYmFja3Nw
YWNlU2VuZHNCYWNrc3BhY2UgPSB2Owog
ICAgfSwKCiAgICAnY2hhcmFjdGVyLW1h
cC1vdmVycmlkZXMnOiBmdW5jdGlvbih2
KSB7CiAgICAgIGlmICghKHYgPT0gbnVs
bCB8fCB2IGluc3RhbmNlb2YgT2JqZWN0
KSkgewogICAgICAgIGNvbnNvbGUud2Fy
bignUHJlZmVyZW5jZSBjaGFyYWN0ZXIt
bWFwLW1vZGlmaWNhdGlvbnMgaXMgbm90
IGFuICcgKwogICAgICAgICAgICAgICAg
ICAgICAnb2JqZWN0OiAnICsgdik7CiAg
ICAgICAgcmV0dXJuOwogICAgICB9Cgog
ICAgICBmb3IgKHZhciBjb2RlIGluIHYp
IHsKICAgICAgICB2YXIgZ2xtYXAgPSBo
dGVybS5WVC5DaGFyYWN0ZXJNYXAubWFw
c1tjb2RlXS5nbG1hcDsKICAgICAgICBm
b3IgKHZhciByZWNlaXZlZCBpbiB2W2Nv
ZGVdKSB7CiAgICAgICAgICBnbG1hcFty
ZWNlaXZlZF0gPSB2W2NvZGVdW3JlY2Vp
dmVkXTsKICAgICAgICB9CiAgICAgICAg
aHRlcm0uVlQuQ2hhcmFjdGVyTWFwLm1h
cHNbY29kZV0ucmVzZXQoZ2xtYXApOwog
ICAgICB9CiAgICB9LAoKICAgICdjdXJz
b3ItYmxpbmsnOiBmdW5jdGlvbih2KSB7
CiAgICAgIHRlcm1pbmFsLnNldEN1cnNv
ckJsaW5rKCEhdik7CiAgICB9LAoKICAg
ICdjdXJzb3ItYmxpbmstY3ljbGUnOiBm
dW5jdGlvbih2KSB7CiAgICAgICAgaWYg
KHYgaW5zdGFuY2VvZiBBcnJheSAmJgog
ICAgICAgICAgICB0eXBlb2YgdlswXSA9
PSAnbnVtYmVyJyAmJgogICAgICAgICAg
ICB0eXBlb2YgdlsxXSA9PSAnbnVtYmVy
JykgewogICAgICAgICAgdGVybWluYWwu
Y3Vyc29yQmxpbmtDeWNsZV8gPSB2Owog
ICAgICAgIH0gZWxzZSBpZiAodHlwZW9m
IHYgPT0gJ251bWJlcicpIHsKICAgICAg
ICAgIHRlcm1pbmFsLmN1cnNvckJsaW5r
Q3ljbGVfID0gW3YsIHZdOwogICAgICAg
IH0gZWxzZSB7CiAgICAgICAgICAvLyBG
YXN0IGJsaW5rIGluZGljYXRlcyBhbiBl
cnJvci4KICAgICAgICAgIHRlcm1pbmFs
LmN1cnNvckJsaW5rQ3ljbGVfID0gWzEw
MCwgMTAwXTsKICAgICAgICB9CiAgICB9
LAoKICAgICdjdXJzb3ItY29sb3InOiBm
dW5jdGlvbih2KSB7CiAgICAgIHRlcm1p
bmFsLnNldEN1cnNvckNvbG9yKHYpOwog
ICAgfSwKCiAgICAnY29sb3ItcGFsZXR0
ZS1vdmVycmlkZXMnOiBmdW5jdGlvbih2
KSB7CiAgICAgIGlmICghKHYgPT0gbnVs
bCB8fCB2IGluc3RhbmNlb2YgT2JqZWN0
IHx8IHYgaW5zdGFuY2VvZiBBcnJheSkp
IHsKICAgICAgICBjb25zb2xlLndhcm4o
J1ByZWZlcmVuY2UgY29sb3ItcGFsZXR0
ZS1vdmVycmlkZXMgaXMgbm90IGFuIGFy
cmF5IG9yICcgKwogICAgICAgICAgICAg
ICAgICAgICAnb2JqZWN0OiAnICsgdik7
CiAgICAgICAgcmV0dXJuOwogICAgICB9
CgogICAgICBsaWIuY29sb3JzLmNvbG9y
UGFsZXR0ZSA9IGxpYi5jb2xvcnMuc3Rv
Y2tDb2xvclBhbGV0dGUuY29uY2F0KCk7
CgogICAgICBpZiAodikgewogICAgICAg
IGZvciAodmFyIGtleSBpbiB2KSB7CiAg
ICAgICAgICB2YXIgaSA9IHBhcnNlSW50
KGtleSk7CiAgICAgICAgICBpZiAoaXNO
YU4oaSkgfHwgaSA8IDAgfHwgaSA+IDI1
NSkgewogICAgICAgICAgICBjb25zb2xl
LmxvZygnSW52YWxpZCB2YWx1ZSBpbiBw
YWxldHRlOiAnICsga2V5ICsgJzogJyAr
IHZba2V5XSk7CiAgICAgICAgICAgIGNv
bnRpbnVlOwogICAgICAgICAgfQoKICAg
ICAgICAgIGlmICh2W2ldKSB7CiAgICAg
ICAgICAgIHZhciByZ2IgPSBsaWIuY29s
b3JzLm5vcm1hbGl6ZUNTUyh2W2ldKTsK
ICAgICAgICAgICAgaWYgKHJnYikKICAg
ICAgICAgICAgICBsaWIuY29sb3JzLmNv
bG9yUGFsZXR0ZVtpXSA9IHJnYjsKICAg
ICAgICAgIH0KICAgICAgICB9CiAgICAg
IH0KCiAgICAgIHRlcm1pbmFsLnByaW1h
cnlTY3JlZW5fLnRleHRBdHRyaWJ1dGVz
LnJlc2V0Q29sb3JQYWxldHRlKCkKICAg
ICAgdGVybWluYWwuYWx0ZXJuYXRlU2Ny
ZWVuXy50ZXh0QXR0cmlidXRlcy5yZXNl
dENvbG9yUGFsZXR0ZSgpOwogICAgfSwK
CiAgICAnY29weS1vbi1zZWxlY3QnOiBm
dW5jdGlvbih2KSB7CiAgICAgIHRlcm1p
bmFsLmNvcHlPblNlbGVjdCA9ICEhdjsK
ICAgIH0sCgogICAgJ3VzZS1kZWZhdWx0
LXdpbmRvdy1jb3B5JzogZnVuY3Rpb24o
dikgewogICAgICB0ZXJtaW5hbC51c2VE
ZWZhdWx0V2luZG93Q29weSA9ICEhdjsK
ICAgIH0sCgogICAgJ2NsZWFyLXNlbGVj
dGlvbi1hZnRlci1jb3B5JzogZnVuY3Rp
b24odikgewogICAgICB0ZXJtaW5hbC5j
bGVhclNlbGVjdGlvbkFmdGVyQ29weSA9
ICEhdjsKICAgIH0sCgogICAgJ2N0cmwt
cGx1cy1taW51cy16ZXJvLXpvb20nOiBm
dW5jdGlvbih2KSB7CiAgICAgIHRlcm1p
bmFsLmtleWJvYXJkLmN0cmxQbHVzTWlu
dXNaZXJvWm9vbSA9IHY7CiAgICB9LAoK
ICAgICdjdHJsLWMtY29weSc6IGZ1bmN0
aW9uKHYpIHsKICAgICAgdGVybWluYWwu
a2V5Ym9hcmQuY3RybENDb3B5ID0gdjsK
ICAgIH0sCgogICAgJ2N0cmwtdi1wYXN0
ZSc6IGZ1bmN0aW9uKHYpIHsKICAgICAg
dGVybWluYWwua2V5Ym9hcmQuY3RybFZQ
YXN0ZSA9IHY7CiAgICAgIHRlcm1pbmFs
LnNjcm9sbFBvcnRfLnNldEN0cmxWUGFz
dGUodik7CiAgICB9LAoKICAgICdlYXN0
LWFzaWFuLWFtYmlndW91cy1hcy10d28t
Y29sdW1uJzogZnVuY3Rpb24odikgewog
ICAgICBsaWIud2MucmVnYXJkQ2prQW1i
aWd1b3VzID0gdjsKICAgIH0sCgogICAg
J2VuYWJsZS04LWJpdC1jb250cm9sJzog
ZnVuY3Rpb24odikgewogICAgICB0ZXJt
aW5hbC52dC5lbmFibGU4Qml0Q29udHJv
bCA9ICEhdjsKICAgIH0sCgogICAgJ2Vu
YWJsZS1ib2xkJzogZnVuY3Rpb24odikg
ewogICAgICB0ZXJtaW5hbC5zeW5jQm9s
ZFNhZmVTdGF0ZSgpOwogICAgfSwKCiAg
ICAnZW5hYmxlLWJvbGQtYXMtYnJpZ2h0
JzogZnVuY3Rpb24odikgewogICAgICB0
ZXJtaW5hbC5wcmltYXJ5U2NyZWVuXy50
ZXh0QXR0cmlidXRlcy5lbmFibGVCb2xk
QXNCcmlnaHQgPSAhIXY7CiAgICAgIHRl
cm1pbmFsLmFsdGVybmF0ZVNjcmVlbl8u
dGV4dEF0dHJpYnV0ZXMuZW5hYmxlQm9s
ZEFzQnJpZ2h0ID0gISF2OwogICAgfSwK
CiAgICAnZW5hYmxlLWNsaXBib2FyZC13
cml0ZSc6IGZ1bmN0aW9uKHYpIHsKICAg
ICAgdGVybWluYWwudnQuZW5hYmxlQ2xp
cGJvYXJkV3JpdGUgPSAhIXY7CiAgICB9
LAoKICAgICdlbmFibGUtZGVjMTInOiBm
dW5jdGlvbih2KSB7CiAgICAgIHRlcm1p
bmFsLnZ0LmVuYWJsZURlYzEyID0gISF2
OwogICAgfSwKCiAgICAnZm9udC1mYW1p
bHknOiBmdW5jdGlvbih2KSB7CiAgICAg
IHRlcm1pbmFsLnN5bmNGb250RmFtaWx5
KCk7CiAgICB9LAoKICAgICdmb250LXNp
emUnOiBmdW5jdGlvbih2KSB7CiAgICAg
IHRlcm1pbmFsLnNldEZvbnRTaXplKHYp
OwogICAgfSwKCiAgICAnZm9udC1zbW9v
dGhpbmcnOiBmdW5jdGlvbih2KSB7CiAg
ICAgIHRlcm1pbmFsLnN5bmNGb250RmFt
aWx5KCk7CiAgICB9LAoKICAgICdmb3Jl
Z3JvdW5kLWNvbG9yJzogZnVuY3Rpb24o
dikgewogICAgICB0ZXJtaW5hbC5zZXRG
b3JlZ3JvdW5kQ29sb3Iodik7CiAgICB9
LAoKICAgICdob21lLWtleXMtc2Nyb2xs
JzogZnVuY3Rpb24odikgewogICAgICB0
ZXJtaW5hbC5rZXlib2FyZC5ob21lS2V5
c1Njcm9sbCA9IHY7CiAgICB9LAoKICAg
ICdtYXgtc3RyaW5nLXNlcXVlbmNlJzog
ZnVuY3Rpb24odikgewogICAgICB0ZXJt
aW5hbC52dC5tYXhTdHJpbmdTZXF1ZW5j
ZSA9IHY7CiAgICB9LAoKICAgICdtZWRp
YS1rZXlzLWFyZS1ma2V5cyc6IGZ1bmN0
aW9uKHYpIHsKICAgICAgdGVybWluYWwu
a2V5Ym9hcmQubWVkaWFLZXlzQXJlRktl
eXMgPSB2OwogICAgfSwKCiAgICAnbWV0
YS1zZW5kcy1lc2NhcGUnOiBmdW5jdGlv
bih2KSB7CiAgICAgIHRlcm1pbmFsLmtl
eWJvYXJkLm1ldGFTZW5kc0VzY2FwZSA9
IHY7CiAgICB9LAoKICAgICdtb3VzZS1w
YXN0ZS1idXR0b24nOiBmdW5jdGlvbih2
KSB7CiAgICAgIHRlcm1pbmFsLnN5bmNN
b3VzZVBhc3RlQnV0dG9uKCk7CiAgICB9
LAoKICAgICdwYWdlLWtleXMtc2Nyb2xs
JzogZnVuY3Rpb24odikgewogICAgICB0
ZXJtaW5hbC5rZXlib2FyZC5wYWdlS2V5
c1Njcm9sbCA9IHY7CiAgICB9LAoKICAg
ICdwYXNzLWFsdC1udW1iZXInOiBmdW5j
dGlvbih2KSB7CiAgICAgIGlmICh2ID09
IG51bGwpIHsKICAgICAgICB2YXIgb3N4
ID0gd2luZG93Lm5hdmlnYXRvci51c2Vy
QWdlbnQubWF0Y2goL01hYyBPUyBYLyk7
CgogICAgICAgIC8vIExldCBBbHQtMS4u
OSBwYXNzIHRvIHRoZSBicm93c2VyICh0
byBjb250cm9sIHRhYiBzd2l0Y2hpbmcp
IG9uCiAgICAgICAgLy8gbm9uLU9TIFgg
c3lzdGVtcywgb3IgaWYgaHRlcm0gaXMg
bm90IG9wZW5lZCBpbiBhbiBhcHAgd2lu
ZG93LgogICAgICAgIHYgPSAoIW9zeCAm
JiBodGVybS53aW5kb3dUeXBlICE9ICdw
b3B1cCcpOwogICAgICB9CgogICAgICB0
ZXJtaW5hbC5wYXNzQWx0TnVtYmVyID0g
djsKICAgIH0sCgogICAgJ3Bhc3MtY3Ry
bC1udW1iZXInOiBmdW5jdGlvbih2KSB7
CiAgICAgIGlmICh2ID09IG51bGwpIHsK
ICAgICAgICB2YXIgb3N4ID0gd2luZG93
Lm5hdmlnYXRvci51c2VyQWdlbnQubWF0
Y2goL01hYyBPUyBYLyk7CgogICAgICAg
IC8vIExldCBDdHJsLTEuLjkgcGFzcyB0
byB0aGUgYnJvd3NlciAodG8gY29udHJv
bCB0YWIgc3dpdGNoaW5nKSBvbgogICAg
ICAgIC8vIG5vbi1PUyBYIHN5c3RlbXMs
IG9yIGlmIGh0ZXJtIGlzIG5vdCBvcGVu
ZWQgaW4gYW4gYXBwIHdpbmRvdy4KICAg
ICAgICB2ID0gKCFvc3ggJiYgaHRlcm0u
d2luZG93VHlwZSAhPSAncG9wdXAnKTsK
ICAgICAgfQoKICAgICAgdGVybWluYWwu
cGFzc0N0cmxOdW1iZXIgPSB2OwogICAg
fSwKCiAgICAncGFzcy1tZXRhLW51bWJl
cic6IGZ1bmN0aW9uKHYpIHsKICAgICAg
aWYgKHYgPT0gbnVsbCkgewogICAgICAg
IHZhciBvc3ggPSB3aW5kb3cubmF2aWdh
dG9yLnVzZXJBZ2VudC5tYXRjaCgvTWFj
IE9TIFgvKTsKCiAgICAgICAgLy8gTGV0
IE1ldGEtMS4uOSBwYXNzIHRvIHRoZSBi
cm93c2VyICh0byBjb250cm9sIHRhYiBz
d2l0Y2hpbmcpIG9uCiAgICAgICAgLy8g
T1MgWCBzeXN0ZW1zLCBvciBpZiBodGVy
bSBpcyBub3Qgb3BlbmVkIGluIGFuIGFw
cCB3aW5kb3cuCiAgICAgICAgdiA9IChv
c3ggJiYgaHRlcm0ud2luZG93VHlwZSAh
PSAncG9wdXAnKTsKICAgICAgfQoKICAg
ICAgdGVybWluYWwucGFzc01ldGFOdW1i
ZXIgPSB2OwogICAgfSwKCiAgICAncGFz
cy1tZXRhLXYnOiBmdW5jdGlvbih2KSB7
CiAgICAgIHRlcm1pbmFsLmtleWJvYXJk
LnBhc3NNZXRhViA9IHY7CiAgICB9LAoK
ICAgICdyZWNlaXZlLWVuY29kaW5nJzog
ZnVuY3Rpb24odikgewogICAgICAgaWYg
KCEoL14odXRmLTh8cmF3KSQvKS50ZXN0
KHYpKSB7CiAgICAgICAgIGNvbnNvbGUu
d2FybignSW52YWxpZCB2YWx1ZSBmb3Ig
InJlY2VpdmUtZW5jb2RpbmciOiAnICsg
dik7CiAgICAgICAgIHYgPSAndXRmLTgn
OwogICAgICAgfQoKICAgICAgIHRlcm1p
bmFsLnZ0LmNoYXJhY3RlckVuY29kaW5n
ID0gdjsKICAgIH0sCgogICAgJ3Njcm9s
bC1vbi1rZXlzdHJva2UnOiBmdW5jdGlv
bih2KSB7CiAgICAgIHRlcm1pbmFsLnNj
cm9sbE9uS2V5c3Ryb2tlXyA9IHY7CiAg
ICB9LAoKICAgICdzY3JvbGwtb24tb3V0
cHV0JzogZnVuY3Rpb24odikgewogICAg
ICB0ZXJtaW5hbC5zY3JvbGxPbk91dHB1
dF8gPSB2OwogICAgfSwKCiAgICAnc2Ny
b2xsYmFyLXZpc2libGUnOiBmdW5jdGlv
bih2KSB7CiAgICAgIHRlcm1pbmFsLnNl
dFNjcm9sbGJhclZpc2libGUodik7CiAg
ICB9LAoKICAgICdzY3JvbGwtd2hlZWwt
bW92ZS1tdWx0aXBsaWVyJzogZnVuY3Rp
b24odikgewogICAgICB0ZXJtaW5hbC5z
ZXRTY3JvbGxXaGVlbE1vdmVNdWx0aXBs
ZXIodik7CiAgICB9LAoKICAgICdzZW5k
LWVuY29kaW5nJzogZnVuY3Rpb24odikg
ewogICAgICAgaWYgKCEoL14odXRmLTh8
cmF3KSQvKS50ZXN0KHYpKSB7CiAgICAg
ICAgIGNvbnNvbGUud2FybignSW52YWxp
ZCB2YWx1ZSBmb3IgInNlbmQtZW5jb2Rp
bmciOiAnICsgdik7CiAgICAgICAgIHYg
PSAndXRmLTgnOwogICAgICAgfQoKICAg
ICAgIHRlcm1pbmFsLmtleWJvYXJkLmNo
YXJhY3RlckVuY29kaW5nID0gdjsKICAg
IH0sCgogICAgJ3NoaWZ0LWluc2VydC1w
YXN0ZSc6IGZ1bmN0aW9uKHYpIHsKICAg
ICAgdGVybWluYWwua2V5Ym9hcmQuc2hp
ZnRJbnNlcnRQYXN0ZSA9IHY7CiAgICB9
LAoKICAgICd1c2VyLWNzcyc6IGZ1bmN0
aW9uKHYpIHsKICAgICAgdGVybWluYWwu
c2Nyb2xsUG9ydF8uc2V0VXNlckNzcyh2
KTsKICAgIH0KICB9KTsKCiAgdGhpcy5w
cmVmc18ucmVhZFN0b3JhZ2UoZnVuY3Rp
b24oKSB7CiAgICB0aGlzLnByZWZzXy5u
b3RpZnlBbGwoKTsKCiAgICBpZiAob3B0
X2NhbGxiYWNrKQogICAgICBvcHRfY2Fs
bGJhY2soKTsKICB9LmJpbmQodGhpcykp
Owp9OwoKCi8qKgogKiBSZXR1cm5zIHRo
ZSBwcmVmZXJlbmNlcyBtYW5hZ2VyIHVz
ZWQgZm9yIGNvbmZpZ3VyaW5nIHRoaXMg
dGVybWluYWwuCiAqLwpodGVybS5UZXJt
aW5hbC5wcm90b3R5cGUuZ2V0UHJlZnMg
PSBmdW5jdGlvbigpIHsKICByZXR1cm4g
dGhpcy5wcmVmc187Cn07CgovKioKICog
RW5hYmxlIG9yIGRpc2FibGUgYnJhY2tl
dGVkIHBhc3RlIG1vZGUuCiAqLwpodGVy
bS5UZXJtaW5hbC5wcm90b3R5cGUuc2V0
QnJhY2tldGVkUGFzdGUgPSBmdW5jdGlv
bihzdGF0ZSkgewogIHRoaXMub3B0aW9u
c18uYnJhY2tldGVkUGFzdGUgPSBzdGF0
ZTsKfTsKCi8qKgogKiBTZXQgdGhlIGNv
bG9yIGZvciB0aGUgY3Vyc29yLgogKgog
KiBJZiB5b3Ugd2FudCB0aGlzIHNldHRp
bmcgdG8gcGVyc2lzdCwgc2V0IGl0IHRo
cm91Z2ggcHJlZnNfLCByYXRoZXIgdGhh
bgogKiB3aXRoIHRoaXMgbWV0aG9kLgog
Ki8KaHRlcm0uVGVybWluYWwucHJvdG90
eXBlLnNldEN1cnNvckNvbG9yID0gZnVu
Y3Rpb24oY29sb3IpIHsKICB0aGlzLmN1
cnNvckNvbG9yXyA9IGNvbG9yOwogIHRo
aXMuY3Vyc29yTm9kZV8uc3R5bGUuYmFj
a2dyb3VuZENvbG9yID0gY29sb3I7CiAg
dGhpcy5jdXJzb3JOb2RlXy5zdHlsZS5i
b3JkZXJDb2xvciA9IGNvbG9yOwp9OwoK
LyoqCiAqIFJldHVybiB0aGUgY3VycmVu
dCBjdXJzb3IgY29sb3IgYXMgYSBzdHJp
bmcuCiAqLwpodGVybS5UZXJtaW5hbC5w
cm90b3R5cGUuZ2V0Q3Vyc29yQ29sb3Ig
PSBmdW5jdGlvbigpIHsKICByZXR1cm4g
dGhpcy5jdXJzb3JDb2xvcl87Cn07Cgov
KioKICogRW5hYmxlIG9yIGRpc2FibGUg
bW91c2UgYmFzZWQgdGV4dCBzZWxlY3Rp
b24gaW4gdGhlIHRlcm1pbmFsLgogKi8K
aHRlcm0uVGVybWluYWwucHJvdG90eXBl
LnNldFNlbGVjdGlvbkVuYWJsZWQgPSBm
dW5jdGlvbihzdGF0ZSkgewogIHRoaXMu
ZW5hYmxlTW91c2VEcmFnU2Nyb2xsID0g
c3RhdGU7Cn07CgovKioKICogU2V0IHRo
ZSBiYWNrZ3JvdW5kIGNvbG9yLgogKgog
KiBJZiB5b3Ugd2FudCB0aGlzIHNldHRp
bmcgdG8gcGVyc2lzdCwgc2V0IGl0IHRo
cm91Z2ggcHJlZnNfLCByYXRoZXIgdGhh
bgogKiB3aXRoIHRoaXMgbWV0aG9kLgog
Ki8KaHRlcm0uVGVybWluYWwucHJvdG90
eXBlLnNldEJhY2tncm91bmRDb2xvciA9
IGZ1bmN0aW9uKGNvbG9yKSB7CiAgdGhp
cy5iYWNrZ3JvdW5kQ29sb3JfID0gbGli
LmNvbG9ycy5ub3JtYWxpemVDU1MoY29s
b3IpOwogIHRoaXMucHJpbWFyeVNjcmVl
bl8udGV4dEF0dHJpYnV0ZXMuc2V0RGVm
YXVsdHMoCiAgICAgIHRoaXMuZm9yZWdy
b3VuZENvbG9yXywgdGhpcy5iYWNrZ3Jv
dW5kQ29sb3JfKTsKICB0aGlzLmFsdGVy
bmF0ZVNjcmVlbl8udGV4dEF0dHJpYnV0
ZXMuc2V0RGVmYXVsdHMoCiAgICAgIHRo
aXMuZm9yZWdyb3VuZENvbG9yXywgdGhp
cy5iYWNrZ3JvdW5kQ29sb3JfKTsKICB0
aGlzLnNjcm9sbFBvcnRfLnNldEJhY2tn
cm91bmRDb2xvcihjb2xvcik7Cn07Cgov
KioKICogUmV0dXJuIHRoZSBjdXJyZW50
IHRlcm1pbmFsIGJhY2tncm91bmQgY29s
b3IuCiAqCiAqIEludGVuZGVkIGZvciB1
c2UgYnkgb3RoZXIgY2xhc3Nlcywgc28g
d2UgZG9uJ3QgaGF2ZSB0byBleHBvc2Ug
dGhlIGVudGlyZQogKiBwcmVmc18gb2Jq
ZWN0LgogKi8KaHRlcm0uVGVybWluYWwu
cHJvdG90eXBlLmdldEJhY2tncm91bmRD
b2xvciA9IGZ1bmN0aW9uKCkgewogIHJl
dHVybiB0aGlzLmJhY2tncm91bmRDb2xv
cl87Cn07CgovKioKICogU2V0IHRoZSBm
b3JlZ3JvdW5kIGNvbG9yLgogKgogKiBJ
ZiB5b3Ugd2FudCB0aGlzIHNldHRpbmcg
dG8gcGVyc2lzdCwgc2V0IGl0IHRocm91
Z2ggcHJlZnNfLCByYXRoZXIgdGhhbgog
KiB3aXRoIHRoaXMgbWV0aG9kLgogKi8K
aHRlcm0uVGVybWluYWwucHJvdG90eXBl
LnNldEZvcmVncm91bmRDb2xvciA9IGZ1
bmN0aW9uKGNvbG9yKSB7CiAgdGhpcy5m
b3JlZ3JvdW5kQ29sb3JfID0gbGliLmNv
bG9ycy5ub3JtYWxpemVDU1MoY29sb3Ip
OwogIHRoaXMucHJpbWFyeVNjcmVlbl8u
dGV4dEF0dHJpYnV0ZXMuc2V0RGVmYXVs
dHMoCiAgICAgIHRoaXMuZm9yZWdyb3Vu
ZENvbG9yXywgdGhpcy5iYWNrZ3JvdW5k
Q29sb3JfKTsKICB0aGlzLmFsdGVybmF0
ZVNjcmVlbl8udGV4dEF0dHJpYnV0ZXMu
c2V0RGVmYXVsdHMoCiAgICAgIHRoaXMu
Zm9yZWdyb3VuZENvbG9yXywgdGhpcy5i
YWNrZ3JvdW5kQ29sb3JfKTsKICB0aGlz
LnNjcm9sbFBvcnRfLnNldEZvcmVncm91
bmRDb2xvcihjb2xvcik7Cn07CgovKioK
ICogUmV0dXJuIHRoZSBjdXJyZW50IHRl
cm1pbmFsIGZvcmVncm91bmQgY29sb3Iu
CiAqCiAqIEludGVuZGVkIGZvciB1c2Ug
Ynkgb3RoZXIgY2xhc3Nlcywgc28gd2Ug
ZG9uJ3QgaGF2ZSB0byBleHBvc2UgdGhl
IGVudGlyZQogKiBwcmVmc18gb2JqZWN0
LgogKi8KaHRlcm0uVGVybWluYWwucHJv
dG90eXBlLmdldEZvcmVncm91bmRDb2xv
ciA9IGZ1bmN0aW9uKCkgewogIHJldHVy
biB0aGlzLmZvcmVncm91bmRDb2xvcl87
Cn07CgovKioKICogQ3JlYXRlIGEgbmV3
IGluc3RhbmNlIG9mIGEgdGVybWluYWwg
Y29tbWFuZCBhbmQgcnVuIGl0IHdpdGgg
YSBnaXZlbgogKiBhcmd1bWVudCBzdHJp
bmcuCiAqCiAqIEBwYXJhbSB7ZnVuY3Rp
b259IGNvbW1hbmRDbGFzcyBUaGUgY29u
c3RydWN0b3IgZm9yIGEgdGVybWluYWwg
Y29tbWFuZC4KICogQHBhcmFtIHtzdHJp
bmd9IGFyZ1N0cmluZyBUaGUgYXJndW1l
bnQgc3RyaW5nIHRvIHBhc3MgdG8gdGhl
IGNvbW1hbmQuCiAqLwpodGVybS5UZXJt
aW5hbC5wcm90b3R5cGUucnVuQ29tbWFu
ZENsYXNzID0gZnVuY3Rpb24oY29tbWFu
ZENsYXNzLCBhcmdTdHJpbmcpIHsKICB2
YXIgZW52aXJvbm1lbnQgPSB0aGlzLnBy
ZWZzXy5nZXQoJ2Vudmlyb25tZW50Jyk7
CiAgaWYgKHR5cGVvZiBlbnZpcm9ubWVu
dCAhPSAnb2JqZWN0JyB8fCBlbnZpcm9u
bWVudCA9PSBudWxsKQogICAgZW52aXJv
bm1lbnQgPSB7fTsKCiAgdmFyIHNlbGYg
PSB0aGlzOwogIHRoaXMuY29tbWFuZCA9
IG5ldyBjb21tYW5kQ2xhc3MoCiAgICAg
IHsgYXJnU3RyaW5nOiBhcmdTdHJpbmcg
fHwgJycsCiAgICAgICAgaW86IHRoaXMu
aW8ucHVzaCgpLAogICAgICAgIGVudmly
b25tZW50OiBlbnZpcm9ubWVudCwKICAg
ICAgICBvbkV4aXQ6IGZ1bmN0aW9uKGNv
ZGUpIHsKICAgICAgICAgIHNlbGYuaW8u
cG9wKCk7CiAgICAgICAgICBzZWxmLnVu
aW5zdGFsbEtleWJvYXJkKCk7CiAgICAg
ICAgICBpZiAoc2VsZi5wcmVmc18uZ2V0
KCdjbG9zZS1vbi1leGl0JykpCiAgICAg
ICAgICAgICAgd2luZG93LmNsb3NlKCk7
CiAgICAgICAgfQogICAgICB9KTsKCiAg
dGhpcy5pbnN0YWxsS2V5Ym9hcmQoKTsK
ICB0aGlzLmNvbW1hbmQucnVuKCk7Cn07
CgovKioKICogUmV0dXJucyB0cnVlIGlm
IHRoZSBjdXJyZW50IHNjcmVlbiBpcyB0
aGUgcHJpbWFyeSBzY3JlZW4sIGZhbHNl
IG90aGVyd2lzZS4KICovCmh0ZXJtLlRl
cm1pbmFsLnByb3RvdHlwZS5pc1ByaW1h
cnlTY3JlZW4gPSBmdW5jdGlvbigpIHsK
ICByZXR1cm4gdGhpcy5zY3JlZW5fID09
IHRoaXMucHJpbWFyeVNjcmVlbl87Cn07
CgovKioKICogSW5zdGFsbCB0aGUga2V5
Ym9hcmQgaGFuZGxlciBmb3IgdGhpcyB0
ZXJtaW5hbC4KICoKICogVGhpcyB3aWxs
IHByZXZlbnQgdGhlIGJyb3dzZXIgZnJv
bSBzZWVpbmcgYW55IGtleXN0cm9rZXMg
c2VudCB0byB0aGUKICogdGVybWluYWwu
CiAqLwpodGVybS5UZXJtaW5hbC5wcm90
b3R5cGUuaW5zdGFsbEtleWJvYXJkID0g
ZnVuY3Rpb24oKSB7CiAgdGhpcy5rZXli
b2FyZC5pbnN0YWxsS2V5Ym9hcmQodGhp
cy5zY3JvbGxQb3J0Xy5nZXREb2N1bWVu
dCgpLmJvZHkpOwp9CgovKioKICogVW5p
bnN0YWxsIHRoZSBrZXlib2FyZCBoYW5k
bGVyIGZvciB0aGlzIHRlcm1pbmFsLgog
Ki8KaHRlcm0uVGVybWluYWwucHJvdG90
eXBlLnVuaW5zdGFsbEtleWJvYXJkID0g
ZnVuY3Rpb24oKSB7CiAgdGhpcy5rZXli
b2FyZC5pbnN0YWxsS2V5Ym9hcmQobnVs
bCk7Cn0KCi8qKgogKiBTZXQgdGhlIGZv
bnQgc2l6ZSBmb3IgdGhpcyB0ZXJtaW5h
bC4KICoKICogQ2FsbCBzZXRGb250U2l6
ZSgwKSB0byByZXNldCB0byB0aGUgZGVm
YXVsdCBmb250IHNpemUuCiAqCiAqIFRo
aXMgZnVuY3Rpb24gZG9lcyBub3QgbW9k
aWZ5IHRoZSBmb250LXNpemUgcHJlZmVy
ZW5jZS4KICoKICogQHBhcmFtIHtudW1i
ZXJ9IHB4IFRoZSBkZXNpcmVkIGZvbnQg
c2l6ZSwgaW4gcGl4ZWxzLgogKi8KaHRl
cm0uVGVybWluYWwucHJvdG90eXBlLnNl
dEZvbnRTaXplID0gZnVuY3Rpb24ocHgp
IHsKICBpZiAocHggPT09IDApCiAgICBw
eCA9IHRoaXMucHJlZnNfLmdldCgnZm9u
dC1zaXplJyk7CgogIHRoaXMuc2Nyb2xs
UG9ydF8uc2V0Rm9udFNpemUocHgpOwog
IGlmICh0aGlzLndjQ3NzUnVsZV8pIHsK
ICAgIHRoaXMud2NDc3NSdWxlXy5zdHls
ZS53aWR0aCA9IHRoaXMuc2Nyb2xsUG9y
dF8uY2hhcmFjdGVyU2l6ZS53aWR0aCAq
IDIgKwogICAgICAgICdweCc7CiAgfQp9
OwoKLyoqCiAqIEdldCB0aGUgY3VycmVu
dCBmb250IHNpemUuCiAqLwpodGVybS5U
ZXJtaW5hbC5wcm90b3R5cGUuZ2V0Rm9u
dFNpemUgPSBmdW5jdGlvbigpIHsKICBy
ZXR1cm4gdGhpcy5zY3JvbGxQb3J0Xy5n
ZXRGb250U2l6ZSgpOwp9OwoKLyoqCiAq
IEdldCB0aGUgY3VycmVudCBmb250IGZh
bWlseS4KICovCmh0ZXJtLlRlcm1pbmFs
LnByb3RvdHlwZS5nZXRGb250RmFtaWx5
ID0gZnVuY3Rpb24oKSB7CiAgcmV0dXJu
IHRoaXMuc2Nyb2xsUG9ydF8uZ2V0Rm9u
dEZhbWlseSgpOwp9OwoKLyoqCiAqIFNl
dCB0aGUgQ1NTICJmb250LWZhbWlseSIg
Zm9yIHRoaXMgdGVybWluYWwuCiAqLwpo
dGVybS5UZXJtaW5hbC5wcm90b3R5cGUu
c3luY0ZvbnRGYW1pbHkgPSBmdW5jdGlv
bigpIHsKICB0aGlzLnNjcm9sbFBvcnRf
LnNldEZvbnRGYW1pbHkodGhpcy5wcmVm
c18uZ2V0KCdmb250LWZhbWlseScpLAog
ICAgICAgICAgICAgICAgICAgICAgICAg
ICAgICAgICB0aGlzLnByZWZzXy5nZXQo
J2ZvbnQtc21vb3RoaW5nJykpOwogIHRo
aXMuc3luY0JvbGRTYWZlU3RhdGUoKTsK
fTsKCi8qKgogKiBTZXQgdGhpcy5tb3Vz
ZVBhc3RlQnV0dG9uIGJhc2VkIG9uIHRo
ZSBtb3VzZS1wYXN0ZS1idXR0b24gcHJl
ZiwKICogYXV0b2RldGVjdGluZyBpZiBu
ZWNlc3NhcnkuCiAqLwpodGVybS5UZXJt
aW5hbC5wcm90b3R5cGUuc3luY01vdXNl
UGFzdGVCdXR0b24gPSBmdW5jdGlvbigp
IHsKICB2YXIgYnV0dG9uID0gdGhpcy5w
cmVmc18uZ2V0KCdtb3VzZS1wYXN0ZS1i
dXR0b24nKTsKICBpZiAodHlwZW9mIGJ1
dHRvbiA9PSAnbnVtYmVyJykgewogICAg
dGhpcy5tb3VzZVBhc3RlQnV0dG9uID0g
YnV0dG9uOwogICAgcmV0dXJuOwogIH0K
CiAgdmFyIGFyeSA9IG5hdmlnYXRvci51
c2VyQWdlbnQubWF0Y2goL1woWDExO1xz
KyhcUyspLyk7CiAgaWYgKCFhcnkgfHwg
YXJ5WzJdID09ICdDck9TJykgewogICAg
dGhpcy5tb3VzZVBhc3RlQnV0dG9uID0g
MjsKICB9IGVsc2UgewogICAgdGhpcy5t
b3VzZVBhc3RlQnV0dG9uID0gMzsKICB9
Cn07CgovKioKICogRW5hYmxlIG9yIGRp
c2FibGUgYm9sZCBiYXNlZCBvbiB0aGUg
ZW5hYmxlLWJvbGQgcHJlZiwgYXV0b2Rl
dGVjdGluZyBpZgogKiBuZWNlc3Nhcnku
CiAqLwpodGVybS5UZXJtaW5hbC5wcm90
b3R5cGUuc3luY0JvbGRTYWZlU3RhdGUg
PSBmdW5jdGlvbigpIHsKICB2YXIgZW5h
YmxlQm9sZCA9IHRoaXMucHJlZnNfLmdl
dCgnZW5hYmxlLWJvbGQnKTsKICBpZiAo
ZW5hYmxlQm9sZCAhPT0gbnVsbCkgewog
ICAgdGhpcy5wcmltYXJ5U2NyZWVuXy50
ZXh0QXR0cmlidXRlcy5lbmFibGVCb2xk
ID0gZW5hYmxlQm9sZDsKICAgIHRoaXMu
YWx0ZXJuYXRlU2NyZWVuXy50ZXh0QXR0
cmlidXRlcy5lbmFibGVCb2xkID0gZW5h
YmxlQm9sZDsKICAgIHJldHVybjsKICB9
CgogIHZhciBub3JtYWxTaXplID0gdGhp
cy5zY3JvbGxQb3J0Xy5tZWFzdXJlQ2hh
cmFjdGVyU2l6ZSgpOwogIHZhciBib2xk
U2l6ZSA9IHRoaXMuc2Nyb2xsUG9ydF8u
bWVhc3VyZUNoYXJhY3RlclNpemUoJ2Jv
bGQnKTsKCiAgdmFyIGlzQm9sZFNhZmUg
PSBub3JtYWxTaXplLmVxdWFscyhib2xk
U2l6ZSk7CiAgaWYgKCFpc0JvbGRTYWZl
KSB7CiAgICBjb25zb2xlLndhcm4oJ0Jv
bGQgY2hhcmFjdGVycyBkaXNhYmxlZDog
U2l6ZSBvZiBib2xkIHdlaWdodCBkaWZm
ZXJzICcgKwogICAgICAgICAgICAgICAg
ICdmcm9tIG5vcm1hbC4gIEZvbnQgZmFt
aWx5IGlzOiAnICsKICAgICAgICAgICAg
ICAgICB0aGlzLnNjcm9sbFBvcnRfLmdl
dEZvbnRGYW1pbHkoKSk7CiAgfQoKICB0
aGlzLnByaW1hcnlTY3JlZW5fLnRleHRB
dHRyaWJ1dGVzLmVuYWJsZUJvbGQgPSBp
c0JvbGRTYWZlOwogIHRoaXMuYWx0ZXJu
YXRlU2NyZWVuXy50ZXh0QXR0cmlidXRl
cy5lbmFibGVCb2xkID0gaXNCb2xkU2Fm
ZTsKfTsKCi8qKgogKiBSZXR1cm4gYSBj
b3B5IG9mIHRoZSBjdXJyZW50IGN1cnNv
ciBwb3NpdGlvbi4KICoKICogQHJldHVy
biB7aHRlcm0uUm93Q29sfSBUaGUgUm93
Q29sIG9iamVjdCByZXByZXNlbnRpbmcg
dGhlIGN1cnJlbnQgcG9zaXRpb24uCiAq
LwpodGVybS5UZXJtaW5hbC5wcm90b3R5
cGUuc2F2ZUN1cnNvciA9IGZ1bmN0aW9u
KCkgewogIHJldHVybiB0aGlzLnNjcmVl
bl8uY3Vyc29yUG9zaXRpb24uY2xvbmUo
KTsKfTsKCmh0ZXJtLlRlcm1pbmFsLnBy
b3RvdHlwZS5nZXRUZXh0QXR0cmlidXRl
cyA9IGZ1bmN0aW9uKCkgewogIHJldHVy
biB0aGlzLnNjcmVlbl8udGV4dEF0dHJp
YnV0ZXM7Cn07CgpodGVybS5UZXJtaW5h
bC5wcm90b3R5cGUuc2V0VGV4dEF0dHJp
YnV0ZXMgPSBmdW5jdGlvbih0ZXh0QXR0
cmlidXRlcykgewogIHRoaXMuc2NyZWVu
Xy50ZXh0QXR0cmlidXRlcyA9IHRleHRB
dHRyaWJ1dGVzOwp9OwoKLyoqCiAqIFJl
dHVybiB0aGUgY3VycmVudCBicm93c2Vy
IHpvb20gZmFjdG9yIGFwcGxpZWQgdG8g
dGhlIHRlcm1pbmFsLgogKgogKiBAcmV0
dXJuIHtudW1iZXJ9IFRoZSBjdXJyZW50
IGJyb3dzZXIgem9vbSBmYWN0b3IuCiAq
LwpodGVybS5UZXJtaW5hbC5wcm90b3R5
cGUuZ2V0Wm9vbUZhY3RvciA9IGZ1bmN0
aW9uKCkgewogIHJldHVybiB0aGlzLnNj
cm9sbFBvcnRfLmNoYXJhY3RlclNpemUu
em9vbUZhY3RvcjsKfTsKCi8qKgogKiBD
aGFuZ2UgdGhlIHRpdGxlIG9mIHRoaXMg
dGVybWluYWwncyB3aW5kb3cuCiAqLwpo
dGVybS5UZXJtaW5hbC5wcm90b3R5cGUu
c2V0V2luZG93VGl0bGUgPSBmdW5jdGlv
bih0aXRsZSkgewogIHdpbmRvdy5kb2N1
bWVudC50aXRsZSA9IHRpdGxlOwp9OwoK
LyoqCiAqIFJlc3RvcmUgYSBwcmV2aW91
c2x5IHNhdmVkIGN1cnNvciBwb3NpdGlv
bi4KICoKICogQHBhcmFtIHtodGVybS5S
b3dDb2x9IGN1cnNvciBUaGUgcG9zaXRp
b24gdG8gcmVzdG9yZS4KICovCmh0ZXJt
LlRlcm1pbmFsLnByb3RvdHlwZS5yZXN0
b3JlQ3Vyc29yID0gZnVuY3Rpb24oY3Vy
c29yKSB7CiAgdmFyIHJvdyA9IGxpYi5m
LmNsYW1wKGN1cnNvci5yb3csIDAsIHRo
aXMuc2NyZWVuU2l6ZS5oZWlnaHQgLSAx
KTsKICB2YXIgY29sdW1uID0gbGliLmYu
Y2xhbXAoY3Vyc29yLmNvbHVtbiwgMCwg
dGhpcy5zY3JlZW5TaXplLndpZHRoIC0g
MSk7CiAgdGhpcy5zY3JlZW5fLnNldEN1
cnNvclBvc2l0aW9uKHJvdywgY29sdW1u
KTsKICBpZiAoY3Vyc29yLmNvbHVtbiA+
IGNvbHVtbiB8fAogICAgICBjdXJzb3Iu
Y29sdW1uID09IGNvbHVtbiAmJiBjdXJz
b3Iub3ZlcmZsb3cpIHsKICAgIHRoaXMu
c2NyZWVuXy5jdXJzb3JQb3NpdGlvbi5v
dmVyZmxvdyA9IHRydWU7CiAgfQp9OwoK
LyoqCiAqIENsZWFyIHRoZSBjdXJzb3In
cyBvdmVyZmxvdyBmbGFnLgogKi8KaHRl
cm0uVGVybWluYWwucHJvdG90eXBlLmNs
ZWFyQ3Vyc29yT3ZlcmZsb3cgPSBmdW5j
dGlvbigpIHsKICB0aGlzLnNjcmVlbl8u
Y3Vyc29yUG9zaXRpb24ub3ZlcmZsb3cg
PSBmYWxzZTsKfTsKCi8qKgogKiBTZXRz
IHRoZSBjdXJzb3Igc2hhcGUKICovCmh0
ZXJtLlRlcm1pbmFsLnByb3RvdHlwZS5z
ZXRDdXJzb3JTaGFwZSA9IGZ1bmN0aW9u
KHNoYXBlKSB7CiAgdGhpcy5jdXJzb3JT
aGFwZV8gPSBzaGFwZTsKICB0aGlzLnJl
c3R5bGVDdXJzb3JfKCk7Cn0KCi8qKgog
KiBHZXQgdGhlIGN1cnNvciBzaGFwZQog
Ki8KaHRlcm0uVGVybWluYWwucHJvdG90
eXBlLmdldEN1cnNvclNoYXBlID0gZnVu
Y3Rpb24oKSB7CiAgcmV0dXJuIHRoaXMu
Y3Vyc29yU2hhcGVfOwp9CgovKioKICog
U2V0IHRoZSB3aWR0aCBvZiB0aGUgdGVy
bWluYWwsIHJlc2l6aW5nIHRoZSBVSSB0
byBtYXRjaC4KICovCmh0ZXJtLlRlcm1p
bmFsLnByb3RvdHlwZS5zZXRXaWR0aCA9
IGZ1bmN0aW9uKGNvbHVtbkNvdW50KSB7
CiAgaWYgKGNvbHVtbkNvdW50ID09IG51
bGwpIHsKICAgIHRoaXMuZGl2Xy5zdHls
ZS53aWR0aCA9ICcxMDAlJzsKICAgIHJl
dHVybjsKICB9CgogIHRoaXMuZGl2Xy5z
dHlsZS53aWR0aCA9IE1hdGguY2VpbCgK
ICAgICAgdGhpcy5zY3JvbGxQb3J0Xy5j
aGFyYWN0ZXJTaXplLndpZHRoICoKICAg
ICAgY29sdW1uQ291bnQgKyB0aGlzLnNj
cm9sbFBvcnRfLmN1cnJlbnRTY3JvbGxi
YXJXaWR0aFB4KSArICdweCc7CiAgdGhp
cy5yZWFsaXplU2l6ZV8oY29sdW1uQ291
bnQsIHRoaXMuc2NyZWVuU2l6ZS5oZWln
aHQpOwogIHRoaXMuc2NoZWR1bGVTeW5j
Q3Vyc29yUG9zaXRpb25fKCk7Cn07Cgov
KioKICogU2V0IHRoZSBoZWlnaHQgb2Yg
dGhlIHRlcm1pbmFsLCByZXNpemluZyB0
aGUgVUkgdG8gbWF0Y2guCiAqLwpodGVy
bS5UZXJtaW5hbC5wcm90b3R5cGUuc2V0
SGVpZ2h0ID0gZnVuY3Rpb24ocm93Q291
bnQpIHsKICBpZiAocm93Q291bnQgPT0g
bnVsbCkgewogICAgdGhpcy5kaXZfLnN0
eWxlLmhlaWdodCA9ICcxMDAlJzsKICAg
IHJldHVybjsKICB9CgogIHRoaXMuZGl2
Xy5zdHlsZS5oZWlnaHQgPQogICAgICB0
aGlzLnNjcm9sbFBvcnRfLmNoYXJhY3Rl
clNpemUuaGVpZ2h0ICogcm93Q291bnQg
KyAncHgnOwogIHRoaXMucmVhbGl6ZVNp
emVfKHRoaXMuc2NyZWVuU2l6ZS53aWR0
aCwgcm93Q291bnQpOwogIHRoaXMuc2No
ZWR1bGVTeW5jQ3Vyc29yUG9zaXRpb25f
KCk7Cn07CgovKioKICogRGVhbCB3aXRo
IHRlcm1pbmFsIHNpemUgY2hhbmdlcy4K
ICoKICovCmh0ZXJtLlRlcm1pbmFsLnBy
b3RvdHlwZS5yZWFsaXplU2l6ZV8gPSBm
dW5jdGlvbihjb2x1bW5Db3VudCwgcm93
Q291bnQpIHsKICBpZiAoY29sdW1uQ291
bnQgIT0gdGhpcy5zY3JlZW5TaXplLndp
ZHRoKQogICAgdGhpcy5yZWFsaXplV2lk
dGhfKGNvbHVtbkNvdW50KTsKCiAgaWYg
KHJvd0NvdW50ICE9IHRoaXMuc2NyZWVu
U2l6ZS5oZWlnaHQpCiAgICB0aGlzLnJl
YWxpemVIZWlnaHRfKHJvd0NvdW50KTsK
CiAgLy8gU2VuZCBuZXcgdGVybWluYWwg
c2l6ZSB0byBwbHVnaW4uCiAgdGhpcy5p
by5vblRlcm1pbmFsUmVzaXplXyhjb2x1
bW5Db3VudCwgcm93Q291bnQpOwp9OwoK
LyoqCiAqIERlYWwgd2l0aCB0ZXJtaW5h
bCB3aWR0aCBjaGFuZ2VzLgogKgogKiBU
aGlzIGZ1bmN0aW9uIGRvZXMgd2hhdCBu
ZWVkcyB0byBiZSBkb25lIHdoZW4gdGhl
IHRlcm1pbmFsIHdpZHRoIGNoYW5nZXMK
ICogb3V0IGZyb20gdW5kZXIgdXMuICBJ
dCBoYXBwZW5zIGhlcmUgcmF0aGVyIHRo
YW4gaW4gb25SZXNpemVfKCkgYmVjYXVz
ZSB0aGlzCiAqIGNvZGUgbWF5IG5lZWQg
dG8gcnVuIHN5bmNocm9ub3VzbHkgdG8g
aGFuZGxlIHByb2dyYW1tYXRpYyBjaGFu
Z2VzIG9mCiAqIHRlcm1pbmFsIHdpZHRo
LgogKgogKiBSZWx5aW5nIG9uIHRoZSBi
cm93c2VyIHRvIHNlbmQgdXMgYW4gYXN5
bmMgcmVzaXplIGV2ZW50IG1lYW5zIHdl
IG1heSBub3QgYmUKICogaW4gdGhlIGNv
cnJlY3Qgc3RhdGUgeWV0IHdoZW4gdGhl
IG5leHQgZXNjYXBlIHNlcXVlbmNlIGhp
dHMuCiAqLwpodGVybS5UZXJtaW5hbC5w
cm90b3R5cGUucmVhbGl6ZVdpZHRoXyA9
IGZ1bmN0aW9uKGNvbHVtbkNvdW50KSB7
CiAgaWYgKGNvbHVtbkNvdW50IDw9IDAp
CiAgICB0aHJvdyBuZXcgRXJyb3IoJ0F0
dGVtcHQgdG8gcmVhbGl6ZSBiYWQgd2lk
dGg6ICcgKyBjb2x1bW5Db3VudCk7Cgog
IHZhciBkZWx0YUNvbHVtbnMgPSBjb2x1
bW5Db3VudCAtIHRoaXMuc2NyZWVuXy5n
ZXRXaWR0aCgpOwoKICB0aGlzLnNjcmVl
blNpemUud2lkdGggPSBjb2x1bW5Db3Vu
dDsKICB0aGlzLnNjcmVlbl8uc2V0Q29s
dW1uQ291bnQoY29sdW1uQ291bnQpOwoK
ICBpZiAoZGVsdGFDb2x1bW5zID4gMCkg
ewogICAgaWYgKHRoaXMuZGVmYXVsdFRh
YlN0b3BzKQogICAgICB0aGlzLnNldERl
ZmF1bHRUYWJTdG9wcyh0aGlzLnNjcmVl
blNpemUud2lkdGggLSBkZWx0YUNvbHVt
bnMpOwogIH0gZWxzZSB7CiAgICBmb3Ig
KHZhciBpID0gdGhpcy50YWJTdG9wc18u
bGVuZ3RoIC0gMTsgaSA+PSAwOyBpLS0p
IHsKICAgICAgaWYgKHRoaXMudGFiU3Rv
cHNfW2ldIDwgY29sdW1uQ291bnQpCiAg
ICAgICAgYnJlYWs7CgogICAgICB0aGlz
LnRhYlN0b3BzXy5wb3AoKTsKICAgIH0K
ICB9CgogIHRoaXMuc2NyZWVuXy5zZXRD
b2x1bW5Db3VudCh0aGlzLnNjcmVlblNp
emUud2lkdGgpOwp9OwoKLyoqCiAqIERl
YWwgd2l0aCB0ZXJtaW5hbCBoZWlnaHQg
Y2hhbmdlcy4KICoKICogVGhpcyBmdW5j
dGlvbiBkb2VzIHdoYXQgbmVlZHMgdG8g
YmUgZG9uZSB3aGVuIHRoZSB0ZXJtaW5h
bCBoZWlnaHQgY2hhbmdlcwogKiBvdXQg
ZnJvbSB1bmRlciB1cy4gIEl0IGhhcHBl
bnMgaGVyZSByYXRoZXIgdGhhbiBpbiBv
blJlc2l6ZV8oKSBiZWNhdXNlIHRoaXMK
ICogY29kZSBtYXkgbmVlZCB0byBydW4g
c3luY2hyb25vdXNseSB0byBoYW5kbGUg
cHJvZ3JhbW1hdGljIGNoYW5nZXMgb2YK
ICogdGVybWluYWwgaGVpZ2h0LgogKgog
KiBSZWx5aW5nIG9uIHRoZSBicm93c2Vy
IHRvIHNlbmQgdXMgYW4gYXN5bmMgcmVz
aXplIGV2ZW50IG1lYW5zIHdlIG1heSBu
b3QgYmUKICogaW4gdGhlIGNvcnJlY3Qg
c3RhdGUgeWV0IHdoZW4gdGhlIG5leHQg
ZXNjYXBlIHNlcXVlbmNlIGhpdHMuCiAq
LwpodGVybS5UZXJtaW5hbC5wcm90b3R5
cGUucmVhbGl6ZUhlaWdodF8gPSBmdW5j
dGlvbihyb3dDb3VudCkgewogIGlmIChy
b3dDb3VudCA8PSAwKQogICAgdGhyb3cg
bmV3IEVycm9yKCdBdHRlbXB0IHRvIHJl
YWxpemUgYmFkIGhlaWdodDogJyArIHJv
d0NvdW50KTsKCiAgdmFyIGRlbHRhUm93
cyA9IHJvd0NvdW50IC0gdGhpcy5zY3Jl
ZW5fLmdldEhlaWdodCgpOwoKICB0aGlz
LnNjcmVlblNpemUuaGVpZ2h0ID0gcm93
Q291bnQ7CgogIHZhciBjdXJzb3IgPSB0
aGlzLnNhdmVDdXJzb3IoKTsKCiAgaWYg
KGRlbHRhUm93cyA8IDApIHsKICAgIC8v
IFNjcmVlbiBnb3Qgc21hbGxlci4KICAg
IGRlbHRhUm93cyAqPSAtMTsKICAgIHdo
aWxlIChkZWx0YVJvd3MpIHsKICAgICAg
dmFyIGxhc3RSb3cgPSB0aGlzLmdldFJv
d0NvdW50KCkgLSAxOwogICAgICBpZiAo
bGFzdFJvdyAtIHRoaXMuc2Nyb2xsYmFj
a1Jvd3NfLmxlbmd0aCA9PSBjdXJzb3Iu
cm93KQogICAgICAgIGJyZWFrOwoKICAg
ICAgaWYgKHRoaXMuZ2V0Um93VGV4dChs
YXN0Um93KSkKICAgICAgICBicmVhazsK
CiAgICAgIHRoaXMuc2NyZWVuXy5wb3BS
b3coKTsKICAgICAgZGVsdGFSb3dzLS07
CiAgICB9CgogICAgdmFyIGFyeSA9IHRo
aXMuc2NyZWVuXy5zaGlmdFJvd3MoZGVs
dGFSb3dzKTsKICAgIHRoaXMuc2Nyb2xs
YmFja1Jvd3NfLnB1c2guYXBwbHkodGhp
cy5zY3JvbGxiYWNrUm93c18sIGFyeSk7
CgogICAgLy8gV2UganVzdCByZW1vdmVk
IHJvd3MgZnJvbSB0aGUgdG9wIG9mIHRo
ZSBzY3JlZW4sIHdlIG5lZWQgdG8gdXBk
YXRlCiAgICAvLyB0aGUgY3Vyc29yIHRv
IG1hdGNoLgogICAgY3Vyc29yLnJvdyA9
IE1hdGgubWF4KGN1cnNvci5yb3cgLSBk
ZWx0YVJvd3MsIDApOwogIH0gZWxzZSBp
ZiAoZGVsdGFSb3dzID4gMCkgewogICAg
Ly8gU2NyZWVuIGdvdCBsYXJnZXIuCgog
ICAgaWYgKGRlbHRhUm93cyA8PSB0aGlz
LnNjcm9sbGJhY2tSb3dzXy5sZW5ndGgp
IHsKICAgICAgdmFyIHNjcm9sbGJhY2tD
b3VudCA9IE1hdGgubWluKGRlbHRhUm93
cywgdGhpcy5zY3JvbGxiYWNrUm93c18u
bGVuZ3RoKTsKICAgICAgdmFyIHJvd3Mg
PSB0aGlzLnNjcm9sbGJhY2tSb3dzXy5z
cGxpY2UoCiAgICAgICAgICB0aGlzLnNj
cm9sbGJhY2tSb3dzXy5sZW5ndGggLSBz
Y3JvbGxiYWNrQ291bnQsIHNjcm9sbGJh
Y2tDb3VudCk7CiAgICAgIHRoaXMuc2Ny
ZWVuXy51bnNoaWZ0Um93cyhyb3dzKTsK
ICAgICAgZGVsdGFSb3dzIC09IHNjcm9s
bGJhY2tDb3VudDsKICAgICAgY3Vyc29y
LnJvdyArPSBzY3JvbGxiYWNrQ291bnQ7
CiAgICB9CgogICAgaWYgKGRlbHRhUm93
cykKICAgICAgdGhpcy5hcHBlbmRSb3dz
XyhkZWx0YVJvd3MpOwogIH0KCiAgdGhp
cy5zZXRWVFNjcm9sbFJlZ2lvbihudWxs
LCBudWxsKTsKICB0aGlzLnJlc3RvcmVD
dXJzb3IoY3Vyc29yKTsKfTsKCi8qKgog
KiBTY3JvbGwgdGhlIHRlcm1pbmFsIHRv
IHRoZSB0b3Agb2YgdGhlIHNjcm9sbGJh
Y2sgYnVmZmVyLgogKi8KaHRlcm0uVGVy
bWluYWwucHJvdG90eXBlLnNjcm9sbEhv
bWUgPSBmdW5jdGlvbigpIHsKICB0aGlz
LnNjcm9sbFBvcnRfLnNjcm9sbFJvd1Rv
VG9wKDApOwp9OwoKLyoqCiAqIFNjcm9s
bCB0aGUgdGVybWluYWwgdG8gdGhlIGVu
ZC4KICovCmh0ZXJtLlRlcm1pbmFsLnBy
b3RvdHlwZS5zY3JvbGxFbmQgPSBmdW5j
dGlvbigpIHsKICB0aGlzLnNjcm9sbFBv
cnRfLnNjcm9sbFJvd1RvQm90dG9tKHRo
aXMuZ2V0Um93Q291bnQoKSk7Cn07Cgov
KioKICogU2Nyb2xsIHRoZSB0ZXJtaW5h
bCBvbmUgcGFnZSB1cCAobWludXMgb25l
IGxpbmUpIHJlbGF0aXZlIHRvIHRoZSBj
dXJyZW50CiAqIHBvc2l0aW9uLgogKi8K
aHRlcm0uVGVybWluYWwucHJvdG90eXBl
LnNjcm9sbFBhZ2VVcCA9IGZ1bmN0aW9u
KCkgewogIHZhciBpID0gdGhpcy5zY3Jv
bGxQb3J0Xy5nZXRUb3BSb3dJbmRleCgp
OwogIHRoaXMuc2Nyb2xsUG9ydF8uc2Ny
b2xsUm93VG9Ub3AoaSAtIHRoaXMuc2Ny
ZWVuU2l6ZS5oZWlnaHQgKyAxKTsKfTsK
Ci8qKgogKiBTY3JvbGwgdGhlIHRlcm1p
bmFsIG9uZSBwYWdlIGRvd24gKG1pbnVz
IG9uZSBsaW5lKSByZWxhdGl2ZSB0byB0
aGUgY3VycmVudAogKiBwb3NpdGlvbi4K
ICovCmh0ZXJtLlRlcm1pbmFsLnByb3Rv
dHlwZS5zY3JvbGxQYWdlRG93biA9IGZ1
bmN0aW9uKCkgewogIHZhciBpID0gdGhp
cy5zY3JvbGxQb3J0Xy5nZXRUb3BSb3dJ
bmRleCgpOwogIHRoaXMuc2Nyb2xsUG9y
dF8uc2Nyb2xsUm93VG9Ub3AoaSArIHRo
aXMuc2NyZWVuU2l6ZS5oZWlnaHQgLSAx
KTsKfTsKCi8qKgogKiBDbGVhciBwcmlt
YXJ5IHNjcmVlbiwgc2Vjb25kYXJ5IHNj
cmVlbiwgYW5kIHRoZSBzY3JvbGxiYWNr
IGJ1ZmZlci4KICovCmh0ZXJtLlRlcm1p
bmFsLnByb3RvdHlwZS53aXBlQ29udGVu
dHMgPSBmdW5jdGlvbigpIHsKICB0aGlz
LnNjcm9sbGJhY2tSb3dzXy5sZW5ndGgg
PSAwOwogIHRoaXMuc2Nyb2xsUG9ydF8u
cmVzZXRDYWNoZSgpOwoKICBbdGhpcy5w
cmltYXJ5U2NyZWVuXywgdGhpcy5hbHRl
cm5hdGVTY3JlZW5fXS5mb3JFYWNoKGZ1
bmN0aW9uKHNjcmVlbikgewogICAgdmFy
IGJvdHRvbSA9IHNjcmVlbi5nZXRIZWln
aHQoKTsKICAgIGlmIChib3R0b20gPiAw
KSB7CiAgICAgIHRoaXMucmVudW1iZXJS
b3dzXygwLCBib3R0b20pOwogICAgICB0
aGlzLmNsZWFySG9tZShzY3JlZW4pOwog
ICAgfQogIH0uYmluZCh0aGlzKSk7Cgog
IHRoaXMuc3luY0N1cnNvclBvc2l0aW9u
XygpOwogIHRoaXMuc2Nyb2xsUG9ydF8u
aW52YWxpZGF0ZSgpOwp9OwoKLyoqCiAq
IEZ1bGwgdGVybWluYWwgcmVzZXQuCiAq
LwpodGVybS5UZXJtaW5hbC5wcm90b3R5
cGUucmVzZXQgPSBmdW5jdGlvbigpIHsK
ICB0aGlzLmNsZWFyQWxsVGFiU3RvcHMo
KTsKICB0aGlzLnNldERlZmF1bHRUYWJT
dG9wcygpOwoKICB0aGlzLmNsZWFySG9t
ZSh0aGlzLnByaW1hcnlTY3JlZW5fKTsK
ICB0aGlzLnByaW1hcnlTY3JlZW5fLnRl
eHRBdHRyaWJ1dGVzLnJlc2V0KCk7Cgog
IHRoaXMuY2xlYXJIb21lKHRoaXMuYWx0
ZXJuYXRlU2NyZWVuXyk7CiAgdGhpcy5h
bHRlcm5hdGVTY3JlZW5fLnRleHRBdHRy
aWJ1dGVzLnJlc2V0KCk7CgogIHRoaXMu
c2V0Q3Vyc29yQmxpbmsoISF0aGlzLnBy
ZWZzXy5nZXQoJ2N1cnNvci1ibGluaycp
KTsKCiAgdGhpcy52dC5yZXNldCgpOwoK
ICB0aGlzLnNvZnRSZXNldCgpOwp9OwoK
LyoqCiAqIFNvZnQgdGVybWluYWwgcmVz
ZXQuCiAqCiAqIFBlcmZvcm0gYSBzb2Z0
IHJlc2V0IHRvIHRoZSBkZWZhdWx0IHZh
bHVlcyBsaXN0ZWQgaW4KICogaHR0cDov
L3d3dy52dDEwMC5uZXQvZG9jcy92dDUx
MC1ybS9ERUNTVFIjVDUtOQogKi8KaHRl
cm0uVGVybWluYWwucHJvdG90eXBlLnNv
ZnRSZXNldCA9IGZ1bmN0aW9uKCkgewog
IC8vIFJlc2V0IHRlcm1pbmFsIG9wdGlv
bnMgdG8gdGhlaXIgZGVmYXVsdCB2YWx1
ZXMuCiAgdGhpcy5vcHRpb25zXyA9IG5l
dyBodGVybS5PcHRpb25zKCk7CgogIC8v
IFdlIHNob3cgdGhlIGN1cnNvciBvbiBz
b2Z0IHJlc2V0IGJ1dCBkbyBub3QgYWx0
ZXIgdGhlIGJsaW5rIHN0YXRlLgogIHRo
aXMub3B0aW9uc18uY3Vyc29yQmxpbmsg
PSAhIXRoaXMudGltZW91dHNfLmN1cnNv
ckJsaW5rOwoKICAvLyBYdGVybSBhbHNv
IHJlc2V0cyB0aGUgY29sb3IgcGFsZXR0
ZSBvbiBzb2Z0IHJlc2V0LCBldmVuIHRo
b3VnaCBpdCBkb2Vzbid0CiAgLy8gc2Vl
bSB0byBiZSBkb2N1bWVudGVkIGFueXdo
ZXJlLgogIHRoaXMucHJpbWFyeVNjcmVl
bl8udGV4dEF0dHJpYnV0ZXMucmVzZXRD
b2xvclBhbGV0dGUoKTsKICB0aGlzLmFs
dGVybmF0ZVNjcmVlbl8udGV4dEF0dHJp
YnV0ZXMucmVzZXRDb2xvclBhbGV0dGUo
KTsKCiAgLy8gVGhlIHh0ZXJtIG1hbiBw
YWdlIGV4cGxpY2l0bHkgc2F5cyB0aGlz
IHdpbGwgaGFwcGVuIG9uIHNvZnQgcmVz
ZXQuCiAgdGhpcy5zZXRWVFNjcm9sbFJl
Z2lvbihudWxsLCBudWxsKTsKCiAgLy8g
WHRlcm0gYWxzbyBzaG93cyB0aGUgY3Vy
c29yIG9uIHNvZnQgcmVzZXQsIGJ1dCBk
b2VzIG5vdCBhbHRlciB0aGUgYmxpbmsK
ICAvLyBzdGF0ZS4KICB0aGlzLnNldEN1
cnNvclZpc2libGUodHJ1ZSk7Cn07Cgov
KioKICogTW92ZSB0aGUgY3Vyc29yIGZv
cndhcmQgdG8gdGhlIG5leHQgdGFiIHN0
b3AsIG9yIHRvIHRoZSBsYXN0IGNvbHVt
bgogKiBpZiBubyBtb3JlIHRhYiBzdG9w
cyBhcmUgc2V0LgogKi8KaHRlcm0uVGVy
bWluYWwucHJvdG90eXBlLmZvcndhcmRU
YWJTdG9wID0gZnVuY3Rpb24oKSB7CiAg
dmFyIGNvbHVtbiA9IHRoaXMuc2NyZWVu
Xy5jdXJzb3JQb3NpdGlvbi5jb2x1bW47
CgogIGZvciAodmFyIGkgPSAwOyBpIDwg
dGhpcy50YWJTdG9wc18ubGVuZ3RoOyBp
KyspIHsKICAgIGlmICh0aGlzLnRhYlN0
b3BzX1tpXSA+IGNvbHVtbikgewogICAg
ICB0aGlzLnNldEN1cnNvckNvbHVtbih0
aGlzLnRhYlN0b3BzX1tpXSk7CiAgICAg
IHJldHVybjsKICAgIH0KICB9CgogIC8v
IHh0ZXJtIGRvZXMgbm90IGNsZWFyIHRo
ZSBvdmVyZmxvdyBmbGFnIG9uIEhUIG9y
IENIVC4KICB2YXIgb3ZlcmZsb3cgPSB0
aGlzLnNjcmVlbl8uY3Vyc29yUG9zaXRp
b24ub3ZlcmZsb3c7CiAgdGhpcy5zZXRD
dXJzb3JDb2x1bW4odGhpcy5zY3JlZW5T
aXplLndpZHRoIC0gMSk7CiAgdGhpcy5z
Y3JlZW5fLmN1cnNvclBvc2l0aW9uLm92
ZXJmbG93ID0gb3ZlcmZsb3c7Cn07Cgov
KioKICogTW92ZSB0aGUgY3Vyc29yIGJh
Y2t3YXJkIHRvIHRoZSBwcmV2aW91cyB0
YWIgc3RvcCwgb3IgdG8gdGhlIGZpcnN0
IGNvbHVtbgogKiBpZiBubyBwcmV2aW91
cyB0YWIgc3RvcHMgYXJlIHNldC4KICov
Cmh0ZXJtLlRlcm1pbmFsLnByb3RvdHlw
ZS5iYWNrd2FyZFRhYlN0b3AgPSBmdW5j
dGlvbigpIHsKICB2YXIgY29sdW1uID0g
dGhpcy5zY3JlZW5fLmN1cnNvclBvc2l0
aW9uLmNvbHVtbjsKCiAgZm9yICh2YXIg
aSA9IHRoaXMudGFiU3RvcHNfLmxlbmd0
aCAtIDE7IGkgPj0gMDsgaS0tKSB7CiAg
ICBpZiAodGhpcy50YWJTdG9wc19baV0g
PCBjb2x1bW4pIHsKICAgICAgdGhpcy5z
ZXRDdXJzb3JDb2x1bW4odGhpcy50YWJT
dG9wc19baV0pOwogICAgICByZXR1cm47
CiAgICB9CiAgfQoKICB0aGlzLnNldEN1
cnNvckNvbHVtbigxKTsKfTsKCi8qKgog
KiBTZXQgYSB0YWIgc3RvcCBhdCB0aGUg
Z2l2ZW4gY29sdW1uLgogKgogKiBAcGFy
YW0ge2ludH0gY29sdW1uIFplcm8gYmFz
ZWQgY29sdW1uLgogKi8KaHRlcm0uVGVy
bWluYWwucHJvdG90eXBlLnNldFRhYlN0
b3AgPSBmdW5jdGlvbihjb2x1bW4pIHsK
ICBmb3IgKHZhciBpID0gdGhpcy50YWJT
dG9wc18ubGVuZ3RoIC0gMTsgaSA+PSAw
OyBpLS0pIHsKICAgIGlmICh0aGlzLnRh
YlN0b3BzX1tpXSA9PSBjb2x1bW4pCiAg
ICAgIHJldHVybjsKCiAgICBpZiAodGhp
cy50YWJTdG9wc19baV0gPCBjb2x1bW4p
IHsKICAgICAgdGhpcy50YWJTdG9wc18u
c3BsaWNlKGkgKyAxLCAwLCBjb2x1bW4p
OwogICAgICByZXR1cm47CiAgICB9CiAg
fQoKICB0aGlzLnRhYlN0b3BzXy5zcGxp
Y2UoMCwgMCwgY29sdW1uKTsKfTsKCi8q
KgogKiBDbGVhciB0aGUgdGFiIHN0b3Ag
YXQgdGhlIGN1cnJlbnQgY3Vyc29yIHBv
c2l0aW9uLgogKgogKiBObyBlZmZlY3Qg
aWYgdGhlcmUgaXMgbm8gdGFiIHN0b3Ag
YXQgdGhlIGN1cnJlbnQgY3Vyc29yIHBv
c2l0aW9uLgogKi8KaHRlcm0uVGVybWlu
YWwucHJvdG90eXBlLmNsZWFyVGFiU3Rv
cEF0Q3Vyc29yID0gZnVuY3Rpb24oKSB7
CiAgdmFyIGNvbHVtbiA9IHRoaXMuc2Ny
ZWVuXy5jdXJzb3JQb3NpdGlvbi5jb2x1
bW47CgogIHZhciBpID0gdGhpcy50YWJT
dG9wc18uaW5kZXhPZihjb2x1bW4pOwog
IGlmIChpID09IC0xKQogICAgcmV0dXJu
OwoKICB0aGlzLnRhYlN0b3BzXy5zcGxp
Y2UoaSwgMSk7Cn07CgovKioKICogQ2xl
YXIgYWxsIHRhYiBzdG9wcy4KICovCmh0
ZXJtLlRlcm1pbmFsLnByb3RvdHlwZS5j
bGVhckFsbFRhYlN0b3BzID0gZnVuY3Rp
b24oKSB7CiAgdGhpcy50YWJTdG9wc18u
bGVuZ3RoID0gMDsKICB0aGlzLmRlZmF1
bHRUYWJTdG9wcyA9IGZhbHNlOwp9OwoK
LyoqCiAqIFNldCB1cCB0aGUgZGVmYXVs
dCB0YWIgc3RvcHMsIHN0YXJ0aW5nIGZy
b20gYSBnaXZlbiBjb2x1bW4uCiAqCiAq
IFRoaXMgc2V0cyBhIHRhYnN0b3AgZXZl
cnkgKGNvbHVtbiAlIHRoaXMudGFiV2lk
dGgpIGNvbHVtbiwgc3RhcnRpbmcKICog
ZnJvbSB0aGUgc3BlY2lmaWVkIGNvbHVt
biwgb3IgMCBpZiBubyBjb2x1bW4gaXMg
cHJvdmlkZWQuICBJdCBhbHNvIGZsYWdz
CiAqIGZ1dHVyZSByZXNpemVzIHRvIHNl
dCB0aGVtIHVwLgogKgogKiBUaGlzIGRv
ZXMgbm90IGNsZWFyIHRoZSBleGlzdGlu
ZyB0YWIgc3RvcHMgZmlyc3QsIHVzZSBj
bGVhckFsbFRhYlN0b3BzCiAqIGZvciB0
aGF0LgogKgogKiBAcGFyYW0ge2ludH0g
b3B0X3N0YXJ0IE9wdGlvbmFsIHN0YXJ0
aW5nIHplcm8gYmFzZWQgc3RhcnRpbmcg
Y29sdW1uLCB1c2VmdWwKICogICAgIGZv
ciBmaWxsaW5nIG91dCBtaXNzaW5nIHRh
YiBzdG9wcyB3aGVuIHRoZSB0ZXJtaW5h
bCBpcyByZXNpemVkLgogKi8KaHRlcm0u
VGVybWluYWwucHJvdG90eXBlLnNldERl
ZmF1bHRUYWJTdG9wcyA9IGZ1bmN0aW9u
KG9wdF9zdGFydCkgewogIHZhciBzdGFy
dCA9IG9wdF9zdGFydCB8fCAwOwogIHZh
ciB3ID0gdGhpcy50YWJXaWR0aDsKICAv
LyBSb3VuZCBzdGFydCB1cCB0byBhIGRl
ZmF1bHQgdGFiIHN0b3AuCiAgc3RhcnQg
PSBzdGFydCAtIDEgLSAoKHN0YXJ0IC0g
MSkgJSB3KSArIHc7CiAgZm9yICh2YXIg
aSA9IHN0YXJ0OyBpIDwgdGhpcy5zY3Jl
ZW5TaXplLndpZHRoOyBpICs9IHcpIHsK
ICAgIHRoaXMuc2V0VGFiU3RvcChpKTsK
ICB9CgogIHRoaXMuZGVmYXVsdFRhYlN0
b3BzID0gdHJ1ZTsKfTsKCi8qKgogKiBJ
bnRlcnByZXQgYSBzZXF1ZW5jZSBvZiBj
aGFyYWN0ZXJzLgogKgogKiBJbmNvbXBs
ZXRlIGVzY2FwZSBzZXF1ZW5jZXMgYXJl
IGJ1ZmZlcmVkIHVudGlsIHRoZSBuZXh0
IGNhbGwuCiAqCiAqIEBwYXJhbSB7c3Ry
aW5nfSBzdHIgU2VxdWVuY2Ugb2YgY2hh
cmFjdGVycyB0byBpbnRlcnByZXQgb3Ig
cGFzcyB0aHJvdWdoLgogKi8KaHRlcm0u
VGVybWluYWwucHJvdG90eXBlLmludGVy
cHJldCA9IGZ1bmN0aW9uKHN0cikgewog
IHRoaXMudnQuaW50ZXJwcmV0KHN0cik7
CiAgdGhpcy5zY2hlZHVsZVN5bmNDdXJz
b3JQb3NpdGlvbl8oKTsKfTsKCi8qKgog
KiBUYWtlIG92ZXIgdGhlIGdpdmVuIERJ
ViBmb3IgdXNlIGFzIHRoZSB0ZXJtaW5h
bCBkaXNwbGF5LgogKgogKiBAcGFyYW0g
e0hUTUxEaXZFbGVtZW50fSBkaXYgVGhl
IGRpdiB0byB1c2UgYXMgdGhlIHRlcm1p
bmFsIGRpc3BsYXkuCiAqLwpodGVybS5U
ZXJtaW5hbC5wcm90b3R5cGUuZGVjb3Jh
dGUgPSBmdW5jdGlvbihkaXYpIHsKICB0
aGlzLmRpdl8gPSBkaXY7CgogIHRoaXMu
c2Nyb2xsUG9ydF8uZGVjb3JhdGUoZGl2
KTsKICB0aGlzLnNjcm9sbFBvcnRfLnNl
dEJhY2tncm91bmRJbWFnZSh0aGlzLnBy
ZWZzXy5nZXQoJ2JhY2tncm91bmQtaW1h
Z2UnKSk7CiAgdGhpcy5zY3JvbGxQb3J0
Xy5zZXRCYWNrZ3JvdW5kU2l6ZSh0aGlz
LnByZWZzXy5nZXQoJ2JhY2tncm91bmQt
c2l6ZScpKTsKICB0aGlzLnNjcm9sbFBv
cnRfLnNldEJhY2tncm91bmRQb3NpdGlv
bigKICAgICAgdGhpcy5wcmVmc18uZ2V0
KCdiYWNrZ3JvdW5kLXBvc2l0aW9uJykp
OwogIHRoaXMuc2Nyb2xsUG9ydF8uc2V0
VXNlckNzcyh0aGlzLnByZWZzXy5nZXQo
J3VzZXItY3NzJykpOwoKICB0aGlzLmRp
dl8uZm9jdXMgPSB0aGlzLmZvY3VzLmJp
bmQodGhpcyk7CgogIHRoaXMuc2V0Rm9u
dFNpemUodGhpcy5wcmVmc18uZ2V0KCdm
b250LXNpemUnKSk7CiAgdGhpcy5zeW5j
Rm9udEZhbWlseSgpOwoKICB0aGlzLnNl
dFNjcm9sbGJhclZpc2libGUodGhpcy5w
cmVmc18uZ2V0KCdzY3JvbGxiYXItdmlz
aWJsZScpKTsKICB0aGlzLnNldFNjcm9s
bFdoZWVsTW92ZU11bHRpcGxlcigKICAg
ICAgdGhpcy5wcmVmc18uZ2V0KCdzY3Jv
bGwtd2hlZWwtbW92ZS1tdWx0aXBsaWVy
JykpOwoKICB0aGlzLmRvY3VtZW50XyA9
IHRoaXMuc2Nyb2xsUG9ydF8uZ2V0RG9j
dW1lbnQoKTsKCiAgdGhpcy5kb2N1bWVu
dF8uYm9keS5vbmNvbnRleHRtZW51ID0g
ZnVuY3Rpb24oKSB7IHJldHVybiBmYWxz
ZSB9OwoKICB2YXIgb25Nb3VzZSA9IHRo
aXMub25Nb3VzZV8uYmluZCh0aGlzKTsK
ICB2YXIgc2NyZWVuTm9kZSA9IHRoaXMu
c2Nyb2xsUG9ydF8uZ2V0U2NyZWVuTm9k
ZSgpOwogIHNjcmVlbk5vZGUuYWRkRXZl
bnRMaXN0ZW5lcignbW91c2Vkb3duJywg
b25Nb3VzZSk7CiAgc2NyZWVuTm9kZS5h
ZGRFdmVudExpc3RlbmVyKCdtb3VzZXVw
Jywgb25Nb3VzZSk7CiAgc2NyZWVuTm9k
ZS5hZGRFdmVudExpc3RlbmVyKCdtb3Vz
ZW1vdmUnLCBvbk1vdXNlKTsKICB0aGlz
LnNjcm9sbFBvcnRfLm9uU2Nyb2xsV2hl
ZWwgPSBvbk1vdXNlOwoKICBzY3JlZW5O
b2RlLmFkZEV2ZW50TGlzdGVuZXIoCiAg
ICAgICdmb2N1cycsIHRoaXMub25Gb2N1
c0NoYW5nZV8uYmluZCh0aGlzLCB0cnVl
KSk7CiAgLy8gTGlzdGVuIGZvciBtb3Vz
ZWRvd24gZXZlbnRzIG9uIHRoZSBzY3Jl
ZW5Ob2RlIGFzIGluIEZGIHRoZSBmb2N1
cwogIC8vIGV2ZW50cyBkb24ndCBidWJi
bGUuCiAgc2NyZWVuTm9kZS5hZGRFdmVu
dExpc3RlbmVyKCdtb3VzZWRvd24nLCBm
dW5jdGlvbigpIHsKICAgIHNldFRpbWVv
dXQodGhpcy5vbkZvY3VzQ2hhbmdlXy5i
aW5kKHRoaXMsIHRydWUpKTsKICB9LmJp
bmQodGhpcykpOwoKICBzY3JlZW5Ob2Rl
LmFkZEV2ZW50TGlzdGVuZXIoCiAgICAg
ICdibHVyJywgdGhpcy5vbkZvY3VzQ2hh
bmdlXy5iaW5kKHRoaXMsIGZhbHNlKSk7
CgogIHZhciBzdHlsZSA9IHRoaXMuZG9j
dW1lbnRfLmNyZWF0ZUVsZW1lbnQoJ3N0
eWxlJyk7CiAgc3R5bGUudGV4dENvbnRl
bnQgPQogICAgICAoJy5jdXJzb3Itbm9k
ZVtmb2N1cz0iZmFsc2UiXSB7JyArCiAg
ICAgICAnICBib3gtc2l6aW5nOiBib3Jk
ZXItYm94OycgKwogICAgICAgJyAgYmFj
a2dyb3VuZC1jb2xvcjogdHJhbnNwYXJl
bnQgIWltcG9ydGFudDsnICsKICAgICAg
ICcgIGJvcmRlci13aWR0aDogMnB4Oycg
KwogICAgICAgJyAgYm9yZGVyLXN0eWxl
OiBzb2xpZDsnICsKICAgICAgICd9JyAr
CiAgICAgICAnLndjLW5vZGUgeycgKwog
ICAgICAgJyAgZGlzcGxheTogaW5saW5l
LWJsb2NrOycgKwogICAgICAgJyAgdGV4
dC1hbGlnbjogY2VudGVyOycgKwogICAg
ICAgJyAgd2lkdGg6ICcgKyB0aGlzLnNj
cm9sbFBvcnRfLmNoYXJhY3RlclNpemUu
d2lkdGggKiAyICsgJ3B4OycgKwogICAg
ICAgJ30nKTsKICB0aGlzLmRvY3VtZW50
Xy5oZWFkLmFwcGVuZENoaWxkKHN0eWxl
KTsKCiAgdmFyIHN0eWxlU2hlZXRzID0g
dGhpcy5kb2N1bWVudF8uc3R5bGVTaGVl
dHM7CiAgdmFyIGNzc1J1bGVzID0gc3R5
bGVTaGVldHNbc3R5bGVTaGVldHMubGVu
Z3RoIC0gMV0uY3NzUnVsZXM7CiAgdGhp
cy53Y0Nzc1J1bGVfID0gY3NzUnVsZXNb
Y3NzUnVsZXMubGVuZ3RoIC0gMV07Cgog
IHRoaXMuY3Vyc29yTm9kZV8gPSB0aGlz
LmRvY3VtZW50Xy5jcmVhdGVFbGVtZW50
KCdkaXYnKTsKICB0aGlzLmN1cnNvck5v
ZGVfLmNsYXNzTmFtZSA9ICdjdXJzb3It
bm9kZSc7CiAgdGhpcy5jdXJzb3JOb2Rl
Xy5zdHlsZS5jc3NUZXh0ID0KICAgICAg
KCdwb3NpdGlvbjogYWJzb2x1dGU7JyAr
CiAgICAgICAndG9wOiAtOTlweDsnICsK
ICAgICAgICdkaXNwbGF5OiBibG9jazsn
ICsKICAgICAgICd3aWR0aDogJyArIHRo
aXMuc2Nyb2xsUG9ydF8uY2hhcmFjdGVy
U2l6ZS53aWR0aCArICdweDsnICsKICAg
ICAgICdoZWlnaHQ6ICcgKyB0aGlzLnNj
cm9sbFBvcnRfLmNoYXJhY3RlclNpemUu
aGVpZ2h0ICsgJ3B4OycgKwogICAgICAg
Jy13ZWJraXQtdHJhbnNpdGlvbjogb3Bh
Y2l0eSwgYmFja2dyb3VuZC1jb2xvciAx
MDBtcyBsaW5lYXI7JyArCiAgICAgICAn
LW1vei10cmFuc2l0aW9uOiBvcGFjaXR5
LCBiYWNrZ3JvdW5kLWNvbG9yIDEwMG1z
IGxpbmVhcjsnKTsKCiAgdGhpcy5zZXRD
dXJzb3JDb2xvcih0aGlzLnByZWZzXy5n
ZXQoJ2N1cnNvci1jb2xvcicpKTsKICB0
aGlzLnNldEN1cnNvckJsaW5rKCEhdGhp
cy5wcmVmc18uZ2V0KCdjdXJzb3ItYmxp
bmsnKSk7CiAgdGhpcy5yZXN0eWxlQ3Vy
c29yXygpOwoKICB0aGlzLmRvY3VtZW50
Xy5ib2R5LmFwcGVuZENoaWxkKHRoaXMu
Y3Vyc29yTm9kZV8pOwoKICAvLyBXaGVu
ICdlbmFibGVNb3VzZURyYWdTY3JvbGwn
IGlzIG9mZiB3ZSByZXBvc2l0aW9uIHRo
aXMgZWxlbWVudCBkaXJlY3RseQogIC8v
IHVuZGVyIHRoZSBtb3VzZSBjdXJzb3Ig
YWZ0ZXIgYSBjbGljay4gIFRoaXMgbWFr
ZXMgQ2hyb21lIGFzc29jaWF0ZQogIC8v
IHN1YnNlcXVlbnQgbW91c2Vtb3ZlIGV2
ZW50cyB3aXRoIHRoZSBzY3JvbGwtYmxv
Y2tlci4gIFNpbmNlIHRoZQogIC8vIHNj
cm9sbC1ibG9ja2VyIGlzIGEgcGVlciAo
bm90IGEgY2hpbGQpIG9mIHRoZSBzY3Jv
bGxwb3J0LCB0aGUgbW91c2Vtb3ZlCiAg
Ly8gZXZlbnRzIGRvIG5vdCBjYXVzZSB0
aGUgc2Nyb2xscG9ydCB0byBzY3JvbGwu
CiAgLy8KICAvLyBJdCdzIGEgaGFjaywg
YnV0IGl0J3MgdGhlIGNsZWFuZXN0IHdh
eSBJIGNvdWxkIGZpbmQuCiAgdGhpcy5z
Y3JvbGxCbG9ja2VyTm9kZV8gPSB0aGlz
LmRvY3VtZW50Xy5jcmVhdGVFbGVtZW50
KCdkaXYnKTsKICB0aGlzLnNjcm9sbEJs
b2NrZXJOb2RlXy5zdHlsZS5jc3NUZXh0
ID0KICAgICAgKCdwb3NpdGlvbjogYWJz
b2x1dGU7JyArCiAgICAgICAndG9wOiAt
OTlweDsnICsKICAgICAgICdkaXNwbGF5
OiBibG9jazsnICsKICAgICAgICd3aWR0
aDogMTBweDsnICsKICAgICAgICdoZWln
aHQ6IDEwcHg7Jyk7CiAgdGhpcy5kb2N1
bWVudF8uYm9keS5hcHBlbmRDaGlsZCh0
aGlzLnNjcm9sbEJsb2NrZXJOb2RlXyk7
CgogIHZhciBvbk1vdXNlID0gdGhpcy5v
bk1vdXNlXy5iaW5kKHRoaXMpOwogIHRo
aXMuc2Nyb2xsUG9ydF8ub25TY3JvbGxX
aGVlbCA9IG9uTW91c2U7CiAgWydtb3Vz
ZWRvd24nLCAnbW91c2V1cCcsICdtb3Vz
ZW1vdmUnLCAnY2xpY2snLCAnZGJsY2xp
Y2snLAogICBdLmZvckVhY2goZnVuY3Rp
b24oZXZlbnQpIHsKICAgICAgIHRoaXMu
c2Nyb2xsQmxvY2tlck5vZGVfLmFkZEV2
ZW50TGlzdGVuZXIoZXZlbnQsIG9uTW91
c2UpOwogICAgICAgdGhpcy5jdXJzb3JO
b2RlXy5hZGRFdmVudExpc3RlbmVyKGV2
ZW50LCBvbk1vdXNlKTsKICAgICAgIHRo
aXMuZG9jdW1lbnRfLmFkZEV2ZW50TGlz
dGVuZXIoZXZlbnQsIG9uTW91c2UpOwog
ICAgIH0uYmluZCh0aGlzKSk7CgogIHRo
aXMuY3Vyc29yTm9kZV8uYWRkRXZlbnRM
aXN0ZW5lcignbW91c2Vkb3duJywgZnVu
Y3Rpb24oKSB7CiAgICAgIHNldFRpbWVv
dXQodGhpcy5mb2N1cy5iaW5kKHRoaXMp
KTsKICAgIH0uYmluZCh0aGlzKSk7Cgog
IHRoaXMuc2V0UmV2ZXJzZVZpZGVvKGZh
bHNlKTsKCiAgdGhpcy5zY3JvbGxQb3J0
Xy5mb2N1cygpOwogIHRoaXMuc2Nyb2xs
UG9ydF8uc2NoZWR1bGVSZWRyYXcoKTsK
fTsKCi8qKgogKiBSZXR1cm4gdGhlIEhU
TUwgZG9jdW1lbnQgdGhhdCBjb250YWlu
cyB0aGUgdGVybWluYWwgRE9NIG5vZGVz
LgogKi8KaHRlcm0uVGVybWluYWwucHJv
dG90eXBlLmdldERvY3VtZW50ID0gZnVu
Y3Rpb24oKSB7CiAgcmV0dXJuIHRoaXMu
ZG9jdW1lbnRfOwp9OwoKLyoqCiAqIEZv
Y3VzIHRoZSB0ZXJtaW5hbC4KICovCmh0
ZXJtLlRlcm1pbmFsLnByb3RvdHlwZS5m
b2N1cyA9IGZ1bmN0aW9uKCkgewogIHRo
aXMuc2Nyb2xsUG9ydF8uZm9jdXMoKTsK
fTsKCi8qKgogKiBSZXR1cm4gdGhlIEhU
TUwgRWxlbWVudCBmb3IgYSBnaXZlbiBy
b3cgaW5kZXguCiAqCiAqIFRoaXMgaXMg
YSBtZXRob2QgZnJvbSB0aGUgUm93UHJv
dmlkZXIgaW50ZXJmYWNlLiAgVGhlIFNj
cm9sbFBvcnQgdXNlcwogKiBpdCB0byBm
ZXRjaCByb3dzIG9uIGRlbWFuZCBhcyB0
aGV5IGFyZSBzY3JvbGxlZCBpbnRvIHZp
ZXcuCiAqCiAqIFRPRE8ocmdpbmRhKTog
Q29uc2lkZXIgc2F2aW5nIHNjcm9sbGJh
Y2sgcm93cyBhcyAoSFRNTCBzb3VyY2Us
IHRleHQgY29udGVudCkKICogcGFpcnMg
dG8gY29uc2VydmUgbWVtb3J5LgogKgog
KiBAcGFyYW0ge2ludGVnZXJ9IGluZGV4
IFRoZSB6ZXJvLWJhc2VkIHJvdyBpbmRl
eCwgbWVhc3VyZWQgcmVsYXRpdmUgdG8g
dGhlCiAqICAgICBzdGFydCBvZiB0aGUg
c2Nyb2xsYmFjayBidWZmZXIuICBPbi1z
Y3JlZW4gcm93cyB3aWxsIGFsd2F5cyBo
YXZlIHRoZQogKiAgICAgbGFyZ2VzdCBp
bmRpY2llcy4KICogQHJldHVybiB7SFRN
TEVsZW1lbnR9IFRoZSAneC1yb3cnIGVs
ZW1lbnQgY29udGFpbmluZyBmb3IgdGhl
IHJlcXVlc3RlZCByb3cuCiAqLwpodGVy
bS5UZXJtaW5hbC5wcm90b3R5cGUuZ2V0
Um93Tm9kZSA9IGZ1bmN0aW9uKGluZGV4
KSB7CiAgaWYgKGluZGV4IDwgdGhpcy5z
Y3JvbGxiYWNrUm93c18ubGVuZ3RoKQog
ICAgcmV0dXJuIHRoaXMuc2Nyb2xsYmFj
a1Jvd3NfW2luZGV4XTsKCiAgdmFyIHNj
cmVlbkluZGV4ID0gaW5kZXggLSB0aGlz
LnNjcm9sbGJhY2tSb3dzXy5sZW5ndGg7
CiAgcmV0dXJuIHRoaXMuc2NyZWVuXy5y
b3dzQXJyYXlbc2NyZWVuSW5kZXhdOwp9
OwoKLyoqCiAqIFJldHVybiB0aGUgdGV4
dCBjb250ZW50IGZvciBhIGdpdmVuIHJh
bmdlIG9mIHJvd3MuCiAqCiAqIFRoaXMg
aXMgYSBtZXRob2QgZnJvbSB0aGUgUm93
UHJvdmlkZXIgaW50ZXJmYWNlLiAgVGhl
IFNjcm9sbFBvcnQgdXNlcwogKiBpdCB0
byBmZXRjaCB0ZXh0IGNvbnRlbnQgb24g
ZGVtYW5kIHdoZW4gdGhlIHVzZXIgYXR0
ZW1wdHMgdG8gY29weSB0aGVpcgogKiBz
ZWxlY3Rpb24gdG8gdGhlIGNsaXBib2Fy
ZC4KICoKICogQHBhcmFtIHtpbnRlZ2Vy
fSBzdGFydCBUaGUgemVyby1iYXNlZCBy
b3cgaW5kZXggdG8gc3RhcnQgZnJvbSwg
bWVhc3VyZWQKICogICAgIHJlbGF0aXZl
IHRvIHRoZSBzdGFydCBvZiB0aGUgc2Ny
b2xsYmFjayBidWZmZXIuICBPbi1zY3Jl
ZW4gcm93cyB3aWxsCiAqICAgICBhbHdh
eXMgaGF2ZSB0aGUgbGFyZ2VzdCBpbmRp
Y2llcy4KICogQHBhcmFtIHtpbnRlZ2Vy
fSBlbmQgVGhlIHplcm8tYmFzZWQgcm93
IGluZGV4IHRvIGVuZCBvbiwgbWVhc3Vy
ZWQKICogICAgIHJlbGF0aXZlIHRvIHRo
ZSBzdGFydCBvZiB0aGUgc2Nyb2xsYmFj
ayBidWZmZXIuCiAqIEByZXR1cm4ge3N0
cmluZ30gQSBzaW5nbGUgc3RyaW5nIGNv
bnRhaW5pbmcgdGhlIHRleHQgdmFsdWUg
b2YgdGhlIHJhbmdlIG9mCiAqICAgICBy
b3dzLiAgTGluZXMgd2lsbCBiZSBuZXds
aW5lIGRlbGltaXRlZCwgd2l0aCBubyB0
cmFpbGluZyBuZXdsaW5lLgogKi8KaHRl
cm0uVGVybWluYWwucHJvdG90eXBlLmdl
dFJvd3NUZXh0ID0gZnVuY3Rpb24oc3Rh
cnQsIGVuZCkgewogIHZhciBhcnkgPSBb
XTsKICBmb3IgKHZhciBpID0gc3RhcnQ7
IGkgPCBlbmQ7IGkrKykgewogICAgdmFy
IG5vZGUgPSB0aGlzLmdldFJvd05vZGUo
aSk7CiAgICBhcnkucHVzaChub2RlLnRl
eHRDb250ZW50KTsKICAgIGlmIChpIDwg
ZW5kIC0gMSAmJiAhbm9kZS5nZXRBdHRy
aWJ1dGUoJ2xpbmUtb3ZlcmZsb3cnKSkK
ICAgICAgYXJ5LnB1c2goJ1xuJyk7CiAg
fQoKICByZXR1cm4gYXJ5LmpvaW4oJycp
Owp9OwoKLyoqCiAqIFJldHVybiB0aGUg
dGV4dCBjb250ZW50IGZvciBhIGdpdmVu
IHJvdy4KICoKICogVGhpcyBpcyBhIG1l
dGhvZCBmcm9tIHRoZSBSb3dQcm92aWRl
ciBpbnRlcmZhY2UuICBUaGUgU2Nyb2xs
UG9ydCB1c2VzCiAqIGl0IHRvIGZldGNo
IHRleHQgY29udGVudCBvbiBkZW1hbmQg
d2hlbiB0aGUgdXNlciBhdHRlbXB0cyB0
byBjb3B5IHRoZWlyCiAqIHNlbGVjdGlv
biB0byB0aGUgY2xpcGJvYXJkLgogKgog
KiBAcGFyYW0ge2ludGVnZXJ9IGluZGV4
IFRoZSB6ZXJvLWJhc2VkIHJvdyBpbmRl
eCB0byByZXR1cm4sIG1lYXN1cmVkCiAq
ICAgICByZWxhdGl2ZSB0byB0aGUgc3Rh
cnQgb2YgdGhlIHNjcm9sbGJhY2sgYnVm
ZmVyLiAgT24tc2NyZWVuIHJvd3Mgd2ls
bAogKiAgICAgYWx3YXlzIGhhdmUgdGhl
IGxhcmdlc3QgaW5kaWNpZXMuCiAqIEBy
ZXR1cm4ge3N0cmluZ30gQSBzdHJpbmcg
Y29udGFpbmluZyB0aGUgdGV4dCB2YWx1
ZSBvZiB0aGUgc2VsZWN0ZWQgcm93Lgog
Ki8KaHRlcm0uVGVybWluYWwucHJvdG90
eXBlLmdldFJvd1RleHQgPSBmdW5jdGlv
bihpbmRleCkgewogIHZhciBub2RlID0g
dGhpcy5nZXRSb3dOb2RlKGluZGV4KTsK
ICByZXR1cm4gbm9kZS50ZXh0Q29udGVu
dDsKfTsKCi8qKgogKiBSZXR1cm4gdGhl
IHRvdGFsIG51bWJlciBvZiByb3dzIGlu
IHRoZSBhZGRyZXNzYWJsZSBzY3JlZW4g
YW5kIGluIHRoZQogKiBzY3JvbGxiYWNr
IGJ1ZmZlciBvZiB0aGlzIHRlcm1pbmFs
LgogKgogKiBUaGlzIGlzIGEgbWV0aG9k
IGZyb20gdGhlIFJvd1Byb3ZpZGVyIGlu
dGVyZmFjZS4gIFRoZSBTY3JvbGxQb3J0
IHVzZXMKICogaXQgdG8gY29tcHV0ZSB0
aGUgc2l6ZSBvZiB0aGUgc2Nyb2xsYmFy
LgogKgogKiBAcmV0dXJuIHtpbnRlZ2Vy
fSBUaGUgbnVtYmVyIG9mIHJvd3MgaW4g
dGhpcyB0ZXJtaW5hbC4KICovCmh0ZXJt
LlRlcm1pbmFsLnByb3RvdHlwZS5nZXRS
b3dDb3VudCA9IGZ1bmN0aW9uKCkgewog
IHJldHVybiB0aGlzLnNjcm9sbGJhY2tS
b3dzXy5sZW5ndGggKyB0aGlzLnNjcmVl
bl8ucm93c0FycmF5Lmxlbmd0aDsKfTsK
Ci8qKgogKiBDcmVhdGUgRE9NIG5vZGVz
IGZvciBuZXcgcm93cyBhbmQgYXBwZW5k
IHRoZW0gdG8gdGhlIGVuZCBvZiB0aGUg
dGVybWluYWwuCiAqCiAqIFRoaXMgaXMg
dGhlIG9ubHkgY29ycmVjdCB3YXkgdG8g
YWRkIGEgbmV3IERPTSBub2RlIGZvciBh
IHJvdy4gIE5vdGljZSB0aGF0CiAqIHRo
ZSBuZXcgcm93IGlzIGFwcGVuZGVkIHRv
IHRoZSBib3R0b20gb2YgdGhlIGxpc3Qg
b2Ygcm93cywgYW5kIGRvZXMgbm90CiAq
IHJlcXVpcmUgcmVudW1iZXJpbmcgKG9m
IHRoZSByb3dJbmRleCBwcm9wZXJ0eSkg
b2YgcHJldmlvdXMgcm93cy4KICoKICog
SWYgeW91IHRoaW5rIHlvdSB3YW50IGEg
bmV3IGJsYW5rIHJvdyBzb21ld2hlcmUg
aW4gdGhlIG1pZGRsZSBvZiB0aGUKICog
dGVybWluYWwsIGxvb2sgaW50byBtb3Zl
Um93c18oKS4KICoKICogVGhpcyBtZXRo
b2QgZG9lcyBub3QgcGF5IGF0dGVudGlv
biB0byB2dFNjcm9sbFRvcC9Cb3R0b20s
IHNpbmNlIHlvdSBzaG91bGQKICogYmUg
dXNpbmcgbW92ZVJvd3MoKSBpbiBjYXNl
cyB3aGVyZSB0aGV5IHdvdWxkIG1hdHRl
ci4KICoKICogVGhlIGN1cnNvciB3aWxs
IGJlIHBvc2l0aW9uZWQgYXQgY29sdW1u
IDAgb2YgdGhlIGZpcnN0IGluc2VydGVk
IGxpbmUuCiAqLwpodGVybS5UZXJtaW5h
bC5wcm90b3R5cGUuYXBwZW5kUm93c18g
PSBmdW5jdGlvbihjb3VudCkgewogIHZh
ciBjdXJzb3JSb3cgPSB0aGlzLnNjcmVl
bl8ucm93c0FycmF5Lmxlbmd0aDsKICB2
YXIgb2Zmc2V0ID0gdGhpcy5zY3JvbGxi
YWNrUm93c18ubGVuZ3RoICsgY3Vyc29y
Um93OwogIGZvciAodmFyIGkgPSAwOyBp
IDwgY291bnQ7IGkrKykgewogICAgdmFy
IHJvdyA9IHRoaXMuZG9jdW1lbnRfLmNy
ZWF0ZUVsZW1lbnQoJ3gtcm93Jyk7CiAg
ICByb3cuYXBwZW5kQ2hpbGQodGhpcy5k
b2N1bWVudF8uY3JlYXRlVGV4dE5vZGUo
JycpKTsKICAgIHJvdy5yb3dJbmRleCA9
IG9mZnNldCArIGk7CiAgICB0aGlzLnNj
cmVlbl8ucHVzaFJvdyhyb3cpOwogIH0K
CiAgdmFyIGV4dHJhUm93cyA9IHRoaXMu
c2NyZWVuXy5yb3dzQXJyYXkubGVuZ3Ro
IC0gdGhpcy5zY3JlZW5TaXplLmhlaWdo
dDsKICBpZiAoZXh0cmFSb3dzID4gMCkg
ewogICAgdmFyIGFyeSA9IHRoaXMuc2Ny
ZWVuXy5zaGlmdFJvd3MoZXh0cmFSb3dz
KTsKICAgIEFycmF5LnByb3RvdHlwZS5w
dXNoLmFwcGx5KHRoaXMuc2Nyb2xsYmFj
a1Jvd3NfLCBhcnkpOwogICAgaWYgKHRo
aXMuc2Nyb2xsUG9ydF8uaXNTY3JvbGxl
ZEVuZCkKICAgICAgdGhpcy5zY2hlZHVs
ZVNjcm9sbERvd25fKCk7CiAgfQoKICBp
ZiAoY3Vyc29yUm93ID49IHRoaXMuc2Ny
ZWVuXy5yb3dzQXJyYXkubGVuZ3RoKQog
ICAgY3Vyc29yUm93ID0gdGhpcy5zY3Jl
ZW5fLnJvd3NBcnJheS5sZW5ndGggLSAx
OwoKICB0aGlzLnNldEFic29sdXRlQ3Vy
c29yUG9zaXRpb24oY3Vyc29yUm93LCAw
KTsKfTsKCi8qKgogKiBSZWxvY2F0ZSBy
b3dzIGZyb20gb25lIHBhcnQgb2YgdGhl
IGFkZHJlc3NhYmxlIHNjcmVlbiB0byBh
bm90aGVyLgogKgogKiBUaGlzIGlzIHVz
ZWQgdG8gcmVjeWNsZSByb3dzIGR1cmlu
ZyBWVCBzY3JvbGxzICh0aG9zZSB3aGlj
aCBhcmUgZHJpdmVuCiAqIGJ5IFZUIGNv
bW1hbmRzLCByYXRoZXIgdGhhbiBieSB0
aGUgdXNlciBtYW5pcHVsYXRpbmcgdGhl
IHNjcm9sbGJhci4pCiAqCiAqIEluIHRo
aXMgY2FzZSwgdGhlIGJsYW5rIGxpbmVz
IHNjcm9sbGVkIGludG8gdGhlIHNjcm9s
bCByZWdpb24gYXJlIG1hZGUgb2YKICog
dGhlIG5vZGVzIHdlIHNjcm9sbGVkIG9m
Zi4gIFRoZXNlIGhhdmUgdGhlaXIgcm93
SW5kZXggcHJvcGVydGllcyBjYXJlZnVs
bHkKICogcmVudW1iZXJlZCBzbyBhcyBu
b3QgdG8gY29uZnVzZSB0aGUgU2Nyb2xs
UG9ydC4KICovCmh0ZXJtLlRlcm1pbmFs
LnByb3RvdHlwZS5tb3ZlUm93c18gPSBm
dW5jdGlvbihmcm9tSW5kZXgsIGNvdW50
LCB0b0luZGV4KSB7CiAgdmFyIGFyeSA9
IHRoaXMuc2NyZWVuXy5yZW1vdmVSb3dz
KGZyb21JbmRleCwgY291bnQpOwogIHRo
aXMuc2NyZWVuXy5pbnNlcnRSb3dzKHRv
SW5kZXgsIGFyeSk7CgogIHZhciBzdGFy
dCwgZW5kOwogIGlmIChmcm9tSW5kZXgg
PCB0b0luZGV4KSB7CiAgICBzdGFydCA9
IGZyb21JbmRleDsKICAgIGVuZCA9IHRv
SW5kZXggKyBjb3VudDsKICB9IGVsc2Ug
ewogICAgc3RhcnQgPSB0b0luZGV4Owog
ICAgZW5kID0gZnJvbUluZGV4ICsgY291
bnQ7CiAgfQoKICB0aGlzLnJlbnVtYmVy
Um93c18oc3RhcnQsIGVuZCk7CiAgdGhp
cy5zY3JvbGxQb3J0Xy5zY2hlZHVsZUlu
dmFsaWRhdGUoKTsKfTsKCi8qKgogKiBS
ZW51bWJlciB0aGUgcm93SW5kZXggcHJv
cGVydHkgb2YgdGhlIGdpdmVuIHJhbmdl
IG9mIHJvd3MuCiAqCiAqIFRoZSBzdGFy
dCBhbmQgZW5kIGluZGljaWVzIGFyZSBy
ZWxhdGl2ZSB0byB0aGUgc2NyZWVuLCBu
b3QgdGhlIHNjcm9sbGJhY2suCiAqIFJv
d3MgaW4gdGhlIHNjcm9sbGJhY2sgYnVm
ZmVyIGNhbm5vdCBiZSByZW51bWJlcmVk
LiAgU2luY2UgdGhleSBhcmUgbm90CiAq
IGFkZHJlc3NhYmxlICh5b3UgY2FuJ3Qg
ZGVsZXRlIHRoZW0sIHNjcm9sbCB0aGVt
LCBldGMpLCB5b3Ugc2hvdWxkIGhhdmUK
ICogbm8gbmVlZCB0byByZW51bWJlciBz
Y3JvbGxiYWNrIHJvd3MuCiAqLwpodGVy
bS5UZXJtaW5hbC5wcm90b3R5cGUucmVu
dW1iZXJSb3dzXyA9IGZ1bmN0aW9uKHN0
YXJ0LCBlbmQsIG9wdF9zY3JlZW4pIHsK
ICB2YXIgc2NyZWVuID0gb3B0X3NjcmVl
biB8fCB0aGlzLnNjcmVlbl87CgogIHZh
ciBvZmZzZXQgPSB0aGlzLnNjcm9sbGJh
Y2tSb3dzXy5sZW5ndGg7CiAgZm9yICh2
YXIgaSA9IHN0YXJ0OyBpIDwgZW5kOyBp
KyspIHsKICAgIHNjcmVlbi5yb3dzQXJy
YXlbaV0ucm93SW5kZXggPSBvZmZzZXQg
KyBpOwogIH0KfTsKCi8qKgogKiBQcmlu
dCBhIHN0cmluZyB0byB0aGUgdGVybWlu
YWwuCiAqCiAqIFRoaXMgcmVzcGVjdHMg
dGhlIGN1cnJlbnQgaW5zZXJ0IGFuZCB3
cmFwYXJvdW5kIG1vZGVzLiAgSXQgd2ls
bCBhZGQgbmV3IGxpbmVzCiAqIHRvIHRo
ZSBlbmQgb2YgdGhlIHRlcm1pbmFsLCBz
Y3JvbGxpbmcgb2ZmIHRoZSB0b3AgaW50
byB0aGUgc2Nyb2xsYmFjayBidWZmZXIK
ICogaWYgbmVjZXNzYXJ5LgogKgogKiBU
aGUgc3RyaW5nIGlzICpub3QqIHBhcnNl
ZCBmb3IgZXNjYXBlIGNvZGVzLiAgVXNl
IHRoZSBpbnRlcnByZXQoKSBtZXRob2Qg
aWYKICogdGhhdCdzIHdoYXQgeW91J3Jl
IGFmdGVyLgogKgogKiBAcGFyYW17c3Ry
aW5nfSBzdHIgVGhlIHN0cmluZyB0byBw
cmludC4KICovCmh0ZXJtLlRlcm1pbmFs
LnByb3RvdHlwZS5wcmludCA9IGZ1bmN0
aW9uKHN0cikgewogIHZhciBzdGFydE9m
ZnNldCA9IDA7CgogIHZhciBzdHJXaWR0
aCA9IGxpYi53Yy5zdHJXaWR0aChzdHIp
OwoKICB3aGlsZSAoc3RhcnRPZmZzZXQg
PCBzdHJXaWR0aCkgewogICAgaWYgKHRo
aXMub3B0aW9uc18ud3JhcGFyb3VuZCAm
JiB0aGlzLnNjcmVlbl8uY3Vyc29yUG9z
aXRpb24ub3ZlcmZsb3cpIHsKICAgICAg
dGhpcy5zY3JlZW5fLmNvbW1pdExpbmVP
dmVyZmxvdygpOwogICAgICB0aGlzLm5l
d0xpbmUoKTsKICAgIH0KCiAgICB2YXIg
Y291bnQgPSBzdHJXaWR0aCAtIHN0YXJ0
T2Zmc2V0OwogICAgdmFyIGRpZE92ZXJm
bG93ID0gZmFsc2U7CiAgICB2YXIgc3Vi
c3RyOwoKICAgIGlmICh0aGlzLnNjcmVl
bl8uY3Vyc29yUG9zaXRpb24uY29sdW1u
ICsgY291bnQgPj0gdGhpcy5zY3JlZW5T
aXplLndpZHRoKSB7CiAgICAgIGRpZE92
ZXJmbG93ID0gdHJ1ZTsKICAgICAgY291
bnQgPSB0aGlzLnNjcmVlblNpemUud2lk
dGggLSB0aGlzLnNjcmVlbl8uY3Vyc29y
UG9zaXRpb24uY29sdW1uOwogICAgfQoK
ICAgIGlmIChkaWRPdmVyZmxvdyAmJiAh
dGhpcy5vcHRpb25zXy53cmFwYXJvdW5k
KSB7CiAgICAgIC8vIElmIHRoZSBzdHJp
bmcgb3ZlcmZsb3dlZCB0aGUgbGluZSBi
dXQgd3JhcGFyb3VuZCBpcyBvZmYsIHRo
ZW4gdGhlCiAgICAgIC8vIGxhc3QgcHJp
bnRlZCBjaGFyYWN0ZXIgc2hvdWxkIGJl
IHRoZSBsYXN0IG9mIHRoZSBzdHJpbmcu
CiAgICAgIC8vIFRPRE86IFRoaXMgd2ls
bCBhZGQgdG8gb3VyIHByb2JsZW1zIHdp
dGggbXVsdGlieXRlIFVURi0xNiBjaGFy
YWN0ZXJzLgogICAgICBzdWJzdHIgPSBs
aWIud2Muc3Vic3RyKHN0ciwgc3RhcnRP
ZmZzZXQsIGNvdW50IC0gMSkgKwogICAg
ICAgICAgbGliLndjLnN1YnN0cihzdHIs
IHN0cldpZHRoIC0gMSk7CiAgICAgIGNv
dW50ID0gc3RyV2lkdGg7CiAgICB9IGVs
c2UgewogICAgICBzdWJzdHIgPSBsaWIu
d2Muc3Vic3RyKHN0ciwgc3RhcnRPZmZz
ZXQsIGNvdW50KTsKICAgIH0KCiAgICB2
YXIgdG9rZW5zID0gaHRlcm0uVGV4dEF0
dHJpYnV0ZXMuc3BsaXRXaWRlY2hhclN0
cmluZyhzdWJzdHIpOwogICAgZm9yICh2
YXIgaSA9IDA7IGkgPCB0b2tlbnMubGVu
Z3RoOyBpKyspIHsKICAgICAgaWYgKHRv
a2Vuc1tpXS53Y05vZGUpCiAgICAgICAg
dGhpcy5zY3JlZW5fLnRleHRBdHRyaWJ1
dGVzLndjTm9kZSA9IHRydWU7CgogICAg
ICBpZiAodGhpcy5vcHRpb25zXy5pbnNl
cnRNb2RlKSB7CiAgICAgICAgICB0aGlz
LnNjcmVlbl8uaW5zZXJ0U3RyaW5nKHRv
a2Vuc1tpXS5zdHIpOwogICAgICB9IGVs
c2UgewogICAgICAgIHRoaXMuc2NyZWVu
Xy5vdmVyd3JpdGVTdHJpbmcodG9rZW5z
W2ldLnN0cik7CiAgICAgIH0KICAgICAg
dGhpcy5zY3JlZW5fLnRleHRBdHRyaWJ1
dGVzLndjTm9kZSA9IGZhbHNlOwogICAg
fQoKICAgIHRoaXMuc2NyZWVuXy5tYXli
ZUNsaXBDdXJyZW50Um93KCk7CiAgICBz
dGFydE9mZnNldCArPSBjb3VudDsKICB9
CgogIHRoaXMuc2NoZWR1bGVTeW5jQ3Vy
c29yUG9zaXRpb25fKCk7CgogIGlmICh0
aGlzLnNjcm9sbE9uT3V0cHV0XykKICAg
IHRoaXMuc2Nyb2xsUG9ydF8uc2Nyb2xs
Um93VG9Cb3R0b20odGhpcy5nZXRSb3dD
b3VudCgpKTsKfTsKCi8qKgogKiBTZXQg
dGhlIFZUIHNjcm9sbCByZWdpb24uCiAq
CiAqIFRoaXMgYWxzbyByZXNldHMgdGhl
IGN1cnNvciBwb3NpdGlvbiB0byB0aGUg
YWJzb2x1dGUgKDAsIDApIHBvc2l0aW9u
LCBzaW5jZQogKiB0aGF0J3Mgd2hhdCB4
dGVybSBhcHBlYXJzIHRvIGRvLgogKgog
KiBTZXR0aW5nIHRoZSBzY3JvbGwgcmVn
aW9uIHRvIHRoZSBmdWxsIGhlaWdodCBv
ZiB0aGUgdGVybWluYWwgd2lsbCBjbGVh
cgogKiB0aGUgc2Nyb2xsIHJlZ2lvbi4g
IFRoaXMgaXMgKk5PVCogd2hhdCBtb3N0
IHRlcm1pbmFscyBkby4gIFdlJ3JlIGV4
cGxpY2l0bHkKICogZ29pbmcgIm9mZi1z
cGVjIiBoZXJlIGJlY2F1c2UgaXQgbWFr
ZXMgYHNjcmVlbmAgYW5kIGB0bXV4YCBv
dmVyZmxvdyBpbnRvIHRoZQogKiBsb2Nh
bCBzY3JvbGxiYWNrIGJ1ZmZlciwgd2hp
Y2ggbWVhbnMgdGhlIHNjcm9sbGJhcnMg
YW5kIHNoaWZ0LXBndXAvcGdkbgogKiBj
b250aW51ZSB0byB3b3JrIGFzIG1vc3Qg
dXNlcnMgd291bGQgZXhwZWN0LgogKgog
KiBAcGFyYW0ge2ludGVnZXJ9IHNjcm9s
bFRvcCBUaGUgemVyby1iYXNlZCB0b3Ag
b2YgdGhlIHNjcm9sbCByZWdpb24uCiAq
IEBwYXJhbSB7aW50ZWdlcn0gc2Nyb2xs
Qm90dG9tIFRoZSB6ZXJvLWJhc2VkIGJv
dHRvbSBvZiB0aGUgc2Nyb2xsIHJlZ2lv
biwKICogICAgIGluY2x1c2l2ZS4KICov
Cmh0ZXJtLlRlcm1pbmFsLnByb3RvdHlw
ZS5zZXRWVFNjcm9sbFJlZ2lvbiA9IGZ1
bmN0aW9uKHNjcm9sbFRvcCwgc2Nyb2xs
Qm90dG9tKSB7CiAgaWYgKHNjcm9sbFRv
cCA9PSAwICYmIHNjcm9sbEJvdHRvbSA9
PSB0aGlzLnNjcmVlblNpemUuaGVpZ2h0
IC0gMSkgewogICAgdGhpcy52dFNjcm9s
bFRvcF8gPSBudWxsOwogICAgdGhpcy52
dFNjcm9sbEJvdHRvbV8gPSBudWxsOwog
IH0gZWxzZSB7CiAgICB0aGlzLnZ0U2Ny
b2xsVG9wXyA9IHNjcm9sbFRvcDsKICAg
IHRoaXMudnRTY3JvbGxCb3R0b21fID0g
c2Nyb2xsQm90dG9tOwogIH0KfTsKCi8q
KgogKiBSZXR1cm4gdGhlIHRvcCByb3cg
aW5kZXggYWNjb3JkaW5nIHRvIHRoZSBW
VC4KICoKICogVGhpcyB3aWxsIHJldHVy
biAwIHVubGVzcyB0aGUgdGVybWluYWwg
aGFzIGJlZW4gdG9sZCB0byByZXN0cmlj
dCBzY3JvbGxpbmcKICogdG8gc29tZSBs
b3dlciByb3cuICBJdCBpcyB1c2VkIGZv
ciBzb21lIFZUIGN1cnNvciBwb3NpdGlv
bmluZyBhbmQgc2Nyb2xsaW5nCiAqIGNv
bW1hbmRzLgogKgogKiBAcmV0dXJuIHtp
bnRlZ2VyfSBUaGUgdG9wbW9zdCByb3cg
aW4gdGhlIHRlcm1pbmFsJ3Mgc2Nyb2xs
IHJlZ2lvbi4KICovCmh0ZXJtLlRlcm1p
bmFsLnByb3RvdHlwZS5nZXRWVFNjcm9s
bFRvcCA9IGZ1bmN0aW9uKCkgewogIGlm
ICh0aGlzLnZ0U2Nyb2xsVG9wXyAhPSBu
dWxsKQogICAgcmV0dXJuIHRoaXMudnRT
Y3JvbGxUb3BfOwoKICByZXR1cm4gMDsK
fTsKCi8qKgogKiBSZXR1cm4gdGhlIGJv
dHRvbSByb3cgaW5kZXggYWNjb3JkaW5n
IHRvIHRoZSBWVC4KICoKICogVGhpcyB3
aWxsIHJldHVybiB0aGUgaGVpZ2h0IG9m
IHRoZSB0ZXJtaW5hbCB1bmxlc3MgdGhl
IGl0IGhhcyBiZWVuIHRvbGQgdG8KICog
cmVzdHJpY3Qgc2Nyb2xsaW5nIHRvIHNv
bWUgaGlnaGVyIHJvdy4gIEl0IGlzIHVz
ZWQgZm9yIHNvbWUgVlQgY3Vyc29yCiAq
IHBvc2l0aW9uaW5nIGFuZCBzY3JvbGxp
bmcgY29tbWFuZHMuCiAqCiAqIEByZXR1
cm4ge2ludGVnZXJ9IFRoZSBib3R0b21t
b3N0IHJvdyBpbiB0aGUgdGVybWluYWwn
cyBzY3JvbGwgcmVnaW9uLgogKi8KaHRl
cm0uVGVybWluYWwucHJvdG90eXBlLmdl
dFZUU2Nyb2xsQm90dG9tID0gZnVuY3Rp
b24oKSB7CiAgaWYgKHRoaXMudnRTY3Jv
bGxCb3R0b21fICE9IG51bGwpCiAgICBy
ZXR1cm4gdGhpcy52dFNjcm9sbEJvdHRv
bV87CgogIHJldHVybiB0aGlzLnNjcmVl
blNpemUuaGVpZ2h0IC0gMTsKfQoKLyoq
CiAqIFByb2Nlc3MgYSAnXG4nIGNoYXJh
Y3Rlci4KICoKICogSWYgdGhlIGN1cnNv
ciBpcyBvbiB0aGUgZmluYWwgcm93IG9m
IHRoZSB0ZXJtaW5hbCB0aGlzIHdpbGwg
YXBwZW5kIGEgbmV3CiAqIGJsYW5rIHJv
dyB0byB0aGUgc2NyZWVuIGFuZCBzY3Jv
bGwgdGhlIHRvcG1vc3Qgcm93IGludG8g
dGhlIHNjcm9sbGJhY2sKICogYnVmZmVy
LgogKgogKiBPdGhlcndpc2UsIHRoaXMg
bW92ZXMgdGhlIGN1cnNvciB0byBjb2x1
bW4gemVybyBvZiB0aGUgbmV4dCByb3cu
CiAqLwpodGVybS5UZXJtaW5hbC5wcm90
b3R5cGUubmV3TGluZSA9IGZ1bmN0aW9u
KCkgewogIHZhciBjdXJzb3JBdEVuZE9m
U2NyZWVuID0gKHRoaXMuc2NyZWVuXy5j
dXJzb3JQb3NpdGlvbi5yb3cgPT0KICAg
ICAgICAgICAgICAgICAgICAgICAgICAg
ICB0aGlzLnNjcmVlbl8ucm93c0FycmF5
Lmxlbmd0aCAtIDEpOwoKICBpZiAodGhp
cy52dFNjcm9sbEJvdHRvbV8gIT0gbnVs
bCkgewogICAgLy8gQSBWVCBTY3JvbGwg
cmVnaW9uIGlzIGFjdGl2ZSwgd2UgbmV2
ZXIgYXBwZW5kIG5ldyByb3dzLgogICAg
aWYgKHRoaXMuc2NyZWVuXy5jdXJzb3JQ
b3NpdGlvbi5yb3cgPT0gdGhpcy52dFNj
cm9sbEJvdHRvbV8pIHsKICAgICAgLy8g
V2UncmUgYXQgdGhlIGVuZCBvZiB0aGUg
VlQgU2Nyb2xsIFJlZ2lvbiwgcGVyZm9y
bSBhIFZUIHNjcm9sbC4KICAgICAgdGhp
cy52dFNjcm9sbFVwKDEpOwogICAgICB0
aGlzLnNldEFic29sdXRlQ3Vyc29yUG9z
aXRpb24odGhpcy5zY3JlZW5fLmN1cnNv
clBvc2l0aW9uLnJvdywgMCk7CiAgICB9
IGVsc2UgaWYgKGN1cnNvckF0RW5kT2ZT
Y3JlZW4pIHsKICAgICAgLy8gV2UncmUg
YXQgdGhlIGVuZCBvZiB0aGUgc2NyZWVu
LCB0aGUgb25seSB0aGluZyB0byBkbyBp
cyBwdXQgdGhlCiAgICAgIC8vIGN1cnNv
ciB0byBjb2x1bW4gMC4KICAgICAgdGhp
cy5zZXRBYnNvbHV0ZUN1cnNvclBvc2l0
aW9uKHRoaXMuc2NyZWVuXy5jdXJzb3JQ
b3NpdGlvbi5yb3csIDApOwogICAgfSBl
bHNlIHsKICAgICAgLy8gQW55d2hlcmUg
ZWxzZSwgYWR2YW5jZSB0aGUgY3Vyc29y
IHJvdywgYW5kIHJlc2V0IHRoZSBjb2x1
bW4uCiAgICAgIHRoaXMuc2V0QWJzb2x1
dGVDdXJzb3JQb3NpdGlvbih0aGlzLnNj
cmVlbl8uY3Vyc29yUG9zaXRpb24ucm93
ICsgMSwgMCk7CiAgICB9CiAgfSBlbHNl
IGlmIChjdXJzb3JBdEVuZE9mU2NyZWVu
KSB7CiAgICAvLyBXZSdyZSBhdCB0aGUg
ZW5kIG9mIHRoZSBzY3JlZW4uICBBcHBl
bmQgYSBuZXcgcm93IHRvIHRoZSB0ZXJt
aW5hbCwKICAgIC8vIHNoaWZ0aW5nIHRo
ZSB0b3Agcm93IGludG8gdGhlIHNjcm9s
bGJhY2suCiAgICB0aGlzLmFwcGVuZFJv
d3NfKDEpOwogIH0gZWxzZSB7CiAgICAv
LyBBbnl3aGVyZSBlbHNlIGluIHRoZSBz
Y3JlZW4ganVzdCBtb3ZlcyB0aGUgY3Vy
c29yLgogICAgdGhpcy5zZXRBYnNvbHV0
ZUN1cnNvclBvc2l0aW9uKHRoaXMuc2Ny
ZWVuXy5jdXJzb3JQb3NpdGlvbi5yb3cg
KyAxLCAwKTsKICB9Cn07CgovKioKICog
TGlrZSBuZXdMaW5lKCksIGV4Y2VwdCBt
YWludGFpbiB0aGUgY3Vyc29yIGNvbHVt
bi4KICovCmh0ZXJtLlRlcm1pbmFsLnBy
b3RvdHlwZS5saW5lRmVlZCA9IGZ1bmN0
aW9uKCkgewogIHZhciBjb2x1bW4gPSB0
aGlzLnNjcmVlbl8uY3Vyc29yUG9zaXRp
b24uY29sdW1uOwogIHRoaXMubmV3TGlu
ZSgpOwogIHRoaXMuc2V0Q3Vyc29yQ29s
dW1uKGNvbHVtbik7Cn07CgovKioKICog
SWYgYXV0b0NhcnJpYWdlUmV0dXJuIGlz
IHNldCB0aGVuIG5ld0xpbmUoKSwgZWxz
ZSBsaW5lRmVlZCgpLgogKi8KaHRlcm0u
VGVybWluYWwucHJvdG90eXBlLmZvcm1G
ZWVkID0gZnVuY3Rpb24oKSB7CiAgaWYg
KHRoaXMub3B0aW9uc18uYXV0b0NhcnJp
YWdlUmV0dXJuKSB7CiAgICB0aGlzLm5l
d0xpbmUoKTsKICB9IGVsc2UgewogICAg
dGhpcy5saW5lRmVlZCgpOwogIH0KfTsK
Ci8qKgogKiBNb3ZlIHRoZSBjdXJzb3Ig
dXAgb25lIHJvdywgcG9zc2libHkgaW5z
ZXJ0aW5nIGEgYmxhbmsgbGluZS4KICoK
ICogVGhlIGN1cnNvciBjb2x1bW4gaXMg
bm90IGNoYW5nZWQuCiAqLwpodGVybS5U
ZXJtaW5hbC5wcm90b3R5cGUucmV2ZXJz
ZUxpbmVGZWVkID0gZnVuY3Rpb24oKSB7
CiAgdmFyIHNjcm9sbFRvcCA9IHRoaXMu
Z2V0VlRTY3JvbGxUb3AoKTsKICB2YXIg
Y3VycmVudFJvdyA9IHRoaXMuc2NyZWVu
Xy5jdXJzb3JQb3NpdGlvbi5yb3c7Cgog
IGlmIChjdXJyZW50Um93ID09IHNjcm9s
bFRvcCkgewogICAgdGhpcy5pbnNlcnRM
aW5lcygxKTsKICB9IGVsc2UgewogICAg
dGhpcy5zZXRBYnNvbHV0ZUN1cnNvclJv
dyhjdXJyZW50Um93IC0gMSk7CiAgfQp9
OwoKLyoqCiAqIFJlcGxhY2UgYWxsIGNo
YXJhY3RlcnMgdG8gdGhlIGxlZnQgb2Yg
dGhlIGN1cnJlbnQgY3Vyc29yIHdpdGgg
dGhlIHNwYWNlCiAqIGNoYXJhY3Rlci4K
ICoKICogVE9ETyhyZ2luZGEpOiBUaGlz
IHNob3VsZCBwcm9iYWJseSAqcmVtb3Zl
KiB0aGUgY2hhcmFjdGVycyAobm90IGp1
c3QgcmVwbGFjZQogKiB3aXRoIGEgc3Bh
Y2UpIGlmIHRoZXJlIGFyZSBubyBjaGFy
YWN0ZXJzIGF0IG9yIGJleW9uZCB0aGUg
Y3VycmVudCBjdXJzb3IKICogcG9zaXRp
b24uCiAqLwpodGVybS5UZXJtaW5hbC5w
cm90b3R5cGUuZXJhc2VUb0xlZnQgPSBm
dW5jdGlvbigpIHsKICB2YXIgY3Vyc29y
ID0gdGhpcy5zYXZlQ3Vyc29yKCk7CiAg
dGhpcy5zZXRDdXJzb3JDb2x1bW4oMCk7
CiAgdGhpcy5zY3JlZW5fLm92ZXJ3cml0
ZVN0cmluZyhsaWIuZi5nZXRXaGl0ZXNw
YWNlKGN1cnNvci5jb2x1bW4gKyAxKSk7
CiAgdGhpcy5yZXN0b3JlQ3Vyc29yKGN1
cnNvcik7Cn07CgovKioKICogRXJhc2Ug
YSBnaXZlbiBudW1iZXIgb2YgY2hhcmFj
dGVycyB0byB0aGUgcmlnaHQgb2YgdGhl
IGN1cnNvci4KICoKICogVGhlIGN1cnNv
ciBwb3NpdGlvbiBpcyB1bmNoYW5nZWQu
CiAqCiAqIElmIHRoZSBjdXJyZW50IGJh
Y2tncm91bmQgY29sb3IgaXMgbm90IHRo
ZSBkZWZhdWx0IGJhY2tncm91bmQgY29s
b3IgdGhpcwogKiB3aWxsIGluc2VydCBz
cGFjZXMgcmF0aGVyIHRoYW4gZGVsZXRl
LiAgVGhpcyBpcyB1bmZvcnR1bmF0ZSBi
ZWNhdXNlIHRoZQogKiB0cmFpbGluZyBz
cGFjZSB3aWxsIGFmZmVjdCB0ZXh0IHNl
bGVjdGlvbiwgYnV0IGl0J3MgZGlmZmlj
dWx0IHRvIGNvbWUgdXAKICogd2l0aCBh
IHdheSB0byBzdHlsZSBlbXB0eSBzcGFj
ZSB0aGF0IHdvdWxkbid0IHRyaXAgdXAg
dGhlIGh0ZXJtLlNjcmVlbgogKiBjb2Rl
LgogKgogKiBlcmFzZVRvUmlnaHQgaXMg
aWdub3JlZCBpbiB0aGUgcHJlc2VuY2Ug
b2YgYSBjdXJzb3Igb3ZlcmZsb3cuICBU
aGlzIGRldmlhdGVzCiAqIGZyb20geHRl
cm0sIGJ1dCBhZ3JlZXMgd2l0aCBnbm9t
ZS10ZXJtaW5hbCBhbmQga29uc29sZSwg
eGZjZTQtdGVybWluYWwuICBTZWUKICog
Y3JidWcuY29tLzIzMjM5MCBmb3IgZGV0
YWlscy4KICovCmh0ZXJtLlRlcm1pbmFs
LnByb3RvdHlwZS5lcmFzZVRvUmlnaHQg
PSBmdW5jdGlvbihvcHRfY291bnQpIHsK
ICBpZiAodGhpcy5zY3JlZW5fLmN1cnNv
clBvc2l0aW9uLm92ZXJmbG93KQogICAg
cmV0dXJuOwoKICB2YXIgbWF4Q291bnQg
PSB0aGlzLnNjcmVlblNpemUud2lkdGgg
LSB0aGlzLnNjcmVlbl8uY3Vyc29yUG9z
aXRpb24uY29sdW1uOwogIHZhciBjb3Vu
dCA9IG9wdF9jb3VudCA/IE1hdGgubWlu
KG9wdF9jb3VudCwgbWF4Q291bnQpIDog
bWF4Q291bnQ7CgogIGlmICh0aGlzLnNj
cmVlbl8udGV4dEF0dHJpYnV0ZXMuYmFj
a2dyb3VuZCA9PT0KICAgICAgdGhpcy5z
Y3JlZW5fLnRleHRBdHRyaWJ1dGVzLkRF
RkFVTFRfQ09MT1IpIHsKICAgIHZhciBj
dXJzb3JSb3cgPSB0aGlzLnNjcmVlbl8u
cm93c0FycmF5W3RoaXMuc2NyZWVuXy5j
dXJzb3JQb3NpdGlvbi5yb3ddOwogICAg
aWYgKGh0ZXJtLlRleHRBdHRyaWJ1dGVz
Lm5vZGVXaWR0aChjdXJzb3JSb3cpIDw9
CiAgICAgICAgdGhpcy5zY3JlZW5fLmN1
cnNvclBvc2l0aW9uLmNvbHVtbiArIGNv
dW50KSB7CiAgICAgIHRoaXMuc2NyZWVu
Xy5kZWxldGVDaGFycyhjb3VudCk7CiAg
ICAgIHRoaXMuY2xlYXJDdXJzb3JPdmVy
ZmxvdygpOwogICAgICByZXR1cm47CiAg
ICB9CiAgfQoKICB2YXIgY3Vyc29yID0g
dGhpcy5zYXZlQ3Vyc29yKCk7CiAgdGhp
cy5zY3JlZW5fLm92ZXJ3cml0ZVN0cmlu
ZyhsaWIuZi5nZXRXaGl0ZXNwYWNlKGNv
dW50KSk7CiAgdGhpcy5yZXN0b3JlQ3Vy
c29yKGN1cnNvcik7CiAgdGhpcy5jbGVh
ckN1cnNvck92ZXJmbG93KCk7Cn07Cgov
KioKICogRXJhc2UgdGhlIGN1cnJlbnQg
bGluZS4KICoKICogVGhlIGN1cnNvciBw
b3NpdGlvbiBpcyB1bmNoYW5nZWQuCiAq
LwpodGVybS5UZXJtaW5hbC5wcm90b3R5
cGUuZXJhc2VMaW5lID0gZnVuY3Rpb24o
KSB7CiAgdmFyIGN1cnNvciA9IHRoaXMu
c2F2ZUN1cnNvcigpOwogIHRoaXMuc2Ny
ZWVuXy5jbGVhckN1cnNvclJvdygpOwog
IHRoaXMucmVzdG9yZUN1cnNvcihjdXJz
b3IpOwogIHRoaXMuY2xlYXJDdXJzb3JP
dmVyZmxvdygpOwp9OwoKLyoqCiAqIEVy
YXNlIGFsbCBjaGFyYWN0ZXJzIGZyb20g
dGhlIHN0YXJ0IG9mIHRoZSBzY3JlZW4g
dG8gdGhlIGN1cnJlbnQgY3Vyc29yCiAq
IHBvc2l0aW9uLCByZWdhcmRsZXNzIG9m
IHNjcm9sbCByZWdpb24uCiAqCiAqIFRo
ZSBjdXJzb3IgcG9zaXRpb24gaXMgdW5j
aGFuZ2VkLgogKi8KaHRlcm0uVGVybWlu
YWwucHJvdG90eXBlLmVyYXNlQWJvdmUg
PSBmdW5jdGlvbigpIHsKICB2YXIgY3Vy
c29yID0gdGhpcy5zYXZlQ3Vyc29yKCk7
CgogIHRoaXMuZXJhc2VUb0xlZnQoKTsK
CiAgZm9yICh2YXIgaSA9IDA7IGkgPCBj
dXJzb3Iucm93OyBpKyspIHsKICAgIHRo
aXMuc2V0QWJzb2x1dGVDdXJzb3JQb3Np
dGlvbihpLCAwKTsKICAgIHRoaXMuc2Ny
ZWVuXy5jbGVhckN1cnNvclJvdygpOwog
IH0KCiAgdGhpcy5yZXN0b3JlQ3Vyc29y
KGN1cnNvcik7CiAgdGhpcy5jbGVhckN1
cnNvck92ZXJmbG93KCk7Cn07CgovKioK
ICogRXJhc2UgYWxsIGNoYXJhY3RlcnMg
ZnJvbSB0aGUgY3VycmVudCBjdXJzb3Ig
cG9zaXRpb24gdG8gdGhlIGVuZCBvZiB0
aGUKICogc2NyZWVuLCByZWdhcmRsZXNz
IG9mIHNjcm9sbCByZWdpb24uCiAqCiAq
IFRoZSBjdXJzb3IgcG9zaXRpb24gaXMg
dW5jaGFuZ2VkLgogKi8KaHRlcm0uVGVy
bWluYWwucHJvdG90eXBlLmVyYXNlQmVs
b3cgPSBmdW5jdGlvbigpIHsKICB2YXIg
Y3Vyc29yID0gdGhpcy5zYXZlQ3Vyc29y
KCk7CgogIHRoaXMuZXJhc2VUb1JpZ2h0
KCk7CgogIHZhciBib3R0b20gPSB0aGlz
LnNjcmVlblNpemUuaGVpZ2h0IC0gMTsK
ICBmb3IgKHZhciBpID0gY3Vyc29yLnJv
dyArIDE7IGkgPD0gYm90dG9tOyBpKysp
IHsKICAgIHRoaXMuc2V0QWJzb2x1dGVD
dXJzb3JQb3NpdGlvbihpLCAwKTsKICAg
IHRoaXMuc2NyZWVuXy5jbGVhckN1cnNv
clJvdygpOwogIH0KCiAgdGhpcy5yZXN0
b3JlQ3Vyc29yKGN1cnNvcik7CiAgdGhp
cy5jbGVhckN1cnNvck92ZXJmbG93KCk7
Cn07CgovKioKICogRmlsbCB0aGUgdGVy
bWluYWwgd2l0aCBhIGdpdmVuIGNoYXJh
Y3Rlci4KICoKICogVGhpcyBtZXRob2Rz
IGRvZXMgbm90IHJlc3BlY3QgdGhlIFZU
IHNjcm9sbCByZWdpb24uCiAqCiAqIEBw
YXJhbSB7c3RyaW5nfSBjaCBUaGUgY2hh
cmFjdGVyIHRvIHVzZSBmb3IgdGhlIGZp
bGwuCiAqLwpodGVybS5UZXJtaW5hbC5w
cm90b3R5cGUuZmlsbCA9IGZ1bmN0aW9u
KGNoKSB7CiAgdmFyIGN1cnNvciA9IHRo
aXMuc2F2ZUN1cnNvcigpOwoKICB0aGlz
LnNldEFic29sdXRlQ3Vyc29yUG9zaXRp
b24oMCwgMCk7CiAgZm9yICh2YXIgcm93
ID0gMDsgcm93IDwgdGhpcy5zY3JlZW5T
aXplLmhlaWdodDsgcm93KyspIHsKICAg
IGZvciAodmFyIGNvbCA9IDA7IGNvbCA8
IHRoaXMuc2NyZWVuU2l6ZS53aWR0aDsg
Y29sKyspIHsKICAgICAgdGhpcy5zZXRB
YnNvbHV0ZUN1cnNvclBvc2l0aW9uKHJv
dywgY29sKTsKICAgICAgdGhpcy5zY3Jl
ZW5fLm92ZXJ3cml0ZVN0cmluZyhjaCk7
CiAgICB9CiAgfQoKICB0aGlzLnJlc3Rv
cmVDdXJzb3IoY3Vyc29yKTsKfTsKCi8q
KgogKiBFcmFzZSB0aGUgZW50aXJlIGRp
c3BsYXkgYW5kIGxlYXZlIHRoZSBjdXJz
b3IgYXQgKDAsIDApLgogKgogKiBUaGlz
IGRvZXMgbm90IHJlc3BlY3QgdGhlIHNj
cm9sbCByZWdpb24uCiAqCiAqIEBwYXJh
bSB7aHRlcm0uU2NyZWVufSBvcHRfc2Ny
ZWVuIE9wdGlvbmFsIHNjcmVlbiB0byBv
cGVyYXRlIG9uLiAgRGVmYXVsdHMKICog
ICAgIHRvIHRoZSBjdXJyZW50IHNjcmVl
bi4KICovCmh0ZXJtLlRlcm1pbmFsLnBy
b3RvdHlwZS5jbGVhckhvbWUgPSBmdW5j
dGlvbihvcHRfc2NyZWVuKSB7CiAgdmFy
IHNjcmVlbiA9IG9wdF9zY3JlZW4gfHwg
dGhpcy5zY3JlZW5fOwogIHZhciBib3R0
b20gPSBzY3JlZW4uZ2V0SGVpZ2h0KCk7
CgogIGlmIChib3R0b20gPT0gMCkgewog
ICAgLy8gRW1wdHkgc2NyZWVuLCBub3Ro
aW5nIHRvIGRvLgogICAgcmV0dXJuOwog
IH0KCiAgZm9yICh2YXIgaSA9IDA7IGkg
PCBib3R0b207IGkrKykgewogICAgc2Ny
ZWVuLnNldEN1cnNvclBvc2l0aW9uKGks
IDApOwogICAgc2NyZWVuLmNsZWFyQ3Vy
c29yUm93KCk7CiAgfQoKICBzY3JlZW4u
c2V0Q3Vyc29yUG9zaXRpb24oMCwgMCk7
Cn07CgovKioKICogRXJhc2UgdGhlIGVu
dGlyZSBkaXNwbGF5IHdpdGhvdXQgY2hh
bmdpbmcgdGhlIGN1cnNvciBwb3NpdGlv
bi4KICoKICogVGhlIGN1cnNvciBwb3Np
dGlvbiBpcyB1bmNoYW5nZWQuICBUaGlz
IGRvZXMgbm90IHJlc3BlY3QgdGhlIHNj
cm9sbAogKiByZWdpb24uCiAqCiAqIEBw
YXJhbSB7aHRlcm0uU2NyZWVufSBvcHRf
c2NyZWVuIE9wdGlvbmFsIHNjcmVlbiB0
byBvcGVyYXRlIG9uLiAgRGVmYXVsdHMK
ICogICAgIHRvIHRoZSBjdXJyZW50IHNj
cmVlbi4KICovCmh0ZXJtLlRlcm1pbmFs
LnByb3RvdHlwZS5jbGVhciA9IGZ1bmN0
aW9uKG9wdF9zY3JlZW4pIHsKICB2YXIg
c2NyZWVuID0gb3B0X3NjcmVlbiB8fCB0
aGlzLnNjcmVlbl87CiAgdmFyIGN1cnNv
ciA9IHNjcmVlbi5jdXJzb3JQb3NpdGlv
bi5jbG9uZSgpOwogIHRoaXMuY2xlYXJI
b21lKHNjcmVlbik7CiAgc2NyZWVuLnNl
dEN1cnNvclBvc2l0aW9uKGN1cnNvci5y
b3csIGN1cnNvci5jb2x1bW4pOwp9OwoK
LyoqCiAqIFZUIGNvbW1hbmQgdG8gaW5z
ZXJ0IGxpbmVzIGF0IHRoZSBjdXJyZW50
IGN1cnNvciByb3cuCiAqCiAqIFRoaXMg
cmVzcGVjdHMgdGhlIGN1cnJlbnQgc2Ny
b2xsIHJlZ2lvbi4gIFJvd3MgcHVzaGVk
IG9mZiB0aGUgYm90dG9tIGFyZQogKiBs
b3N0ICh0aGV5IHdvbid0IHNob3cgdXAg
aW4gdGhlIHNjcm9sbGJhY2sgYnVmZmVy
KS4KICoKICogQHBhcmFtIHtpbnRlZ2Vy
fSBjb3VudCBUaGUgbnVtYmVyIG9mIGxp
bmVzIHRvIGluc2VydC4KICovCmh0ZXJt
LlRlcm1pbmFsLnByb3RvdHlwZS5pbnNl
cnRMaW5lcyA9IGZ1bmN0aW9uKGNvdW50
KSB7CiAgdmFyIGN1cnNvclJvdyA9IHRo
aXMuc2NyZWVuXy5jdXJzb3JQb3NpdGlv
bi5yb3c7CgogIHZhciBib3R0b20gPSB0
aGlzLmdldFZUU2Nyb2xsQm90dG9tKCk7
CiAgY291bnQgPSBNYXRoLm1pbihjb3Vu
dCwgYm90dG9tIC0gY3Vyc29yUm93KTsK
CiAgLy8gVGhlIG1vdmVDb3VudCBpcyB0
aGUgbnVtYmVyIG9mIHJvd3Mgd2UgbmVl
ZCB0byByZWxvY2F0ZSB0byBtYWtlIHJv
b20gZm9yCiAgLy8gdGhlIG5ldyByb3co
cykuICBUaGUgY291bnQgaXMgdGhlIGRp
c3RhbmNlIHRvIG1vdmUgdGhlbS4KICB2
YXIgbW92ZUNvdW50ID0gYm90dG9tIC0g
Y3Vyc29yUm93IC0gY291bnQgKyAxOwog
IGlmIChtb3ZlQ291bnQpCiAgICB0aGlz
Lm1vdmVSb3dzXyhjdXJzb3JSb3csIG1v
dmVDb3VudCwgY3Vyc29yUm93ICsgY291
bnQpOwoKICBmb3IgKHZhciBpID0gY291
bnQgLSAxOyBpID49IDA7IGktLSkgewog
ICAgdGhpcy5zZXRBYnNvbHV0ZUN1cnNv
clBvc2l0aW9uKGN1cnNvclJvdyArIGks
IDApOwogICAgdGhpcy5zY3JlZW5fLmNs
ZWFyQ3Vyc29yUm93KCk7CiAgfQp9OwoK
LyoqCiAqIFZUIGNvbW1hbmQgdG8gZGVs
ZXRlIGxpbmVzIGF0IHRoZSBjdXJyZW50
IGN1cnNvciByb3cuCiAqCiAqIE5ldyBy
b3dzIGFyZSBhZGRlZCB0byB0aGUgYm90
dG9tIG9mIHNjcm9sbCByZWdpb24gdG8g
dGFrZSB0aGVpciBwbGFjZS4gIE5ldwog
KiByb3dzIGFyZSBzdHJpY3RseSB0aGVy
ZSB0byB0YWtlIHVwIHNwYWNlIGFuZCBo
YXZlIG5vIGNvbnRlbnQgb3Igc3R5bGUu
CiAqLwpodGVybS5UZXJtaW5hbC5wcm90
b3R5cGUuZGVsZXRlTGluZXMgPSBmdW5j
dGlvbihjb3VudCkgewogIHZhciBjdXJz
b3IgPSB0aGlzLnNhdmVDdXJzb3IoKTsK
CiAgdmFyIHRvcCA9IGN1cnNvci5yb3c7
CiAgdmFyIGJvdHRvbSA9IHRoaXMuZ2V0
VlRTY3JvbGxCb3R0b20oKTsKCiAgdmFy
IG1heENvdW50ID0gYm90dG9tIC0gdG9w
ICsgMTsKICBjb3VudCA9IE1hdGgubWlu
KGNvdW50LCBtYXhDb3VudCk7CgogIHZh
ciBtb3ZlU3RhcnQgPSBib3R0b20gLSBj
b3VudCArIDE7CiAgaWYgKGNvdW50ICE9
IG1heENvdW50KQogICAgdGhpcy5tb3Zl
Um93c18odG9wLCBjb3VudCwgbW92ZVN0
YXJ0KTsKCiAgZm9yICh2YXIgaSA9IDA7
IGkgPCBjb3VudDsgaSsrKSB7CiAgICB0
aGlzLnNldEFic29sdXRlQ3Vyc29yUG9z
aXRpb24obW92ZVN0YXJ0ICsgaSwgMCk7
CiAgICB0aGlzLnNjcmVlbl8uY2xlYXJD
dXJzb3JSb3coKTsKICB9CgogIHRoaXMu
cmVzdG9yZUN1cnNvcihjdXJzb3IpOwog
IHRoaXMuY2xlYXJDdXJzb3JPdmVyZmxv
dygpOwp9OwoKLyoqCiAqIEluc2VydHMg
dGhlIGdpdmVuIG51bWJlciBvZiBzcGFj
ZXMgYXQgdGhlIGN1cnJlbnQgY3Vyc29y
IHBvc2l0aW9uLgogKgogKiBUaGUgY3Vy
c29yIHBvc2l0aW9uIGlzIG5vdCBjaGFu
Z2VkLgogKi8KaHRlcm0uVGVybWluYWwu
cHJvdG90eXBlLmluc2VydFNwYWNlID0g
ZnVuY3Rpb24oY291bnQpIHsKICB2YXIg
Y3Vyc29yID0gdGhpcy5zYXZlQ3Vyc29y
KCk7CgogIHZhciB3cyA9IGxpYi5mLmdl
dFdoaXRlc3BhY2UoY291bnQgfHwgMSk7
CiAgdGhpcy5zY3JlZW5fLmluc2VydFN0
cmluZyh3cyk7CiAgdGhpcy5zY3JlZW5f
Lm1heWJlQ2xpcEN1cnJlbnRSb3coKTsK
CiAgdGhpcy5yZXN0b3JlQ3Vyc29yKGN1
cnNvcik7CiAgdGhpcy5jbGVhckN1cnNv
ck92ZXJmbG93KCk7Cn07CgovKioKICog
Rm9yd2FyZC1kZWxldGUgdGhlIHNwZWNp
ZmllZCBudW1iZXIgb2YgY2hhcmFjdGVy
cyBzdGFydGluZyBhdCB0aGUgY3Vyc29y
CiAqIHBvc2l0aW9uLgogKgogKiBAcGFy
YW0ge2ludGVnZXJ9IGNvdW50IFRoZSBu
dW1iZXIgb2YgY2hhcmFjdGVycyB0byBk
ZWxldGUuCiAqLwpodGVybS5UZXJtaW5h
bC5wcm90b3R5cGUuZGVsZXRlQ2hhcnMg
PSBmdW5jdGlvbihjb3VudCkgewogIHZh
ciBkZWxldGVkID0gdGhpcy5zY3JlZW5f
LmRlbGV0ZUNoYXJzKGNvdW50KTsKICBp
ZiAoZGVsZXRlZCAmJiAhdGhpcy5zY3Jl
ZW5fLnRleHRBdHRyaWJ1dGVzLmlzRGVm
YXVsdCgpKSB7CiAgICB2YXIgY3Vyc29y
ID0gdGhpcy5zYXZlQ3Vyc29yKCk7CiAg
ICB0aGlzLnNldEN1cnNvckNvbHVtbih0
aGlzLnNjcmVlblNpemUud2lkdGggLSBk
ZWxldGVkKTsKICAgIHRoaXMuc2NyZWVu
Xy5pbnNlcnRTdHJpbmcobGliLmYuZ2V0
V2hpdGVzcGFjZShkZWxldGVkKSk7CiAg
ICB0aGlzLnJlc3RvcmVDdXJzb3IoY3Vy
c29yKTsKICB9CgogIHRoaXMuY2xlYXJD
dXJzb3JPdmVyZmxvdygpOwp9OwoKLyoq
CiAqIFNoaWZ0IHJvd3MgaW4gdGhlIHNj
cm9sbCByZWdpb24gdXB3YXJkcyBieSBh
IGdpdmVuIG51bWJlciBvZiBsaW5lcy4K
ICoKICogTmV3IHJvd3MgYXJlIGluc2Vy
dGVkIGF0IHRoZSBib3R0b20gb2YgdGhl
IHNjcm9sbCByZWdpb24gdG8gZmlsbCB0
aGUKICogdmFjYXRlZCByb3dzLiAgVGhl
IG5ldyByb3dzIG5vdCBmaWxsZWQgb3V0
IHdpdGggdGhlIGN1cnJlbnQgdGV4dCBh
dHRyaWJ1dGVzLgogKgogKiBUaGlzIGZ1
bmN0aW9uIGRvZXMgbm90IGFmZmVjdCB0
aGUgc2Nyb2xsYmFjayByb3dzIGF0IGFs
bC4gIFJvd3Mgc2hpZnRlZAogKiBvZmYg
dGhlIHRvcCBhcmUgbG9zdC4KICoKICog
VGhlIGN1cnNvciBwb3NpdGlvbiBpcyBu
b3QgYWx0ZXJlZC4KICoKICogQHBhcmFt
IHtpbnRlZ2VyfSBjb3VudCBUaGUgbnVt
YmVyIG9mIHJvd3MgdG8gc2Nyb2xsLgog
Ki8KaHRlcm0uVGVybWluYWwucHJvdG90
eXBlLnZ0U2Nyb2xsVXAgPSBmdW5jdGlv
bihjb3VudCkgewogIHZhciBjdXJzb3Ig
PSB0aGlzLnNhdmVDdXJzb3IoKTsKCiAg
dGhpcy5zZXRBYnNvbHV0ZUN1cnNvclJv
dyh0aGlzLmdldFZUU2Nyb2xsVG9wKCkp
OwogIHRoaXMuZGVsZXRlTGluZXMoY291
bnQpOwoKICB0aGlzLnJlc3RvcmVDdXJz
b3IoY3Vyc29yKTsKfTsKCi8qKgogKiBT
aGlmdCByb3dzIGJlbG93IHRoZSBjdXJz
b3IgZG93biBieSBhIGdpdmVuIG51bWJl
ciBvZiBsaW5lcy4KICoKICogVGhpcyBm
dW5jdGlvbiByZXNwZWN0cyB0aGUgY3Vy
cmVudCBzY3JvbGwgcmVnaW9uLgogKgog
KiBOZXcgcm93cyBhcmUgaW5zZXJ0ZWQg
YXQgdGhlIHRvcCBvZiB0aGUgc2Nyb2xs
IHJlZ2lvbiB0byBmaWxsIHRoZQogKiB2
YWNhdGVkIHJvd3MuICBUaGUgbmV3IHJv
d3Mgbm90IGZpbGxlZCBvdXQgd2l0aCB0
aGUgY3VycmVudCB0ZXh0IGF0dHJpYnV0
ZXMuCiAqCiAqIFRoaXMgZnVuY3Rpb24g
ZG9lcyBub3QgYWZmZWN0IHRoZSBzY3Jv
bGxiYWNrIHJvd3MgYXQgYWxsLiAgUm93
cyBzaGlmdGVkCiAqIG9mZiB0aGUgYm90
dG9tIGFyZSBsb3N0LgogKgogKiBAcGFy
YW0ge2ludGVnZXJ9IGNvdW50IFRoZSBu
dW1iZXIgb2Ygcm93cyB0byBzY3JvbGwu
CiAqLwpodGVybS5UZXJtaW5hbC5wcm90
b3R5cGUudnRTY3JvbGxEb3duID0gZnVu
Y3Rpb24ob3B0X2NvdW50KSB7CiAgdmFy
IGN1cnNvciA9IHRoaXMuc2F2ZUN1cnNv
cigpOwoKICB0aGlzLnNldEFic29sdXRl
Q3Vyc29yUG9zaXRpb24odGhpcy5nZXRW
VFNjcm9sbFRvcCgpLCAwKTsKICB0aGlz
Lmluc2VydExpbmVzKG9wdF9jb3VudCk7
CgogIHRoaXMucmVzdG9yZUN1cnNvcihj
dXJzb3IpOwp9OwoKCi8qKgogKiBTZXQg
dGhlIGN1cnNvciBwb3NpdGlvbi4KICoK
ICogVGhlIGN1cnNvciByb3cgaXMgcmVs
YXRpdmUgdG8gdGhlIHNjcm9sbCByZWdp
b24gaWYgdGhlIHRlcm1pbmFsIGhhcwog
KiAnb3JpZ2luIG1vZGUnIGVuYWJsZWQs
IG9yIHJlbGF0aXZlIHRvIHRoZSBhZGRy
ZXNzYWJsZSBzY3JlZW4gb3RoZXJ3aXNl
LgogKgogKiBAcGFyYW0ge2ludGVnZXJ9
IHJvdyBUaGUgbmV3IHplcm8tYmFzZWQg
Y3Vyc29yIHJvdy4KICogQHBhcmFtIHtp
bnRlZ2VyfSByb3cgVGhlIG5ldyB6ZXJv
LWJhc2VkIGN1cnNvciBjb2x1bW4uCiAq
LwpodGVybS5UZXJtaW5hbC5wcm90b3R5
cGUuc2V0Q3Vyc29yUG9zaXRpb24gPSBm
dW5jdGlvbihyb3csIGNvbHVtbikgewog
IGlmICh0aGlzLm9wdGlvbnNfLm9yaWdp
bk1vZGUpIHsKICAgIHRoaXMuc2V0UmVs
YXRpdmVDdXJzb3JQb3NpdGlvbihyb3cs
IGNvbHVtbik7CiAgfSBlbHNlIHsKICAg
IHRoaXMuc2V0QWJzb2x1dGVDdXJzb3JQ
b3NpdGlvbihyb3csIGNvbHVtbik7CiAg
fQp9OwoKaHRlcm0uVGVybWluYWwucHJv
dG90eXBlLnNldFJlbGF0aXZlQ3Vyc29y
UG9zaXRpb24gPSBmdW5jdGlvbihyb3cs
IGNvbHVtbikgewogIHZhciBzY3JvbGxU
b3AgPSB0aGlzLmdldFZUU2Nyb2xsVG9w
KCk7CiAgcm93ID0gbGliLmYuY2xhbXAo
cm93ICsgc2Nyb2xsVG9wLCBzY3JvbGxU
b3AsIHRoaXMuZ2V0VlRTY3JvbGxCb3R0
b20oKSk7CiAgY29sdW1uID0gbGliLmYu
Y2xhbXAoY29sdW1uLCAwLCB0aGlzLnNj
cmVlblNpemUud2lkdGggLSAxKTsKICB0
aGlzLnNjcmVlbl8uc2V0Q3Vyc29yUG9z
aXRpb24ocm93LCBjb2x1bW4pOwp9OwoK
aHRlcm0uVGVybWluYWwucHJvdG90eXBl
LnNldEFic29sdXRlQ3Vyc29yUG9zaXRp
b24gPSBmdW5jdGlvbihyb3csIGNvbHVt
bikgewogIHJvdyA9IGxpYi5mLmNsYW1w
KHJvdywgMCwgdGhpcy5zY3JlZW5TaXpl
LmhlaWdodCAtIDEpOwogIGNvbHVtbiA9
IGxpYi5mLmNsYW1wKGNvbHVtbiwgMCwg
dGhpcy5zY3JlZW5TaXplLndpZHRoIC0g
MSk7CiAgdGhpcy5zY3JlZW5fLnNldEN1
cnNvclBvc2l0aW9uKHJvdywgY29sdW1u
KTsKfTsKCi8qKgogKiBTZXQgdGhlIGN1
cnNvciBjb2x1bW4uCiAqCiAqIEBwYXJh
bSB7aW50ZWdlcn0gY29sdW1uIFRoZSBu
ZXcgemVyby1iYXNlZCBjdXJzb3IgY29s
dW1uLgogKi8KaHRlcm0uVGVybWluYWwu
cHJvdG90eXBlLnNldEN1cnNvckNvbHVt
biA9IGZ1bmN0aW9uKGNvbHVtbikgewog
IHRoaXMuc2V0QWJzb2x1dGVDdXJzb3JQ
b3NpdGlvbih0aGlzLnNjcmVlbl8uY3Vy
c29yUG9zaXRpb24ucm93LCBjb2x1bW4p
Owp9OwoKLyoqCiAqIFJldHVybiB0aGUg
Y3Vyc29yIGNvbHVtbi4KICoKICogQHJl
dHVybiB7aW50ZWdlcn0gVGhlIHplcm8t
YmFzZWQgY3Vyc29yIGNvbHVtbi4KICov
Cmh0ZXJtLlRlcm1pbmFsLnByb3RvdHlw
ZS5nZXRDdXJzb3JDb2x1bW4gPSBmdW5j
dGlvbigpIHsKICByZXR1cm4gdGhpcy5z
Y3JlZW5fLmN1cnNvclBvc2l0aW9uLmNv
bHVtbjsKfTsKCi8qKgogKiBTZXQgdGhl
IGN1cnNvciByb3cuCiAqCiAqIFRoZSBj
dXJzb3Igcm93IGlzIHJlbGF0aXZlIHRv
IHRoZSBzY3JvbGwgcmVnaW9uIGlmIHRo
ZSB0ZXJtaW5hbCBoYXMKICogJ29yaWdp
biBtb2RlJyBlbmFibGVkLCBvciByZWxh
dGl2ZSB0byB0aGUgYWRkcmVzc2FibGUg
c2NyZWVuIG90aGVyd2lzZS4KICoKICog
QHBhcmFtIHtpbnRlZ2VyfSByb3cgVGhl
IG5ldyBjdXJzb3Igcm93LgogKi8KaHRl
cm0uVGVybWluYWwucHJvdG90eXBlLnNl
dEFic29sdXRlQ3Vyc29yUm93ID0gZnVu
Y3Rpb24ocm93KSB7CiAgdGhpcy5zZXRB
YnNvbHV0ZUN1cnNvclBvc2l0aW9uKHJv
dywgdGhpcy5zY3JlZW5fLmN1cnNvclBv
c2l0aW9uLmNvbHVtbik7Cn07CgovKioK
ICogUmV0dXJuIHRoZSBjdXJzb3Igcm93
LgogKgogKiBAcmV0dXJuIHtpbnRlZ2Vy
fSBUaGUgemVyby1iYXNlZCBjdXJzb3Ig
cm93LgogKi8KaHRlcm0uVGVybWluYWwu
cHJvdG90eXBlLmdldEN1cnNvclJvdyA9
IGZ1bmN0aW9uKHJvdykgewogIHJldHVy
biB0aGlzLnNjcmVlbl8uY3Vyc29yUG9z
aXRpb24ucm93Owp9OwoKLyoqCiAqIFJl
cXVlc3QgdGhhdCB0aGUgU2Nyb2xsUG9y
dCByZWRyYXcgaXRzZWxmIHNvb24uCiAq
CiAqIFRoZSByZWRyYXcgd2lsbCBoYXBw
ZW4gYXN5bmNocm9ub3VzbHksIHNvb24g
YWZ0ZXIgdGhlIGNhbGwgc3RhY2sgd2lu
ZHMgZG93bi4KICogTXVsdGlwbGUgY2Fs
bHMgd2lsbCBiZSBjb2FsZXNjZWQgaW50
byBhIHNpbmdsZSByZWRyYXcuCiAqLwpo
dGVybS5UZXJtaW5hbC5wcm90b3R5cGUu
c2NoZWR1bGVSZWRyYXdfID0gZnVuY3Rp
b24oKSB7CiAgaWYgKHRoaXMudGltZW91
dHNfLnJlZHJhdykKICAgIHJldHVybjsK
CiAgdmFyIHNlbGYgPSB0aGlzOwogIHRo
aXMudGltZW91dHNfLnJlZHJhdyA9IHNl
dFRpbWVvdXQoZnVuY3Rpb24oKSB7CiAg
ICAgIGRlbGV0ZSBzZWxmLnRpbWVvdXRz
Xy5yZWRyYXc7CiAgICAgIHNlbGYuc2Ny
b2xsUG9ydF8ucmVkcmF3XygpOwogICAg
fSwgMCk7Cn07CgovKioKICogUmVxdWVz
dCB0aGF0IHRoZSBTY3JvbGxQb3J0IGJl
IHNjcm9sbGVkIHRvIHRoZSBib3R0b20u
CiAqCiAqIFRoZSBzY3JvbGwgd2lsbCBo
YXBwZW4gYXN5bmNocm9ub3VzbHksIHNv
b24gYWZ0ZXIgdGhlIGNhbGwgc3RhY2sg
d2luZHMgZG93bi4KICogTXVsdGlwbGUg
Y2FsbHMgd2lsbCBiZSBjb2FsZXNjZWQg
aW50byBhIHNpbmdsZSBzY3JvbGwuCiAq
CiAqIFRoaXMgYWZmZWN0cyB0aGUgc2Ny
b2xsYmFyIHBvc2l0aW9uIG9mIHRoZSBT
Y3JvbGxQb3J0LCBhbmQgaGFzIG5vdGhp
bmcgdG8KICogZG8gd2l0aCB0aGUgVlQg
c2Nyb2xsIGNvbW1hbmRzLgogKi8KaHRl
cm0uVGVybWluYWwucHJvdG90eXBlLnNj
aGVkdWxlU2Nyb2xsRG93bl8gPSBmdW5j
dGlvbigpIHsKICBpZiAodGhpcy50aW1l
b3V0c18uc2Nyb2xsRG93bikKICAgIHJl
dHVybjsKCiAgdmFyIHNlbGYgPSB0aGlz
OwogIHRoaXMudGltZW91dHNfLnNjcm9s
bERvd24gPSBzZXRUaW1lb3V0KGZ1bmN0
aW9uKCkgewogICAgICBkZWxldGUgc2Vs
Zi50aW1lb3V0c18uc2Nyb2xsRG93bjsK
ICAgICAgc2VsZi5zY3JvbGxQb3J0Xy5z
Y3JvbGxSb3dUb0JvdHRvbShzZWxmLmdl
dFJvd0NvdW50KCkpOwogICAgfSwgMTAp
Owp9OwoKLyoqCiAqIE1vdmUgdGhlIGN1
cnNvciB1cCBhIHNwZWNpZmllZCBudW1i
ZXIgb2Ygcm93cy4KICoKICogQHBhcmFt
IHtpbnRlZ2VyfSBjb3VudCBUaGUgbnVt
YmVyIG9mIHJvd3MgdG8gbW92ZSB0aGUg
Y3Vyc29yLgogKi8KaHRlcm0uVGVybWlu
YWwucHJvdG90eXBlLmN1cnNvclVwID0g
ZnVuY3Rpb24oY291bnQpIHsKICByZXR1
cm4gdGhpcy5jdXJzb3JEb3duKC0oY291
bnQgfHwgMSkpOwp9OwoKLyoqCiAqIE1v
dmUgdGhlIGN1cnNvciBkb3duIGEgc3Bl
Y2lmaWVkIG51bWJlciBvZiByb3dzLgog
KgogKiBAcGFyYW0ge2ludGVnZXJ9IGNv
dW50IFRoZSBudW1iZXIgb2Ygcm93cyB0
byBtb3ZlIHRoZSBjdXJzb3IuCiAqLwpo
dGVybS5UZXJtaW5hbC5wcm90b3R5cGUu
Y3Vyc29yRG93biA9IGZ1bmN0aW9uKGNv
dW50KSB7CiAgY291bnQgPSBjb3VudCB8
fCAxOwogIHZhciBtaW5IZWlnaHQgPSAo
dGhpcy5vcHRpb25zXy5vcmlnaW5Nb2Rl
ID8gdGhpcy5nZXRWVFNjcm9sbFRvcCgp
IDogMCk7CiAgdmFyIG1heEhlaWdodCA9
ICh0aGlzLm9wdGlvbnNfLm9yaWdpbk1v
ZGUgPyB0aGlzLmdldFZUU2Nyb2xsQm90
dG9tKCkgOgogICAgICAgICAgICAgICAg
ICAgdGhpcy5zY3JlZW5TaXplLmhlaWdo
dCAtIDEpOwoKICB2YXIgcm93ID0gbGli
LmYuY2xhbXAodGhpcy5zY3JlZW5fLmN1
cnNvclBvc2l0aW9uLnJvdyArIGNvdW50
LAogICAgICAgICAgICAgICAgICAgICAg
ICBtaW5IZWlnaHQsIG1heEhlaWdodCk7
CiAgdGhpcy5zZXRBYnNvbHV0ZUN1cnNv
clJvdyhyb3cpOwp9OwoKLyoqCiAqIE1v
dmUgdGhlIGN1cnNvciBsZWZ0IGEgc3Bl
Y2lmaWVkIG51bWJlciBvZiBjb2x1bW5z
LgogKgogKiBJZiByZXZlcnNlIHdyYXBh
cm91bmQgbW9kZSBpcyBlbmFibGVkIGFu
ZCB0aGUgcHJldmlvdXMgcm93IHdyYXBw
ZWQgaW50bwogKiB0aGUgY3VycmVudCBy
b3cgdGhlbiB3ZSBiYWNrIHVwIHRocm91
Z2ggdGhlIHdyYXBhcm91bmQgYXMgd2Vs
bC4KICoKICogQHBhcmFtIHtpbnRlZ2Vy
fSBjb3VudCBUaGUgbnVtYmVyIG9mIGNv
bHVtbnMgdG8gbW92ZSB0aGUgY3Vyc29y
LgogKi8KaHRlcm0uVGVybWluYWwucHJv
dG90eXBlLmN1cnNvckxlZnQgPSBmdW5j
dGlvbihjb3VudCkgewogIGNvdW50ID0g
Y291bnQgfHwgMTsKCiAgaWYgKGNvdW50
IDwgMSkKICAgIHJldHVybjsKCiAgdmFy
IGN1cnJlbnRDb2x1bW4gPSB0aGlzLnNj
cmVlbl8uY3Vyc29yUG9zaXRpb24uY29s
dW1uOwogIGlmICh0aGlzLm9wdGlvbnNf
LnJldmVyc2VXcmFwYXJvdW5kKSB7CiAg
ICBpZiAodGhpcy5zY3JlZW5fLmN1cnNv
clBvc2l0aW9uLm92ZXJmbG93KSB7CiAg
ICAgIC8vIElmIHRoaXMgY3Vyc29yIGlz
IGluIHRoZSByaWdodCBtYXJnaW4sIGNv
bnN1bWUgb25lIGNvdW50IHRvIGdldCBp
dAogICAgICAvLyBiYWNrIHRvIHRoZSBs
YXN0IGNvbHVtbi4gIFRoaXMgb25seSBh
cHBsaWVzIHdoZW4gd2UncmUgaW4gcmV2
ZXJzZQogICAgICAvLyB3cmFwYXJvdW5k
IG1vZGUuCiAgICAgIGNvdW50LS07CiAg
ICAgIHRoaXMuY2xlYXJDdXJzb3JPdmVy
ZmxvdygpOwoKICAgICAgaWYgKCFjb3Vu
dCkKICAgICAgICByZXR1cm47CiAgICB9
CgogICAgdmFyIG5ld1JvdyA9IHRoaXMu
c2NyZWVuXy5jdXJzb3JQb3NpdGlvbi5y
b3c7CiAgICB2YXIgbmV3Q29sdW1uID0g
Y3VycmVudENvbHVtbiAtIGNvdW50Owog
ICAgaWYgKG5ld0NvbHVtbiA8IDApIHsK
ICAgICAgbmV3Um93ID0gbmV3Um93IC0g
TWF0aC5mbG9vcihjb3VudCAvIHRoaXMu
c2NyZWVuU2l6ZS53aWR0aCkgLSAxOwog
ICAgICBpZiAobmV3Um93IDwgMCkgewog
ICAgICAgIC8vIHh0ZXJtIGFsc28gd3Jh
cHMgZnJvbSByb3cgMCB0byB0aGUgbGFz
dCByb3cuCiAgICAgICAgbmV3Um93ID0g
dGhpcy5zY3JlZW5TaXplLmhlaWdodCAr
IG5ld1JvdyAlIHRoaXMuc2NyZWVuU2l6
ZS5oZWlnaHQ7CiAgICAgIH0KICAgICAg
bmV3Q29sdW1uID0gdGhpcy5zY3JlZW5T
aXplLndpZHRoICsgbmV3Q29sdW1uICUg
dGhpcy5zY3JlZW5TaXplLndpZHRoOwog
ICAgfQoKICAgIHRoaXMuc2V0Q3Vyc29y
UG9zaXRpb24oTWF0aC5tYXgobmV3Um93
LCAwKSwgbmV3Q29sdW1uKTsKCiAgfSBl
bHNlIHsKICAgIHZhciBuZXdDb2x1bW4g
PSBNYXRoLm1heChjdXJyZW50Q29sdW1u
IC0gY291bnQsIDApOwogICAgdGhpcy5z
ZXRDdXJzb3JDb2x1bW4obmV3Q29sdW1u
KTsKICB9Cn07CgovKioKICogTW92ZSB0
aGUgY3Vyc29yIHJpZ2h0IGEgc3BlY2lm
aWVkIG51bWJlciBvZiBjb2x1bW5zLgog
KgogKiBAcGFyYW0ge2ludGVnZXJ9IGNv
dW50IFRoZSBudW1iZXIgb2YgY29sdW1u
cyB0byBtb3ZlIHRoZSBjdXJzb3IuCiAq
LwpodGVybS5UZXJtaW5hbC5wcm90b3R5
cGUuY3Vyc29yUmlnaHQgPSBmdW5jdGlv
bihjb3VudCkgewogIGNvdW50ID0gY291
bnQgfHwgMTsKCiAgaWYgKGNvdW50IDwg
MSkKICAgIHJldHVybjsKCiAgdmFyIGNv
bHVtbiA9IGxpYi5mLmNsYW1wKHRoaXMu
c2NyZWVuXy5jdXJzb3JQb3NpdGlvbi5j
b2x1bW4gKyBjb3VudCwKICAgICAgICAg
ICAgICAgICAgICAgICAgICAgMCwgdGhp
cy5zY3JlZW5TaXplLndpZHRoIC0gMSk7
CiAgdGhpcy5zZXRDdXJzb3JDb2x1bW4o
Y29sdW1uKTsKfTsKCi8qKgogKiBSZXZl
cnNlIHRoZSBmb3JlZ3JvdW5kIGFuZCBi
YWNrZ3JvdW5kIGNvbG9ycyBvZiB0aGUg
dGVybWluYWwuCiAqCiAqIFRoaXMgb25s
eSBhZmZlY3RzIHRleHQgdGhhdCB3YXMg
ZHJhd24gd2l0aCBubyBhdHRyaWJ1dGVz
LgogKgogKiBUT0RPKHJnaW5kYSk6IFRl
c3QgeHRlcm0gdG8gc2VlIGlmIHJldmVy
c2UgaXMgcmVzcGVjdGVkIGZvciB0ZXh0
IHRoYXQgaGFzCiAqIGJlZW4gZHJhd24g
d2l0aCBhdHRyaWJ1dGVzIHRoYXQgaGFw
cGVuIHRvIGNvaW5jaWRlIHdpdGggdGhl
IGRlZmF1bHQKICogJ25vLWF0dHJpYnV0
ZScgY29sb3JzLiAgTXkgZ3Vlc3MgaXMg
cHJvYmFibHkgbm90LgogKi8KaHRlcm0u
VGVybWluYWwucHJvdG90eXBlLnNldFJl
dmVyc2VWaWRlbyA9IGZ1bmN0aW9uKHN0
YXRlKSB7CiAgdGhpcy5vcHRpb25zXy5y
ZXZlcnNlVmlkZW8gPSBzdGF0ZTsKICBp
ZiAoc3RhdGUpIHsKICAgIHRoaXMuc2Ny
b2xsUG9ydF8uc2V0Rm9yZWdyb3VuZENv
bG9yKHRoaXMucHJlZnNfLmdldCgnYmFj
a2dyb3VuZC1jb2xvcicpKTsKICAgIHRo
aXMuc2Nyb2xsUG9ydF8uc2V0QmFja2dy
b3VuZENvbG9yKHRoaXMucHJlZnNfLmdl
dCgnZm9yZWdyb3VuZC1jb2xvcicpKTsK
ICB9IGVsc2UgewogICAgdGhpcy5zY3Jv
bGxQb3J0Xy5zZXRGb3JlZ3JvdW5kQ29s
b3IodGhpcy5wcmVmc18uZ2V0KCdmb3Jl
Z3JvdW5kLWNvbG9yJykpOwogICAgdGhp
cy5zY3JvbGxQb3J0Xy5zZXRCYWNrZ3Jv
dW5kQ29sb3IodGhpcy5wcmVmc18uZ2V0
KCdiYWNrZ3JvdW5kLWNvbG9yJykpOwog
IH0KfTsKCi8qKgogKiBSaW5nIHRoZSB0
ZXJtaW5hbCBiZWxsLgogKgogKiBUaGlz
IHdpbGwgbm90IHBsYXkgdGhlIGJlbGwg
YXVkaW8gbW9yZSB0aGFuIG9uY2UgcGVy
IHNlY29uZC4KICovCmh0ZXJtLlRlcm1p
bmFsLnByb3RvdHlwZS5yaW5nQmVsbCA9
IGZ1bmN0aW9uKCkgewogIHRoaXMuY3Vy
c29yTm9kZV8uc3R5bGUuYmFja2dyb3Vu
ZENvbG9yID0KICAgICAgdGhpcy5zY3Jv
bGxQb3J0Xy5nZXRGb3JlZ3JvdW5kQ29s
b3IoKTsKCiAgdmFyIHNlbGYgPSB0aGlz
OwogIHNldFRpbWVvdXQoZnVuY3Rpb24o
KSB7CiAgICAgIHNlbGYuY3Vyc29yTm9k
ZV8uc3R5bGUuYmFja2dyb3VuZENvbG9y
ID0gc2VsZi5wcmVmc18uZ2V0KCdjdXJz
b3ItY29sb3InKTsKICAgIH0sIDIwMCk7
CgogIC8vIGJlbGxTcXVlbGNoVGltZW91
dF8gYWZmZWN0cyBib3RoIGF1ZGlvIGFu
ZCBub3RpZmljYXRpb24gYmVsbHMuCiAg
aWYgKHRoaXMuYmVsbFNxdWVsY2hUaW1l
b3V0XykKICAgIHJldHVybjsKCiAgaWYg
KHRoaXMuYmVsbEF1ZGlvXy5nZXRBdHRy
aWJ1dGUoJ3NyYycpKSB7CiAgICB0aGlz
LmJlbGxBdWRpb18ucGxheSgpOwogICAg
dGhpcy5iZWxsU2VxdWVsY2hUaW1lb3V0
XyA9IHNldFRpbWVvdXQoZnVuY3Rpb24o
KSB7CiAgICAgICAgZGVsZXRlIHRoaXMu
YmVsbFNxdWVsY2hUaW1lb3V0XzsKICAg
ICAgfS5iaW5kKHRoaXMpLCA1MDApOwog
IH0gZWxzZSB7CiAgICBkZWxldGUgdGhp
cy5iZWxsU3F1ZWxjaFRpbWVvdXRfOwog
IH0KCiAgaWYgKHRoaXMuZGVza3RvcE5v
dGlmaWNhdGlvbkJlbGxfICYmICF0aGlz
LmRvY3VtZW50Xy5oYXNGb2N1cygpKSB7
CiAgICB2YXIgbiA9IG5ldyBOb3RpZmlj
YXRpb24oCiAgICAgICAgbGliLmYucmVw
bGFjZVZhcnMoaHRlcm0uZGVza3RvcE5v
dGlmaWNhdGlvblRpdGxlLAogICAgICAg
ICAgICAgICAgICAgICAgICAgIHsndGl0
bGUnOiB3aW5kb3cuZG9jdW1lbnQudGl0
bGUgfHwgJ2h0ZXJtJ30pKTsKICAgIHRo
aXMuYmVsbE5vdGlmaWNhdGlvbkxpc3Rf
LnB1c2gobik7CiAgICAvLyBUT0RPOiBT
aG91bGQgd2UgdHJ5IHRvIHJhaXNlIHRo
ZSB3aW5kb3cgaGVyZT8KICAgIG4ub25j
bGljayA9IGZ1bmN0aW9uKCkgeyBzZWxm
LmNsb3NlQmVsbE5vdGlmaWNhdGlvbnNf
KCk7IH07CiAgfQp9OwoKLyoqCiAqIFNl
dCB0aGUgb3JpZ2luIG1vZGUgYml0Lgog
KgogKiBJZiBvcmlnaW4gbW9kZSBpcyBv
biwgY2VydGFpbiBWVCBjdXJzb3IgYW5k
IHNjcm9sbGluZyBjb21tYW5kcyBtZWFz
dXJlIHRoZWlyCiAqIHJvdyBwYXJhbWV0
ZXIgcmVsYXRpdmUgdG8gdGhlIFZUIHNj
cm9sbCByZWdpb24uICBPdGhlcndpc2Us
IHJvdyAwIGNvcnJlc3BvbmRzCiAqIHRv
IHRoZSB0b3Agb2YgdGhlIGFkZHJlc3Nh
YmxlIHNjcmVlbi4KICoKICogRGVmYXVs
dHMgdG8gb2ZmLgogKgogKiBAcGFyYW0g
e2Jvb2xlYW59IHN0YXRlIFRydWUgdG8g
c2V0IG9yaWdpbiBtb2RlLCBmYWxzZSB0
byB1bnNldC4KICovCmh0ZXJtLlRlcm1p
bmFsLnByb3RvdHlwZS5zZXRPcmlnaW5N
b2RlID0gZnVuY3Rpb24oc3RhdGUpIHsK
ICB0aGlzLm9wdGlvbnNfLm9yaWdpbk1v
ZGUgPSBzdGF0ZTsKICB0aGlzLnNldEN1
cnNvclBvc2l0aW9uKDAsIDApOwp9OwoK
LyoqCiAqIFNldCB0aGUgaW5zZXJ0IG1v
ZGUgYml0LgogKgogKiBJZiBpbnNlcnQg
bW9kZSBpcyBvbiwgZXhpc3RpbmcgdGV4
dCBiZXlvbmQgdGhlIGN1cnNvciBwb3Np
dGlvbiB3aWxsIGJlCiAqIHNoaWZ0ZWQg
cmlnaHQgdG8gbWFrZSByb29tIGZvciBu
ZXcgdGV4dC4gIE90aGVyd2lzZSwgbmV3
IHRleHQgb3ZlcndyaXRlcwogKiBhbnkg
ZXhpc3RpbmcgdGV4dC4KICoKICogRGVm
YXVsdHMgdG8gb2ZmLgogKgogKiBAcGFy
YW0ge2Jvb2xlYW59IHN0YXRlIFRydWUg
dG8gc2V0IGluc2VydCBtb2RlLCBmYWxz
ZSB0byB1bnNldC4KICovCmh0ZXJtLlRl
cm1pbmFsLnByb3RvdHlwZS5zZXRJbnNl
cnRNb2RlID0gZnVuY3Rpb24oc3RhdGUp
IHsKICB0aGlzLm9wdGlvbnNfLmluc2Vy
dE1vZGUgPSBzdGF0ZTsKfTsKCi8qKgog
KiBTZXQgdGhlIGF1dG8gY2FycmlhZ2Ug
cmV0dXJuIGJpdC4KICoKICogSWYgYXV0
byBjYXJyaWFnZSByZXR1cm4gaXMgb24g
dGhlbiBhIGZvcm1mZWVkIGNoYXJhY3Rl
ciBpcyBpbnRlcnByZXRlZAogKiBhcyBh
IG5ld2xpbmUsIG90aGVyd2lzZSBpdCdz
IHRoZSBzYW1lIGFzIGEgbGluZWZlZWQu
ICBUaGUgZGlmZmVyZW5jZSBib2lscwog
KiBkb3duIHRvIHdoZXRoZXIgb3Igbm90
IHRoZSBjdXJzb3IgY29sdW1uIGlzIHJl
c2V0LgogKi8KaHRlcm0uVGVybWluYWwu
cHJvdG90eXBlLnNldEF1dG9DYXJyaWFn
ZVJldHVybiA9IGZ1bmN0aW9uKHN0YXRl
KSB7CiAgdGhpcy5vcHRpb25zXy5hdXRv
Q2FycmlhZ2VSZXR1cm4gPSBzdGF0ZTsK
fTsKCi8qKgogKiBTZXQgdGhlIHdyYXBh
cm91bmQgbW9kZSBiaXQuCiAqCiAqIElm
IHdyYXBhcm91bmQgbW9kZSBpcyBvbiwg
Y2VydGFpbiBWVCBjb21tYW5kcyB3aWxs
IGFsbG93IHRoZSBjdXJzb3IgdG8gd3Jh
cAogKiB0byB0aGUgc3RhcnQgb2YgdGhl
IGZvbGxvd2luZyByb3cuICBPdGhlcndp
c2UsIHRoZSBjdXJzb3IgaXMgY2xhbXBl
ZCB0byB0aGUKICogZW5kIG9mIHRoZSBz
Y3JlZW4gYW5kIGF0dGVtcHRzIHRvIHdy
aXRlIHBhc3QgaXQgYXJlIGlnbm9yZWQu
CiAqCiAqIERlZmF1bHRzIHRvIG9uLgog
KgogKiBAcGFyYW0ge2Jvb2xlYW59IHN0
YXRlIFRydWUgdG8gc2V0IHdyYXBhcm91
bmQgbW9kZSwgZmFsc2UgdG8gdW5zZXQu
CiAqLwpodGVybS5UZXJtaW5hbC5wcm90
b3R5cGUuc2V0V3JhcGFyb3VuZCA9IGZ1
bmN0aW9uKHN0YXRlKSB7CiAgdGhpcy5v
cHRpb25zXy53cmFwYXJvdW5kID0gc3Rh
dGU7Cn07CgovKioKICogU2V0IHRoZSBy
ZXZlcnNlLXdyYXBhcm91bmQgbW9kZSBi
aXQuCiAqCiAqIElmIHdyYXBhcm91bmQg
bW9kZSBpcyBvZmYsIGNlcnRhaW4gVlQg
Y29tbWFuZHMgd2lsbCBhbGxvdyB0aGUg
Y3Vyc29yIHRvIHdyYXAKICogdG8gdGhl
IGVuZCBvZiB0aGUgcHJldmlvdXMgcm93
LiAgT3RoZXJ3aXNlLCB0aGUgY3Vyc29y
IGlzIGNsYW1wZWQgdG8gY29sdW1uCiAq
IDAuCiAqCiAqIERlZmF1bHRzIHRvIG9m
Zi4KICoKICogQHBhcmFtIHtib29sZWFu
fSBzdGF0ZSBUcnVlIHRvIHNldCByZXZl
cnNlLXdyYXBhcm91bmQgbW9kZSwgZmFs
c2UgdG8gdW5zZXQuCiAqLwpodGVybS5U
ZXJtaW5hbC5wcm90b3R5cGUuc2V0UmV2
ZXJzZVdyYXBhcm91bmQgPSBmdW5jdGlv
bihzdGF0ZSkgewogIHRoaXMub3B0aW9u
c18ucmV2ZXJzZVdyYXBhcm91bmQgPSBz
dGF0ZTsKfTsKCi8qKgogKiBTZWxlY3Rz
IGJldHdlZW4gdGhlIHByaW1hcnkgYW5k
IGFsdGVybmF0ZSBzY3JlZW5zLgogKgog
KiBJZiBhbHRlcm5hdGUgbW9kZSBpcyBv
biwgdGhlIGFsdGVybmF0ZSBzY3JlZW4g
aXMgYWN0aXZlLiAgT3RoZXJ3aXNlIHRo
ZQogKiBwcmltYXJ5IHNjcmVlbiBpcyBh
Y3RpdmUuCiAqCiAqIFN3YXBwaW5nIHNj
cmVlbnMgaGFzIG5vIGVmZmVjdCBvbiB0
aGUgc2Nyb2xsYmFjayBidWZmZXIuCiAq
CiAqIEVhY2ggc2NyZWVuIG1haW50YWlu
cyBpdHMgb3duIGN1cnNvciBwb3NpdGlv
bi4KICoKICogRGVmYXVsdHMgdG8gb2Zm
LgogKgogKiBAcGFyYW0ge2Jvb2xlYW59
IHN0YXRlIFRydWUgdG8gc2V0IGFsdGVy
bmF0ZSBtb2RlLCBmYWxzZSB0byB1bnNl
dC4KICovCmh0ZXJtLlRlcm1pbmFsLnBy
b3RvdHlwZS5zZXRBbHRlcm5hdGVNb2Rl
ID0gZnVuY3Rpb24oc3RhdGUpIHsKICB2
YXIgY3Vyc29yID0gdGhpcy5zYXZlQ3Vy
c29yKCk7CiAgdGhpcy5zY3JlZW5fID0g
c3RhdGUgPyB0aGlzLmFsdGVybmF0ZVNj
cmVlbl8gOiB0aGlzLnByaW1hcnlTY3Jl
ZW5fOwoKICBpZiAodGhpcy5zY3JlZW5f
LnJvd3NBcnJheS5sZW5ndGggJiYKICAg
ICAgdGhpcy5zY3JlZW5fLnJvd3NBcnJh
eVswXS5yb3dJbmRleCAhPSB0aGlzLnNj
cm9sbGJhY2tSb3dzXy5sZW5ndGgpIHsK
ICAgIC8vIElmIHRoZSBzY3JlZW4gY2hh
bmdlZCBzaXplcyB3aGlsZSB3ZSB3ZXJl
IGF3YXksIG91ciByb3dJbmRleGVzIG1h
eQogICAgLy8gYmUgaW5jb3JyZWN0Lgog
ICAgdmFyIG9mZnNldCA9IHRoaXMuc2Ny
b2xsYmFja1Jvd3NfLmxlbmd0aDsKICAg
IHZhciBhcnkgPSB0aGlzLnNjcmVlbl8u
cm93c0FycmF5OwogICAgZm9yICh2YXIg
aSA9IDA7IGkgPCBhcnkubGVuZ3RoOyBp
KyspIHsKICAgICAgYXJ5W2ldLnJvd0lu
ZGV4ID0gb2Zmc2V0ICsgaTsKICAgIH0K
ICB9CgogIHRoaXMucmVhbGl6ZVdpZHRo
Xyh0aGlzLnNjcmVlblNpemUud2lkdGgp
OwogIHRoaXMucmVhbGl6ZUhlaWdodF8o
dGhpcy5zY3JlZW5TaXplLmhlaWdodCk7
CiAgdGhpcy5zY3JvbGxQb3J0Xy5zeW5j
U2Nyb2xsSGVpZ2h0KCk7CiAgdGhpcy5z
Y3JvbGxQb3J0Xy5pbnZhbGlkYXRlKCk7
CgogIHRoaXMucmVzdG9yZUN1cnNvcihj
dXJzb3IpOwogIHRoaXMuc2Nyb2xsUG9y
dF8ucmVzaXplKCk7Cn07CgovKioKICog
U2V0IHRoZSBjdXJzb3ItYmxpbmsgbW9k
ZSBiaXQuCiAqCiAqIElmIGN1cnNvci1i
bGluayBpcyBvbiwgdGhlIGN1cnNvciB3
aWxsIGJsaW5rIHdoZW4gaXQgaXMgdmlz
aWJsZS4gIE90aGVyd2lzZQogKiBhIHZp
c2libGUgY3Vyc29yIGRvZXMgbm90IGJs
aW5rLgogKgogKiBZb3Ugc2hvdWxkIG1h
a2Ugc3VyZSB0byB0dXJuIGJsaW5raW5n
IG9mZiBpZiB5b3UncmUgZ29pbmcgdG8g
ZGlzcG9zZSBvZiBhCiAqIHRlcm1pbmFs
LCBvdGhlcndpc2UgeW91J2xsIGxlYWsg
YSB0aW1lb3V0LgogKgogKiBEZWZhdWx0
cyB0byBvbi4KICoKICogQHBhcmFtIHti
b29sZWFufSBzdGF0ZSBUcnVlIHRvIHNl
dCBjdXJzb3ItYmxpbmsgbW9kZSwgZmFs
c2UgdG8gdW5zZXQuCiAqLwpodGVybS5U
ZXJtaW5hbC5wcm90b3R5cGUuc2V0Q3Vy
c29yQmxpbmsgPSBmdW5jdGlvbihzdGF0
ZSkgewogIHRoaXMub3B0aW9uc18uY3Vy
c29yQmxpbmsgPSBzdGF0ZTsKCiAgaWYg
KCFzdGF0ZSAmJiB0aGlzLnRpbWVvdXRz
Xy5jdXJzb3JCbGluaykgewogICAgY2xl
YXJUaW1lb3V0KHRoaXMudGltZW91dHNf
LmN1cnNvckJsaW5rKTsKICAgIGRlbGV0
ZSB0aGlzLnRpbWVvdXRzXy5jdXJzb3JC
bGluazsKICB9CgogIGlmICh0aGlzLm9w
dGlvbnNfLmN1cnNvclZpc2libGUpCiAg
ICB0aGlzLnNldEN1cnNvclZpc2libGUo
dHJ1ZSk7Cn07CgovKioKICogU2V0IHRo
ZSBjdXJzb3ItdmlzaWJsZSBtb2RlIGJp
dC4KICoKICogSWYgY3Vyc29yLXZpc2li
bGUgaXMgb24sIHRoZSBjdXJzb3Igd2ls
bCBiZSB2aXNpYmxlLiAgT3RoZXJ3aXNl
IGl0IHdpbGwgbm90LgogKgogKiBEZWZh
dWx0cyB0byBvbi4KICoKICogQHBhcmFt
IHtib29sZWFufSBzdGF0ZSBUcnVlIHRv
IHNldCBjdXJzb3ItdmlzaWJsZSBtb2Rl
LCBmYWxzZSB0byB1bnNldC4KICovCmh0
ZXJtLlRlcm1pbmFsLnByb3RvdHlwZS5z
ZXRDdXJzb3JWaXNpYmxlID0gZnVuY3Rp
b24oc3RhdGUpIHsKICB0aGlzLm9wdGlv
bnNfLmN1cnNvclZpc2libGUgPSBzdGF0
ZTsKCiAgaWYgKCFzdGF0ZSkgewogICAg
aWYgKHRoaXMudGltZW91dHNfLmN1cnNv
ckJsaW5rKSB7CiAgICAgIGNsZWFyVGlt
ZW91dCh0aGlzLnRpbWVvdXRzXy5jdXJz
b3JCbGluayk7CiAgICAgIGRlbGV0ZSB0
aGlzLnRpbWVvdXRzXy5jdXJzb3JCbGlu
azsKICAgIH0KICAgIHRoaXMuY3Vyc29y
Tm9kZV8uc3R5bGUub3BhY2l0eSA9ICcw
JzsKICAgIHJldHVybjsKICB9CgogIHRo
aXMuc3luY0N1cnNvclBvc2l0aW9uXygp
OwoKICB0aGlzLmN1cnNvck5vZGVfLnN0
eWxlLm9wYWNpdHkgPSAnMSc7CgogIGlm
ICh0aGlzLm9wdGlvbnNfLmN1cnNvckJs
aW5rKSB7CiAgICBpZiAodGhpcy50aW1l
b3V0c18uY3Vyc29yQmxpbmspCiAgICAg
IHJldHVybjsKCiAgICB0aGlzLm9uQ3Vy
c29yQmxpbmtfKCk7CiAgfSBlbHNlIHsK
ICAgIGlmICh0aGlzLnRpbWVvdXRzXy5j
dXJzb3JCbGluaykgewogICAgICBjbGVh
clRpbWVvdXQodGhpcy50aW1lb3V0c18u
Y3Vyc29yQmxpbmspOwogICAgICBkZWxl
dGUgdGhpcy50aW1lb3V0c18uY3Vyc29y
Qmxpbms7CiAgICB9CiAgfQp9OwoKLyoq
CiAqIFN5bmNocm9uaXplcyB0aGUgdmlz
aWJsZSBjdXJzb3IgYW5kIGRvY3VtZW50
IHNlbGVjdGlvbiB3aXRoIHRoZSBjdXJy
ZW50CiAqIGN1cnNvciBjb29yZGluYXRl
cy4KICovCmh0ZXJtLlRlcm1pbmFsLnBy
b3RvdHlwZS5zeW5jQ3Vyc29yUG9zaXRp
b25fID0gZnVuY3Rpb24oKSB7CiAgdmFy
IHRvcFJvd0luZGV4ID0gdGhpcy5zY3Jv
bGxQb3J0Xy5nZXRUb3BSb3dJbmRleCgp
OwogIHZhciBib3R0b21Sb3dJbmRleCA9
IHRoaXMuc2Nyb2xsUG9ydF8uZ2V0Qm90
dG9tUm93SW5kZXgodG9wUm93SW5kZXgp
OwogIHZhciBjdXJzb3JSb3dJbmRleCA9
IHRoaXMuc2Nyb2xsYmFja1Jvd3NfLmxl
bmd0aCArCiAgICAgIHRoaXMuc2NyZWVu
Xy5jdXJzb3JQb3NpdGlvbi5yb3c7Cgog
IGlmIChjdXJzb3JSb3dJbmRleCA+IGJv
dHRvbVJvd0luZGV4KSB7CiAgICAvLyBD
dXJzb3IgaXMgc2Nyb2xsZWQgb2ZmIHNj
cmVlbiwgbW92ZSBpdCBvdXRzaWRlIG9m
IHRoZSB2aXNpYmxlIGFyZWEuCiAgICB0
aGlzLmN1cnNvck5vZGVfLnN0eWxlLnRv
cCA9IC10aGlzLnNjcm9sbFBvcnRfLmNo
YXJhY3RlclNpemUuaGVpZ2h0ICsgJ3B4
JzsKICAgIHJldHVybjsKICB9CgogIGlm
ICh0aGlzLm9wdGlvbnNfLmN1cnNvclZp
c2libGUgJiYKICAgICAgdGhpcy5jdXJz
b3JOb2RlXy5zdHlsZS5kaXNwbGF5ID09
ICdub25lJykgewogICAgLy8gUmUtZGlz
cGxheSB0aGUgdGVybWluYWwgY3Vyc29y
IGlmIGl0IHdhcyBoaWRkZW4gYnkgdGhl
IG1vdXNlIGN1cnNvci4KICAgIHRoaXMu
Y3Vyc29yTm9kZV8uc3R5bGUuZGlzcGxh
eSA9ICcnOwogIH0KCgogIHRoaXMuY3Vy
c29yTm9kZV8uc3R5bGUudG9wID0gdGhp
cy5zY3JvbGxQb3J0Xy52aXNpYmxlUm93
VG9wTWFyZ2luICsKICAgICAgdGhpcy5z
Y3JvbGxQb3J0Xy5jaGFyYWN0ZXJTaXpl
LmhlaWdodCAqIChjdXJzb3JSb3dJbmRl
eCAtIHRvcFJvd0luZGV4KSArCiAgICAg
ICdweCc7CiAgdGhpcy5jdXJzb3JOb2Rl
Xy5zdHlsZS5sZWZ0ID0gdGhpcy5zY3Jv
bGxQb3J0Xy5jaGFyYWN0ZXJTaXplLndp
ZHRoICoKICAgICAgdGhpcy5zY3JlZW5f
LmN1cnNvclBvc2l0aW9uLmNvbHVtbiAr
ICdweCc7CgogIHRoaXMuY3Vyc29yTm9k
ZV8uc2V0QXR0cmlidXRlKCd0aXRsZScs
CiAgICAgICAgICAgICAgICAgICAgICAg
ICAgICAgICAgJygnICsgdGhpcy5zY3Jl
ZW5fLmN1cnNvclBvc2l0aW9uLnJvdyAr
CiAgICAgICAgICAgICAgICAgICAgICAg
ICAgICAgICAgJywgJyArIHRoaXMuc2Ny
ZWVuXy5jdXJzb3JQb3NpdGlvbi5jb2x1
bW4gKwogICAgICAgICAgICAgICAgICAg
ICAgICAgICAgICAgICcpJyk7CgogIC8v
IFVwZGF0ZSB0aGUgY2FyZXQgZm9yIGEx
MXkgcHVycG9zZXMuCiAgdmFyIHNlbGVj
dGlvbiA9IHRoaXMuZG9jdW1lbnRfLmdl
dFNlbGVjdGlvbigpOwogIGlmIChzZWxl
Y3Rpb24gJiYgc2VsZWN0aW9uLmlzQ29s
bGFwc2VkKQogICAgdGhpcy5zY3JlZW5f
LnN5bmNTZWxlY3Rpb25DYXJldChzZWxl
Y3Rpb24pOwp9OwoKLyoqCiAqIEFkanVz
dHMgdGhlIHN0eWxlIG9mIHRoaXMuY3Vy
c29yTm9kZV8gYWNjb3JkaW5nIHRvIHRo
ZSBjdXJyZW50IGN1cnNvciBzaGFwZQog
KiBhbmQgY2hhcmFjdGVyIGNlbGwgZGlt
ZW5zaW9ucy4KICovCmh0ZXJtLlRlcm1p
bmFsLnByb3RvdHlwZS5yZXN0eWxlQ3Vy
c29yXyA9IGZ1bmN0aW9uKCkgewogIHZh
ciBzaGFwZSA9IHRoaXMuY3Vyc29yU2hh
cGVfOwoKICBpZiAodGhpcy5jdXJzb3JO
b2RlXy5nZXRBdHRyaWJ1dGUoJ2ZvY3Vz
JykgPT0gJ2ZhbHNlJykgewogICAgLy8g
QWx3YXlzIHNob3cgYSBibG9jayBjdXJz
b3Igd2hlbiB1bmZvY3VzZWQuCiAgICBz
aGFwZSA9IGh0ZXJtLlRlcm1pbmFsLmN1
cnNvclNoYXBlLkJMT0NLOwogIH0KCiAg
dmFyIHN0eWxlID0gdGhpcy5jdXJzb3JO
b2RlXy5zdHlsZTsKCiAgc3R5bGUud2lk
dGggPSB0aGlzLnNjcm9sbFBvcnRfLmNo
YXJhY3RlclNpemUud2lkdGggKyAncHgn
OwoKICBzd2l0Y2ggKHNoYXBlKSB7CiAg
ICBjYXNlIGh0ZXJtLlRlcm1pbmFsLmN1
cnNvclNoYXBlLkJFQU06CiAgICAgIHN0
eWxlLmhlaWdodCA9IHRoaXMuc2Nyb2xs
UG9ydF8uY2hhcmFjdGVyU2l6ZS5oZWln
aHQgKyAncHgnOwogICAgICBzdHlsZS5i
YWNrZ3JvdW5kQ29sb3IgPSAndHJhbnNw
YXJlbnQnOwogICAgICBzdHlsZS5ib3Jk
ZXJCb3R0b21TdHlsZSA9IG51bGw7CiAg
ICAgIHN0eWxlLmJvcmRlckxlZnRTdHls
ZSA9ICdzb2xpZCc7CiAgICAgIGJyZWFr
OwoKICAgIGNhc2UgaHRlcm0uVGVybWlu
YWwuY3Vyc29yU2hhcGUuVU5ERVJMSU5F
OgogICAgICBzdHlsZS5oZWlnaHQgPSB0
aGlzLnNjcm9sbFBvcnRfLmNoYXJhY3Rl
clNpemUuYmFzZWxpbmUgKyAncHgnOwog
ICAgICBzdHlsZS5iYWNrZ3JvdW5kQ29s
b3IgPSAndHJhbnNwYXJlbnQnOwogICAg
ICBzdHlsZS5ib3JkZXJCb3R0b21TdHls
ZSA9ICdzb2xpZCc7CiAgICAgIC8vIGNv
cnJlY3QgdGhlIHNpemUgdG8gcHV0IGl0
IGV4YWN0bHkgYXQgdGhlIGJhc2VsaW5l
CiAgICAgIHN0eWxlLmJvcmRlckxlZnRT
dHlsZSA9IG51bGw7CiAgICAgIGJyZWFr
OwoKICAgIGRlZmF1bHQ6CiAgICAgIHN0
eWxlLmhlaWdodCA9IHRoaXMuc2Nyb2xs
UG9ydF8uY2hhcmFjdGVyU2l6ZS5oZWln
aHQgKyAncHgnOwogICAgICBzdHlsZS5i
YWNrZ3JvdW5kQ29sb3IgPSB0aGlzLmN1
cnNvckNvbG9yXzsKICAgICAgc3R5bGUu
Ym9yZGVyQm90dG9tU3R5bGUgPSBudWxs
OwogICAgICBzdHlsZS5ib3JkZXJMZWZ0
U3R5bGUgPSBudWxsOwogICAgICBicmVh
azsKICB9Cn07CgovKioKICogU3luY2hy
b25pemVzIHRoZSB2aXNpYmxlIGN1cnNv
ciB3aXRoIHRoZSBjdXJyZW50IGN1cnNv
ciBjb29yZGluYXRlcy4KICoKICogVGhl
IHN5bmMgd2lsbCBoYXBwZW4gYXN5bmNo
cm9ub3VzbHksIHNvb24gYWZ0ZXIgdGhl
IGNhbGwgc3RhY2sgd2luZHMgZG93bi4K
ICogTXVsdGlwbGUgY2FsbHMgd2lsbCBi
ZSBjb2FsZXNjZWQgaW50byBhIHNpbmds
ZSBzeW5jLgogKi8KaHRlcm0uVGVybWlu
YWwucHJvdG90eXBlLnNjaGVkdWxlU3lu
Y0N1cnNvclBvc2l0aW9uXyA9IGZ1bmN0
aW9uKCkgewogIGlmICh0aGlzLnRpbWVv
dXRzXy5zeW5jQ3Vyc29yKQogICAgcmV0
dXJuOwoKICB2YXIgc2VsZiA9IHRoaXM7
CiAgdGhpcy50aW1lb3V0c18uc3luY0N1
cnNvciA9IHNldFRpbWVvdXQoZnVuY3Rp
b24oKSB7CiAgICAgIHNlbGYuc3luY0N1
cnNvclBvc2l0aW9uXygpOwogICAgICBk
ZWxldGUgc2VsZi50aW1lb3V0c18uc3lu
Y0N1cnNvcjsKICAgIH0sIDApOwp9OwoK
LyoqCiAqIFNob3cgb3IgaGlkZSB0aGUg
em9vbSB3YXJuaW5nLgogKgogKiBUaGUg
em9vbSB3YXJuaW5nIGlzIGEgbWVzc2Fn
ZSB3YXJuaW5nIHRoZSB1c2VyIHRoYXQg
dGhlaXIgYnJvd3NlciB6b29tIG11c3QK
ICogYmUgc2V0IHRvIDEwMCUgaW4gb3Jk
ZXIgZm9yIGh0ZXJtIHRvIGZ1bmN0aW9u
IHByb3Blcmx5LgogKgogKiBAcGFyYW0g
e2Jvb2xlYW59IHN0YXRlIFRydWUgdG8g
c2hvdyB0aGUgbWVzc2FnZSwgZmFsc2Ug
dG8gaGlkZSBpdC4KICovCmh0ZXJtLlRl
cm1pbmFsLnByb3RvdHlwZS5zaG93Wm9v
bVdhcm5pbmdfID0gZnVuY3Rpb24oc3Rh
dGUpIHsKICBpZiAoIXRoaXMuem9vbVdh
cm5pbmdOb2RlXykgewogICAgaWYgKCFz
dGF0ZSkKICAgICAgcmV0dXJuOwoKICAg
IHRoaXMuem9vbVdhcm5pbmdOb2RlXyA9
IHRoaXMuZG9jdW1lbnRfLmNyZWF0ZUVs
ZW1lbnQoJ2RpdicpOwogICAgdGhpcy56
b29tV2FybmluZ05vZGVfLnN0eWxlLmNz
c1RleHQgPSAoCiAgICAgICAgJ2NvbG9y
OiBibGFjazsnICsKICAgICAgICAnYmFj
a2dyb3VuZC1jb2xvcjogI2ZmMjIyMjsn
ICsKICAgICAgICAnZm9udC1zaXplOiBs
YXJnZTsnICsKICAgICAgICAnYm9yZGVy
LXJhZGl1czogOHB4OycgKwogICAgICAg
ICdvcGFjaXR5OiAwLjc1OycgKwogICAg
ICAgICdwYWRkaW5nOiAwLjJlbSAwLjVl
bSAwLjJlbSAwLjVlbTsnICsKICAgICAg
ICAndG9wOiAwLjVlbTsnICsKICAgICAg
ICAncmlnaHQ6IDEuMmVtOycgKwogICAg
ICAgICdwb3NpdGlvbjogYWJzb2x1dGU7
JyArCiAgICAgICAgJy13ZWJraXQtdGV4
dC1zaXplLWFkanVzdDogbm9uZTsnICsK
ICAgICAgICAnLXdlYmtpdC11c2VyLXNl
bGVjdDogbm9uZTsnICsKICAgICAgICAn
LW1vei10ZXh0LXNpemUtYWRqdXN0OiBu
b25lOycgKwogICAgICAgICctbW96LXVz
ZXItc2VsZWN0OiBub25lOycpOwogIH0K
CiAgdGhpcy56b29tV2FybmluZ05vZGVf
LnRleHRDb250ZW50ID0gbGliLk1lc3Nh
Z2VNYW5hZ2VyLnJlcGxhY2VSZWZlcmVu
Y2VzKAogICAgICBodGVybS56b29tV2Fy
bmluZ01lc3NhZ2UsCiAgICAgIFtwYXJz
ZUludCh0aGlzLnNjcm9sbFBvcnRfLmNo
YXJhY3RlclNpemUuem9vbUZhY3RvciAq
IDEwMCldKTsKCiAgdGhpcy56b29tV2Fy
bmluZ05vZGVfLnN0eWxlLmZvbnRGYW1p
bHkgPSB0aGlzLnByZWZzXy5nZXQoJ2Zv
bnQtZmFtaWx5Jyk7CgogIGlmIChzdGF0
ZSkgewogICAgaWYgKCF0aGlzLnpvb21X
YXJuaW5nTm9kZV8ucGFyZW50Tm9kZSkK
ICAgICAgdGhpcy5kaXZfLnBhcmVudE5v
ZGUuYXBwZW5kQ2hpbGQodGhpcy56b29t
V2FybmluZ05vZGVfKTsKICB9IGVsc2Ug
aWYgKHRoaXMuem9vbVdhcm5pbmdOb2Rl
Xy5wYXJlbnROb2RlKSB7CiAgICB0aGlz
Lnpvb21XYXJuaW5nTm9kZV8ucGFyZW50
Tm9kZS5yZW1vdmVDaGlsZCh0aGlzLnpv
b21XYXJuaW5nTm9kZV8pOwogIH0KfTsK
Ci8qKgogKiBTaG93IHRoZSB0ZXJtaW5h
bCBvdmVybGF5IGZvciBhIGdpdmVuIGFt
b3VudCBvZiB0aW1lLgogKgogKiBUaGUg
dGVybWluYWwgb3ZlcmxheSBhcHBlYXJz
IGluIGludmVyc2UgdmlkZW8gaW4gYSBs
YXJnZSBmb250LCBjZW50ZXJlZAogKiBv
dmVyIHRoZSB0ZXJtaW5hbC4gIFlvdSBz
aG91bGQgcHJvYmFibHkga2VlcCB0aGUg
b3ZlcmxheSBtZXNzYWdlIGJyaWVmLAog
KiBzaW5jZSBpdCdzIGluIGEgbGFyZ2Ug
Zm9udCBhbmQgeW91IHByb2JhYmx5IGFy
ZW4ndCBnb2luZyB0byBjaGVjayB0aGUg
c2l6ZQogKiBvZiB0aGUgdGVybWluYWwg
Zmlyc3QuCiAqCiAqIEBwYXJhbSB7c3Ry
aW5nfSBtc2cgVGhlIHRleHQgKG5vdCBI
VE1MKSBtZXNzYWdlIHRvIGRpc3BsYXkg
aW4gdGhlIG92ZXJsYXkuCiAqIEBwYXJh
bSB7bnVtYmVyfSBvcHRfdGltZW91dCBU
aGUgYW1vdW50IG9mIHRpbWUgdG8gd2Fp
dCBiZWZvcmUgZmFkaW5nIG91dAogKiAg
ICAgdGhlIG92ZXJsYXkuICBEZWZhdWx0
cyB0byAxLjUgc2Vjb25kcy4gIFBhc3Mg
bnVsbCB0byBoYXZlIHRoZSBvdmVybGF5
CiAqICAgICBzdGF5IHVwIGZvcmV2ZXIg
KG9yIHVudGlsIHRoZSBuZXh0IG92ZXJs
YXkpLgogKi8KaHRlcm0uVGVybWluYWwu
cHJvdG90eXBlLnNob3dPdmVybGF5ID0g
ZnVuY3Rpb24obXNnLCBvcHRfdGltZW91
dCkgewogIGlmICghdGhpcy5vdmVybGF5
Tm9kZV8pIHsKICAgIGlmICghdGhpcy5k
aXZfKQogICAgICByZXR1cm47CgogICAg
dGhpcy5vdmVybGF5Tm9kZV8gPSB0aGlz
LmRvY3VtZW50Xy5jcmVhdGVFbGVtZW50
KCdkaXYnKTsKICAgIHRoaXMub3Zlcmxh
eU5vZGVfLnN0eWxlLmNzc1RleHQgPSAo
CiAgICAgICAgJ2JvcmRlci1yYWRpdXM6
IDE1cHg7JyArCiAgICAgICAgJ2ZvbnQt
c2l6ZTogeHgtbGFyZ2U7JyArCiAgICAg
ICAgJ29wYWNpdHk6IDAuNzU7JyArCiAg
ICAgICAgJ3BhZGRpbmc6IDAuMmVtIDAu
NWVtIDAuMmVtIDAuNWVtOycgKwogICAg
ICAgICdwb3NpdGlvbjogYWJzb2x1dGU7
JyArCiAgICAgICAgJy13ZWJraXQtdXNl
ci1zZWxlY3Q6IG5vbmU7JyArCiAgICAg
ICAgJy13ZWJraXQtdHJhbnNpdGlvbjog
b3BhY2l0eSAxODBtcyBlYXNlLWluOycg
KwogICAgICAgICctbW96LXVzZXItc2Vs
ZWN0OiBub25lOycgKwogICAgICAgICct
bW96LXRyYW5zaXRpb246IG9wYWNpdHkg
MTgwbXMgZWFzZS1pbjsnKTsKCiAgICB0
aGlzLm92ZXJsYXlOb2RlXy5hZGRFdmVu
dExpc3RlbmVyKCdtb3VzZWRvd24nLCBm
dW5jdGlvbihlKSB7CiAgICAgIGUucHJl
dmVudERlZmF1bHQoKTsKICAgICAgZS5z
dG9wUHJvcGFnYXRpb24oKTsKICAgIH0s
IHRydWUpOwogIH0KCiAgdGhpcy5vdmVy
bGF5Tm9kZV8uc3R5bGUuY29sb3IgPSB0
aGlzLnByZWZzXy5nZXQoJ2JhY2tncm91
bmQtY29sb3InKTsKICB0aGlzLm92ZXJs
YXlOb2RlXy5zdHlsZS5iYWNrZ3JvdW5k
Q29sb3IgPSB0aGlzLnByZWZzXy5nZXQo
J2ZvcmVncm91bmQtY29sb3InKTsKICB0
aGlzLm92ZXJsYXlOb2RlXy5zdHlsZS5m
b250RmFtaWx5ID0gdGhpcy5wcmVmc18u
Z2V0KCdmb250LWZhbWlseScpOwoKICB0
aGlzLm92ZXJsYXlOb2RlXy50ZXh0Q29u
dGVudCA9IG1zZzsKICB0aGlzLm92ZXJs
YXlOb2RlXy5zdHlsZS5vcGFjaXR5ID0g
JzAuNzUnOwoKICBpZiAoIXRoaXMub3Zl
cmxheU5vZGVfLnBhcmVudE5vZGUpCiAg
ICB0aGlzLmRpdl8uYXBwZW5kQ2hpbGQo
dGhpcy5vdmVybGF5Tm9kZV8pOwoKICB2
YXIgZGl2U2l6ZSA9IGh0ZXJtLmdldENs
aWVudFNpemUodGhpcy5kaXZfKTsKICB2
YXIgb3ZlcmxheVNpemUgPSBodGVybS5n
ZXRDbGllbnRTaXplKHRoaXMub3Zlcmxh
eU5vZGVfKTsKCiAgdGhpcy5vdmVybGF5
Tm9kZV8uc3R5bGUudG9wID0KICAgICAg
KGRpdlNpemUuaGVpZ2h0IC0gb3Zlcmxh
eVNpemUuaGVpZ2h0KSAvIDIgKyAncHgn
OwogIHRoaXMub3ZlcmxheU5vZGVfLnN0
eWxlLmxlZnQgPSAoZGl2U2l6ZS53aWR0
aCAtIG92ZXJsYXlTaXplLndpZHRoIC0K
ICAgICAgdGhpcy5zY3JvbGxQb3J0Xy5j
dXJyZW50U2Nyb2xsYmFyV2lkdGhQeCkg
LyAyICsgJ3B4JzsKCiAgdmFyIHNlbGYg
PSB0aGlzOwoKICBpZiAodGhpcy5vdmVy
bGF5VGltZW91dF8pCiAgICBjbGVhclRp
bWVvdXQodGhpcy5vdmVybGF5VGltZW91
dF8pOwoKICBpZiAob3B0X3RpbWVvdXQg
PT09IG51bGwpCiAgICByZXR1cm47Cgog
IHRoaXMub3ZlcmxheVRpbWVvdXRfID0g
c2V0VGltZW91dChmdW5jdGlvbigpIHsK
ICAgICAgc2VsZi5vdmVybGF5Tm9kZV8u
c3R5bGUub3BhY2l0eSA9ICcwJzsKICAg
ICAgc2VsZi5vdmVybGF5VGltZW91dF8g
PSBzZXRUaW1lb3V0KGZ1bmN0aW9uKCkg
ewogICAgICAgICAgaWYgKHNlbGYub3Zl
cmxheU5vZGVfLnBhcmVudE5vZGUpCiAg
ICAgICAgICAgIHNlbGYub3ZlcmxheU5v
ZGVfLnBhcmVudE5vZGUucmVtb3ZlQ2hp
bGQoc2VsZi5vdmVybGF5Tm9kZV8pOwog
ICAgICAgICAgc2VsZi5vdmVybGF5VGlt
ZW91dF8gPSBudWxsOwogICAgICAgICAg
c2VsZi5vdmVybGF5Tm9kZV8uc3R5bGUu
b3BhY2l0eSA9ICcwLjc1JzsKICAgICAg
ICB9LCAyMDApOwogICAgfSwgb3B0X3Rp
bWVvdXQgfHwgMTUwMCk7Cn07CgovKioK
ICogUGFzdGUgZnJvbSB0aGUgc3lzdGVt
IGNsaXBib2FyZCB0byB0aGUgdGVybWlu
YWwuCiAqLwpodGVybS5UZXJtaW5hbC5w
cm90b3R5cGUucGFzdGUgPSBmdW5jdGlv
bigpIHsKICBodGVybS5wYXN0ZUZyb21D
bGlwYm9hcmQodGhpcy5kb2N1bWVudF8p
Owp9OwoKLyoqCiAqIENvcHkgYSBzdHJp
bmcgdG8gdGhlIHN5c3RlbSBjbGlwYm9h
cmQuCiAqCiAqIE5vdGU6IElmIHRoZXJl
IGlzIGEgc2VsZWN0ZWQgcmFuZ2UgaW4g
dGhlIHRlcm1pbmFsLCBpdCdsbCBiZSBj
bGVhcmVkLgogKi8KaHRlcm0uVGVybWlu
YWwucHJvdG90eXBlLmNvcHlTdHJpbmdU
b0NsaXBib2FyZCA9IGZ1bmN0aW9uKHN0
cikgewogIGlmICh0aGlzLnByZWZzXy5n
ZXQoJ2VuYWJsZS1jbGlwYm9hcmQtbm90
aWNlJykpCiAgICBzZXRUaW1lb3V0KHRo
aXMuc2hvd092ZXJsYXkuYmluZCh0aGlz
LCBodGVybS5ub3RpZnlDb3B5TWVzc2Fn
ZSwgNTAwKSwgMjAwKTsKCiAgdmFyIGNv
cHlTb3VyY2UgPSB0aGlzLmRvY3VtZW50
Xy5jcmVhdGVFbGVtZW50KCdwcmUnKTsK
ICBjb3B5U291cmNlLnRleHRDb250ZW50
ID0gc3RyOwogIGNvcHlTb3VyY2Uuc3R5
bGUuY3NzVGV4dCA9ICgKICAgICAgJy13
ZWJraXQtdXNlci1zZWxlY3Q6IHRleHQ7
JyArCiAgICAgICctbW96LXVzZXItc2Vs
ZWN0OiB0ZXh0OycgKwogICAgICAncG9z
aXRpb246IGFic29sdXRlOycgKwogICAg
ICAndG9wOiAtOTlweCcpOwoKICB0aGlz
LmRvY3VtZW50Xy5ib2R5LmFwcGVuZENo
aWxkKGNvcHlTb3VyY2UpOwoKICB2YXIg
c2VsZWN0aW9uID0gdGhpcy5kb2N1bWVu
dF8uZ2V0U2VsZWN0aW9uKCk7CiAgdmFy
IGFuY2hvck5vZGUgPSBzZWxlY3Rpb24u
YW5jaG9yTm9kZTsKICB2YXIgYW5jaG9y
T2Zmc2V0ID0gc2VsZWN0aW9uLmFuY2hv
ck9mZnNldDsKICB2YXIgZm9jdXNOb2Rl
ID0gc2VsZWN0aW9uLmZvY3VzTm9kZTsK
ICB2YXIgZm9jdXNPZmZzZXQgPSBzZWxl
Y3Rpb24uZm9jdXNPZmZzZXQ7CgogIHNl
bGVjdGlvbi5zZWxlY3RBbGxDaGlsZHJl
bihjb3B5U291cmNlKTsKCiAgaHRlcm0u
Y29weVNlbGVjdGlvblRvQ2xpcGJvYXJk
KHRoaXMuZG9jdW1lbnRfKTsKCiAgLy8g
SUUgZG9lc24ndCBzdXBwb3J0IHNlbGVj
dGlvbi5leHRlbmQuIFRoaXMgbWVhbnMg
dGhhdCB0aGUgc2VsZWN0aW9uCiAgLy8g
d29uJ3QgcmV0dXJuIG9uIElFLgogIGlm
IChzZWxlY3Rpb24uZXh0ZW5kKSB7CiAg
ICBzZWxlY3Rpb24uY29sbGFwc2UoYW5j
aG9yTm9kZSwgYW5jaG9yT2Zmc2V0KTsK
ICAgIHNlbGVjdGlvbi5leHRlbmQoZm9j
dXNOb2RlLCBmb2N1c09mZnNldCk7CiAg
fQoKICBjb3B5U291cmNlLnBhcmVudE5v
ZGUucmVtb3ZlQ2hpbGQoY29weVNvdXJj
ZSk7Cn07CgpodGVybS5UZXJtaW5hbC5w
cm90b3R5cGUuZ2V0U2VsZWN0aW9uVGV4
dCA9IGZ1bmN0aW9uKCkgewogIHZhciBz
ZWxlY3Rpb24gPSB0aGlzLnNjcm9sbFBv
cnRfLnNlbGVjdGlvbjsKICBzZWxlY3Rp
b24uc3luYygpOwoKICBpZiAoc2VsZWN0
aW9uLmlzQ29sbGFwc2VkKQogICAgcmV0
dXJuIG51bGw7CgoKICAvLyBTdGFydCBv
ZmZzZXQgbWVhc3VyZXMgZnJvbSB0aGUg
YmVnaW5uaW5nIG9mIHRoZSBsaW5lLgog
IHZhciBzdGFydE9mZnNldCA9IHNlbGVj
dGlvbi5zdGFydE9mZnNldDsKICB2YXIg
bm9kZSA9IHNlbGVjdGlvbi5zdGFydE5v
ZGU7CgogIGlmIChub2RlLm5vZGVOYW1l
ICE9ICdYLVJPVycpIHsKICAgIC8vIElm
IHRoZSBzZWxlY3Rpb24gZG9lc24ndCBz
dGFydCBvbiBhbiB4LXJvdyBub2RlLCB0
aGVuIGl0IG11c3QgYmUKICAgIC8vIHNv
bWV3aGVyZSBpbnNpZGUgdGhlIHgtcm93
LiAgQWRkIGFueSBjaGFyYWN0ZXJzIGZy
b20gcHJldmlvdXMgc2libGluZ3MKICAg
IC8vIGludG8gdGhlIHN0YXJ0IG9mZnNl
dC4KCiAgICBpZiAobm9kZS5ub2RlTmFt
ZSA9PSAnI3RleHQnICYmIG5vZGUucGFy
ZW50Tm9kZS5ub2RlTmFtZSA9PSAnU1BB
TicpIHsKICAgICAgLy8gSWYgbm9kZSBp
cyB0aGUgdGV4dCBub2RlIGluIGEgc3R5
bGVkIHNwYW4sIG1vdmUgdXAgdG8gdGhl
IHNwYW4gbm9kZS4KICAgICAgbm9kZSA9
IG5vZGUucGFyZW50Tm9kZTsKICAgIH0K
CiAgICB3aGlsZSAobm9kZS5wcmV2aW91
c1NpYmxpbmcpIHsKICAgICAgbm9kZSA9
IG5vZGUucHJldmlvdXNTaWJsaW5nOwog
ICAgICBzdGFydE9mZnNldCArPSBodGVy
bS5UZXh0QXR0cmlidXRlcy5ub2RlV2lk
dGgobm9kZSk7CiAgICB9CiAgfQoKICAv
LyBFbmQgb2Zmc2V0IG1lYXN1cmVzIGZy
b20gdGhlIGVuZCBvZiB0aGUgbGluZS4K
ICB2YXIgZW5kT2Zmc2V0ID0gKGh0ZXJt
LlRleHRBdHRyaWJ1dGVzLm5vZGVXaWR0
aChzZWxlY3Rpb24uZW5kTm9kZSkgLQog
ICAgICAgICAgICAgICAgICAgc2VsZWN0
aW9uLmVuZE9mZnNldCk7CiAgdmFyIG5v
ZGUgPSBzZWxlY3Rpb24uZW5kTm9kZTsK
CiAgaWYgKG5vZGUubm9kZU5hbWUgIT0g
J1gtUk9XJykgewogICAgLy8gSWYgdGhl
IHNlbGVjdGlvbiBkb2Vzbid0IGVuZCBv
biBhbiB4LXJvdyBub2RlLCB0aGVuIGl0
IG11c3QgYmUKICAgIC8vIHNvbWV3aGVy
ZSBpbnNpZGUgdGhlIHgtcm93LiAgQWRk
IGFueSBjaGFyYWN0ZXJzIGZyb20gZm9s
bG93aW5nIHNpYmxpbmdzCiAgICAvLyBp
bnRvIHRoZSBlbmQgb2Zmc2V0LgoKICAg
IGlmIChub2RlLm5vZGVOYW1lID09ICcj
dGV4dCcgJiYgbm9kZS5wYXJlbnROb2Rl
Lm5vZGVOYW1lID09ICdTUEFOJykgewog
ICAgICAvLyBJZiBub2RlIGlzIHRoZSB0
ZXh0IG5vZGUgaW4gYSBzdHlsZWQgc3Bh
biwgbW92ZSB1cCB0byB0aGUgc3BhbiBu
b2RlLgogICAgICBub2RlID0gbm9kZS5w
YXJlbnROb2RlOwogICAgfQoKICAgIHdo
aWxlIChub2RlLm5leHRTaWJsaW5nKSB7
CiAgICAgIG5vZGUgPSBub2RlLm5leHRT
aWJsaW5nOwogICAgICBlbmRPZmZzZXQg
Kz0gaHRlcm0uVGV4dEF0dHJpYnV0ZXMu
bm9kZVdpZHRoKG5vZGUpOwogICAgfQog
IH0KCiAgdmFyIHJ2ID0gdGhpcy5nZXRS
b3dzVGV4dChzZWxlY3Rpb24uc3RhcnRS
b3cucm93SW5kZXgsCiAgICAgICAgICAg
ICAgICAgICAgICAgICAgICBzZWxlY3Rp
b24uZW5kUm93LnJvd0luZGV4ICsgMSk7
CiAgcmV0dXJuIGxpYi53Yy5zdWJzdHJp
bmcocnYsIHN0YXJ0T2Zmc2V0LCBsaWIu
d2Muc3RyV2lkdGgocnYpIC0gZW5kT2Zm
c2V0KTsKfTsKCi8qKgogKiBDb3B5IHRo
ZSBjdXJyZW50IHNlbGVjdGlvbiB0byB0
aGUgc3lzdGVtIGNsaXBib2FyZCwgdGhl
biBjbGVhciBpdCBhZnRlciBhCiAqIHNo
b3J0IGRlbGF5LgogKi8KaHRlcm0uVGVy
bWluYWwucHJvdG90eXBlLmNvcHlTZWxl
Y3Rpb25Ub0NsaXBib2FyZCA9IGZ1bmN0
aW9uKCkgewogIHZhciB0ZXh0ID0gdGhp
cy5nZXRTZWxlY3Rpb25UZXh0KCk7CiAg
aWYgKHRleHQgIT0gbnVsbCkKICAgIHRo
aXMuY29weVN0cmluZ1RvQ2xpcGJvYXJk
KHRleHQpOwp9OwoKaHRlcm0uVGVybWlu
YWwucHJvdG90eXBlLm92ZXJsYXlTaXpl
ID0gZnVuY3Rpb24oKSB7CiAgdGhpcy5z
aG93T3ZlcmxheSh0aGlzLnNjcmVlblNp
emUud2lkdGggKyAneCcgKyB0aGlzLnNj
cmVlblNpemUuaGVpZ2h0KTsKfTsKCi8q
KgogKiBJbnZva2VkIGJ5IGh0ZXJtLlRl
cm1pbmFsLktleWJvYXJkIHdoZW4gYSBW
VCBrZXlzdHJva2UgaXMgZGV0ZWN0ZWQu
CiAqCiAqIEBwYXJhbSB7c3RyaW5nfSBz
dHJpbmcgVGhlIFZUIHN0cmluZyByZXBy
ZXNlbnRpbmcgdGhlIGtleXN0cm9rZSwg
aW4gVVRGLTE2LgogKi8KaHRlcm0uVGVy
bWluYWwucHJvdG90eXBlLm9uVlRLZXlz
dHJva2UgPSBmdW5jdGlvbihzdHJpbmcp
IHsKICBpZiAodGhpcy5zY3JvbGxPbktl
eXN0cm9rZV8pCiAgICB0aGlzLnNjcm9s
bFBvcnRfLnNjcm9sbFJvd1RvQm90dG9t
KHRoaXMuZ2V0Um93Q291bnQoKSk7Cgog
IHRoaXMuaW8ub25WVEtleXN0cm9rZSh0
aGlzLmtleWJvYXJkLmVuY29kZShzdHJp
bmcpKTsKfTsKCi8qKgogKiBBZGQgdGhl
IHRlcm1pbmFsUm93IGFuZCB0ZXJtaW5h
bENvbHVtbiBwcm9wZXJ0aWVzIHRvIG1v
dXNlIGV2ZW50cyBhbmQKICogdGhlbiBm
b3J3YXJkIG9uIHRvIG9uTW91c2UoKS4K
ICoKICogVGhlIHRlcm1pbmFsUm93IGFu
ZCB0ZXJtaW5hbENvbHVtbiBwcm9wZXJ0
aWVzIGNvbnRhaW4gdGhlIChyb3csIGNv
bHVtbikKICogY29vcmRpbmF0ZXMgZm9y
IHRoZSBtb3VzZSBldmVudC4KICovCmh0
ZXJtLlRlcm1pbmFsLnByb3RvdHlwZS5v
bk1vdXNlXyA9IGZ1bmN0aW9uKGUpIHsK
ICBpZiAoZS5wcm9jZXNzZWRCeVRlcm1p
bmFsSGFuZGxlcl8pIHsKICAgIC8vIFdl
IHJlZ2lzdGVyIG91ciBldmVudCBoYW5k
bGVycyBvbiB0aGUgZG9jdW1lbnQsIGFz
IHdlbGwgYXMgdGhlIGN1cnNvcgogICAg
Ly8gYW5kIHRoZSBzY3JvbGwgYmxvY2tl
ci4gIE1vdXNlIGV2ZW50cyB0aGF0IG9j
Y3VyIG9uIHRoZSBjdXJzb3Igb3IKICAg
IC8vIHNjcm9sbCBibG9ja2VyIHdpbGwg
YWxzbyBhcHBlYXIgb24gdGhlIGRvY3Vt
ZW50LCBidXQgd2UgZG9uJ3Qgd2FudCB0
bwogICAgLy8gcHJvY2VzcyB0aGVtIHR3
aWNlLgogICAgLy8KICAgIC8vIFdlIGNh
bid0IGp1c3QgcHJldmVudCBidWJibGlu
ZyBiZWNhdXNlIHRoYXQgaGFzIG90aGVy
IHNpZGUgZWZmZWN0cywgc28KICAgIC8v
IHdlIGRlY29yYXRlIHRoZSBldmVudCBv
YmplY3Qgd2l0aCB0aGlzIHByb3BlcnR5
IGluc3RlYWQuCiAgICByZXR1cm47CiAg
fQoKICBlLnByb2Nlc3NlZEJ5VGVybWlu
YWxIYW5kbGVyXyA9IHRydWU7CgogIC8v
IE9uZSBiYXNlZCByb3cvY29sdW1uIHN0
b3JlZCBvbiB0aGUgbW91c2UgZXZlbnQu
CiAgZS50ZXJtaW5hbFJvdyA9IHBhcnNl
SW50KChlLmNsaWVudFkgLSB0aGlzLnNj
cm9sbFBvcnRfLnZpc2libGVSb3dUb3BN
YXJnaW4pIC8KICAgICAgICAgICAgICAg
ICAgICAgICAgICAgdGhpcy5zY3JvbGxQ
b3J0Xy5jaGFyYWN0ZXJTaXplLmhlaWdo
dCkgKyAxOwogIGUudGVybWluYWxDb2x1
bW4gPSBwYXJzZUludChlLmNsaWVudFgg
LwogICAgICAgICAgICAgICAgICAgICAg
ICAgICAgICB0aGlzLnNjcm9sbFBvcnRf
LmNoYXJhY3RlclNpemUud2lkdGgpICsg
MTsKCiAgaWYgKGUudHlwZSA9PSAnbW91
c2Vkb3duJyAmJiBlLnRlcm1pbmFsQ29s
dW1uID4gdGhpcy5zY3JlZW5TaXplLndp
ZHRoKSB7CiAgICAvLyBNb3VzZWRvd24g
aW4gdGhlIHNjcm9sbGJhciBhcmVhLgog
ICAgcmV0dXJuOwogIH0KCiAgaWYgKHRo
aXMub3B0aW9uc18uY3Vyc29yVmlzaWJs
ZSAmJgogICAgICB0aGlzLnZ0Lm1vdXNl
UmVwb3J0ID09IHRoaXMudnQuTU9VU0Vf
UkVQT1JUX0RJU0FCTEVEKSB7CiAgICAv
LyBJZiB0aGUgY3Vyc29yIGlzIHZpc2li
bGUgYW5kIHdlJ3JlIG5vdCBzZW5kaW5n
IG1vdXNlIGV2ZW50cyB0byB0aGUKICAg
IC8vIGhvc3QgYXBwLCB0aGVuIHdlIHdh
bnQgdG8gaGlkZSB0aGUgdGVybWluYWwg
Y3Vyc29yIHdoZW4gdGhlIG1vdXNlCiAg
ICAvLyBjdXJzb3IgaXMgb3ZlciB0b3Au
ICBUaGlzIGtlZXBzIHRoZSB0ZXJtaW5h
bCBjdXJzb3IgZnJvbSBpbnRlcmZlcmlu
ZwogICAgLy8gd2l0aCBsb2NhbCB0ZXh0
IHNlbGVjdGlvbi4KICAgIGlmIChlLnRl
cm1pbmFsUm93IC0gMSA9PSB0aGlzLnNj
cmVlbl8uY3Vyc29yUG9zaXRpb24ucm93
ICYmCiAgICAgICAgZS50ZXJtaW5hbENv
bHVtbiAtIDEgPT0gdGhpcy5zY3JlZW5f
LmN1cnNvclBvc2l0aW9uLmNvbHVtbikg
ewogICAgICB0aGlzLmN1cnNvck5vZGVf
LnN0eWxlLmRpc3BsYXkgPSAnbm9uZSc7
CiAgICB9IGVsc2UgaWYgKHRoaXMuY3Vy
c29yTm9kZV8uc3R5bGUuZGlzcGxheSA9
PSAnbm9uZScpIHsKICAgICAgdGhpcy5j
dXJzb3JOb2RlXy5zdHlsZS5kaXNwbGF5
ID0gJyc7CiAgICB9CiAgfQoKICBpZiAo
ZS50eXBlID09ICdtb3VzZWRvd24nKSB7
CiAgICBpZiAoZS5hbHRLZXkgfHwgdGhp
cy52dC5tb3VzZVJlcG9ydCA9PSB0aGlz
LnZ0Lk1PVVNFX1JFUE9SVF9ESVNBQkxF
RCkgewogICAgICAvLyBJZiBWVCBtb3Vz
ZSByZXBvcnRpbmcgaXMgZGlzYWJsZWQs
IG9yIGhhcyBiZWVuIGRlZmVhdGVkIHdp
dGgKICAgICAgLy8gYWx0LW1vdXNlZG93
biwgdGhlbiB0aGUgbW91c2Ugd2lsbCBh
Y3Qgb24gdGhlIGxvY2FsIHNlbGVjdGlv
bi4KICAgICAgdGhpcy5yZXBvcnRNb3Vz
ZUV2ZW50c18gPSBmYWxzZTsKICAgICAg
dGhpcy5zZXRTZWxlY3Rpb25FbmFibGVk
KHRydWUpOwogICAgfSBlbHNlIHsKICAg
ICAgLy8gT3RoZXJ3aXNlIHdlIGRlZmVy
IG93bmVyc2hpcCBvZiB0aGUgbW91c2Ug
dG8gdGhlIFZULgogICAgICB0aGlzLnJl
cG9ydE1vdXNlRXZlbnRzXyA9IHRydWU7
CiAgICAgIHRoaXMuZG9jdW1lbnRfLmdl
dFNlbGVjdGlvbigpLmNvbGxhcHNlVG9F
bmQoKTsKICAgICAgdGhpcy5zZXRTZWxl
Y3Rpb25FbmFibGVkKGZhbHNlKTsKICAg
ICAgZS5wcmV2ZW50RGVmYXVsdCgpOwog
ICAgfQogIH0KCiAgaWYgKCF0aGlzLnJl
cG9ydE1vdXNlRXZlbnRzXykgewogICAg
aWYgKGUudHlwZSA9PSAnZGJsY2xpY2sn
KSB7CiAgICAgIHRoaXMuc2NyZWVuXy5l
eHBhbmRTZWxlY3Rpb24odGhpcy5kb2N1
bWVudF8uZ2V0U2VsZWN0aW9uKCkpOwog
ICAgICBodGVybS5jb3B5U2VsZWN0aW9u
VG9DbGlwYm9hcmQodGhpcy5kb2N1bWVu
dF8pOwogICAgfQoKICAgIGlmIChlLnR5
cGUgPT0gJ21vdXNlZG93bicgJiYgZS53
aGljaCA9PSB0aGlzLm1vdXNlUGFzdGVC
dXR0b24pCiAgICAgIHRoaXMucGFzdGUo
KTsKCiAgICBpZiAoZS50eXBlID09ICdt
b3VzZXVwJyAmJiBlLndoaWNoID09IDEg
JiYgdGhpcy5jb3B5T25TZWxlY3QgJiYK
ICAgICAgICAhdGhpcy5kb2N1bWVudF8u
Z2V0U2VsZWN0aW9uKCkuaXNDb2xsYXBz
ZWQpIHsKICAgICAgaHRlcm0uY29weVNl
bGVjdGlvblRvQ2xpcGJvYXJkKHRoaXMu
ZG9jdW1lbnRfKTsKICAgIH0KCiAgICBp
ZiAoKGUudHlwZSA9PSAnbW91c2Vtb3Zl
JyB8fCBlLnR5cGUgPT0gJ21vdXNldXAn
KSAmJgogICAgICAgIHRoaXMuc2Nyb2xs
QmxvY2tlck5vZGVfLmVuZ2FnZWQpIHsK
ICAgICAgLy8gRGlzZW5nYWdlIHRoZSBz
Y3JvbGwtYmxvY2tlciBhZnRlciBvbmUg
b2YgdGhlc2UgZXZlbnRzLgogICAgICB0
aGlzLnNjcm9sbEJsb2NrZXJOb2RlXy5l
bmdhZ2VkID0gZmFsc2U7CiAgICAgIHRo
aXMuc2Nyb2xsQmxvY2tlck5vZGVfLnN0
eWxlLnRvcCA9ICctOTlweCc7CiAgICB9
CgogIH0gZWxzZSAvKiBpZiAodGhpcy5y
ZXBvcnRNb3VzZUV2ZW50cykgKi8gewog
ICAgaWYgKCF0aGlzLnNjcm9sbEJsb2Nr
ZXJOb2RlXy5lbmdhZ2VkKSB7CiAgICAg
IGlmIChlLnR5cGUgPT0gJ21vdXNlZG93
bicpIHsKICAgICAgICAvLyBNb3ZlIHRo
ZSBzY3JvbGwtYmxvY2tlciBpbnRvIHBs
YWNlIGlmIHdlIHdhbnQgdG8ga2VlcCB0
aGUgc2Nyb2xscG9ydAogICAgICAgIC8v
IGZyb20gc2Nyb2xsaW5nLgogICAgICAg
IHRoaXMuc2Nyb2xsQmxvY2tlck5vZGVf
LmVuZ2FnZWQgPSB0cnVlOwogICAgICAg
IHRoaXMuc2Nyb2xsQmxvY2tlck5vZGVf
LnN0eWxlLnRvcCA9IChlLmNsaWVudFkg
LSA1KSArICdweCc7CiAgICAgICAgdGhp
cy5zY3JvbGxCbG9ja2VyTm9kZV8uc3R5
bGUubGVmdCA9IChlLmNsaWVudFggLSA1
KSArICdweCc7CiAgICAgIH0gZWxzZSBp
ZiAoZS50eXBlID09ICdtb3VzZW1vdmUn
KSB7CiAgICAgICAgLy8gT2guICBUaGlz
IG1lYW5zIHRoYXQgZHJhZy1zY3JvbGwg
d2FzIGRpc2FibGVkIEFGVEVSIHRoZSBt
b3VzZSBkb3duLAogICAgICAgIC8vIGlu
IHdoaWNoIGNhc2UgaXQncyB0b28gbGF0
ZSB0byBlbmdhZ2UgdGhlIHNjcm9sbC1i
bG9ja2VyLgogICAgICAgIHRoaXMuZG9j
dW1lbnRfLmdldFNlbGVjdGlvbigpLmNv
bGxhcHNlVG9FbmQoKTsKICAgICAgICBl
LnByZXZlbnREZWZhdWx0KCk7CiAgICAg
IH0KICAgIH0KCiAgICB0aGlzLm9uTW91
c2UoZSk7CiAgfQoKICBpZiAoZS50eXBl
ID09ICdtb3VzZXVwJyAmJiB0aGlzLmRv
Y3VtZW50Xy5nZXRTZWxlY3Rpb24oKS5p
c0NvbGxhcHNlZCkgewogICAgLy8gUmVz
dG9yZSB0aGlzIG9uIG1vdXNldXAgaW4g
Y2FzZSBpdCB3YXMgdGVtcG9yYXJpbHkg
ZGVmZWF0ZWQgd2l0aCBhCiAgICAvLyBh
bHQtbW91c2Vkb3duLiAgT25seSBkbyB0
aGlzIHdoZW4gdGhlIHNlbGVjdGlvbiBp
cyBlbXB0eSBzbyB0aGF0CiAgICAvLyB3
ZSBkb24ndCBpbW1lZGlhdGVseSBraWxs
IHRoZSB1c2VycyBzZWxlY3Rpb24uCiAg
ICB0aGlzLnJlcG9ydE1vdXNlRXZlbnRz
XyA9ICh0aGlzLnZ0Lm1vdXNlUmVwb3J0
ICE9CiAgICAgICAgICAgICAgICAgICAg
ICAgICAgICAgICB0aGlzLnZ0Lk1PVVNF
X1JFUE9SVF9ESVNBQkxFRCk7CiAgfQp9
OwoKLyoqCiAqIENsaWVudHMgc2hvdWxk
IG92ZXJyaWRlIHRoaXMgaWYgdGhleSBj
YXJlIHRvIGtub3cgYWJvdXQgbW91c2Ug
ZXZlbnRzLgogKgogKiBUaGUgZXZlbnQg
cGFyYW1ldGVyIHdpbGwgYmUgYSBub3Jt
YWwgRE9NIG1vdXNlIGNsaWNrIGV2ZW50
IHdpdGggYWRkaXRpb25hbAogKiAndGVy
bWluYWxSb3cnIGFuZCAndGVybWluYWxD
b2x1bW4nIHByb3BlcnRpZXMuCiAqLwpo
dGVybS5UZXJtaW5hbC5wcm90b3R5cGUu
b25Nb3VzZSA9IGZ1bmN0aW9uKGUpIHsg
fTsKCi8qKgogKiBSZWFjdCB3aGVuIGZv
Y3VzIGNoYW5nZXMuCiAqLwpodGVybS5U
ZXJtaW5hbC5wcm90b3R5cGUub25Gb2N1
c0NoYW5nZV8gPSBmdW5jdGlvbihmb2N1
c2VkKSB7CiAgdGhpcy5jdXJzb3JOb2Rl
Xy5zZXRBdHRyaWJ1dGUoJ2ZvY3VzJywg
Zm9jdXNlZCk7CiAgdGhpcy5yZXN0eWxl
Q3Vyc29yXygpOwogIGlmIChmb2N1c2Vk
ID09PSB0cnVlKQogICAgdGhpcy5jbG9z
ZUJlbGxOb3RpZmljYXRpb25zXygpOwp9
OwoKLyoqCiAqIFJlYWN0IHdoZW4gdGhl
IFNjcm9sbFBvcnQgaXMgc2Nyb2xsZWQu
CiAqLwpodGVybS5UZXJtaW5hbC5wcm90
b3R5cGUub25TY3JvbGxfID0gZnVuY3Rp
b24oKSB7CiAgdGhpcy5zY2hlZHVsZVN5
bmNDdXJzb3JQb3NpdGlvbl8oKTsKfTsK
Ci8qKgogKiBSZWFjdCB3aGVuIHRleHQg
aXMgcGFzdGVkIGludG8gdGhlIHNjcm9s
bFBvcnQuCiAqLwpodGVybS5UZXJtaW5h
bC5wcm90b3R5cGUub25QYXN0ZV8gPSBm
dW5jdGlvbihlKSB7CiAgdmFyIGRhdGEg
PSBlLnRleHQucmVwbGFjZSgvXG4vbWcs
ICdccicpOwogIGRhdGEgPSB0aGlzLmtl
eWJvYXJkLmVuY29kZShkYXRhKTsKICBp
ZiAodGhpcy5vcHRpb25zXy5icmFja2V0
ZWRQYXN0ZSkKICAgIGRhdGEgPSAnXHgx
YlsyMDB+JyArIGRhdGEgKyAnXHgxYlsy
MDF+JzsKCiAgdGhpcy5pby5zZW5kU3Ry
aW5nKGRhdGEpOwp9OwoKLyoqCiAqIFJl
YWN0IHdoZW4gdGhlIHVzZXIgdHJpZXMg
dG8gY29weSBmcm9tIHRoZSBzY3JvbGxQ
b3J0LgogKi8KaHRlcm0uVGVybWluYWwu
cHJvdG90eXBlLm9uQ29weV8gPSBmdW5j
dGlvbihlKSB7CiAgaWYgKCF0aGlzLnVz
ZURlZmF1bHRXaW5kb3dDb3B5KSB7CiAg
ICBlLnByZXZlbnREZWZhdWx0KCk7CiAg
ICBzZXRUaW1lb3V0KHRoaXMuY29weVNl
bGVjdGlvblRvQ2xpcGJvYXJkLmJpbmQo
dGhpcyksIDApOwogIH0KfTsKCi8qKgog
KiBSZWFjdCB3aGVuIHRoZSBTY3JvbGxQ
b3J0IGlzIHJlc2l6ZWQuCiAqCiAqIE5v
dGU6IFRoaXMgZnVuY3Rpb24gc2hvdWxk
IG5vdCBkaXJlY3RseSBjb250YWluIGNv
ZGUgdGhhdCBhbHRlcnMgdGhlIGludGVy
bmFsCiAqIHN0YXRlIG9mIHRoZSB0ZXJt
aW5hbC4gIFRoYXQga2luZCBvZiBjb2Rl
IGJlbG9uZ3MgaW4gcmVhbGl6ZVdpZHRo
IG9yCiAqIHJlYWxpemVIZWlnaHQsIHNv
IHRoYXQgaXQgY2FuIGJlIGV4ZWN1dGVk
IHN5bmNocm9ub3VzbHkgaW4gdGhlIGNh
c2Ugb2YgYQogKiBwcm9ncmFtbWF0aWMg
d2lkdGggY2hhbmdlLgogKi8KaHRlcm0u
VGVybWluYWwucHJvdG90eXBlLm9uUmVz
aXplXyA9IGZ1bmN0aW9uKCkgewogIHZh
ciBjb2x1bW5Db3VudCA9IE1hdGguZmxv
b3IodGhpcy5zY3JvbGxQb3J0Xy5nZXRT
Y3JlZW5XaWR0aCgpIC8KICAgICAgICAg
ICAgICAgICAgICAgICAgICAgICAgIHRo
aXMuc2Nyb2xsUG9ydF8uY2hhcmFjdGVy
U2l6ZS53aWR0aCk7CiAgdmFyIHJvd0Nv
dW50ID0gbGliLmYuc21hcnRGbG9vckRp
dmlkZSh0aGlzLnNjcm9sbFBvcnRfLmdl
dFNjcmVlbkhlaWdodCgpLAogICAgICAg
ICAgICAgICAgICAgICAgICAgICAgdGhp
cy5zY3JvbGxQb3J0Xy5jaGFyYWN0ZXJT
aXplLmhlaWdodCk7CgogIGlmIChjb2x1
bW5Db3VudCA8PSAwIHx8IHJvd0NvdW50
IDw9IDApIHsKICAgIC8vIFdlIGF2b2lk
IHRoZXNlIHNpdHVhdGlvbnMgc2luY2Ug
dGhleSBoYXBwZW4gc29tZXRpbWVzIHdo
ZW4gdGhlIHRlcm1pbmFsCiAgICAvLyBn
ZXRzIHJlbW92ZWQgZnJvbSB0aGUgZG9j
dW1lbnQgb3IgZHVyaW5nIHRoZSBpbml0
aWFsIGxvYWQsIGFuZCB3ZSBjYW4ndAog
ICAgLy8gZGVhbCB3aXRoIHRoYXQuCiAg
ICByZXR1cm47CiAgfQoKICB2YXIgaXNO
ZXdTaXplID0gKGNvbHVtbkNvdW50ICE9
IHRoaXMuc2NyZWVuU2l6ZS53aWR0aCB8
fAogICAgICAgICAgICAgICAgICAgcm93
Q291bnQgIT0gdGhpcy5zY3JlZW5TaXpl
LmhlaWdodCk7CgogIC8vIFdlIGRvIHRo
aXMgZXZlbiBpZiB0aGUgc2l6ZSBkaWRu
J3QgY2hhbmdlLCBqdXN0IHRvIGJlIHN1
cmUgZXZlcnl0aGluZyBpcwogIC8vIGlu
IHN5bmMuCiAgdGhpcy5yZWFsaXplU2l6
ZV8oY29sdW1uQ291bnQsIHJvd0NvdW50
KTsKICB0aGlzLnNob3dab29tV2Fybmlu
Z18odGhpcy5zY3JvbGxQb3J0Xy5jaGFy
YWN0ZXJTaXplLnpvb21GYWN0b3IgIT0g
MSk7CgogIGlmIChpc05ld1NpemUpCiAg
ICB0aGlzLm92ZXJsYXlTaXplKCk7Cgog
IHRoaXMucmVzdHlsZUN1cnNvcl8oKTsK
ICB0aGlzLnNjaGVkdWxlU3luY0N1cnNv
clBvc2l0aW9uXygpOwp9OwoKLyoqCiAq
IFNlcnZpY2UgdGhlIGN1cnNvciBibGlu
ayB0aW1lb3V0LgogKi8KaHRlcm0uVGVy
bWluYWwucHJvdG90eXBlLm9uQ3Vyc29y
QmxpbmtfID0gZnVuY3Rpb24oKSB7CiAg
aWYgKCF0aGlzLm9wdGlvbnNfLmN1cnNv
ckJsaW5rKSB7CiAgICBkZWxldGUgdGhp
cy50aW1lb3V0c18uY3Vyc29yQmxpbms7
CiAgICByZXR1cm47CiAgfQoKICBpZiAo
dGhpcy5jdXJzb3JOb2RlXy5nZXRBdHRy
aWJ1dGUoJ2ZvY3VzJykgPT0gJ2ZhbHNl
JyB8fAogICAgICB0aGlzLmN1cnNvck5v
ZGVfLnN0eWxlLm9wYWNpdHkgPT0gJzAn
KSB7CiAgICB0aGlzLmN1cnNvck5vZGVf
LnN0eWxlLm9wYWNpdHkgPSAnMSc7CiAg
ICB0aGlzLnRpbWVvdXRzXy5jdXJzb3JC
bGluayA9IHNldFRpbWVvdXQodGhpcy5t
eU9uQ3Vyc29yQmxpbmtfLAogICAgICAg
ICAgICAgICAgICAgICAgICAgICAgICAg
ICAgICAgICAgICAgIHRoaXMuY3Vyc29y
QmxpbmtDeWNsZV9bMF0pOwogIH0gZWxz
ZSB7CiAgICB0aGlzLmN1cnNvck5vZGVf
LnN0eWxlLm9wYWNpdHkgPSAnMCc7CiAg
ICB0aGlzLnRpbWVvdXRzXy5jdXJzb3JC
bGluayA9IHNldFRpbWVvdXQodGhpcy5t
eU9uQ3Vyc29yQmxpbmtfLAogICAgICAg
ICAgICAgICAgICAgICAgICAgICAgICAg
ICAgICAgICAgICAgIHRoaXMuY3Vyc29y
QmxpbmtDeWNsZV9bMV0pOwogIH0KfTsK
Ci8qKgogKiBTZXQgdGhlIHNjcm9sbGJh
ci12aXNpYmxlIG1vZGUgYml0LgogKgog
KiBJZiBzY3JvbGxiYXItdmlzaWJsZSBp
cyBvbiwgdGhlIHZlcnRpY2FsIHNjcm9s
bGJhciB3aWxsIGJlIHZpc2libGUuCiAq
IE90aGVyd2lzZSBpdCB3aWxsIG5vdC4K
ICoKICogRGVmYXVsdHMgdG8gb24uCiAq
CiAqIEBwYXJhbSB7Ym9vbGVhbn0gc3Rh
dGUgVHJ1ZSB0byBzZXQgc2Nyb2xsYmFy
LXZpc2libGUgbW9kZSwgZmFsc2UgdG8g
dW5zZXQuCiAqLwpodGVybS5UZXJtaW5h
bC5wcm90b3R5cGUuc2V0U2Nyb2xsYmFy
VmlzaWJsZSA9IGZ1bmN0aW9uKHN0YXRl
KSB7CiAgdGhpcy5zY3JvbGxQb3J0Xy5z
ZXRTY3JvbGxiYXJWaXNpYmxlKHN0YXRl
KTsKfTsKCi8qKgogKiBTZXQgdGhlIHNj
cm9sbCB3aGVlbCBtb3ZlIG11bHRpcGxp
ZXIuICBUaGlzIHdpbGwgYWZmZWN0IGhv
dyBmYXN0IHRoZSBwYWdlCiAqIHNjcm9s
bHMgb24gbW91c2V3aGVlbCBldmVudHMu
CiAqCiAqIERlZmF1bHRzIHRvIDEuCiAq
CiAqIEBwYXJhbSB7bnVtYmVyfSBtdWx0
aXBsaWVyLgogKi8KaHRlcm0uVGVybWlu
YWwucHJvdG90eXBlLnNldFNjcm9sbFdo
ZWVsTW92ZU11bHRpcGxlciA9IGZ1bmN0
aW9uKG11bHRpcGxpZXIpIHsKICB0aGlz
LnNjcm9sbFBvcnRfLnNldFNjcm9sbFdo
ZWVsTW92ZU11bHRpcGxlcihtdWx0aXBs
aWVyKTsKfTsKCi8qKgogKiBDbG9zZSBh
bGwgd2ViIG5vdGlmaWNhdGlvbnMgY3Jl
YXRlZCBieSB0ZXJtaW5hbCBiZWxscy4K
ICovCmh0ZXJtLlRlcm1pbmFsLnByb3Rv
dHlwZS5jbG9zZUJlbGxOb3RpZmljYXRp
b25zXyA9IGZ1bmN0aW9uKCkgewogIHRo
aXMuYmVsbE5vdGlmaWNhdGlvbkxpc3Rf
LmZvckVhY2goZnVuY3Rpb24obikgewog
ICAgICBuLmNsb3NlKCk7CiAgICB9KTsK
ICB0aGlzLmJlbGxOb3RpZmljYXRpb25M
aXN0Xy5sZW5ndGggPSAwOwp9OwovLyBT
T1VSQ0UgRklMRTogaHRlcm0vanMvaHRl
cm1fdGVybWluYWxfaW8uanMKLy8gQ29w
eXJpZ2h0IChjKSAyMDEyIFRoZSBDaHJv
bWl1bSBPUyBBdXRob3JzLiBBbGwgcmln
aHRzIHJlc2VydmVkLgovLyBVc2Ugb2Yg
dGhpcyBzb3VyY2UgY29kZSBpcyBnb3Zl
cm5lZCBieSBhIEJTRC1zdHlsZSBsaWNl
bnNlIHRoYXQgY2FuIGJlCi8vIGZvdW5k
IGluIHRoZSBMSUNFTlNFIGZpbGUuCgon
dXNlIHN0cmljdCc7CgpsaWIucnRkZXAo
J2xpYi5lbmNvZGVVVEY4Jyk7CgovKioK
ICogSW5wdXQvT3V0cHV0IGludGVyZmFj
ZSB1c2VkIGJ5IGNvbW1hbmRzIHRvIGNv
bW11bmljYXRlIHdpdGggdGhlIHRlcm1p
bmFsLgogKgogKiBDb21tYW5kcyBsaWtl
IGBuYXNzaGAgYW5kIGBjcm9zaGAgcmVj
ZWl2ZSBhbiBpbnN0YW5jZSBvZiB0aGlz
IGNsYXNzIGFzCiAqIHBhcnQgb2YgdGhl
aXIgYXJndiBvYmplY3QuICBUaGlzIGFs
bG93cyB0aGVtIHRvIHdyaXRlIHRvIGFu
ZCByZWFkIGZyb20gdGhlCiAqIHRlcm1p
bmFsIHdpdGhvdXQgZXhwb3NpbmcgdGhl
bSB0byBhbiBlbnRpcmUgaHRlcm0uVGVy
bWluYWwgaW5zdGFuY2UuCiAqCiAqIFRo
ZSBhY3RpdmUgY29tbWFuZCBtdXN0IG92
ZXJyaWRlIHRoZSBvblZUS2V5c3Ryb2tl
KCkgYW5kIHNlbmRTdHJpbmcoKSBtZXRo
b2RzCiAqIG9mIHRoaXMgY2xhc3MgaW4g
b3JkZXIgdG8gcmVjZWl2ZSBrZXlzdHJv
a2VzIGFuZCBzZW5kIG91dHB1dCB0byB0
aGUgY29ycmVjdAogKiBkZXN0aW5hdGlv
bi4KICoKICogSXNvbGF0aW5nIGNvbW1h
bmRzIGZyb20gdGhlIHRlcm1pbmFsIHBy
b3ZpZGVzIHRoZSBmb2xsb3dpbmcgYmVu
ZWZpdHM6CiAqIC0gUHJvdmlkZXMgYSBt
ZWNoYW5pc20gdG8gc2F2ZSBhbmQgcmVz
dG9yZSBvblZUS2V5c3Ryb2tlIGFuZCBz
ZW5kU3RyaW5nCiAqICAgaGFuZGxlcnMg
d2hlbiBpbnZva2luZyBzdWJjb21tYW5k
cyAoc2VlIHRoZSBwdXNoKCkgYW5kIHBv
cCgpIG1ldGhvZHMpLgogKiAtIFRoZSBp
c29sYXRpb24gbWFrZXMgaXQgZWFzaWVy
IHRvIG1ha2UgY2hhbmdlcyBpbiBUZXJt
aW5hbCBhbmQgc3VwcG9ydGluZwogKiAg
IGNsYXNzZXMgd2l0aG91dCBhZmZlY3Rp
bmcgY29tbWFuZHMuCiAqIC0gSW4gVGhl
IEZ1dHVyZSBjb21tYW5kcyBtYXkgcnVu
IGluIHdlYiB3b3JrZXJzIHdoZXJlIHRo
ZXkgd291bGQgb25seSBiZSBhYmxlCiAq
ICAgdG8gdGFsayB0byBhIFRlcm1pbmFs
IGluc3RhbmNlIHRocm91Z2ggYW4gSVBD
IG1lY2hhbmlzbS4KICoKICogQHBhcmFt
IHtodGVybS5UZXJtaW5hbH0KICovCmh0
ZXJtLlRlcm1pbmFsLklPID0gZnVuY3Rp
b24odGVybWluYWwpIHsKICB0aGlzLnRl
cm1pbmFsXyA9IHRlcm1pbmFsOwoKICAv
LyBUaGUgSU8gb2JqZWN0IHRvIHJlc3Rv
cmUgb24gSU8ucG9wKCkuCiAgdGhpcy5w
cmV2aW91c0lPXyA9IG51bGw7Cn07Cgov
KioKICogU2hvdyB0aGUgdGVybWluYWwg
b3ZlcmxheSBmb3IgYSBnaXZlbiBhbW91
bnQgb2YgdGltZS4KICoKICogVGhlIHRl
cm1pbmFsIG92ZXJsYXkgYXBwZWFycyBp
biBpbnZlcnNlIHZpZGVvIGluIGEgbGFy
Z2UgZm9udCwgY2VudGVyZWQKICogb3Zl
ciB0aGUgdGVybWluYWwuICBZb3Ugc2hv
dWxkIHByb2JhYmx5IGtlZXAgdGhlIG92
ZXJsYXkgbWVzc2FnZSBicmllZiwKICog
c2luY2UgaXQncyBpbiBhIGxhcmdlIGZv
bnQgYW5kIHlvdSBwcm9iYWJseSBhcmVu
J3QgZ29pbmcgdG8gY2hlY2sgdGhlIHNp
emUKICogb2YgdGhlIHRlcm1pbmFsIGZp
cnN0LgogKgogKiBAcGFyYW0ge3N0cmlu
Z30gbXNnIFRoZSB0ZXh0IChub3QgSFRN
TCkgbWVzc2FnZSB0byBkaXNwbGF5IGlu
IHRoZSBvdmVybGF5LgogKiBAcGFyYW0g
e251bWJlcn0gb3B0X3RpbWVvdXQgVGhl
IGFtb3VudCBvZiB0aW1lIHRvIHdhaXQg
YmVmb3JlIGZhZGluZyBvdXQKICogICAg
IHRoZSBvdmVybGF5LiAgRGVmYXVsdHMg
dG8gMS41IHNlY29uZHMuICBQYXNzIG51
bGwgdG8gaGF2ZSB0aGUgb3ZlcmxheQog
KiAgICAgc3RheSB1cCBmb3JldmVyIChv
ciB1bnRpbCB0aGUgbmV4dCBvdmVybGF5
KS4KICovCmh0ZXJtLlRlcm1pbmFsLklP
LnByb3RvdHlwZS5zaG93T3ZlcmxheSA9
IGZ1bmN0aW9uKG1lc3NhZ2UsIG9wdF90
aW1lb3V0KSB7CiAgdGhpcy50ZXJtaW5h
bF8uc2hvd092ZXJsYXkobWVzc2FnZSwg
b3B0X3RpbWVvdXQpOwp9OwoKLyoqCiAq
IE9wZW4gYW4gZnJhbWUgaW4gdGhlIGN1
cnJlbnQgdGVybWluYWwgd2luZG93LCBw
b2ludGVkIHRvIHRoZSBzcGVjaWZpZWQK
ICogdXJsLgogKgogKiBFdmVudHVhbGx5
IHdlJ2xsIHByb2JhYmx5IG5lZWQgc2l6
ZS9wb3NpdGlvbi9kZWNvcmF0aW9uIG9w
dGlvbnMuCiAqIFRoZSB1c2VyIHNob3Vs
ZCBhbHNvIGJlIGFibGUgdG8gbW92ZS9y
ZXNpemUgdGhlIGZyYW1lLgogKgogKiBA
cGFyYW0ge3N0cmluZ30gdXJsIFRoZSBV
UkwgdG8gbG9hZCBpbiB0aGUgZnJhbWUu
CiAqIEBwYXJhbSB7T2JqZWN0fSBvcHRf
b3B0aW9ucyBPcHRpb25hbCBmcmFtZSBv
cHRpb25zLiAgTm90IGltcGxlbWVudGVk
LgogKi8KaHRlcm0uVGVybWluYWwuSU8u
cHJvdG90eXBlLmNyZWF0ZUZyYW1lID0g
ZnVuY3Rpb24odXJsLCBvcHRfb3B0aW9u
cykgewogIHJldHVybiBuZXcgaHRlcm0u
RnJhbWUodGhpcy50ZXJtaW5hbF8sIHVy
bCwgb3B0X29wdGlvbnMpOwp9OwoKLyoq
CiAqIENoYW5nZSB0aGUgcHJlZmVyZW5j
ZSBwcm9maWxlIGZvciB0aGUgdGVybWlu
YWwuCiAqCiAqIEBwYXJhbSBwcm9maWxl
TmFtZSB7c3RyaW5nfSBUaGUgbmFtZSBv
ZiB0aGUgcHJlZmVyZW5jZSBwcm9maWxl
IHRvIGFjdGl2YXRlLgogKi8KaHRlcm0u
VGVybWluYWwuSU8ucHJvdG90eXBlLnNl
dFRlcm1pbmFsUHJvZmlsZSA9IGZ1bmN0
aW9uKHByb2ZpbGVOYW1lKSB7CiAgdGhp
cy50ZXJtaW5hbF8uc2V0UHJvZmlsZShw
cm9maWxlTmFtZSk7Cn07CgovKioKICog
Q3JlYXRlIGEgbmV3IGh0ZXJtLlRlcm1p
bmFsLklPIGluc3RhbmNlIGFuZCBtYWtl
IGl0IGFjdGl2ZSBvbiB0aGUgVGVybWlu
YWwKICogb2JqZWN0IGFzc29jaWF0ZWQg
d2l0aCB0aGlzIGluc3RhbmNlLgogKgog
KiBUaGlzIGlzIHVzZWQgdG8gcGFzcyBj
b250cm9sIG9mIHRoZSB0ZXJtaW5hbCBJ
TyBvZmYgdG8gYSBzdWJjb21tYW5kLiAg
VGhlCiAqIElPLnBvcCgpIG1ldGhvZCBj
YW4gYmUgdXNlZCB0byByZXN0b3JlIGNv
bnRyb2wgd2hlbiB0aGUgc3ViY29tbWFu
ZCBjb21wbGV0ZXMuCiAqLwpodGVybS5U
ZXJtaW5hbC5JTy5wcm90b3R5cGUucHVz
aCA9IGZ1bmN0aW9uKCkgewogIHZhciBp
byA9IG5ldyBodGVybS5UZXJtaW5hbC5J
Tyh0aGlzLnRlcm1pbmFsXyk7CiAgaW8u
a2V5Ym9hcmRDYXB0dXJlZF8gPSB0aGlz
LmtleWJvYXJkQ2FwdHVyZWRfOwoKICBp
by5jb2x1bW5Db3VudCA9IHRoaXMuY29s
dW1uQ291bnQ7CiAgaW8ucm93Q291bnQg
PSB0aGlzLnJvd0NvdW50OwoKICBpby5w
cmV2aW91c0lPXyA9IHRoaXMudGVybWlu
YWxfLmlvOwogIHRoaXMudGVybWluYWxf
LmlvID0gaW87CgogIHJldHVybiBpbzsK
fTsKCi8qKgogKiBSZXN0b3JlIHRoZSBU
ZXJtaW5hbCdzIHByZXZpb3VzIElPIG9i
amVjdC4KICovCmh0ZXJtLlRlcm1pbmFs
LklPLnByb3RvdHlwZS5wb3AgPSBmdW5j
dGlvbigpIHsKICB0aGlzLnRlcm1pbmFs
Xy5pbyA9IHRoaXMucHJldmlvdXNJT187
Cn07CgovKioKICogQ2FsbGVkIHdoZW4g
ZGF0YSBuZWVkcyB0byBiZSBzZW50IHRv
IHRoZSBjdXJyZW50IGNvbW1hbmQuCiAq
CiAqIENsaWVudHMgc2hvdWxkIG92ZXJy
aWRlIHRoaXMgdG8gcmVjZWl2ZSBub3Rp
ZmljYXRpb24gb2YgcGVuZGluZyBkYXRh
LgogKgogKiBAcGFyYW0ge3N0cmluZ30g
c3RyaW5nIFRoZSBkYXRhIHRvIHNlbmQu
CiAqLwpodGVybS5UZXJtaW5hbC5JTy5w
cm90b3R5cGUuc2VuZFN0cmluZyA9IGZ1
bmN0aW9uKHN0cmluZykgewogIC8vIE92
ZXJyaWRlIHRoaXMuCiAgY29uc29sZS5s
b2coJ1VuaGFuZGxlZCBzZW5kU3RyaW5n
OiAnICsgc3RyaW5nKTsKfTsKCi8qKgog
KiBDYWxsZWQgd2hlbiBhIHRlcm1pbmFs
IGtleXN0cm9rZSBpcyBkZXRlY3RlZC4K
ICoKICogQ2xpZW50cyBzaG91bGQgb3Zl
cnJpZGUgdGhpcyB0byByZWNlaXZlIG5v
dGlmaWNhdGlvbiBvZiBrZXlzdHJva2Vz
LgogKgogKiBUaGUga2V5c3Ryb2tlIGRh
dGEgd2lsbCBiZSBlbmNvZGVkIGFjY29y
ZGluZyB0byB0aGUgJ3NlbmQtZW5jb2Rp
bmcnCiAqIHByZWZlcmVuY2UuCiAqCiAq
IEBwYXJhbSB7c3RyaW5nfSBzdHJpbmcg
VGhlIFZUIGtleSBzZXF1ZW5jZS4KICov
Cmh0ZXJtLlRlcm1pbmFsLklPLnByb3Rv
dHlwZS5vblZUS2V5c3Ryb2tlID0gZnVu
Y3Rpb24oc3RyaW5nKSB7CiAgLy8gT3Zl
cnJpZGUgdGhpcy4KICBjb25zb2xlLmxv
ZygnVW5vYnNlcnZlcmQgVlQga2V5c3Ry
b2tlOiAnICsgSlNPTi5zdHJpbmdpZnko
c3RyaW5nKSk7Cn07CgpodGVybS5UZXJt
aW5hbC5JTy5wcm90b3R5cGUub25UZXJt
aW5hbFJlc2l6ZV8gPSBmdW5jdGlvbih3
aWR0aCwgaGVpZ2h0KSB7CiAgdmFyIG9i
aiA9IHRoaXM7CiAgd2hpbGUgKG9iaikg
ewogICAgb2JqLmNvbHVtbkNvdW50ID0g
d2lkdGg7CiAgICBvYmoucm93Q291bnQg
PSBoZWlnaHQ7CiAgICBvYmogPSBvYmou
cHJldmlvdXNJT187CiAgfQoKICB0aGlz
Lm9uVGVybWluYWxSZXNpemUod2lkdGgs
IGhlaWdodCk7Cn07CgovKioKICogQ2Fs
bGVkIHdoZW4gdGVybWluYWwgc2l6ZSBp
cyBjaGFuZ2VkLgogKgogKiBDbGllbnRz
IHNob3VsZCBvdmVycmlkZSB0aGlzIHRv
IHJlY2VpdmUgbm90aWZpY2F0aW9uIG9m
IHJlc2l6ZS4KICoKICogQHBhcmFtIHtz
dHJpbmd8aW50ZWdlcn0gdGVybWluYWwg
d2lkdGguCiAqIEBwYXJhbSB7c3RyaW5n
fGludGVnZXJ9IHRlcm1pbmFsIGhlaWdo
dC4KICovCmh0ZXJtLlRlcm1pbmFsLklP
LnByb3RvdHlwZS5vblRlcm1pbmFsUmVz
aXplID0gZnVuY3Rpb24od2lkdGgsIGhl
aWdodCkgewogIC8vIE92ZXJyaWRlIHRo
aXMuCn07CgovKioKICogV3JpdGUgYSBV
VEYtOCBlbmNvZGVkIGJ5dGUgc3RyaW5n
IHRvIHRoZSB0ZXJtaW5hbC4KICoKICog
QHBhcmFtIHtzdHJpbmd9IHN0cmluZyBU
aGUgVVRGLTggZW5jb2RlZCBzdHJpbmcg
dG8gcHJpbnQuCiAqLwpodGVybS5UZXJt
aW5hbC5JTy5wcm90b3R5cGUud3JpdGVV
VEY4ID0gZnVuY3Rpb24oc3RyaW5nKSB7
CiAgaWYgKHRoaXMudGVybWluYWxfLmlv
ICE9IHRoaXMpCiAgICB0aHJvdyAnQXR0
ZW1wdCB0byBwcmludCBmcm9tIGluYWN0
aXZlIElPIG9iamVjdC4nOwoKICB0aGlz
LnRlcm1pbmFsXy5pbnRlcnByZXQoc3Ry
aW5nKTsKfTsKCi8qKgogKiBXcml0ZSBh
IFVURi04IGVuY29kZWQgYnl0ZSBzdHJp
bmcgdG8gdGhlIHRlcm1pbmFsIGZvbGxv
d2VkIGJ5IGNybGYuCiAqCiAqIEBwYXJh
bSB7c3RyaW5nfSBzdHJpbmcgVGhlIFVU
Ri04IGVuY29kZWQgc3RyaW5nIHRvIHBy
aW50LgogKi8KaHRlcm0uVGVybWluYWwu
SU8ucHJvdG90eXBlLndyaXRlbG5VVEY4
ID0gZnVuY3Rpb24oc3RyaW5nKSB7CiAg
aWYgKHRoaXMudGVybWluYWxfLmlvICE9
IHRoaXMpCiAgICB0aHJvdyAnQXR0ZW1w
dCB0byBwcmludCBmcm9tIGluYWN0aXZl
IElPIG9iamVjdC4nOwoKICB0aGlzLnRl
cm1pbmFsXy5pbnRlcnByZXQoc3RyaW5n
ICsgJ1xyXG4nKTsKfTsKCi8qKgogKiBX
cml0ZSBhIFVURi0xNiBKYXZhU2NyaXB0
IHN0cmluZyB0byB0aGUgdGVybWluYWwu
CiAqCiAqIEBwYXJhbSB7c3RyaW5nfSBz
dHJpbmcgVGhlIHN0cmluZyB0byBwcmlu
dC4KICovCmh0ZXJtLlRlcm1pbmFsLklP
LnByb3RvdHlwZS5wcmludCA9Cmh0ZXJt
LlRlcm1pbmFsLklPLnByb3RvdHlwZS53
cml0ZVVURjE2ID0gZnVuY3Rpb24oc3Ry
aW5nKSB7CiAgdGhpcy53cml0ZVVURjgo
bGliLmVuY29kZVVURjgoc3RyaW5nKSk7
Cn07CgovKioKICogUHJpbnQgYSBVVEYt
MTYgSmF2YVNjcmlwdCBzdHJpbmcgdG8g
dGhlIHRlcm1pbmFsIGZvbGxvd2VkIGJ5
IGEgbmV3bGluZS4KICoKICogQHBhcmFt
IHtzdHJpbmd9IHN0cmluZyBUaGUgc3Ry
aW5nIHRvIHByaW50LgogKi8KaHRlcm0u
VGVybWluYWwuSU8ucHJvdG90eXBlLnBy
aW50bG4gPQpodGVybS5UZXJtaW5hbC5J
Ty5wcm90b3R5cGUud3JpdGVsblVURjE2
ID0gZnVuY3Rpb24oc3RyaW5nKSB7CiAg
dGhpcy53cml0ZWxuVVRGOChsaWIuZW5j
b2RlVVRGOChzdHJpbmcpKTsKfTsKLy8g
U09VUkNFIEZJTEU6IGh0ZXJtL2pzL2h0
ZXJtX3RleHRfYXR0cmlidXRlcy5qcwov
LyBDb3B5cmlnaHQgKGMpIDIwMTIgVGhl
IENocm9taXVtIE9TIEF1dGhvcnMuIEFs
bCByaWdodHMgcmVzZXJ2ZWQuCi8vIFVz
ZSBvZiB0aGlzIHNvdXJjZSBjb2RlIGlz
IGdvdmVybmVkIGJ5IGEgQlNELXN0eWxl
IGxpY2Vuc2UgdGhhdCBjYW4gYmUKLy8g
Zm91bmQgaW4gdGhlIExJQ0VOU0UgZmls
ZS4KCid1c2Ugc3RyaWN0JzsKCmxpYi5y
dGRlcCgnbGliLmNvbG9ycycpOwoKLyoq
CiAqIENvbnN0cnVjdG9yIGZvciBUZXh0
QXR0cmlidXRlIG9iamVjdHMuCiAqCiAq
IFRoZXNlIG9iamVjdHMgbWFuYWdlIGEg
c2V0IG9mIHRleHQgYXR0cmlidXRlcyBz
dWNoIGFzIGZvcmVncm91bmQvCiAqIGJh
Y2tncm91bmQgY29sb3IsIGJvbGQsIGZh
aW50LCBpdGFsaWMsIGJsaW5rLCB1bmRl
cmxpbmUsIGFuZCBzdHJpa2V0aHJvdWdo
LgogKgogKiBUZXh0QXR0cmlidXRlIGlu
c3RhbmNlcyBjYW4gYmUgdXNlZCB0byBj
b25zdHJ1Y3QgYSBET00gY29udGFpbmVy
IGltcGxlbWVudGluZwogKiB0aGUgY3Vy
cmVudCBhdHRyaWJ1dGVzLCBvciB0byB0
ZXN0IGFuIGV4aXN0aW5nIERPTSBjb250
YWluZXIgZm9yCiAqIGNvbXBhdGliaWxp
dHkgd2l0aCB0aGUgY3VycmVudCBhdHRy
aWJ1dGVzLgogKgogKiBAY29uc3RydWN0
b3IKICogQHBhcmFtIHtIVE1MRG9jdW1l
bnR9IGRvY3VtZW50IFRoZSBwYXJlbnQg
ZG9jdW1lbnQgdG8gdXNlIHdoZW4gY3Jl
YXRpbmcKICogICAgIG5ldyBET00gY29u
dGFpbmVycy4KICovCmh0ZXJtLlRleHRB
dHRyaWJ1dGVzID0gZnVuY3Rpb24oZG9j
dW1lbnQpIHsKICB0aGlzLmRvY3VtZW50
XyA9IGRvY3VtZW50OwogIC8vIFRoZXNl
IHZhcmlhYmxlcyBjb250YWluIHRoZSBz
b3VyY2Ugb2YgdGhlIGNvbG9yIGFzIGVp
dGhlcjoKICAvLyBTUkNfREVGQVVMVCAg
KHVzZSBjb250ZXh0IGRlZmF1bHQpCiAg
Ly8gU1JDX1JHQiAgICAgIChzcGVjaWZp
ZWQgaW4gJ3JnYiggciwgZywgYiknIGZv
cm0pCiAgLy8gbnVtYmVyICAgICAgIChy
ZXByZXNlbnRpbmcgdGhlIGluZGV4IGZy
b20gY29sb3IgcGFsZXR0ZSB0byB1c2Up
CiAgdGhpcy5mb3JlZ3JvdW5kU291cmNl
ID0gdGhpcy5TUkNfREVGQVVMVDsKICB0
aGlzLmJhY2tncm91bmRTb3VyY2UgPSB0
aGlzLlNSQ19ERUZBVUxUOwoKICAvLyBU
aGVzZSBwcm9wZXJ0aWVzIGNhY2hlIHRo
ZSB2YWx1ZSBpbiB0aGUgY29sb3IgdGFi
bGUsIGJ1dCBmb3JlZ3JvdW5kU291cmNl
CiAgLy8gYW5kIGJhY2tncm91bmRTb3Vy
Y2UgY29udGFpbiB0aGUgY2Fub25pY2Fs
IHZhbHVlcy4KICB0aGlzLmZvcmVncm91
bmQgPSB0aGlzLkRFRkFVTFRfQ09MT1I7
CiAgdGhpcy5iYWNrZ3JvdW5kID0gdGhp
cy5ERUZBVUxUX0NPTE9SOwoKICB0aGlz
LmRlZmF1bHRGb3JlZ3JvdW5kID0gJ3Jn
YigyNTUsIDI1NSwgMjU1KSc7CiAgdGhp
cy5kZWZhdWx0QmFja2dyb3VuZCA9ICdy
Z2IoMCwgMCwgMCknOwoKICB0aGlzLmJv
bGQgPSBmYWxzZTsKICB0aGlzLmZhaW50
ID0gZmFsc2U7CiAgdGhpcy5pdGFsaWMg
PSBmYWxzZTsKICB0aGlzLmJsaW5rID0g
ZmFsc2U7CiAgdGhpcy51bmRlcmxpbmUg
PSBmYWxzZTsKICB0aGlzLnN0cmlrZXRo
cm91Z2ggPSBmYWxzZTsKICB0aGlzLmlu
dmVyc2UgPSBmYWxzZTsKICB0aGlzLmlu
dmlzaWJsZSA9IGZhbHNlOwogIHRoaXMu
d2NOb2RlID0gZmFsc2U7CiAgdGhpcy50
aWxlRGF0YSA9IG51bGw7CgogIHRoaXMu
Y29sb3JQYWxldHRlID0gbnVsbDsKICB0
aGlzLnJlc2V0Q29sb3JQYWxldHRlKCk7
Cn07CgovKioKICogSWYgZmFsc2UsIHdl
IGlnbm9yZSB0aGUgYm9sZCBhdHRyaWJ1
dGUuCiAqCiAqIFRoaXMgaXMgdXNlZCBm
b3IgZm9udHMgdGhhdCBoYXZlIGEgYm9s
ZCB2ZXJzaW9uIHRoYXQgaXMgYSBkaWZm
ZXJlbnQgc2l6ZQogKiB0aGFuIHRoZSBu
b3JtYWwgd2VpZ2h0IHZlcnNpb24uCiAq
LwpodGVybS5UZXh0QXR0cmlidXRlcy5w
cm90b3R5cGUuZW5hYmxlQm9sZCA9IHRy
dWU7CgovKioKICogSWYgdHJ1ZSwgdXNl
IGJyaWdodCBjb2xvcnMgKGlmIGF2YWls
YWJsZSkgZm9yIGJvbGQgdGV4dC4KICoK
ICogVGhpcyBzZXR0aW5nIGlzIGluZGVw
ZW5kZW50IG9mIHRoZSBlbmFibGVCb2xk
IHNldHRpbmcuCiAqLwpodGVybS5UZXh0
QXR0cmlidXRlcy5wcm90b3R5cGUuZW5h
YmxlQm9sZEFzQnJpZ2h0ID0gdHJ1ZTsK
Ci8qKgogKiBBIHNlbnRpbmVsIGNvbnN0
YW50IG1lYW5pbmcgIndoYXRldmVyIHRo
ZSBkZWZhdWx0IGNvbG9yIGlzIGluIHRo
aXMgY29udGV4dCIuCiAqLwpodGVybS5U
ZXh0QXR0cmlidXRlcy5wcm90b3R5cGUu
REVGQVVMVF9DT0xPUiA9IG5ldyBTdHJp
bmcoJycpOwoKLyoqCiAqIEEgY29uc3Rh
bnQgc3RyaW5nIHVzZWQgdG8gc3BlY2lm
eSB0aGF0IHNvdXJjZSBjb2xvciBpcyBj
b250ZXh0IGRlZmF1bHQuCiAqLwpodGVy
bS5UZXh0QXR0cmlidXRlcy5wcm90b3R5
cGUuU1JDX0RFRkFVTFQgPSAnZGVmYXVs
dCc7CgoKLyoqCiAqIEEgY29uc3RhbnQg
c3RyaW5nIHVzZWQgdG8gc3BlY2lmeSB0
aGF0IHRoZSBzb3VyY2Ugb2YgYSBjb2xv
ciBpcyBhIHZhbGlkCiAqIHJnYiggciwg
ZywgYikgc3BlY2lmaWVyLgogKi8KaHRl
cm0uVGV4dEF0dHJpYnV0ZXMucHJvdG90
eXBlLlNSQ19SR0IgPSAncmdiJzsKCi8q
KgogKiBUaGUgZG9jdW1lbnQgb2JqZWN0
IHdoaWNoIHNob3VsZCBvd24gdGhlIERP
TSBub2RlcyBjcmVhdGVkIGJ5IHRoaXMg
aW5zdGFuY2UuCiAqCiAqIEBwYXJhbSB7
SFRNTERvY3VtZW50fSBkb2N1bWVudCBU
aGUgcGFyZW50IGRvY3VtZW50LgogKi8K
aHRlcm0uVGV4dEF0dHJpYnV0ZXMucHJv
dG90eXBlLnNldERvY3VtZW50ID0gZnVu
Y3Rpb24oZG9jdW1lbnQpIHsKICB0aGlz
LmRvY3VtZW50XyA9IGRvY3VtZW50Owp9
OwoKLyoqCiAqIENyZWF0ZSBhIGRlZXAg
Y29weSBvZiB0aGlzIG9iamVjdC4KICoK
ICogQHJldHVybiB7aHRlcm0uVGV4dEF0
dHJpYnV0ZXN9IEEgZGVlcCBjb3B5IG9m
IHRoaXMgb2JqZWN0LgogKi8KaHRlcm0u
VGV4dEF0dHJpYnV0ZXMucHJvdG90eXBl
LmNsb25lID0gZnVuY3Rpb24oKSB7CiAg
dmFyIHJ2ID0gbmV3IGh0ZXJtLlRleHRB
dHRyaWJ1dGVzKG51bGwpOwoKICBmb3Ig
KHZhciBrZXkgaW4gdGhpcykgewogICAg
cnZba2V5XSA9IHRoaXNba2V5XTsKICB9
CgogIHJ2LmNvbG9yUGFsZXR0ZSA9IHRo
aXMuY29sb3JQYWxldHRlLmNvbmNhdCgp
OwogIHJldHVybiBydjsKfTsKCi8qKgog
KiBSZXNldCB0aGUgY3VycmVudCBzZXQg
b2YgYXR0cmlidXRlcy4KICoKICogVGhp
cyBkb2VzIG5vdCBhZmZlY3QgdGhlIHBh
bGV0dGUuICBVc2UgcmVzZXRDb2xvclBh
bGV0dGUoKSBmb3IgdGhhdC4KICogSXQg
YWxzbyBkb2Vzbid0IGFmZmVjdCB0aGUg
dGlsZSBkYXRhLCBpdCdzIG5vdCBtZWFu
dCB0by4KICovCmh0ZXJtLlRleHRBdHRy
aWJ1dGVzLnByb3RvdHlwZS5yZXNldCA9
IGZ1bmN0aW9uKCkgewogIHRoaXMuZm9y
ZWdyb3VuZFNvdXJjZSA9IHRoaXMuU1JD
X0RFRkFVTFQ7CiAgdGhpcy5iYWNrZ3Jv
dW5kU291cmNlID0gdGhpcy5TUkNfREVG
QVVMVDsKICB0aGlzLmZvcmVncm91bmQg
PSB0aGlzLkRFRkFVTFRfQ09MT1I7CiAg
dGhpcy5iYWNrZ3JvdW5kID0gdGhpcy5E
RUZBVUxUX0NPTE9SOwogIHRoaXMuYm9s
ZCA9IGZhbHNlOwogIHRoaXMuZmFpbnQg
PSBmYWxzZTsKICB0aGlzLml0YWxpYyA9
IGZhbHNlOwogIHRoaXMuYmxpbmsgPSBm
YWxzZTsKICB0aGlzLnVuZGVybGluZSA9
IGZhbHNlOwogIHRoaXMuc3RyaWtldGhy
b3VnaCA9IGZhbHNlOwogIHRoaXMuaW52
ZXJzZSA9IGZhbHNlOwogIHRoaXMuaW52
aXNpYmxlID0gZmFsc2U7CiAgdGhpcy53
Y05vZGUgPSBmYWxzZTsKfTsKCi8qKgog
KiBSZXNldCB0aGUgY29sb3IgcGFsZXR0
ZSB0byB0aGUgZGVmYXVsdCBzdGF0ZS4K
ICovCmh0ZXJtLlRleHRBdHRyaWJ1dGVz
LnByb3RvdHlwZS5yZXNldENvbG9yUGFs
ZXR0ZSA9IGZ1bmN0aW9uKCkgewogIHRo
aXMuY29sb3JQYWxldHRlID0gbGliLmNv
bG9ycy5jb2xvclBhbGV0dGUuY29uY2F0
KCk7CiAgdGhpcy5zeW5jQ29sb3JzKCk7
Cn07CgovKioKICogVGVzdCBpZiB0aGUg
Y3VycmVudCBhdHRyaWJ1dGVzIGRlc2Ny
aWJlIHVuc3R5bGVkIHRleHQuCiAqCiAq
IEByZXR1cm4ge2Jvb2xlYW59IFRydWUg
aWYgdGhlIGN1cnJlbnQgYXR0cmlidXRl
cyBkZXNjcmliZSB1bnN0eWxlZCB0ZXh0
LgogKi8KaHRlcm0uVGV4dEF0dHJpYnV0
ZXMucHJvdG90eXBlLmlzRGVmYXVsdCA9
IGZ1bmN0aW9uKCkgewogIHJldHVybiAo
dGhpcy5mb3JlZ3JvdW5kU291cmNlID09
IHRoaXMuU1JDX0RFRkFVTFQgJiYKICAg
ICAgICAgIHRoaXMuYmFja2dyb3VuZFNv
dXJjZSA9PSB0aGlzLlNSQ19ERUZBVUxU
ICYmCiAgICAgICAgICAhdGhpcy5ib2xk
ICYmCiAgICAgICAgICAhdGhpcy5mYWlu
dCAmJgogICAgICAgICAgIXRoaXMuaXRh
bGljICYmCiAgICAgICAgICAhdGhpcy5i
bGluayAmJgogICAgICAgICAgIXRoaXMu
dW5kZXJsaW5lICYmCiAgICAgICAgICAh
dGhpcy5zdHJpa2V0aHJvdWdoICYmCiAg
ICAgICAgICAhdGhpcy5pbnZlcnNlICYm
CiAgICAgICAgICAhdGhpcy5pbnZpc2li
bGUgJiYKICAgICAgICAgICF0aGlzLndj
Tm9kZSAmJgogICAgICAgICAgdGhpcy50
aWxlRGF0YSA9PSBudWxsKTsKfTsKCi8q
KgogKiBDcmVhdGUgYSBET00gY29udGFp
bmVyIChhIHNwYW4gb3IgYSB0ZXh0IG5v
ZGUpIHdpdGggYSBzdHlsZSB0byBtYXRj
aCB0aGUKICogY3VycmVudCBzZXQgb2Yg
YXR0cmlidXRlcy4KICoKICogVGhpcyBt
ZXRob2Qgd2lsbCBjcmVhdGUgYSBwbGFp
biB0ZXh0IG5vZGUgaWYgdGhlIHRleHQg
aXMgdW5zdHlsZWQsIG9yCiAqIGFuIEhU
TUwgc3BhbiBpZiB0aGUgdGV4dCBpcyBz
dHlsZWQuICBEdWUgdG8gbGFjayBvZiBt
b25vc3BhY2Ugd2lkZSBjaGFyYWN0ZXIK
ICogZm9udHMgb24gY2VydGFpbiBzeXN0
ZW1zIChlLmcuIENocm9tZSBPUyksIHdl
IG5lZWQgdG8gcHV0IGVhY2ggd2lkZSBj
aGFyYWN0ZXIKICogaW4gYSBzcGFuIG9m
IENTUyBjbGFzcyAnLndjLW5vZGUnIHdo
aWNoIGhhcyBkb3VibGUgY29sdW1uIHdp
ZHRoLgogKiBFYWNoIHZ0X3RpbGVkYXRh
IHRpbGUgaXMgYWxzbyByZXByZXNlbnRl
ZCBieSBhIHNwYW4gd2l0aCBhIHNpbmds
ZQogKiBjaGFyYWN0ZXIsIHdpdGggQ1NT
IGNsYXNzZXMgJy50aWxlJyBhbmQgJy50
aWxlXzxnbHlwaCBudW1iZXI+Jy4KICoK
ICogQHBhcmFtIHtzdHJpbmd9IG9wdF90
ZXh0Q29udGVudCBPcHRpb25hbCB0ZXh0
IGNvbnRlbnQgZm9yIHRoZSBuZXcgY29u
dGFpbmVyLgogKiBAcmV0dXJuIHtIVE1M
Tm9kZX0gQW4gSFRNTCBzcGFuIG9yIHRl
eHQgbm9kZXMgc3R5bGVkIHRvIG1hdGNo
IHRoZSBjdXJyZW50CiAqICAgICBhdHRy
aWJ1dGVzLgogKi8KaHRlcm0uVGV4dEF0
dHJpYnV0ZXMucHJvdG90eXBlLmNyZWF0
ZUNvbnRhaW5lciA9IGZ1bmN0aW9uKG9w
dF90ZXh0Q29udGVudCkgewogIGlmICh0
aGlzLmlzRGVmYXVsdCgpKQogICAgcmV0
dXJuIHRoaXMuZG9jdW1lbnRfLmNyZWF0
ZVRleHROb2RlKG9wdF90ZXh0Q29udGVu
dCk7CgogIHZhciBzcGFuID0gdGhpcy5k
b2N1bWVudF8uY3JlYXRlRWxlbWVudCgn
c3BhbicpOwogIHZhciBzdHlsZSA9IHNw
YW4uc3R5bGU7CgogIGlmICh0aGlzLmZv
cmVncm91bmQgIT0gdGhpcy5ERUZBVUxU
X0NPTE9SKQogICAgc3R5bGUuY29sb3Ig
PSB0aGlzLmZvcmVncm91bmQ7CgogIGlm
ICh0aGlzLmJhY2tncm91bmQgIT0gdGhp
cy5ERUZBVUxUX0NPTE9SKQogICAgc3R5
bGUuYmFja2dyb3VuZENvbG9yID0gdGhp
cy5iYWNrZ3JvdW5kOwoKICBpZiAodGhp
cy5lbmFibGVCb2xkICYmIHRoaXMuYm9s
ZCkKICAgIHN0eWxlLmZvbnRXZWlnaHQg
PSAnYm9sZCc7CgogIGlmICh0aGlzLmZh
aW50KQogICAgc3Bhbi5mYWludCA9IHRy
dWU7CgogIGlmICh0aGlzLml0YWxpYykK
ICAgIHN0eWxlLmZvbnRTdHlsZSA9ICdp
dGFsaWMnOwoKICBpZiAodGhpcy5ibGlu
aykKICAgIHN0eWxlLmZvbnRTdHlsZSA9
ICdpdGFsaWMnOwoKICB2YXIgdGV4dERl
Y29yYXRpb24gPSAnJzsKICBpZiAodGhp
cy51bmRlcmxpbmUpIHsKICAgIHRleHRE
ZWNvcmF0aW9uICs9ICcgdW5kZXJsaW5l
JzsKICAgIHNwYW4udW5kZXJsaW5lID0g
dHJ1ZTsKICB9CiAgaWYgKHRoaXMuc3Ry
aWtldGhyb3VnaCkgewogICAgdGV4dERl
Y29yYXRpb24gKz0gJyBsaW5lLXRocm91
Z2gnOwogICAgc3Bhbi5zdHJpa2V0aHJv
dWdoID0gdHJ1ZTsKICB9CiAgaWYgKHRl
eHREZWNvcmF0aW9uKSB7CiAgICBzdHls
ZS50ZXh0RGVjb3JhdGlvbiA9IHRleHRE
ZWNvcmF0aW9uOwogIH0KCiAgaWYgKHRo
aXMud2NOb2RlKSB7CiAgICBzcGFuLmNs
YXNzTmFtZSA9ICd3Yy1ub2RlJzsKICAg
IHNwYW4ud2NOb2RlID0gdHJ1ZTsKICB9
CgogIGlmICh0aGlzLnRpbGVEYXRhICE9
IG51bGwpIHsKICAgIC8vIFRoaXMgY291
bGQgYmUgYSB3Y05vZGUgdG9vLCBzbyB3
ZSBhZGQgdG8gdGhlIGNsYXNzTmFtZSBo
ZXJlLgogICAgc3Bhbi5jbGFzc05hbWUg
Kz0gJyB0aWxlIHRpbGVfJyArIHRoaXMu
dGlsZURhdGE7CiAgICBzcGFuLnRpbGVO
b2RlID0gdHJ1ZTsKICB9CgogIGlmIChv
cHRfdGV4dENvbnRlbnQpCiAgICBzcGFu
LnRleHRDb250ZW50ID0gb3B0X3RleHRD
b250ZW50OwoKICByZXR1cm4gc3BhbjsK
fTsKCi8qKgogKiBUZXN0cyBpZiB0aGUg
cHJvdmlkZWQgb2JqZWN0IChzdHJpbmcs
IHNwYW4gb3IgdGV4dCBub2RlKSBoYXMg
dGhlIHNhbWUKICogc3R5bGUgYXMgdGhp
cyBUZXh0QXR0cmlidXRlcyBpbnN0YW5j
ZS4KICoKICogVGhpcyBpbmRpY2F0ZXMg
dGhhdCB0ZXh0IHdpdGggdGhlc2UgYXR0
cmlidXRlcyBjb3VsZCBiZSBpbnNlcnRl
ZCBkaXJlY3RseQogKiBpbnRvIHRoZSB0
YXJnZXQgRE9NIG5vZGUuCiAqCiAqIEZv
ciB0aGUgcHVycG9zZXMgb2YgdGhpcyBt
ZXRob2QsIGEgc3RyaW5nIGlzIGNvbnNp
ZGVyZWQgYSB0ZXh0IG5vZGUuCiAqCiAq
IEBwYXJhbSB7c3RyaW5nfEhUTUxOb2Rl
fSBvYmogVGhlIG9iamVjdCB0byB0ZXN0
LgogKiBAcmV0dXJuIHtib29sZWFufSBU
cnVlIGlmIHRoZSBwcm92aWRlZCBjb250
YWluZXIgaGFzIHRoZSBzYW1lIHN0eWxl
IGFzCiAqICAgICB0aGlzIGF0dHJpYnV0
ZXMgaW5zdGFuY2UuCiAqLwpodGVybS5U
ZXh0QXR0cmlidXRlcy5wcm90b3R5cGUu
bWF0Y2hlc0NvbnRhaW5lciA9IGZ1bmN0
aW9uKG9iaikgewogIGlmICh0eXBlb2Yg
b2JqID09ICdzdHJpbmcnIHx8IG9iai5u
b2RlVHlwZSA9PSAzKQogICAgcmV0dXJu
IHRoaXMuaXNEZWZhdWx0KCk7CgogIHZh
ciBzdHlsZSA9IG9iai5zdHlsZTsKCiAg
Ly8gV2UgZG9uJ3Qgd2FudCB0byBwdXQg
bXVsdGlwbGUgY2hhcmFjdGVycyBpbiBh
IHdjTm9kZSBvciBhIHRpbGUuCiAgLy8g
U2VlIHRoZSBjb21tZW50cyBpbiBjcmVh
dGVDb250YWluZXIuCiAgcmV0dXJuICgh
KHRoaXMud2NOb2RlIHx8IG9iai53Y05v
ZGUpICYmCiAgICAgICAgICAhKHRoaXMu
dGlsZURhdGEgIT0gbnVsbCB8fCBvYmou
dGlsZU5vZGUpICYmCiAgICAgICAgICB0
aGlzLmZvcmVncm91bmQgPT0gc3R5bGUu
Y29sb3IgJiYKICAgICAgICAgIHRoaXMu
YmFja2dyb3VuZCA9PSBzdHlsZS5iYWNr
Z3JvdW5kQ29sb3IgJiYKICAgICAgICAg
ICh0aGlzLmVuYWJsZUJvbGQgJiYgdGhp
cy5ib2xkKSA9PSAhIXN0eWxlLmZvbnRX
ZWlnaHQgJiYKICAgICAgICAgICh0aGlz
LmJsaW5rIHx8IHRoaXMuaXRhbGljKSA9
PSAhIXN0eWxlLmZvbnRTdHlsZSAmJgog
ICAgICAgICAgISF0aGlzLnVuZGVybGlu
ZSA9PSAhIW9iai51bmRlcmxpbmUgJiYK
ICAgICAgICAgICEhdGhpcy5zdHJpa2V0
aHJvdWdoID09ICEhb2JqLnN0cmlrZXRo
cm91Z2gpOwp9OwoKaHRlcm0uVGV4dEF0
dHJpYnV0ZXMucHJvdG90eXBlLnNldERl
ZmF1bHRzID0gZnVuY3Rpb24oZm9yZWdy
b3VuZCwgYmFja2dyb3VuZCkgewogIHRo
aXMuZGVmYXVsdEZvcmVncm91bmQgPSBm
b3JlZ3JvdW5kOwogIHRoaXMuZGVmYXVs
dEJhY2tncm91bmQgPSBiYWNrZ3JvdW5k
OwoKICB0aGlzLnN5bmNDb2xvcnMoKTsK
fTsKCi8qKgogKiBVcGRhdGVzIGZvcmVn
cm91bmQgYW5kIGJhY2tncm91bmQgcHJv
cGVydGllcyBiYXNlZCBvbiBjdXJyZW50
IGluZGljZXMgYW5kCiAqIG90aGVyIHN0
YXRlLgogKgogKiBAcGFyYW0ge3N0cmlu
Z30gdGVybWluYWxGb3JlZ3JvdW5kIFRo
ZSB0ZXJtaW5hbCBmb3JlZ3JvdW5kIGNv
bG9yIGZvciB1c2UgYXMKICogICAgIGlu
dmVyc2UgdGV4dCBiYWNrZ3JvdW5kLgog
KiBAcGFyYW0ge3N0cmluZ30gdGVybWlu
YWxCYWNrZ3JvdW5kIFRoZSB0ZXJtaW5h
bCBiYWNrZ3JvdW5kIGNvbG9yIGZvciB1
c2UgYXMKICogICAgIGludmVyc2UgdGV4
dCBmb3JlZ3JvdW5kLgogKgogKi8KaHRl
cm0uVGV4dEF0dHJpYnV0ZXMucHJvdG90
eXBlLnN5bmNDb2xvcnMgPSBmdW5jdGlv
bigpIHsKICBmdW5jdGlvbiBnZXRCcmln
aHRJbmRleChpKSB7CiAgICBpZiAoaSA8
IDgpIHsKICAgICAgLy8gSWYgdGhlIGNv
bG9yIGlzIGZyb20gdGhlIGxvd2VyIGhh
bGYgb2YgdGhlIEFOU0kgMTYsIGFkZCA4
LgogICAgICByZXR1cm4gaSArIDg7CiAg
ICB9CgogICAgLy8gSWYgaXQncyBub3Qg
ZnJvbSB0aGUgMTYgY29sb3IgcGFsZXR0
ZSwgaWdub3JlIGJvbGQgcmVxdWVzdHMu
ICBUaGlzCiAgICAvLyBtYXRjaGVzIHRo
ZSBiZWhhdmlvciBvZiBnbm9tZS10ZXJt
aW5hbC4KICAgIHJldHVybiBpOwogIH0K
CiAgdmFyIGZvcmVncm91bmRTb3VyY2Ug
PSB0aGlzLmZvcmVncm91bmRTb3VyY2U7
CiAgdmFyIGJhY2tncm91bmRTb3VyY2Ug
PSB0aGlzLmJhY2tncm91bmRTb3VyY2U7
CiAgdmFyIGRlZmF1bHRGb3JlZ3JvdW5k
ID0gdGhpcy5ERUZBVUxUX0NPTE9SOwog
IHZhciBkZWZhdWx0QmFja2dyb3VuZCA9
IHRoaXMuREVGQVVMVF9DT0xPUjsKCiAg
aWYgKHRoaXMuaW52ZXJzZSkgewogICAg
Zm9yZWdyb3VuZFNvdXJjZSA9IHRoaXMu
YmFja2dyb3VuZFNvdXJjZTsKICAgIGJh
Y2tncm91bmRTb3VyY2UgPSB0aGlzLmZv
cmVncm91bmRTb3VyY2U7CiAgICAvLyBX
ZSBjYW4ndCBpbmhlcml0IHRoZSBjb250
YWluZXIncyBjb2xvciBhbnltb3JlLgog
ICAgZGVmYXVsdEZvcmVncm91bmQgPSB0
aGlzLmRlZmF1bHRCYWNrZ3JvdW5kOwog
ICAgZGVmYXVsdEJhY2tncm91bmQgPSB0
aGlzLmRlZmF1bHRGb3JlZ3JvdW5kOwog
IH0KCiAgaWYgKHRoaXMuZW5hYmxlQm9s
ZEFzQnJpZ2h0ICYmIHRoaXMuYm9sZCkg
ewogICAgaWYgKGZvcmVncm91bmRTb3Vy
Y2UgIT0gdGhpcy5TUkNfREVGQVVMVCAm
JgogICAgICAgIGZvcmVncm91bmRTb3Vy
Y2UgIT0gdGhpcy5TUkNfUkdCKSB7CiAg
ICAgIGZvcmVncm91bmRTb3VyY2UgPSBn
ZXRCcmlnaHRJbmRleChmb3JlZ3JvdW5k
U291cmNlKTsKICAgIH0KICB9CgogIGlm
ICh0aGlzLmludmlzaWJsZSkgewogICAg
Zm9yZWdyb3VuZFNvdXJjZSA9IGJhY2tn
cm91bmRTb3VyY2U7CiAgICBkZWZhdWx0
Rm9yZWdyb3VuZCA9IHRoaXMuZGVmYXVs
dEJhY2tncm91bmQ7CiAgfQoKICAvLyBT
ZXQgZm9yZS9iYWNrZ3JvdW5kIGNvbG9y
cyB1bmxlc3MgYWxyZWFkeSBzcGVjaWZp
ZWQgaW4gcmdiKHIsIGcsIGIpIGZvcm0u
CiAgaWYgKGZvcmVncm91bmRTb3VyY2Ug
IT0gdGhpcy5TUkNfUkdCKSB7CiAgICB0
aGlzLmZvcmVncm91bmQgPSAoKGZvcmVn
cm91bmRTb3VyY2UgPT0gdGhpcy5TUkNf
REVGQVVMVCkgPwogICAgICAgICAgICAg
ICAgICAgICAgIGRlZmF1bHRGb3JlZ3Jv
dW5kIDogdGhpcy5jb2xvclBhbGV0dGVb
Zm9yZWdyb3VuZFNvdXJjZV0pOwogIH0K
CiAgaWYgKHRoaXMuZmFpbnQgJiYgIXRo
aXMuaW52aXNpYmxlKSB7CiAgICB2YXIg
Y29sb3JUb01ha2VGYWludCA9ICgodGhp
cy5mb3JlZ3JvdW5kID09IHRoaXMuREVG
QVVMVF9DT0xPUikgPwogICAgICAgICAg
ICAgICAgICAgICAgICAgICAgdGhpcy5k
ZWZhdWx0Rm9yZWdyb3VuZCA6IHRoaXMu
Zm9yZWdyb3VuZCk7CiAgICB0aGlzLmZv
cmVncm91bmQgPSBsaWIuY29sb3JzLm1p
eChjb2xvclRvTWFrZUZhaW50LCAncmdi
KDAsIDAsIDApJywgMC4zMzMzKTsKICB9
CgogIGlmIChiYWNrZ3JvdW5kU291cmNl
ICE9IHRoaXMuU1JDX1JHQikgewogICAg
dGhpcy5iYWNrZ3JvdW5kID0gKChiYWNr
Z3JvdW5kU291cmNlID09IHRoaXMuU1JD
X0RFRkFVTFQpID8KICAgICAgICAgICAg
ICAgICAgICAgICBkZWZhdWx0QmFja2dy
b3VuZCA6IHRoaXMuY29sb3JQYWxldHRl
W2JhY2tncm91bmRTb3VyY2VdKTsKICB9
Cn07CgovKioKICogU3RhdGljIG1ldGhv
ZCB1c2VkIHRvIHRlc3QgaWYgdGhlIHBy
b3ZpZGVkIG9iamVjdHMgKHN0cmluZ3Ms
IHNwYW5zIG9yCiAqIHRleHQgbm9kZXMp
IGhhdmUgdGhlIHNhbWUgc3R5bGUuCiAq
CiAqIEZvciB0aGUgcHVycG9zZXMgb2Yg
dGhpcyBtZXRob2QsIGEgc3RyaW5nIGlz
IGNvbnNpZGVyZWQgYSB0ZXh0IG5vZGUu
CiAqCiAqIEBwYXJhbSB7c3RyaW5nfEhU
TUxOb2RlfSBvYmoxIEFuIG9iamVjdCB0
byB0ZXN0LgogKiBAcGFyYW0ge3N0cmlu
Z3xIVE1MTm9kZX0gb2JqMiBBbm90aGVy
IG9iamVjdCB0byB0ZXN0LgogKiBAcmV0
dXJuIHtib29sZWFufSBUcnVlIGlmIHRo
ZSBjb250YWluZXJzIGhhdmUgdGhlIHNh
bWUgc3R5bGUuCiAqLwpodGVybS5UZXh0
QXR0cmlidXRlcy5jb250YWluZXJzTWF0
Y2ggPSBmdW5jdGlvbihvYmoxLCBvYmoy
KSB7CiAgaWYgKHR5cGVvZiBvYmoxID09
ICdzdHJpbmcnKQogICAgcmV0dXJuIGh0
ZXJtLlRleHRBdHRyaWJ1dGVzLmNvbnRh
aW5lcklzRGVmYXVsdChvYmoyKTsKCiAg
aWYgKG9iajEubm9kZVR5cGUgIT0gb2Jq
Mi5ub2RlVHlwZSkKICAgIHJldHVybiBm
YWxzZTsKCiAgaWYgKG9iajEubm9kZVR5
cGUgPT0gMykKICAgIHJldHVybiB0cnVl
OwoKICB2YXIgc3R5bGUxID0gb2JqMS5z
dHlsZTsKICB2YXIgc3R5bGUyID0gb2Jq
Mi5zdHlsZTsKCiAgcmV0dXJuIChzdHls
ZTEuY29sb3IgPT0gc3R5bGUyLmNvbG9y
ICYmCiAgICAgICAgICBzdHlsZTEuYmFj
a2dyb3VuZENvbG9yID09IHN0eWxlMi5i
YWNrZ3JvdW5kQ29sb3IgJiYKICAgICAg
ICAgIHN0eWxlMS5mb250V2VpZ2h0ID09
IHN0eWxlMi5mb250V2VpZ2h0ICYmCiAg
ICAgICAgICBzdHlsZTEuZm9udFN0eWxl
ID09IHN0eWxlMi5mb250U3R5bGUgJiYK
ICAgICAgICAgIHN0eWxlMS50ZXh0RGVj
b3JhdGlvbiA9PSBzdHlsZTIudGV4dERl
Y29yYXRpb24pOwp9OwoKLyoqCiAqIFN0
YXRpYyBtZXRob2QgdG8gdGVzdCBpZiBh
IGdpdmVuIERPTSBjb250YWluZXIgcmVw
cmVzZW50cyB1bnN0eWxlZCB0ZXh0Lgog
KgogKiBGb3IgdGhlIHB1cnBvc2VzIG9m
IHRoaXMgbWV0aG9kLCBhIHN0cmluZyBp
cyBjb25zaWRlcmVkIGEgdGV4dCBub2Rl
LgogKgogKiBAcGFyYW0ge3N0cmluZ3xI
VE1MTm9kZX0gb2JqMSBBbiBvYmplY3Qg
dG8gdGVzdC4KICogQHJldHVybiB7Ym9v
bGVhbn0gVHJ1ZSBpZiB0aGUgb2JqZWN0
IGlzIHVuc3R5bGVkLgogKi8KaHRlcm0u
VGV4dEF0dHJpYnV0ZXMuY29udGFpbmVy
SXNEZWZhdWx0ID0gZnVuY3Rpb24ob2Jq
KSB7CiAgcmV0dXJuIHR5cGVvZiBvYmog
PT0gJ3N0cmluZycgIHx8IG9iai5ub2Rl
VHlwZSA9PSAzOwp9OwoKLyoqCiAqIFN0
YXRpYyBtZXRob2QgdG8gZ2V0IHRoZSBj
b2x1bW4gd2lkdGggb2YgYSBub2RlJ3Mg
dGV4dENvbnRlbnQuCiAqCiAqIEBwYXJh
bSB7SFRNTEVsZW1lbnR9IG5vZGUgVGhl
IEhUTUwgZWxlbWVudCB0byBnZXQgdGhl
IHdpZHRoIG9mIHRleHRDb250ZW50CiAq
ICAgICBmcm9tLgogKiBAcmV0dXJuIHtp
bnRlZ2VyfSBUaGUgY29sdW1uIHdpZHRo
IG9mIHRoZSBub2RlJ3MgdGV4dENvbnRl
bnQuCiAqLwpodGVybS5UZXh0QXR0cmli
dXRlcy5ub2RlV2lkdGggPSBmdW5jdGlv
bihub2RlKSB7CiAgaWYgKG5vZGUud2NO
b2RlKSB7CiAgICByZXR1cm4gbGliLndj
LnN0cldpZHRoKG5vZGUudGV4dENvbnRl
bnQpOwogIH0gZWxzZSB7CiAgICByZXR1
cm4gbm9kZS50ZXh0Q29udGVudC5sZW5n
dGg7CiAgfQp9CgovKioKICogU3RhdGlj
IG1ldGhvZCB0byBnZXQgdGhlIHN1YnN0
ciBvZiBhIG5vZGUncyB0ZXh0Q29udGVu
dC4gIFRoZSBzdGFydCBpbmRleAogKiBh
bmQgc3Vic3RyIHdpZHRoIGFyZSBjb21w
dXRlZCBpbiBjb2x1bW4gd2lkdGguCiAq
CiAqIEBwYXJhbSB7SFRNTEVsZW1lbnR9
IG5vZGUgVGhlIEhUTUwgZWxlbWVudCB0
byBnZXQgdGhlIHN1YnN0ciBvZiB0ZXh0
Q29udGVudAogKiAgICAgZnJvbS4KICog
QHBhcmFtIHtpbnRlZ2VyfSBzdGFydCBU
aGUgc3RhcnRpbmcgb2Zmc2V0IGluIGNv
bHVtbiB3aWR0aC4KICogQHBhcmFtIHtp
bnRlZ2VyfSB3aWR0aCBUaGUgd2lkdGgg
dG8gY2FwdHVyZSBpbiBjb2x1bW4gd2lk
dGguCiAqIEByZXR1cm4ge2ludGVnZXJ9
IFRoZSBleHRyYWN0ZWQgc3Vic3RyIG9m
IHRoZSBub2RlJ3MgdGV4dENvbnRlbnQu
CiAqLwpodGVybS5UZXh0QXR0cmlidXRl
cy5ub2RlU3Vic3RyID0gZnVuY3Rpb24o
bm9kZSwgc3RhcnQsIHdpZHRoKSB7CiAg
aWYgKG5vZGUud2NOb2RlKSB7CiAgICBy
ZXR1cm4gbGliLndjLnN1YnN0cihub2Rl
LnRleHRDb250ZW50LCBzdGFydCwgd2lk
dGgpOwogIH0gZWxzZSB7CiAgICByZXR1
cm4gbm9kZS50ZXh0Q29udGVudC5zdWJz
dHIoc3RhcnQsIHdpZHRoKTsKICB9Cn0K
Ci8qKgogKiBTdGF0aWMgbWV0aG9kIHRv
IGdldCB0aGUgc3Vic3RyaW5nIGJhc2Vk
IG9mIGEgbm9kZSdzIHRleHRDb250ZW50
LiAgVGhlCiAqIHN0YXJ0IGluZGV4IG9m
IGVuZCBpbmRleCBhcmUgY29tcHV0ZWQg
aW4gY29sdW1uIHdpZHRoLgogKgogKiBA
cGFyYW0ge0hUTUxFbGVtZW50fSBub2Rl
IFRoZSBIVE1MIGVsZW1lbnQgdG8gZ2V0
IHRoZSBzdWJzdHIgb2YgdGV4dENvbnRl
bnQKICogICAgIGZyb20uCiAqIEBwYXJh
bSB7aW50ZWdlcn0gc3RhcnQgVGhlIHN0
YXJ0aW5nIG9mZnNldCBpbiBjb2x1bW4g
d2lkdGguCiAqIEBwYXJhbSB7aW50ZWdl
cn0gZW5kIFRoZSBlbmRpbmcgb2Zmc2V0
IGluIGNvbHVtbiB3aWR0aC4KICogQHJl
dHVybiB7aW50ZWdlcn0gVGhlIGV4dHJh
Y3RlZCBzdWJzdHJpbmcgb2YgdGhlIG5v
ZGUncyB0ZXh0Q29udGVudC4KICovCmh0
ZXJtLlRleHRBdHRyaWJ1dGVzLm5vZGVT
dWJzdHJpbmcgPSBmdW5jdGlvbihub2Rl
LCBzdGFydCwgZW5kKSB7CiAgaWYgKG5v
ZGUud2NOb2RlKSB7CiAgICByZXR1cm4g
bGliLndjLnN1YnN0cmluZyhub2RlLnRl
eHRDb250ZW50LCBzdGFydCwgZW5kKTsK
ICB9IGVsc2UgewogICAgcmV0dXJuIG5v
ZGUudGV4dENvbnRlbnQuc3Vic3RyaW5n
KHN0YXJ0LCBlbmQpOwogIH0KfQoKLyoq
CiAqIFN0YXRpYyBtZXRob2QgdG8gc3Bs
aXQgYSBzdHJpbmcgaW50byBjb250aWd1
b3VzIHJ1bnMgb2Ygc2luZ2xlLXdpZHRo
CiAqIGNoYXJhY3RlcnMgYW5kIHJ1bnMg
b2YgZG91YmxlLXdpZHRoIGNoYXJhY3Rl
cnMuCiAqCiAqIEBwYXJhbSB7c3RyaW5n
fSBzdHIgVGhlIHN0cmluZyB0byBzcGxp
dC4KICogQHJldHVybiB7QXJyYXl9IEFu
IGFycmF5IG9mIG9iamVjdHMgdGhhdCBj
b250YWluIHN1YnN0cmluZ3Mgb2Ygc3Ry
LCB3aGVyZQogKiAgICAgZWFjaCBzdWJz
dHJpbmcgaXMgZWl0aGVyIGEgY29udGln
dW91cyBydW5zIG9mIHNpbmdsZS13aWR0
aCBjaGFyYWN0ZXJzCiAqICAgICBvciBh
IGRvdWJsZS13aWR0aCBjaGFyYWN0ZXIu
ICBGb3Igb2JqZWN0IHRoYXQgY29udGFp
bnMgYSBkb3VibGUtd2lkdGgKICogICAg
IGNoYXJhY3RlciwgaXRzIHdjTm9kZSBw
cm9wZXJ0eSBpcyBzZXQgdG8gdHJ1ZS4K
ICovCmh0ZXJtLlRleHRBdHRyaWJ1dGVz
LnNwbGl0V2lkZWNoYXJTdHJpbmcgPSBm
dW5jdGlvbihzdHIpIHsKICB2YXIgcnYg
PSBbXTsKICB2YXIgYmFzZSA9IDAsIGxl
bmd0aCA9IDA7CgogIGZvciAodmFyIGkg
PSAwOyBpIDwgc3RyLmxlbmd0aDsgaSsr
KSB7CiAgICB2YXIgYyA9IHN0ci5jaGFy
Q29kZUF0KGkpOwogICAgaWYgKGMgPCAx
MjggfHwgbGliLndjLmNoYXJXaWR0aChj
KSA9PSAxKSB7CiAgICAgIGxlbmd0aCsr
OwogICAgfSBlbHNlIHsKICAgICAgaWYg
KGxlbmd0aCkgewogICAgICAgIHJ2LnB1
c2goe3N0cjogc3RyLnN1YnN0cihiYXNl
LCBsZW5ndGgpfSk7CiAgICAgIH0KICAg
ICAgcnYucHVzaCh7c3RyOiBzdHIuc3Vi
c3RyKGksIDEpLCB3Y05vZGU6IHRydWV9
KTsKICAgICAgYmFzZSA9IGkgKyAxOwog
ICAgICBsZW5ndGggPSAwOwogICAgfQog
IH0KCiAgaWYgKGxlbmd0aCkKICAgIHJ2
LnB1c2goe3N0cjogc3RyLnN1YnN0cihi
YXNlLCBsZW5ndGgpfSk7CgogIHJldHVy
biBydjsKfQovLyBTT1VSQ0UgRklMRTog
aHRlcm0vanMvaHRlcm1fdnQuanMKLy8g
Q29weXJpZ2h0IChjKSAyMDEyIFRoZSBD
aHJvbWl1bSBPUyBBdXRob3JzLiBBbGwg
cmlnaHRzIHJlc2VydmVkLgovLyBVc2Ug
b2YgdGhpcyBzb3VyY2UgY29kZSBpcyBn
b3Zlcm5lZCBieSBhIEJTRC1zdHlsZSBs
aWNlbnNlIHRoYXQgY2FuIGJlCi8vIGZv
dW5kIGluIHRoZSBMSUNFTlNFIGZpbGUu
CgondXNlIHN0cmljdCc7CgpsaWIucnRk
ZXAoJ2xpYi5jb2xvcnMnLCAnbGliLmYn
LCAnbGliLlVURjhEZWNvZGVyJywKICAg
ICAgICAgICdodGVybS5WVC5DaGFyYWN0
ZXJNYXAnKTsKCi8qKgogKiBDb25zdHJ1
Y3RvciBmb3IgdGhlIFZUIGVzY2FwZSBz
ZXF1ZW5jZSBpbnRlcnByZXRlci4KICoK
ICogVGhlIGludGVycHJldGVyIG9wZXJh
dGVzIG9uIGEgdGVybWluYWwgb2JqZWN0
IGNhcGFibGUgb2YgcGVyZm9ybWluZyBj
dXJzb3IKICogbW92ZSBvcGVyYXRpb25z
LCBwYWludGluZyBjaGFyYWN0ZXJzLCBl
dGMuCiAqCiAqIFRoaXMgaW50ZXJwcmV0
ZXIgaXMgaW50ZW5kZWQgdG8gYmUgY29t
cGF0aWJsZSB3aXRoIHh0ZXJtLCB0aG91
Z2ggaXQKICogaWdub3JlcyBzb21lIG9m
IHRoZSBtb3JlIGVzb3RlcmljIGVzY2Fw
ZSBzZXF1ZW5jZXMuCiAqCiAqIFNvbWUg
c2VxdWVuY2VzIGFyZSBtYXJrZWQgIldp
bGwgbm90IGltcGxlbWVudCIsIG1lYW5p
bmcgdGhhdCB0aGV5IGFyZW4ndAogKiBj
b25zaWRlcmVkIHJlbGV2YW50IHRvIGh0
ZXJtIGFuZCB3aWxsIHByb2JhYmx5IG5l
dmVyIGJlIGltcGxlbWVudGVkLgogKgog
KiBPdGhlcnMgYXJlIG1hcmtlZCAiTm90
IGN1cnJlbnRseSBpbXBsZW1lbnRlZCIs
IG1lYW5pbmcgdGhhdCB0aGV5IGFyZSBs
b3dlcgogKiBwcmlvcml0eSBpdGVtcyB0
aGF0IG1heSBiZSB1c2VmdWwgdG8gaW1w
bGVtZW50IGF0IHNvbWUgcG9pbnQuCiAq
CiAqIFNlZSBhbHNvOgogKiAgIFtWVDEw
MF0gVlQxMDAgVXNlciBHdWlkZQogKiAg
ICAgICAgICAgaHR0cDovL3Z0MTAwLm5l
dC9kb2NzL3Z0MTAwLXVnL2NoYXB0ZXIz
Lmh0bWwKICogICBbVlQ1MTBdIFZUNTEw
IFZpZGVvIFRlcm1pbmFsIFByb2dyYW1t
ZXIgSW5mb3JtYXRpb24KICogICAgICAg
ICAgIGh0dHA6Ly92dDEwMC5uZXQvZG9j
cy92dDUxMC1ybS9jb250ZW50cwogKiAg
IFtYVEVSTV0gWHRlcm0gQ29udHJvbCBT
ZXF1ZW5jZXMKICogICAgICAgICAgIGh0
dHA6Ly9pbnZpc2libGUtaXNsYW5kLm5l
dC94dGVybS9jdGxzZXFzL2N0bHNlcXMu
aHRtbAogKiAgIFtDVFJMXSAgV2lraXBl
ZGlhOiBDMCBhbmQgQzEgQ29udHJvbCBD
b2RlcwogKiAgICAgICAgICAgaHR0cDov
L2VuLndpa2lwZWRpYS5vcmcvd2lraS9D
MF9hbmRfQzFfY29udHJvbF9jb2Rlcwog
KiAgIFtDU0ldICAgV2lraXBlZGlhOiBB
TlNJIEVzY2FwZSBDb2RlCiAqICAgICAg
ICAgICBodHRwOi8vZW4ud2lraXBlZGlh
Lm9yZy93aWtpL0NvbnRyb2xfU2VxdWVu
Y2VfSW50cm9kdWNlcgogKiAgIG1hbiA1
IHRlcm1pbmZvLCBtYW4gaW5mb2NtcCwg
aW5mb2NtcCAtTCB4dGVybS1uZXcKICoK
ICogQHBhcmFtIHtodGVybS5UZXJtaW5h
bH0gdGVybWluYWwgVGVybWluYWwgdG8g
dXNlIHdpdGggdGhlIGludGVycHJldGVy
LgogKi8KaHRlcm0uVlQgPSBmdW5jdGlv
bih0ZXJtaW5hbCkgewogIC8qKgogICAq
IFRoZSBkaXNwbGF5IHRlcm1pbmFsIG9i
amVjdCBhc3NvY2lhdGVkIHdpdGggdGhp
cyB2aXJ0dWFsIHRlcm1pbmFsLgogICAq
LwogIHRoaXMudGVybWluYWwgPSB0ZXJt
aW5hbDsKCiAgdGVybWluYWwub25Nb3Vz
ZSA9IHRoaXMub25UZXJtaW5hbE1vdXNl
Xy5iaW5kKHRoaXMpOwogIHRoaXMubW91
c2VSZXBvcnQgPSB0aGlzLk1PVVNFX1JF
UE9SVF9ESVNBQkxFRDsKCiAgLy8gUGFy
c2Ugc3RhdGUgbGVmdCBvdmVyIGZyb20g
dGhlIGxhc3QgcGFyc2UuICBZb3Ugc2hv
dWxkIHVzZSB0aGUgcGFyc2VTdGF0ZQog
IC8vIGluc3RhbmNlIHBhc3NlZCBpbnRv
IHlvdXIgcGFyc2Ugcm91dGluZSwgcmF0
aGVyIHRoYW4gcmVhZGluZwogIC8vIHRo
aXMucGFyc2VTdGF0ZV8gZGlyZWN0bHku
CiAgdGhpcy5wYXJzZVN0YXRlXyA9IG5l
dyBodGVybS5WVC5QYXJzZVN0YXRlKHRo
aXMucGFyc2VVbmtub3duXyk7CgogIC8v
IEFueSAibGVhZGluZyBtb2RpZmllcnMi
IGZvciB0aGUgZXNjYXBlIHNlcXVlbmNl
LCBzdWNoIGFzICc/JywgJyAnLCBvciB0
aGUKICAvLyBvdGhlciBtb2RpZmllcnMg
aGFuZGxlZCBpbiB0aGlzLnBhcnNlQ1NJ
Xy4KICB0aGlzLmxlYWRpbmdNb2RpZmll
cl8gPSAnJzsKCiAgLy8gQW55ICJ0cmFp
bGluZyBtb2RpZmllcnMiLiAgU2FtZSBj
aGFyYWN0ZXIgc2V0IGFzIGEgbGVhZGlu
ZyBtb2RpZmllciwKICAvLyBleGNlcHQg
dGhlc2UgYXJlIGZvdW5kIGFmdGVyIHRo
ZSBudW1lcmljIGFyZ3VtZW50cy4KICB0
aGlzLnRyYWlsaW5nTW9kaWZpZXJfID0g
Jyc7CgogIC8vIFdoZXRoZXIgb3Igbm90
IHRvIHJlc3BlY3QgdGhlIGVzY2FwZSBj
b2RlcyBmb3Igc2V0dGluZyB0ZXJtaW5h
bCB3aWR0aC4KICB0aGlzLmFsbG93Q29s
dW1uV2lkdGhDaGFuZ2VzXyA9IGZhbHNl
OwoKICAvLyBUaGUgYW1vdW50IG9mIHRp
bWUgd2UncmUgd2lsbGluZyB0byB3YWl0
IGZvciB0aGUgZW5kIG9mIGFuIE9TQyBz
ZXF1ZW5jZS4KICB0aGlzLm9zY1RpbWVM
aW1pdF8gPSAyMDAwMDsKCiAgLy8gQ29u
c3RydWN0IGEgcmVndWxhciBleHByZXNz
aW9uIHRvIG1hdGNoIHRoZSBrbm93biBv
bmUtYnl0ZSBjb250cm9sIGNoYXJzLgog
IC8vIFRoaXMgaXMgdXNlZCBpbiBwYXJz
ZVVua25vd25fIHRvIHF1aWNrbHkgc2Nh
biBhIHN0cmluZyBmb3IgdGhlIG5leHQK
ICAvLyBjb250cm9sIGNoYXJhY3Rlci4K
ICB2YXIgY2MxID0gT2JqZWN0LmtleXMo
aHRlcm0uVlQuQ0MxKS5tYXAoCiAgICAg
IGZ1bmN0aW9uKGUpIHsKICAgICAgICBy
ZXR1cm4gJ1xceCcgKyBsaWIuZi56cGFk
KGUuY2hhckNvZGVBdCgpLnRvU3RyaW5n
KDE2KSwgMikKICAgICAgfSkuam9pbign
Jyk7CiAgdGhpcy5jYzFQYXR0ZXJuXyA9
IG5ldyBSZWdFeHAoJ1snICsgY2MxICsg
J10nKTsKCiAgLy8gRGVjb2RlciB0byBt
YWludGFpbiBVVEYtOCBkZWNvZGUgc3Rh
dGUuCiAgdGhpcy51dGY4RGVjb2Rlcl8g
PSBuZXcgbGliLlVURjhEZWNvZGVyKCk7
CgogIC8qKgogICAqIFdoZXRoZXIgdG8g
YWNjZXB0IHRoZSA4LWJpdCBjb250cm9s
IGNoYXJhY3RlcnMuCiAgICoKICAgKiBB
biA4LWJpdCBjb250cm9sIGNoYXJhY3Rl
ciBpcyBvbmUgd2l0aCB0aGUgZWlnaHRo
IGJpdCBzZXQuICBUaGVzZQogICAqIGRp
ZG4ndCB3b3JrIG9uIDctYml0IHRlcm1p
bmFscyBzbyB0aGV5IGFsbCBoYXZlIHR3
byBieXRlIGVxdWl2YWxlbnRzLgogICAq
IE1vc3QgaG9zdHMgc3RpbGwgb25seSB1
c2UgdGhlIHR3by1ieXRlIHZlcnNpb25z
LgogICAqCiAgICogV2UgaWdub3JlIDgt
Yml0IGNvbnRyb2wgY29kZXMgYnkgZGVm
YXVsdC4gIFRoaXMgaXMgaW4gb3JkZXIg
dG8gYXZvaWQKICAgKiBpc3N1ZXMgd2l0
aCAiYWNjaWRlbnRhbCIgdXNhZ2Ugb2Yg
Y29kZXMgdGhhdCBuZWVkIHRvIGJlIHRl
cm1pbmF0ZWQuCiAgICogVGhlICJhY2Np
ZGVudCIgdXN1YWxseSBpbnZvbHZlcyBj
YXQnaW5nIGJpbmFyeSBkYXRhLgogICAq
LwogIHRoaXMuZW5hYmxlOEJpdENvbnRy
b2wgPSBmYWxzZTsKCiAgLyoqCiAgICog
V2hldGhlciB0byBhbGxvdyB0aGUgT1ND
IDUyIHNlcXVlbmNlIHRvIHdyaXRlIHRv
IHRoZSBzeXN0ZW0gY2xpcGJvYXJkLgog
ICAqLwogIHRoaXMuZW5hYmxlQ2xpcGJv
YXJkV3JpdGUgPSB0cnVlOwoKICAvKioK
ICAgKiBSZXNwZWN0IHRoZSBob3N0J3Mg
YXR0ZW1wdCB0byBjaGFuZ2UgdGhlIGN1
cnNvciBibGluayBzdGF0dXMgdXNpbmcK
ICAgKiB0aGUgREVDIFByaXZhdGUgbW9k
ZSAxMi4KICAgKi8KICB0aGlzLmVuYWJs
ZURlYzEyID0gZmFsc2U7CgogIC8qKgog
ICAqIFRoZSBleHBlY3RlZCBlbmNvZGlu
ZyBtZXRob2QgZm9yIGRhdGEgcmVjZWl2
ZWQgZnJvbSB0aGUgaG9zdC4KICAgKi8K
ICB0aGlzLmNoYXJhY3RlckVuY29kaW5n
ID0gJ3V0Zi04JzsKCiAgLyoqCiAgICog
TWF4IGxlbmd0aCBvZiBhbiB1bnRlcm1p
bmF0ZWQgRENTLCBPU0MsIFBNIG9yIEFQ
QyBzZXF1ZW5jZSBiZWZvcmUgd2UgZ2l2
ZQogICAqIHVwIGFuZCBpZ25vcmUgdGhl
IGNvZGUuCiAgICoKICAgKiBUaGVzZSBh
bGwgZW5kIHdpdGggYSBTdHJpbmcgVGVy
bWluYXRvciAoU1QsICdceDljJywgRVND
ICdcXCcpIG9yCiAgICogKEJFTCwgJ1x4
MDcnKSBjaGFyYWN0ZXIsIGhlbmNlIHRo
ZSAic3RyaW5nIHNlcXVlbmNlIiBtb25p
a2VyLgogICAqLwogIHRoaXMubWF4U3Ry
aW5nU2VxdWVuY2UgPSAxMDI0OwoKICAv
KioKICAgKiBJZiB0cnVlLCBlbWl0IHdh
cm5pbmdzIHdoZW4gd2UgZW5jb3VudGVy
IGEgY29udHJvbCBjaGFyYWN0ZXIgb3Ig
ZXNjYXBlCiAgICogc2VxdWVuY2UgdGhh
dCB3ZSBkb24ndCByZWNvZ25pemUgb3Ig
ZXhwbGljaXRseSBpZ25vcmUuCiAgICov
CiAgdGhpcy53YXJuVW5pbXBsZW1lbnRl
ZCA9IHRydWU7CgogIC8qKgogICAqIFRo
ZSBkZWZhdWx0IEcwLi4uRzMgY2hhcmFj
dGVyIG1hcHMuCiAgICovCiAgdGhpcy5H
MCA9IGh0ZXJtLlZULkNoYXJhY3Rlck1h
cC5tYXBzWydCJ107CiAgdGhpcy5HMSA9
IGh0ZXJtLlZULkNoYXJhY3Rlck1hcC5t
YXBzWycwJ107CiAgdGhpcy5HMiA9IGh0
ZXJtLlZULkNoYXJhY3Rlck1hcC5tYXBz
WydCJ107CiAgdGhpcy5HMyA9IGh0ZXJt
LlZULkNoYXJhY3Rlck1hcC5tYXBzWydC
J107CgogIC8qKgogICAqIFRoZSA3LWJp
dCB2aXNpYmxlIGNoYXJhY3RlciBzZXQu
CiAgICoKICAgKiBUaGlzIGlzIGEgbWFw
cGluZyBmcm9tIGluYm91bmQgZGF0YSB0
byBkaXNwbGF5IGdseXBoLiAgVGhlIEdM
IHNldAogICAqIGNvbnRhaW5zIHRoZSA5
NCBieXRlcyBmcm9tIDB4MjEgdG8gMHg3
ZS4KICAgKgogICAqIFRoZSBkZWZhdWx0
IEdMIHNldCBpcyAnQicsIFVTIEFTQ0lJ
LgogICAqLwogIHRoaXMuR0wgPSAnRzAn
OwoKICAvKioKICAgKiBUaGUgOC1iaXQg
dmlzaWJsZSBjaGFyYWN0ZXIgc2V0Lgog
ICAqCiAgICogVGhpcyBpcyBhIG1hcHBp
bmcgZnJvbSBpbmJvdW5kIGRhdGEgdG8g
ZGlzcGxheSBnbHlwaC4gIFRoZSBHUiBz
ZXQKICAgKiBjb250YWlucyB0aGUgOTQg
Ynl0ZXMgZnJvbSAweGExIHRvIDB4ZmUu
CiAgICovCiAgdGhpcy5HUiA9ICdHMCc7
CgogIC8vIFNhdmVkIHN0YXRlIHVzZWQg
aW4gREVDU0MuCiAgLy8KICAvLyBUaGlz
IGlzIGEgcGxhY2UgdG8gc3RvcmUgYSBj
b3B5IFZUIHN0YXRlLCBpdCBpcyAqbm90
KiB0aGUgYWN0aXZlIHN0YXRlLgogIHRo
aXMuc2F2ZWRTdGF0ZV8gPSBuZXcgaHRl
cm0uVlQuQ3Vyc29yU3RhdGUodGhpcyk7
Cn07CgovKioKICogTm8gbW91c2UgZXZl
bnRzLgogKi8KaHRlcm0uVlQucHJvdG90
eXBlLk1PVVNFX1JFUE9SVF9ESVNBQkxF
RCA9IDA7CgovKioKICogREVDU0VUIG1v
ZGUgMTAwMC4KICoKICogUmVwb3J0IG1v
dXNlIGRvd24vdXAgZXZlbnRzIG9ubHku
CiAqLwpodGVybS5WVC5wcm90b3R5cGUu
TU9VU0VfUkVQT1JUX0NMSUNLID0gMTsK
Ci8qKgogKiBERUNTRVQgbW9kZSAxMDAy
LgogKgogKiBSZXBvcnQgbW91c2UgZG93
bi91cCBhbmQgbW92ZW1lbnQgd2hpbGUg
YSBidXR0b24gaXMgZG93bi4KICovCmh0
ZXJtLlZULnByb3RvdHlwZS5NT1VTRV9S
RVBPUlRfRFJBRyA9IDM7CgovKioKICog
UGFyc2VTdGF0ZSBjb25zdHJ1Y3Rvci4K
ICoKICogVGhpcyBvYmplY3QgdHJhY2tz
IHRoZSBjdXJyZW50IHN0YXRlIG9mIHRo
ZSBwYXJzZS4gIEl0IGhhcyBmaWVsZHMg
Zm9yIHRoZQogKiBjdXJyZW50IGJ1ZmZl
ciwgcG9zaXRpb24gaW4gdGhlIGJ1ZmZl
ciwgYW5kIHRoZSBwYXJzZSBmdW5jdGlv
bi4KICoKICogQHBhcmFtIHtmdW5jdGlv
bn0gZGVmYXVsdEZ1bmMgVGhlIGRlZmF1
bHQgcGFyc2VyIGZ1bmN0aW9uLgogKiBA
cGFyYW0ge3N0cmluZ30gb3B0X2J1ZiBP
cHRpb25hbCBzdHJpbmcgdG8gdXNlIGFz
IHRoZSBjdXJyZW50IGJ1ZmZlci4KICov
Cmh0ZXJtLlZULlBhcnNlU3RhdGUgPSBm
dW5jdGlvbihkZWZhdWx0RnVuY3Rpb24s
IG9wdF9idWYpIHsKICB0aGlzLmRlZmF1
bHRGdW5jdGlvbiA9IGRlZmF1bHRGdW5j
dGlvbjsKICB0aGlzLmJ1ZiA9IG9wdF9i
dWYgfHwgbnVsbDsKICB0aGlzLnBvcyA9
IDA7CiAgdGhpcy5mdW5jID0gZGVmYXVs
dEZ1bmN0aW9uOwogIHRoaXMuYXJncyA9
IFtdOwp9OwoKLyoqCiAqIFJlc2V0IHRo
ZSBwYXJzZXIgZnVuY3Rpb24sIGJ1ZmZl
ciwgYW5kIHBvc2l0aW9uLgogKi8KaHRl
cm0uVlQuUGFyc2VTdGF0ZS5wcm90b3R5
cGUucmVzZXQgPSBmdW5jdGlvbihvcHRf
YnVmKSB7CiAgdGhpcy5yZXNldFBhcnNl
RnVuY3Rpb24oKTsKICB0aGlzLnJlc2V0
QnVmKG9wdF9idWYgfHwgJycpOwogIHRo
aXMucmVzZXRBcmd1bWVudHMoKTsKfTsK
Ci8qKgogKiBSZXNldCB0aGUgcGFyc2Vy
IGZ1bmN0aW9uIG9ubHkuCiAqLwpodGVy
bS5WVC5QYXJzZVN0YXRlLnByb3RvdHlw
ZS5yZXNldFBhcnNlRnVuY3Rpb24gPSBm
dW5jdGlvbigpIHsKICB0aGlzLmZ1bmMg
PSB0aGlzLmRlZmF1bHRGdW5jdGlvbjsK
fTsKCi8qKgogKiBSZXNldCB0aGUgYnVm
ZmVyIGFuZCBwb3NpdGlvbiBvbmx5Lgog
KgogKiBAcGFyYW0ge3N0cmluZ30gYnVm
IE9wdGlvbmFsIG5ldyB2YWx1ZSBmb3Ig
YnVmLCBkZWZhdWx0cyB0byBudWxsLgog
Ki8KaHRlcm0uVlQuUGFyc2VTdGF0ZS5w
cm90b3R5cGUucmVzZXRCdWYgPSBmdW5j
dGlvbihvcHRfYnVmKSB7CiAgdGhpcy5i
dWYgPSAodHlwZW9mIG9wdF9idWYgPT0g
J3N0cmluZycpID8gb3B0X2J1ZiA6IG51
bGw7CiAgdGhpcy5wb3MgPSAwOwp9OwoK
LyoqCiAqIFJlc2V0IHRoZSBhcmd1bWVu
dHMgbGlzdCBvbmx5LgogKgogKiBAcGFy
YW0ge3N0cmluZ30gb3B0X2FyZ196ZXJv
IE9wdGlvbmFsIGluaXRpYWwgdmFsdWUg
Zm9yIGFyZ3NbMF0uCiAqLwpodGVybS5W
VC5QYXJzZVN0YXRlLnByb3RvdHlwZS5y
ZXNldEFyZ3VtZW50cyA9IGZ1bmN0aW9u
KG9wdF9hcmdfemVybykgewogIHRoaXMu
YXJncy5sZW5ndGggPSAwOwogIGlmICh0
eXBlb2Ygb3B0X2FyZ196ZXJvICE9ICd1
bmRlZmluZWQnKQogICAgdGhpcy5hcmdz
WzBdID0gb3B0X2FyZ196ZXJvOwp9OwoK
LyoqCiAqIEdldCBhbiBhcmd1bWVudCBh
cyBhbiBpbnRlZ2VyLgogKgogKiBAcGFy
YW0ge251bWJlcn0gYXJnbnVtIFRoZSBh
cmd1bWVudCBudW1iZXIgdG8gcmV0cmVp
dmUuCiAqLwpodGVybS5WVC5QYXJzZVN0
YXRlLnByb3RvdHlwZS5pYXJnID0gZnVu
Y3Rpb24oYXJnbnVtLCBkZWZhdWx0VmFs
dWUpIHsKICB2YXIgc3RyID0gdGhpcy5h
cmdzW2FyZ251bV07CiAgaWYgKHN0cikg
ewogICAgdmFyIHJldCA9IHBhcnNlSW50
KHN0ciwgMTApOwogICAgLy8gQW4gYXJn
dW1lbnQgb2YgemVybyBpcyB0cmVhdGVk
IGFzIHRoZSBkZWZhdWx0IHZhbHVlLgog
ICAgaWYgKHJldCA9PSAwKQogICAgICBy
ZXQgPSBkZWZhdWx0VmFsdWU7CiAgICBy
ZXR1cm4gcmV0OwogIH0KICByZXR1cm4g
ZGVmYXVsdFZhbHVlOwp9OwoKLyoqCiAq
IEFkdmFuY2UgdGhlIHBhcnNlIHBvc3Rp
b24uCiAqCiAqIEBwYXJhbSB7aW50ZWdl
cn0gY291bnQgVGhlIG51bWJlciBvZiBi
eXRlcyB0byBhZHZhbmNlLgogKi8KaHRl
cm0uVlQuUGFyc2VTdGF0ZS5wcm90b3R5
cGUuYWR2YW5jZSA9IGZ1bmN0aW9uKGNv
dW50KSB7CiAgdGhpcy5wb3MgKz0gY291
bnQ7Cn07CgovKioKICogUmV0dXJuIHRo
ZSByZW1haW5pbmcgcG9ydGlvbiBvZiB0
aGUgYnVmZmVyIHdpdGhvdXQgYWZmZWN0
aW5nIHRoZSBwYXJzZQogKiBwb3NpdGlv
bi4KICoKICogQHJldHVybiB7c3RyaW5n
fSBUaGUgcmVtYWluaW5nIHBvcnRpb24g
b2YgdGhlIGJ1ZmZlci4KICovCmh0ZXJt
LlZULlBhcnNlU3RhdGUucHJvdG90eXBl
LnBlZWtSZW1haW5pbmdCdWYgPSBmdW5j
dGlvbigpIHsKICByZXR1cm4gdGhpcy5i
dWYuc3Vic3RyKHRoaXMucG9zKTsKfTsK
Ci8qKgogKiBSZXR1cm4gdGhlIG5leHQg
c2luZ2xlIGNoYXJhY3RlciBpbiB0aGUg
YnVmZmVyIHdpdGhvdXQgYWZmZWN0aW5n
IHRoZSBwYXJzZQogKiBwb3NpdGlvbi4K
ICoKICogQHJldHVybiB7c3RyaW5nfSBU
aGUgbmV4dCBjaGFyYWN0ZXIgaW4gdGhl
IGJ1ZmZlci4KICovCmh0ZXJtLlZULlBh
cnNlU3RhdGUucHJvdG90eXBlLnBlZWtD
aGFyID0gZnVuY3Rpb24oKSB7CiAgcmV0
dXJuIHRoaXMuYnVmLnN1YnN0cih0aGlz
LnBvcywgMSk7Cn07CgovKioKICogUmV0
dXJuIHRoZSBuZXh0IHNpbmdsZSBjaGFy
YWN0ZXIgaW4gdGhlIGJ1ZmZlciBhbmQg
YWR2YW5jZSB0aGUgcGFyc2UKICogcG9z
aXRpb24gb25lIGJ5dGUuCiAqCiAqIEBy
ZXR1cm4ge3N0cmluZ30gVGhlIG5leHQg
Y2hhcmFjdGVyIGluIHRoZSBidWZmZXIu
CiAqLwpodGVybS5WVC5QYXJzZVN0YXRl
LnByb3RvdHlwZS5jb25zdW1lQ2hhciA9
IGZ1bmN0aW9uKCkgewogIHJldHVybiB0
aGlzLmJ1Zi5zdWJzdHIodGhpcy5wb3Mr
KywgMSk7Cn07CgovKioKICogUmV0dXJu
IHRydWUgaWYgdGhlIGJ1ZmZlciBpcyBl
bXB0eSwgb3IgdGhlIHBvc2l0aW9uIGlz
IHBhc3QgdGhlIGVuZC4KICovCmh0ZXJt
LlZULlBhcnNlU3RhdGUucHJvdG90eXBl
LmlzQ29tcGxldGUgPSBmdW5jdGlvbigp
IHsKICByZXR1cm4gdGhpcy5idWYgPT0g
bnVsbCB8fCB0aGlzLmJ1Zi5sZW5ndGgg
PD0gdGhpcy5wb3M7Cn07CgpodGVybS5W
VC5DdXJzb3JTdGF0ZSA9IGZ1bmN0aW9u
KHZ0KSB7CiAgdGhpcy52dF8gPSB2dDsK
ICB0aGlzLnNhdmUoKTsKfTsKCmh0ZXJt
LlZULkN1cnNvclN0YXRlLnByb3RvdHlw
ZS5zYXZlID0gZnVuY3Rpb24oKSB7CiAg
dGhpcy5jdXJzb3IgPSB0aGlzLnZ0Xy50
ZXJtaW5hbC5zYXZlQ3Vyc29yKCk7Cgog
IHRoaXMudGV4dEF0dHJpYnV0ZXMgPSB0
aGlzLnZ0Xy50ZXJtaW5hbC5nZXRUZXh0
QXR0cmlidXRlcygpLmNsb25lKCk7Cgog
IHRoaXMuR0wgPSB0aGlzLnZ0Xy5HTDsK
ICB0aGlzLkdSID0gdGhpcy52dF8uR1I7
CgogIHRoaXMuRzAgPSB0aGlzLnZ0Xy5H
MDsKICB0aGlzLkcxID0gdGhpcy52dF8u
RzE7CiAgdGhpcy5HMiA9IHRoaXMudnRf
LkcyOwogIHRoaXMuRzMgPSB0aGlzLnZ0
Xy5HMzsKfTsKCmh0ZXJtLlZULkN1cnNv
clN0YXRlLnByb3RvdHlwZS5yZXN0b3Jl
ID0gZnVuY3Rpb24oKSB7CiAgdGhpcy52
dF8udGVybWluYWwucmVzdG9yZUN1cnNv
cih0aGlzLmN1cnNvcik7CgogIHRoaXMu
dnRfLnRlcm1pbmFsLnNldFRleHRBdHRy
aWJ1dGVzKHRoaXMudGV4dEF0dHJpYnV0
ZXMuY2xvbmUoKSk7CgogIHRoaXMudnRf
LkdMID0gdGhpcy5HTDsKICB0aGlzLnZ0
Xy5HUiA9IHRoaXMuR1I7CgogIHRoaXMu
dnRfLkcwID0gdGhpcy5HMDsKICB0aGlz
LnZ0Xy5HMSA9IHRoaXMuRzE7CiAgdGhp
cy52dF8uRzIgPSB0aGlzLkcyOwogIHRo
aXMudnRfLkczID0gdGhpcy5HMzsKfTsK
Cmh0ZXJtLlZULnByb3RvdHlwZS5yZXNl
dCA9IGZ1bmN0aW9uKCkgewogIHRoaXMu
RzAgPSBodGVybS5WVC5DaGFyYWN0ZXJN
YXAubWFwc1snQiddOwogIHRoaXMuRzEg
PSBodGVybS5WVC5DaGFyYWN0ZXJNYXAu
bWFwc1snMCddOwogIHRoaXMuRzIgPSBo
dGVybS5WVC5DaGFyYWN0ZXJNYXAubWFw
c1snQiddOwogIHRoaXMuRzMgPSBodGVy
bS5WVC5DaGFyYWN0ZXJNYXAubWFwc1sn
QiddOwoKICB0aGlzLkdMID0gJ0cwJzsK
ICB0aGlzLkdSID0gJ0cwJzsKCiAgdGhp
cy5zYXZlZFN0YXRlXyA9IG5ldyBodGVy
bS5WVC5DdXJzb3JTdGF0ZSh0aGlzKTsK
CiAgdGhpcy5tb3VzZVJlcG9ydCA9IHRo
aXMuTU9VU0VfUkVQT1JUX0RJU0FCTEVE
Owp9OwoKLyoqCiAqIEhhbmRsZSB0ZXJt
aW5hbCBtb3VzZSBldmVudHMuCiAqCiAq
IFNlZSB0aGUgIk1vdXNlIFRyYWNraW5n
IiBzZWN0aW9uIG9mIFt4dGVybV0uCiAq
LwpodGVybS5WVC5wcm90b3R5cGUub25U
ZXJtaW5hbE1vdXNlXyA9IGZ1bmN0aW9u
KGUpIHsKICBpZiAodGhpcy5tb3VzZVJl
cG9ydCA9PSB0aGlzLk1PVVNFX1JFUE9S
VF9ESVNBQkxFRCkKICAgIHJldHVybjsK
CiAgLy8gVGVtcG9yYXJ5IHN0b3JhZ2Ug
Zm9yIG91ciByZXNwb25zZS4KICB2YXIg
cmVzcG9uc2U7CgogIC8vIE1vZGlmaWVy
IGtleSBzdGF0ZS4KICB2YXIgbW9kID0g
MDsKICBpZiAoZS5zaGlmdEtleSkKICAg
IG1vZCB8PSA0OwogIGlmIChlLm1ldGFL
ZXkgfHwgKHRoaXMudGVybWluYWwua2V5
Ym9hcmQuYWx0SXNNZXRhICYmIGUuYWx0
S2V5KSkKICAgIG1vZCB8PSA4OwogIGlm
IChlLmN0cmxLZXkpCiAgICBtb2QgfD0g
MTY7CgogIC8vIFRPRE8ocmdpbmRhKTog
V2Ugc2hvdWxkIGFsc28gc3VwcG9ydCBt
b2RlIDEwMDUgYW5kL29yIDEwMDYgdG8g
ZXh0ZW5kIHRoZQogIC8vIGNvb3JkaW5h
dGUgc3BhY2UuICBUaG91Z2gsIGFmdGVy
IHBva2luZyBhcm91bmQganVzdCBhIGxp
dHRsZSwgSSB3YXNuJ3QKICAvLyBhYmxl
IHRvIGdldCB2aSBvciBlbWFjcyB0byB1
c2UgZWl0aGVyIG9mIHRoZXNlIG1vZGVz
LgogIHZhciB4ID0gU3RyaW5nLmZyb21D
aGFyQ29kZShsaWIuZi5jbGFtcChlLnRl
cm1pbmFsQ29sdW1uICsgMzIsIDMyLCAy
NTUpKTsKICB2YXIgeSA9IFN0cmluZy5m
cm9tQ2hhckNvZGUobGliLmYuY2xhbXAo
ZS50ZXJtaW5hbFJvdyArIDMyLCAzMiwg
MjU1KSk7CgogIHN3aXRjaCAoZS50eXBl
KSB7CiAgICBjYXNlICdtb3VzZXdoZWVs
JzoKICAgICAgLy8gTW91c2Ugd2hlZWwg
aXMgdHJlYXRlZCBhcyBidXR0b24gMSBv
ciAyIHBsdXMgYW4gYWRkaXRpb25hbCA2
NC4KICAgICAgYiA9ICgoZS53aGVlbERl
bHRhWSA+IDApID8gMCA6IDEpICsgOTY7
CiAgICAgIGIgfD0gbW9kOwogICAgICBy
ZXNwb25zZSA9ICdceDFiW00nICsgU3Ry
aW5nLmZyb21DaGFyQ29kZShiKSArIHgg
KyB5OwoKICAgICAgLy8gS2VlcCB0aGUg
dGVybWluYWwgZnJvbSBzY3JvbGxpbmcu
CiAgICAgIGUucHJldmVudERlZmF1bHQo
KTsKICAgICAgYnJlYWs7CgogICAgY2Fz
ZSAnbW91c2Vkb3duJzoKICAgICAgLy8g
QnV0dG9ucyBhcmUgZW5jb2RlZCBhcyBi
dXR0b24gbnVtYmVyIHBsdXMgMzIuCiAg
ICAgIHZhciBiID0gTWF0aC5taW4oZS53
aGljaCAtIDEsIDIpICsgMzI7CgogICAg
ICAvLyBBbmQgbWl4IGluIHRoZSBtb2Rp
ZmllciBrZXlzLgogICAgICBiIHw9IG1v
ZDsKCiAgICAgIHJlc3BvbnNlID0gJ1x4
MWJbTScgKyBTdHJpbmcuZnJvbUNoYXJD
b2RlKGIpICsgeCArIHk7CiAgICAgIGJy
ZWFrOwoKICAgIGNhc2UgJ21vdXNldXAn
OgogICAgICAvLyBNb3VzZSB1cCBoYXMg
bm8gaW5kaWNhdGlvbiBvZiB3aGljaCBi
dXR0b24gd2FzIHJlbGVhc2VkLgogICAg
ICByZXNwb25zZSA9ICdceDFiW01ceDIz
JyArIHggKyB5OwogICAgICBicmVhazsK
CiAgICBjYXNlICdtb3VzZW1vdmUnOgog
ICAgICBpZiAodGhpcy5tb3VzZVJlcG9y
dCA9PSB0aGlzLk1PVVNFX1JFUE9SVF9E
UkFHICYmIGUud2hpY2gpIHsKICAgICAg
ICAvLyBTdGFuZGFyZCBidXR0b24gYml0
cy4KICAgICAgICBiID0gMzIgKyBNYXRo
Lm1pbihlLndoaWNoIC0gMSwgMik7Cgog
ICAgICAgIC8vIEFkZCAzMiB0byBpbmRp
Y2F0ZSBtb3VzZSBtb3Rpb24uCiAgICAg
ICAgYiArPSAzMjsKCiAgICAgICAgLy8g
QW5kIG1peCBpbiB0aGUgbW9kaWZpZXIg
a2V5cy4KICAgICAgICBiIHw9IG1vZDsK
CiAgICAgICAgcmVzcG9uc2UgPSAnXHgx
YltNJyArIFN0cmluZy5mcm9tQ2hhckNv
ZGUoYikgKyB4ICsgeTsKICAgICAgfQoK
ICAgICAgYnJlYWs7CgogICAgY2FzZSAn
Y2xpY2snOgogICAgY2FzZSAnZGJsY2xp
Y2snOgogICAgICBicmVhazsKCiAgICBk
ZWZhdWx0OgogICAgICBjb25zb2xlLmVy
cm9yKCdVbmtub3duIG1vdXNlIGV2ZW50
OiAnICsgZS50eXBlLCBlKTsKICAgICAg
YnJlYWs7CiAgfQoKICBpZiAocmVzcG9u
c2UpCiAgICB0aGlzLnRlcm1pbmFsLmlv
LnNlbmRTdHJpbmcocmVzcG9uc2UpOwp9
OwoKLyoqCiAqIEludGVycHJldCBhIHN0
cmluZyBvZiBjaGFyYWN0ZXJzLCBkaXNw
bGF5aW5nIHRoZSByZXN1bHRzIG9uIHRo
ZSBhc3NvY2lhdGVkCiAqIHRlcm1pbmFs
IG9iamVjdC4KICoKICogVGhlIGJ1ZmZl
ciB3aWxsIGJlIGRlY29kZWQgYWNjb3Jk
aW5nIHRvIHRoZSAncmVjZWl2ZS1lbmNv
ZGluZycgcHJlZmVyZW5jZS4KICovCmh0
ZXJtLlZULnByb3RvdHlwZS5pbnRlcnBy
ZXQgPSBmdW5jdGlvbihidWYpIHsKICB0
aGlzLnBhcnNlU3RhdGVfLnJlc2V0QnVm
KHRoaXMuZGVjb2RlKGJ1ZikpOwoKICB3
aGlsZSAoIXRoaXMucGFyc2VTdGF0ZV8u
aXNDb21wbGV0ZSgpKSB7CiAgICB2YXIg
ZnVuYyA9IHRoaXMucGFyc2VTdGF0ZV8u
ZnVuYzsKICAgIHZhciBwb3MgPSB0aGlz
LnBhcnNlU3RhdGVfLnBvczsKICAgIHZh
ciBidWYgPSB0aGlzLnBhcnNlU3RhdGVf
LmJ1ZjsKCiAgICB0aGlzLnBhcnNlU3Rh
dGVfLmZ1bmMuY2FsbCh0aGlzLCB0aGlz
LnBhcnNlU3RhdGVfKTsKCiAgICBpZiAo
dGhpcy5wYXJzZVN0YXRlXy5mdW5jID09
IGZ1bmMgJiYgdGhpcy5wYXJzZVN0YXRl
Xy5wb3MgPT0gcG9zICYmCiAgICAgICAg
dGhpcy5wYXJzZVN0YXRlXy5idWYgPT0g
YnVmKSB7CiAgICAgIHRocm93ICdQYXJz
ZXIgZGlkIG5vdCBhbHRlciB0aGUgc3Rh
dGUhJzsKICAgIH0KICB9Cn07CgovKioK
ICogRGVjb2RlIGEgc3RyaW5nIGFjY29y
ZGluZyB0byB0aGUgJ3JlY2VpdmUtZW5j
b2RpbmcnIHByZWZlcmVuY2UuCiAqLwpo
dGVybS5WVC5wcm90b3R5cGUuZGVjb2Rl
ID0gZnVuY3Rpb24oc3RyKSB7CiAgaWYg
KHRoaXMuY2hhcmFjdGVyRW5jb2Rpbmcg
PT0gJ3V0Zi04JykKICAgIHJldHVybiB0
aGlzLmRlY29kZVVURjgoc3RyKTsKCiAg
cmV0dXJuIHN0cjsKfTsKCi8qKgogKiBF
bmNvZGUgYSBVVEYtMTYgc3RyaW5nIGFz
IFVURi04LgogKgogKiBTZWUgYWxzbzog
aHR0cDovL2VuLndpa2lwZWRpYS5vcmcv
d2lraS9VVEYtMTYKICovCmh0ZXJtLlZU
LnByb3RvdHlwZS5lbmNvZGVVVEY4ID0g
ZnVuY3Rpb24oc3RyKSB7CiAgcmV0dXJu
IGxpYi5lbmNvZGVVVEY4KHN0cik7Cn07
CgovKioKICogRGVjb2RlIGEgVVRGLTgg
c3RyaW5nIGludG8gVVRGLTE2LgogKi8K
aHRlcm0uVlQucHJvdG90eXBlLmRlY29k
ZVVURjggPSBmdW5jdGlvbihzdHIpIHsK
ICByZXR1cm4gdGhpcy51dGY4RGVjb2Rl
cl8uZGVjb2RlKHN0cik7Cn07CgovKioK
ICogVGhlIGRlZmF1bHQgcGFyc2UgZnVu
Y3Rpb24uCiAqCiAqIFRoaXMgd2lsbCBz
Y2FuIHRoZSBzdHJpbmcgZm9yIHRoZSBm
aXJzdCAxLWJ5dGUgY29udHJvbCBjaGFy
YWN0ZXIgKEMwL0MxCiAqIGNoYXJhY3Rl
cnMgZnJvbSBbQ1RSTF0pLiAgQW55IHBs
YWluIHRleHQgY29taW5nIGJlZm9yZSB0
aGUgY29kZSB3aWxsIGJlCiAqIHByaW50
ZWQgdG8gdGhlIHRlcm1pbmFsLCB0aGVu
IHRoZSBjb250cm9sIGNoYXJhY3RlciB3
aWxsIGJlIGRpc3BhdGNoZWQuCiAqLwpo
dGVybS5WVC5wcm90b3R5cGUucGFyc2VV
bmtub3duXyA9IGZ1bmN0aW9uKHBhcnNl
U3RhdGUpIHsKICB2YXIgc2VsZiA9IHRo
aXM7CgogIGZ1bmN0aW9uIHByaW50KHN0
cikgewogICAgaWYgKHNlbGZbc2VsZi5H
TF0uR0wpCiAgICAgIHN0ciA9IHNlbGZb
c2VsZi5HTF0uR0woc3RyKTsKCiAgICBp
ZiAoc2VsZltzZWxmLkdSXS5HUikKICAg
ICAgc3RyID0gc2VsZltzZWxmLkdSXS5H
UihzdHIpOwoKICAgIHNlbGYudGVybWlu
YWwucHJpbnQoc3RyKTsKICB9OwoKICAv
LyBTZWFyY2ggZm9yIHRoZSBuZXh0IGNv
bnRpZ3VvdXMgYmxvY2sgb2YgcGxhaW4g
dGV4dC4KICB2YXIgYnVmID0gcGFyc2VT
dGF0ZS5wZWVrUmVtYWluaW5nQnVmKCk7
CiAgdmFyIG5leHRDb250cm9sID0gYnVm
LnNlYXJjaCh0aGlzLmNjMVBhdHRlcm5f
KTsKCiAgaWYgKG5leHRDb250cm9sID09
IDApIHsKICAgIC8vIFdlJ3ZlIHN0dW1i
bGVkIHJpZ2h0IGludG8gYSBjb250cm9s
IGNoYXJhY3Rlci4KICAgIHRoaXMuZGlz
cGF0Y2goJ0NDMScsIGJ1Zi5zdWJzdHIo
MCwgMSksIHBhcnNlU3RhdGUpOwogICAg
cGFyc2VTdGF0ZS5hZHZhbmNlKDEpOwog
ICAgcmV0dXJuOwogIH0KCiAgaWYgKG5l
eHRDb250cm9sID09IC0xKSB7CiAgICAv
LyBUaGVyZSBhcmUgbm8gY29udHJvbCBj
aGFyYWN0ZXJzIGluIHRoaXMgc3RyaW5n
LgogICAgcHJpbnQoYnVmKTsKICAgIHBh
cnNlU3RhdGUucmVzZXQoKTsKICAgIHJl
dHVybjsKICB9CgogIHByaW50KGJ1Zi5z
dWJzdHIoMCwgbmV4dENvbnRyb2wpKTsK
ICB0aGlzLmRpc3BhdGNoKCdDQzEnLCBi
dWYuc3Vic3RyKG5leHRDb250cm9sLCAx
KSwgcGFyc2VTdGF0ZSk7CiAgcGFyc2VT
dGF0ZS5hZHZhbmNlKG5leHRDb250cm9s
ICsgMSk7Cn07CgovKioKICogUGFyc2Ug
YSBDb250cm9sIFNlcXVlbmNlIEludHJv
ZHVjZXIgY29kZSBhbmQgZGlzcGF0Y2gg
aXQuCiAqCiAqIFNlZSBbQ1NJXSBmb3Ig
c29tZSB1c2VmdWwgaW5mb3JtYXRpb24g
YWJvdXQgdGhlc2UgY29kZXMuCiAqLwpo
dGVybS5WVC5wcm90b3R5cGUucGFyc2VD
U0lfID0gZnVuY3Rpb24ocGFyc2VTdGF0
ZSkgewogIHZhciBjaCA9IHBhcnNlU3Rh
dGUucGVla0NoYXIoKTsKICB2YXIgYXJn
cyA9IHBhcnNlU3RhdGUuYXJnczsKCiAg
aWYgKGNoID49ICdAJyAmJiBjaCA8PSAn
ficpIHsKICAgIC8vIFRoaXMgaXMgdGhl
IGZpbmFsIGNoYXJhY3Rlci4KICAgIHRo
aXMuZGlzcGF0Y2goJ0NTSScsIHRoaXMu
bGVhZGluZ01vZGlmaWVyXyArIHRoaXMu
dHJhaWxpbmdNb2RpZmllcl8gKyBjaCwK
ICAgICAgICAgICAgICAgICAgcGFyc2VT
dGF0ZSk7CiAgICBwYXJzZVN0YXRlLnJl
c2V0UGFyc2VGdW5jdGlvbigpOwoKICB9
IGVsc2UgaWYgKGNoID09ICc7Jykgewog
ICAgLy8gUGFyYW1ldGVyIGRlbGltZXRl
ci4KICAgIGlmICh0aGlzLnRyYWlsaW5n
TW9kaWZpZXJfKSB7CiAgICAgIC8vIFBh
cmFtZXRlciBkZWxpbWl0ZXIgYWZ0ZXIg
dGhlIHRyYWlsaW5nIG1vZGlmaWVyLiAg
VGhhdCdzIGEgcGFkZGxpbicuCiAgICAg
IHBhcnNlU3RhdGUucmVzZXRQYXJzZUZ1
bmN0aW9uKCk7CgogICAgfSBlbHNlIHsK
ICAgICAgaWYgKCFhcmdzLmxlbmd0aCkg
ewogICAgICAgIC8vIFRoZXkgb21pdHRl
ZCB0aGUgZmlyc3QgcGFyYW0sIHdlIG5l
ZWQgdG8gc3VwcGx5IGl0LgogICAgICAg
IGFyZ3MucHVzaCgnJyk7CiAgICAgIH0K
CiAgICAgIGFyZ3MucHVzaCgnJyk7CiAg
ICB9CgogIH0gZWxzZSBpZiAoY2ggPj0g
JzAnICYmIGNoIDw9ICc5JykgewogICAg
Ly8gTmV4dCBieXRlIGluIHRoZSBjdXJy
ZW50IHBhcmFtZXRlci4KCiAgICBpZiAo
dGhpcy50cmFpbGluZ01vZGlmaWVyXykg
ewogICAgICAvLyBOdW1lcmljIHBhcmFt
ZXRlciBhZnRlciB0aGUgdHJhaWxpbmcg
bW9kaWZpZXIuICBUaGF0J3MgYSBwYWRk
bGluJy4KICAgICAgcGFyc2VTdGF0ZS5y
ZXNldFBhcnNlRnVuY3Rpb24oKTsKICAg
IH0gZWxzZSB7CiAgICAgIGlmICghYXJn
cy5sZW5ndGgpIHsKICAgICAgICBhcmdz
WzBdID0gY2g7CiAgICAgIH0gZWxzZSB7
CiAgICAgICAgYXJnc1thcmdzLmxlbmd0
aCAtIDFdICs9IGNoOwogICAgICB9CiAg
ICB9CgogIH0gZWxzZSBpZiAoY2ggPj0g
JyAnICYmIGNoIDw9ICc/JyAmJiBjaCAh
PSAnOicpIHsKICAgIC8vIE1vZGlmaWVy
IGNoYXJhY3Rlci4KICAgIGlmICghYXJn
cy5sZW5ndGgpIHsKICAgICAgdGhpcy5s
ZWFkaW5nTW9kaWZpZXJfICs9IGNoOwog
ICAgfSBlbHNlIHsKICAgICAgdGhpcy50
cmFpbGluZ01vZGlmaWVyXyArPSBjaDsK
ICAgIH0KCiAgfSBlbHNlIGlmICh0aGlz
LmNjMVBhdHRlcm5fLnRlc3QoY2gpKSB7
CiAgICAvLyBDb250cm9sIGNoYXJhY3Rl
ci4KICAgIHRoaXMuZGlzcGF0Y2goJ0ND
MScsIGNoLCBwYXJzZVN0YXRlKTsKCiAg
fSBlbHNlIHsKICAgIC8vIFVuZXhwZWN0
ZWQgY2hhcmFjdGVyIGluIHNlcXVlbmNl
LCBiYWlsIG91dC4KICAgIHBhcnNlU3Rh
dGUucmVzZXRQYXJzZUZ1bmN0aW9uKCk7
CiAgfQoKICBwYXJzZVN0YXRlLmFkdmFu
Y2UoMSk7Cn07CgovKioKICogU2tpcCBv
dmVyIHRoZSBzdHJpbmcgdW50aWwgdGhl
IG5leHQgU3RyaW5nIFRlcm1pbmF0b3Ig
KFNULCAnRVNDIFwnKSBvcgogKiBCZWxs
IChCRUwsICdceDA3JykuCiAqCiAqIFRo
ZSBzdHJpbmcgaXMgYWNjdW11bGF0ZWQg
aW4gcGFyc2VTdGF0ZS5hcmdzWzBdLiAg
TWFrZSBzdXJlIHRvIHJlc2V0IHRoZQog
KiBhcmd1bWVudHMgKHdpdGggcGFyc2VT
dGF0ZS5yZXNldEFyZ3VtZW50cykgYmVm
b3JlIHN0YXJ0aW5nIHRoZSBwYXJzZS4K
ICoKICogWW91IGNhbiBkZXRlY3QgdGhh
dCBwYXJzaW5nIGluIGNvbXBsZXRlIGJ5
IGNoZWNraW5nIHRoYXQgdGhlIHBhcnNl
CiAqIGZ1bmN0aW9uIGhhcyBjaGFuZ2Vk
IGJhY2sgdG8gdGhlIGRlZmF1bHQgcGFy
c2UgZnVuY3Rpb24uCiAqCiAqIElmIHdl
IGVuY291bnRlciBtb3JlIHRoYW4gbWF4
U3RyaW5nU2VxdWVuY2UgY2hhcmFjdGVy
cywgd2Ugc2VuZCBiYWNrCiAqIHRoZSB1
bnRlcm1pbmF0ZWQgc2VxdWVuY2UgdG8g
YmUgcmUtcGFyc2VkIHdpdGggdGhlIGRl
ZmF1bHQgcGFyc2VyIGZ1bmN0aW9uLgog
KgogKiBAcmV0dXJuIHtib29sZWFufSBJ
ZiB0cnVlLCBwYXJzaW5nIGlzIG9uZ29p
bmcgb3IgY29tcGxldGUuICBJZiBmYWxz
ZSwgd2UndmUKICogICAgIGV4Y2VlZGVk
IHRoZSBtYXggc3RyaW5nIHNlcXVlbmNl
LgogKi8KaHRlcm0uVlQucHJvdG90eXBl
LnBhcnNlVW50aWxTdHJpbmdUZXJtaW5h
dG9yXyA9IGZ1bmN0aW9uKHBhcnNlU3Rh
dGUpIHsKICB2YXIgYnVmID0gcGFyc2VT
dGF0ZS5wZWVrUmVtYWluaW5nQnVmKCk7
CiAgdmFyIG5leHRUZXJtaW5hdG9yID0g
YnVmLnNlYXJjaCgvKFx4MWJcXHxceDA3
KS8pOwogIHZhciBhcmdzID0gcGFyc2VT
dGF0ZS5hcmdzOwoKICBpZiAoIWFyZ3Mu
bGVuZ3RoKSB7CiAgICBhcmdzWzBdID0g
Jyc7CiAgICBhcmdzWzFdID0gbmV3IERh
dGUoKTsKICB9CgogIGlmIChuZXh0VGVy
bWluYXRvciA9PSAtMSkgewogICAgLy8g
Tm8gdGVybWluYXRvciBoZXJlLCBoYXZl
IHRvIHdhaXQgZm9yIHRoZSBuZXh0IHN0
cmluZy4KCiAgICBhcmdzWzBdICs9IGJ1
ZjsKCiAgICB2YXIgYWJvcnRSZWFzb247
CgogICAgaWYgKGFyZ3NbMF0ubGVuZ3Ro
ID4gdGhpcy5tYXhTdHJpbmdTZXF1ZW5j
ZSkKICAgICAgYWJvcnRSZWFzb24gPSAn
dG9vIGxvbmc6ICcgKyBhcmdzWzBdLmxl
bmd0aDsKCiAgICBpZiAoYXJnc1swXS5p
bmRleE9mKCdceDFiJykgIT0gLTEpCiAg
ICAgIGFib3J0UmVhc29uID0gJ2VtYmVk
ZGVkIGVzY2FwZTogJyArIGFyZ3NbMF0u
aW5kZXhPZignXHgxYicpOwoKICAgIGlm
IChuZXcgRGF0ZSgpIC0gYXJnc1sxXSA+
IHRoaXMub3NjVGltZUxpbWl0XykKICAg
ICAgYWJvcnRSZWFzb24gPSAndGltZW91
dCBleHBpcmVkOiAnICsgbmV3IERhdGUo
KSAtIGFyZ3NbMV07CgogICAgaWYgKGFi
b3J0UmVhc29uKSB7CiAgICAgIGNvbnNv
bGUubG9nKCdwYXJzZVVudGlsU3RyaW5n
VGVybWluYXRvcl86IGFib3J0aW5nOiAn
ICsgYWJvcnRSZWFzb24sCiAgICAgICAg
ICAgICAgICAgIGFyZ3NbMF0pOwogICAg
ICBwYXJzZVN0YXRlLnJlc2V0KGFyZ3Nb
MF0pOwogICAgICByZXR1cm4gZmFsc2U7
CiAgICB9CgogICAgcGFyc2VTdGF0ZS5h
ZHZhbmNlKGJ1Zi5sZW5ndGgpOwogICAg
cmV0dXJuIHRydWU7CiAgfQoKICBpZiAo
YXJnc1swXS5sZW5ndGggKyBuZXh0VGVy
bWluYXRvciA+IHRoaXMubWF4U3RyaW5n
U2VxdWVuY2UpIHsKICAgIC8vIFdlIGZv
dW5kIHRoZSBlbmQgb2YgdGhlIHNlcXVl
bmNlLCBidXQgd2Ugc3RpbGwgdGhpbmsg
aXQncyB0b28gbG9uZy4KICAgIHBhcnNl
U3RhdGUucmVzZXQoYXJnc1swXSArIGJ1
Zik7CiAgICByZXR1cm4gZmFsc2U7CiAg
fQoKICBhcmdzWzBdICs9IGJ1Zi5zdWJz
dHIoMCwgbmV4dFRlcm1pbmF0b3IpOwoK
ICBwYXJzZVN0YXRlLnJlc2V0UGFyc2VG
dW5jdGlvbigpOwogIHBhcnNlU3RhdGUu
YWR2YW5jZShuZXh0VGVybWluYXRvciAr
CiAgICAgICAgICAgICAgICAgICAgIChi
dWYuc3Vic3RyKG5leHRUZXJtaW5hdG9y
LCAxKSA9PSAnXHgxYicgPyAyIDogMSkp
OwoKICByZXR1cm4gdHJ1ZTsKfTsKCi8q
KgogKiBEaXNwYXRjaCB0byB0aGUgZnVu
Y3Rpb24gdGhhdCBoYW5kbGVzIGEgZ2l2
ZW4gQ0MxLCBFU0MsIG9yIENTSSBvciBW
VDUyIGNvZGUuCiAqLwpodGVybS5WVC5w
cm90b3R5cGUuZGlzcGF0Y2ggPSBmdW5j
dGlvbih0eXBlLCBjb2RlLCBwYXJzZVN0
YXRlKSB7CiAgdmFyIGhhbmRsZXIgPSBo
dGVybS5WVFt0eXBlXVtjb2RlXTsKICBp
ZiAoIWhhbmRsZXIpIHsKICAgIGlmICh0
aGlzLndhcm5VbmltcGxlbWVudGVkKQog
ICAgICBjb25zb2xlLndhcm4oJ1Vua25v
d24gJyArIHR5cGUgKyAnIGNvZGU6ICcg
KyBKU09OLnN0cmluZ2lmeShjb2RlKSk7
CiAgICByZXR1cm47CiAgfQoKICBpZiAo
aGFuZGxlciA9PSBodGVybS5WVC5pZ25v
cmUpIHsKICAgIGlmICh0aGlzLndhcm5V
bmltcGxlbWVudGVkKQogICAgICBjb25z
b2xlLndhcm4oJ0lnbm9yZWQgJyArIHR5
cGUgKyAnIGNvZGU6ICcgKyBKU09OLnN0
cmluZ2lmeShjb2RlKSk7CiAgICByZXR1
cm47CiAgfQoKICBpZiAodHlwZSA9PSAn
Q0MxJyAmJiBjb2RlID4gJ1x4N2YnICYm
ICF0aGlzLmVuYWJsZThCaXRDb250cm9s
KSB7CiAgICAvLyBJdCdzIGtpbmQgb2Yg
YSBoYWNrIHRvIHB1dCB0aGlzIGhlcmUs
IGJ1dC4uLgogICAgLy8KICAgIC8vIElm
IHdlJ3JlIGRpc3BhdGNoaW5nIGEgJ0ND
MScgY29kZSwgYW5kIGl0J3MgZ290IHRo
ZSBlaWdodGggYml0IHNldCwKICAgIC8v
IGJ1dCB3ZSdyZSBub3Qgc3VwcG9zZWQg
dG8gaGFuZGxlIDgtYml0IGNvZGVzPyAg
SnVzdCBpZ25vcmUgaXQuCiAgICAvLwog
ICAgLy8gVGhpcyBwcmV2ZW50cyBhbiBl
cnJhbnQgKERDUywgJ1x4OTAnKSwgKE9T
QywgJ1x4OWQnKSwgKFBNLCAnXHg5ZScp
IG9yCiAgICAvLyAoQVBDLCAnXHg5Zicp
IGZyb20gbG9ja2luZyB1cCB0aGUgdGVy
bWluYWwgd2FpdGluZyBmb3IgaXRzIGV4
cGVjdGVkCiAgICAvLyAoU1QsICdceDlj
Jykgb3IgKEJFTCwgJ1x4MDcnKS4KICAg
IGNvbnNvbGUud2FybignSWdub3Jpbmcg
OC1iaXQgY29udHJvbCBjb2RlOiAweCcg
KwogICAgICAgICAgICAgICAgIGNvZGUu
Y2hhckNvZGVBdCgwKS50b1N0cmluZygx
NikpOwogICAgcmV0dXJuOwogIH0KCiAg
aGFuZGxlci5hcHBseSh0aGlzLCBbcGFy
c2VTdGF0ZSwgY29kZV0pOwp9OwoKLyoq
CiAqIFNldCBvbmUgb2YgdGhlIEFOU0kg
ZGVmaW5lZCB0ZXJtaW5hbCBtb2RlIGJp
dHMuCiAqCiAqIEludm9rZWQgaW4gcmVz
cG9uc2UgdG8gU00vUk0uCiAqCiAqIEV4
cGVjdGVkIHZhbHVlcyBmb3IgY29kZToK
ICogICAyIC0gS2V5Ym9hcmQgQWN0aW9u
IE1vZGUgKEFNKS4gIFdpbGwgbm90IGlt
cGxlbWVudC4KICogICA0IC0gSW5zZXJ0
IE1vZGUgKElSTSkuCiAqICAgMTIgLSBT
ZW5kL3JlY2VpdmUgKFNSTSkuICBXaWxs
IG5vdCBpbXBsZW1lbnQuCiAqICAgMjAg
LSBBdXRvbWF0aWMgTmV3bGluZSAoTE5N
KS4KICoKICogVW5leHBlY3RlZCBhbmQg
dW5pbXBsZW1lbnRlZCB2YWx1ZXMgYXJl
IHNpbGVudGx5IGlnbm9yZWQuCiAqLwpo
dGVybS5WVC5wcm90b3R5cGUuc2V0QU5T
SU1vZGUgPSBmdW5jdGlvbihjb2RlLCBz
dGF0ZSkgewogIGlmIChjb2RlID09ICc0
JykgewogICAgdGhpcy50ZXJtaW5hbC5z
ZXRJbnNlcnRNb2RlKHN0YXRlKTsKICB9
IGVsc2UgaWYgKGNvZGUgPT0gJzIwJykg
ewogICAgdGhpcy50ZXJtaW5hbC5zZXRB
dXRvQ2FycmlhZ2VSZXR1cm4oc3RhdGUp
OwogIH0gZWxzZSBpZiAodGhpcy53YXJu
VW5pbXBsZW1lbnRlZCkgewogICAgY29u
c29sZS53YXJuKCdVbmltcGxlbWVudGVk
IEFOU0kgTW9kZTogJyArIGNvZGUpOwog
IH0KfTsKCi8qKgogKiBTZXQgb3IgcmVz
ZXQgb25lIG9mIHRoZSBERUMgUHJpdmF0
ZSBtb2Rlcy4KICoKICogSW52b2tlZCBp
biByZXNwb25zZSB0byBERUNTRVQvREVD
UlNULgogKgogKiBFeHBlY3RlZCB2YWx1
ZXMgZm9yIGNvZGU6CiAqICAgICAgMSAt
IEFwcGxpY2F0aW9uIEN1cnNvciBLZXlz
IChERUNDS00pLgogKiAgICAgIDIgLSBb
IV0gRGVzaWduYXRlIFVTQVNDSUkgZm9y
IGNoYXJhY3RlciBzZXRzIEcwLUczIChE
RUNBTk0pLCBhbmQgc2V0CiAqICAgICAg
ICAgIFZUMTAwIG1vZGUuCiAqICAgICAg
MyAtIDEzMiBDb2x1bW4gTW9kZSAoREVD
Q09MTSkuCiAqICAgICAgNCAtIFt4XSBT
bW9vdGggKFNsb3cpIFNjcm9sbCAoREVD
U0NMTSkuCiAqICAgICAgNSAtIFJldmVy
c2UgVmlkZW8gKERFQ1NDTk0pLgogKiAg
ICAgIDYgLSBPcmlnaW4gTW9kZSAoREVD
T00pLgogKiAgICAgIDcgLSBXcmFwYXJv
dW5kIE1vZGUgKERFQ0FXTSkuCiAqICAg
ICAgOCAtIFt4XSBBdXRvLXJlcGVhdCBL
ZXlzIChERUNBUk0pLgogKiAgICAgIDkg
LSBbIV0gU2VuZCBNb3VzZSBYICYgWSBv
biBidXR0b24gcHJlc3MuCiAqICAgICAx
MCAtIFt4XSBTaG93IHRvb2xiYXIgKHJ4
dnQpLgogKiAgICAgMTIgLSBTdGFydCBC
bGlua2luZyBDdXJzb3IgKGF0dDYxMCku
CiAqICAgICAxOCAtIFshXSBQcmludCBm
b3JtIGZlZWQgKERFQ1BGRikuCiAqICAg
ICAxOSAtIFt4XSBTZXQgcHJpbnQgZXh0
ZW50IHRvIGZ1bGwgc2NyZWVuIChERUNQ
RVgpLgogKiAgICAgMjUgLSBTaG93IEN1
cnNvciAoREVDVENFTSkuCiAqICAgICAz
MCAtIFshXSBTaG93IHNjcm9sbGJhciAo
cnh2dCkuCiAqICAgICAzNSAtIFt4XSBF
bmFibGUgZm9udC1zaGlmdGluZyBmdW5j
dGlvbnMgKHJ4dnQpLgogKiAgICAgMzgg
LSBbeF0gRW50ZXIgVGVrdHJvbml4IE1v
ZGUgKERFQ1RFSykuCiAqICAgICA0MCAt
IEFsbG93IDgwIC0gMTMyIE1vZGUuCiAq
ICAgICA0MSAtIFshXSBtb3JlKDEpIGZp
eCAoc2VlIGN1cnNlcyByZXNvdXJjZSku
CiAqICAgICA0MiAtIFshXSBFbmFibGUg
TmF0aW9uIFJlcGxhY2VtZW50IENoYXJh
Y3RlciBzZXRzIChERUNOUkNNKS4KICog
ICAgIDQ0IC0gWyFdIFR1cm4gT24gTWFy
Z2luIEJlbGwuCiAqICAgICA0NSAtIFJl
dmVyc2Utd3JhcGFyb3VuZCBNb2RlLgog
KiAgICAgNDYgLSBbeF0gU3RhcnQgTG9n
Z2luZy4KICogICAgIDQ3IC0gWyFdIFVz
ZSBBbHRlcm5hdGUgU2NyZWVuIEJ1ZmZl
ci4KICogICAgIDY2IC0gWyFdIEFwcGxp
Y2F0aW9uIGtleXBhZCAoREVDTktNKS4K
ICogICAgIDY3IC0gQmFja2Fycm93IGtl
eSBzZW5kcyBiYWNrc3BhY2UgKERFQ0JL
TSkuCiAqICAgMTAwMCAtIFNlbmQgTW91
c2UgWCAmIFkgb24gYnV0dG9uIHByZXNz
IGFuZCByZWxlYXNlLiAgKE1PVVNFX1JF
UE9SVF9DTElDSykKICogICAxMDAxIC0g
WyFdIFVzZSBIaWxpdGUgTW91c2UgVHJh
Y2tpbmcuCiAqICAgMTAwMiAtIFVzZSBD
ZWxsIE1vdGlvbiBNb3VzZSBUcmFja2lu
Zy4gIChNT1VTRV9SRVBPUlRfRFJBRykK
ICogICAxMDAzIC0gWyFdIFVzZSBBbGwg
TW90aW9uIE1vdXNlIFRyYWNraW5nLgog
KiAgIDEwMDQgLSBbIV0gU2VuZCBGb2N1
c0luL0ZvY3VzT3V0IGV2ZW50cy4KICog
ICAxMDA1IC0gWyFdIEVuYWJsZSBFeHRl
bmRlZCBNb3VzZSBNb2RlLgogKiAgIDEw
MTAgLSBTY3JvbGwgdG8gYm90dG9tIG9u
IHR0eSBvdXRwdXQgKHJ4dnQpLgogKiAg
IDEwMTEgLSBTY3JvbGwgdG8gYm90dG9t
IG9uIGtleSBwcmVzcyAocnh2dCkuCiAq
ICAgMTAzNCAtIFt4XSBJbnRlcnByZXQg
Im1ldGEiIGtleSwgc2V0cyBlaWdodGgg
Yml0LgogKiAgIDEwMzUgLSBbeF0gRW5h
YmxlIHNwZWNpYWwgbW9kaWZpZXJzIGZv
ciBBbHQgYW5kIE51bUxvY2sga2V5cy4K
ICogICAxMDM2IC0gU2VuZCBFU0Mgd2hl
biBNZXRhIG1vZGlmaWVzIGEga2V5Lgog
KiAgIDEwMzcgLSBbIV0gU2VuZCBERUwg
ZnJvbSB0aGUgZWRpdGluZy1rZXlwYWQg
RGVsZXRlIGtleS4KICogICAxMDM5IC0g
U2VuZCBFU0Mgd2hlbiBBbHQgbW9kaWZp
ZXMgYSBrZXkuCiAqICAgMTA0MCAtIFt4
XSBLZWVwIHNlbGVjdGlvbiBldmVuIGlm
IG5vdCBoaWdobGlnaHRlZC4KICogICAx
MDQxIC0gW3hdIFVzZSB0aGUgQ0xJUEJP
QVJEIHNlbGVjdGlvbi4KICogICAxMDQy
IC0gWyFdIEVuYWJsZSBVcmdlbmN5IHdp
bmRvdyBtYW5hZ2VyIGhpbnQgd2hlbiBD
b250cm9sLUcgaXMgcmVjZWl2ZWQuCiAq
ICAgMTA0MyAtIFshXSBFbmFibGUgcmFp
c2luZyBvZiB0aGUgd2luZG93IHdoZW4g
Q29udHJvbC1HIGlzIHJlY2VpdmVkLgog
KiAgIDEwNDcgLSBbIV0gVXNlIEFsdGVy
bmF0ZSBTY3JlZW4gQnVmZmVyLgogKiAg
IDEwNDggLSBTYXZlIGN1cnNvciBhcyBp
biBERUNTQy4KICogICAxMDQ5IC0gU2F2
ZSBjdXJzb3IgYXMgaW4gREVDU0MgYW5k
IHVzZSBBbHRlcm5hdGUgU2NyZWVuIEJ1
ZmZlciwgY2xlYXJpbmcKICogICAgICAg
ICAgaXQgZmlyc3QuIChUaGlzIG1heSBi
ZSBkaXNhYmxlZCBieSB0aGUgdGl0ZUlu
aGliaXQgcmVzb3VyY2UpLiBUaGlzCiAq
ICAgICAgICAgIGNvbWJpbmVzIHRoZSBl
ZmZlY3RzIG9mIHRoZSAxMDQ3IGFuZCAx
MDQ4IG1vZGVzLiBVc2UgdGhpcyB3aXRo
CiAqICAgICAgICAgIHRlcm1pbmZvLWJh
c2VkIGFwcGxpY2F0aW9ucyByYXRoZXIg
dGhhbiB0aGUgNDcgbW9kZS4KICogICAx
MDUwIC0gWyFdIFNldCB0ZXJtaW5mby90
ZXJtY2FwIGZ1bmN0aW9uLWtleSBtb2Rl
LgogKiAgIDEwNTEgLSBbeF0gU2V0IFN1
biBmdW5jdGlvbi1rZXkgbW9kZS4KICog
ICAxMDUyIC0gW3hdIFNldCBIUCBmdW5j
dGlvbi1rZXkgbW9kZS4KICogICAxMDUz
IC0gW3hdIFNldCBTQ08gZnVuY3Rpb24t
a2V5IG1vZGUuCiAqICAgMTA2MCAtIFt4
XSBTZXQgbGVnYWN5IGtleWJvYXJkIGVt
dWxhdGlvbiAoWDExUjYpLgogKiAgIDEw
NjEgLSBbIV0gU2V0IFZUMjIwIGtleWJv
YXJkIGVtdWxhdGlvbi4KICogICAyMDA0
IC0gU2V0IGJyYWNrZXRlZCBwYXN0ZSBt
b2RlLgogKgogKiBbIV0gLSBOb3QgY3Vy
cmVudGx5IGltcGxlbWVudGVkLCBtYXkg
YmUgaW4gdGhlIGZ1dHVyZS4KICogW3hd
IC0gV2lsbCBub3QgaW1wbGVtZW50Lgog
Ki8KaHRlcm0uVlQucHJvdG90eXBlLnNl
dERFQ01vZGUgPSBmdW5jdGlvbihjb2Rl
LCBzdGF0ZSkgewogIHN3aXRjaCAoY29k
ZSkgewogICAgY2FzZSAnMSc6ICAvLyBE
RUNDS00KICAgICAgdGhpcy50ZXJtaW5h
bC5rZXlib2FyZC5hcHBsaWNhdGlvbkN1
cnNvciA9IHN0YXRlOwogICAgICBicmVh
azsKCiAgICBjYXNlICczJzogIC8vIERF
Q0NPTE0KICAgICAgaWYgKHRoaXMuYWxs
b3dDb2x1bW5XaWR0aENoYW5nZXNfKSB7
CiAgICAgICAgdGhpcy50ZXJtaW5hbC5z
ZXRXaWR0aChzdGF0ZSA/IDEzMiA6IDgw
KTsKCiAgICAgICAgdGhpcy50ZXJtaW5h
bC5jbGVhckhvbWUoKTsKICAgICAgICB0
aGlzLnRlcm1pbmFsLnNldFZUU2Nyb2xs
UmVnaW9uKG51bGwsIG51bGwpOwogICAg
ICB9CiAgICAgIGJyZWFrOwoKICAgIGNh
c2UgJzUnOiAgLy8gREVDU0NOTQogICAg
ICB0aGlzLnRlcm1pbmFsLnNldFJldmVy
c2VWaWRlbyhzdGF0ZSk7CiAgICAgIGJy
ZWFrOwoKICAgIGNhc2UgJzYnOiAgLy8g
REVDT00KICAgICAgdGhpcy50ZXJtaW5h
bC5zZXRPcmlnaW5Nb2RlKHN0YXRlKTsK
ICAgICAgYnJlYWs7CgogICAgY2FzZSAn
Nyc6ICAvLyBERUNBV00KICAgICAgdGhp
cy50ZXJtaW5hbC5zZXRXcmFwYXJvdW5k
KHN0YXRlKTsKICAgICAgYnJlYWs7Cgog
ICAgY2FzZSAnMTInOiAgLy8gYXR0NjEw
CiAgICAgIGlmICh0aGlzLmVuYWJsZURl
YzEyKQogICAgICAgIHRoaXMudGVybWlu
YWwuc2V0Q3Vyc29yQmxpbmsoc3RhdGUp
OwogICAgICBicmVhazsKCiAgICBjYXNl
ICcyNSc6ICAvLyBERUNUQ0VNCiAgICAg
IHRoaXMudGVybWluYWwuc2V0Q3Vyc29y
VmlzaWJsZShzdGF0ZSk7CiAgICAgIGJy
ZWFrOwoKICAgIGNhc2UgJzQwJzogIC8v
IG5vLXNwZWMKICAgICAgdGhpcy50ZXJt
aW5hbC5hbGxvd0NvbHVtbldpZHRoQ2hh
bmdlc18gPSBzdGF0ZTsKICAgICAgYnJl
YWs7CgogICAgY2FzZSAnNDUnOiAgLy8g
bm8tc3BlYwogICAgICB0aGlzLnRlcm1p
bmFsLnNldFJldmVyc2VXcmFwYXJvdW5k
KHN0YXRlKTsKICAgICAgYnJlYWs7Cgog
ICAgY2FzZSAnNjcnOiAgLy8gREVDQktN
CiAgICAgIHRoaXMudGVybWluYWwua2V5
Ym9hcmQuYmFja3NwYWNlU2VuZHNCYWNr
c3BhY2UgPSBzdGF0ZTsKICAgICAgYnJl
YWs7CgogICAgY2FzZSAnMTAwMCc6ICAv
LyBSZXBvcnQgb24gbW91c2UgY2xpY2tz
IG9ubHkuCiAgICAgIHRoaXMubW91c2VS
ZXBvcnQgPSAoCiAgICAgICAgICBzdGF0
ZSA/IHRoaXMuTU9VU0VfUkVQT1JUX0NM
SUNLIDogdGhpcy5NT1VTRV9SRVBPUlRf
RElTQUJMRUQpOwogICAgICBicmVhazsK
CiAgICBjYXNlICcxMDAyJzogIC8vIFJl
cG9ydCBvbiBtb3VzZSBjbGlja3MgYW5k
IGRyYWdzCiAgICAgIHRoaXMubW91c2VS
ZXBvcnQgPSAoCiAgICAgICAgICBzdGF0
ZSA/IHRoaXMuTU9VU0VfUkVQT1JUX0RS
QUcgOiB0aGlzLk1PVVNFX1JFUE9SVF9E
SVNBQkxFRCk7CiAgICAgIGJyZWFrOwoK
ICAgIGNhc2UgJzEwMTAnOiAgLy8gcnh2
dAogICAgICB0aGlzLnRlcm1pbmFsLnNj
cm9sbE9uT3V0cHV0ID0gc3RhdGU7CiAg
ICAgIGJyZWFrOwoKICAgIGNhc2UgJzEw
MTEnOiAgLy8gcnh2dAogICAgICB0aGlz
LnRlcm1pbmFsLnNjcm9sbE9uS2V5c3Ry
b2tlID0gc3RhdGU7CiAgICAgIGJyZWFr
OwoKICAgIGNhc2UgJzEwMzYnOiAgLy8g
bm8tc3BlYwogICAgICB0aGlzLnRlcm1p
bmFsLmtleWJvYXJkLm1ldGFTZW5kc0Vz
Y2FwZSA9IHN0YXRlOwogICAgICBicmVh
azsKCiAgICBjYXNlICcxMDM5JzogIC8v
IG5vLXNwZWMKICAgICAgaWYgKHN0YXRl
KSB7CiAgICAgICAgaWYgKCF0aGlzLnRl
cm1pbmFsLmtleWJvYXJkLnByZXZpb3Vz
QWx0U2VuZHNXaGF0XykgewogICAgICAg
ICAgdGhpcy50ZXJtaW5hbC5rZXlib2Fy
ZC5wcmV2aW91c0FsdFNlbmRzV2hhdF8g
PQogICAgICAgICAgICAgIHRoaXMudGVy
bWluYWwua2V5Ym9hcmQuYWx0U2VuZHNX
aGF0OwogICAgICAgICAgdGhpcy50ZXJt
aW5hbC5rZXlib2FyZC5hbHRTZW5kc1do
YXQgPSAnZXNjYXBlJzsKICAgICAgICB9
CiAgICAgIH0gZWxzZSBpZiAodGhpcy50
ZXJtaW5hbC5rZXlib2FyZC5wcmV2aW91
c0FsdFNlbmRzV2hhdF8pIHsKICAgICAg
ICB0aGlzLnRlcm1pbmFsLmtleWJvYXJk
LmFsdFNlbmRzV2hhdCA9CiAgICAgICAg
ICAgIHRoaXMudGVybWluYWwua2V5Ym9h
cmQucHJldmlvdXNBbHRTZW5kc1doYXRf
OwogICAgICAgIHRoaXMudGVybWluYWwu
a2V5Ym9hcmQucHJldmlvdXNBbHRTZW5k
c1doYXRfID0gbnVsbDsKICAgICAgfQog
ICAgICBicmVhazsKCiAgICBjYXNlICc0
Nyc6CiAgICBjYXNlICcxMDQ3JzogIC8v
IG5vLXNwZWMKICAgICAgdGhpcy50ZXJt
aW5hbC5zZXRBbHRlcm5hdGVNb2RlKHN0
YXRlKTsKICAgICAgYnJlYWs7CgogICAg
Y2FzZSAnMTA0OCc6ICAvLyBTYXZlIGN1
cnNvciBhcyBpbiBERUNTQy4KICAgICAg
dGhpcy5zYXZlZFN0YXRlXy5zYXZlKCk7
CgogICAgY2FzZSAnMTA0OSc6ICAvLyAx
MDQ3ICsgMTA0OCArIGNsZWFyLgogICAg
ICBpZiAoc3RhdGUpIHsKICAgICAgICB0
aGlzLnNhdmVkU3RhdGVfLnNhdmUoKTsK
ICAgICAgICB0aGlzLnRlcm1pbmFsLnNl
dEFsdGVybmF0ZU1vZGUoc3RhdGUpOwog
ICAgICAgIHRoaXMudGVybWluYWwuY2xl
YXIoKTsKICAgICAgfSBlbHNlIHsKICAg
ICAgICB0aGlzLnRlcm1pbmFsLnNldEFs
dGVybmF0ZU1vZGUoc3RhdGUpOwogICAg
ICAgIHRoaXMuc2F2ZWRTdGF0ZV8ucmVz
dG9yZSgpOwogICAgICB9CgogICAgICBi
cmVhazsKCiAgICBjYXNlICcyMDA0Jzog
IC8vIEJyYWNrZXRlZCBwYXN0ZSBtb2Rl
LgogICAgICB0aGlzLnRlcm1pbmFsLnNl
dEJyYWNrZXRlZFBhc3RlKHN0YXRlKTsK
ICAgICAgYnJlYWs7CgogICAgZGVmYXVs
dDoKICAgICAgaWYgKHRoaXMud2FyblVu
aW1wbGVtZW50ZWQpCiAgICAgICAgY29u
c29sZS53YXJuKCdVbmltcGxlbWVudGVk
IERFQyBQcml2YXRlIE1vZGU6ICcgKyBj
b2RlKTsKICAgICAgYnJlYWs7CiAgfQp9
OwoKLyoqCiAqIEZ1bmN0aW9uIHNoYXJl
ZCBieSBjb250cm9sIGNoYXJhY3RlcnMg
YW5kIGVzY2FwZSBzZXF1ZW5jZXMgdGhh
dCBhcmUKICogaWdub3JlZC4KICovCmh0
ZXJtLlZULmlnbm9yZSA9IGZ1bmN0aW9u
KCkge307CgovKioKICogQ29sbGVjdGlv
biBvZiBjb250cm9sIGNoYXJhY3RlcnMg
ZXhwcmVzc2VkIGluIGEgc2luZ2xlIGJ5
dGUuCiAqCiAqIFRoaXMgaW5jbHVkZXMg
dGhlIGNoYXJhY3RlcnMgZnJvbSB0aGUg
QzAgYW5kIEMxIHNldHMgKHNlZSBbQ1RS
TF0pIHRoYXQgd2UKICogY2FyZSBhYm91
dC4gIFR3byBieXRlIHZlcnNpb25zIG9m
IHRoZSBDMSBjb2RlcyBhcmUgZGVmaW5l
ZCBpbiB0aGUKICogaHRlcm0uVlQuRVND
IGNvbGxlY3Rpb24uCiAqCiAqIFRoZSAn
Q0MxJyBtbmVtb25pYyBoZXJlIHJlZmVy
cyB0byB0aGUgZmFjdCB0aGF0IHRoZXNl
IGFyZSBvbmUtYnl0ZSBDb250cm9sCiAq
IENvZGVzLiAgSXQncyBvbmx5IHVzZWQg
aW4gdGhpcyBzb3VyY2UgZmlsZSBhbmQg
bm90IGRlZmluZWQgaW4gYW55IG9mIHRo
ZQogKiByZWZlcmVuY2VkIGRvY3VtZW50
cy4KICovCmh0ZXJtLlZULkNDMSA9IHt9
OwoKLyoqCiAqIENvbGxlY3Rpb24gb2Yg
dHdvLWJ5dGUgYW5kIHRocmVlLWJ5dGUg
c2VxdWVuY2VzIHN0YXJ0aW5nIHdpdGgg
RVNDLgogKi8KaHRlcm0uVlQuRVNDID0g
e307CgovKioKICogQ29sbGVjdGlvbiBv
ZiBDU0kgKENvbnRyb2wgU2VxdWVuY2Ug
SW50cm9kdWNlcikgc2VxdWVuY2VzLgog
KgogKiBUaGVzZSBzZXF1ZW5jZXMgYmVn
aW4gd2l0aCAnRVNDIFsnLCBhbmQgbWF5
IHRha2UgemVybyBvciBtb3JlIGFyZ3Vt
ZW50cy4KICovCmh0ZXJtLlZULkNTSSA9
IHt9OwoKLyoqCiAqIENvbGxlY3Rpb24g
b2YgT1NDIChPcGVyYXRpbmcgU3lzdGVt
IENvbnRyb2wpIHNlcXVlbmNlcy4KICoK
ICogVGhlc2Ugc2VxdWVuY2VzIGJlZ2lu
IHdpdGggJ0VTQyBdJywgZm9sbG93ZWQg
YnkgYSBmdW5jdGlvbiBudW1iZXIgYW5k
IGEKICogc3RyaW5nIHRlcm1pbmF0ZWQg
YnkgZWl0aGVyIFNUIG9yIEJFTC4KICov
Cmh0ZXJtLlZULk9TQyA9IHt9OwoKLyoq
CiAqIENvbGxlY3Rpb24gb2YgVlQ1MiBz
ZXF1ZW5jZXMuCiAqCiAqIFdoZW4gaW4g
VlQ1MiBtb2RlLCBvdGhlciBzZXF1ZW5j
ZXMgYXJlIGRpc2FibGVkLgogKi8KaHRl
cm0uVlQuVlQ1MiA9IHt9OwoKLyoqCiAq
IE51bGwgKE5VTCkuCiAqCiAqIFNpbGVu
dGx5IGlnbm9yZWQuCiAqLwpodGVybS5W
VC5DQzFbJ1x4MDAnXSA9IGZ1bmN0aW9u
ICgpIHt9OwoKLyoqCiAqIEVucXVpcnkg
KEVOUSkuCiAqCiAqIFRyYW5zbWl0IGFu
c3dlcmJhY2sgbWVzc2FnZS4KICoKICog
VGhlIGRlZmF1bHQgYW5zd2VyYmFjayBt
ZXNzYWdlIGluIHh0ZXJtIGlzIGFuIGVt
cHR5IHN0cmluZywgc28gd2UganVzdAog
KiBpZ25vcmUgdGhpcy4KICovCmh0ZXJt
LlZULkNDMVsnXHgwNSddID0gaHRlcm0u
VlQuaWdub3JlOwoKLyoqCiAqIFJpbmcg
QmVsbCAoQkVMKS4KICovCmh0ZXJtLlZU
LkNDMVsnXHgwNyddID0gZnVuY3Rpb24o
KSB7CiAgdGhpcy50ZXJtaW5hbC5yaW5n
QmVsbCgpOwp9OwoKLyoqCiAqIEJhY2tz
cGFjZSAoQlMpLgogKgogKiBNb3ZlIHRo
ZSBjdXJzb3IgdG8gdGhlIGxlZnQgb25l
IGNoYXJhY3RlciBwb3NpdGlvbiwgdW5s
ZXNzIGl0IGlzIGF0IHRoZQogKiBsZWZ0
IG1hcmdpbiwgaW4gd2hpY2ggY2FzZSBu
byBhY3Rpb24gb2NjdXJzLgogKi8KaHRl
cm0uVlQuQ0MxWydceDA4J10gPSBmdW5j
dGlvbigpIHsKICB0aGlzLnRlcm1pbmFs
LmN1cnNvckxlZnQoMSk7Cn07CgovKioK
ICogSG9yaXpvbnRhbCBUYWIgKEhUKS4K
ICoKICogTW92ZSB0aGUgY3Vyc29yIHRv
IHRoZSBuZXh0IHRhYiBzdG9wLCBvciB0
byB0aGUgcmlnaHQgbWFyZ2luIGlmIG5v
IGZ1cnRoZXIKICogdGFiIHN0b3BzIGFy
ZSBwcmVzZW50IG9uIHRoZSBsaW5lLgog
Ki8KaHRlcm0uVlQuQ0MxWydceDA5J10g
PSBmdW5jdGlvbigpIHsKICB0aGlzLnRl
cm1pbmFsLmZvcndhcmRUYWJTdG9wKCk7
Cn07CgovKioKICogTGluZSBGZWVkIChM
RikuCiAqCiAqIFRoaXMgY29kZSBjYXVz
ZXMgYSBsaW5lIGZlZWQgb3IgYSBuZXcg
bGluZSBvcGVyYXRpb24uICBTZWUgQXV0
b21hdGljCiAqIE5ld2xpbmUgKExOTSku
CiAqLwpodGVybS5WVC5DQzFbJ1x4MGEn
XSA9IGZ1bmN0aW9uKCkgewogIHRoaXMu
dGVybWluYWwuZm9ybUZlZWQoKTsKfTsK
Ci8qKgogKiBWZXJ0aWNhbCBUYWIgKFZU
KS4KICoKICogSW50ZXJwcmV0ZWQgYXMg
TEYuCiAqLwpodGVybS5WVC5DQzFbJ1x4
MGInXSA9IGh0ZXJtLlZULkNDMVsnXHgw
YSddOwoKLyoqCiAqIEZvcm0gRmVlZCAo
RkYpLgogKgogKiBJbnRlcnByZXRlZCBh
cyBMRi4KICovCmh0ZXJtLlZULkNDMVsn
XHgwYyddID0gZnVuY3Rpb24oKSB7CiAg
dGhpcy50ZXJtaW5hbC5mb3JtRmVlZCgp
Owp9OwoKLyoqCiAqIENhcnJpYWdlIFJl
dHVybiAoQ1IpLgogKgogKiBNb3ZlIGN1
cnNvciB0byB0aGUgbGVmdCBtYXJnaW4g
b24gdGhlIGN1cnJlbnQgbGluZS4KICov
Cmh0ZXJtLlZULkNDMVsnXHgwZCddID0g
ZnVuY3Rpb24oKSB7CiAgdGhpcy50ZXJt
aW5hbC5zZXRDdXJzb3JDb2x1bW4oMCk7
Cn07CgovKioKICogU2hpZnQgT3V0IChT
TyksIGFrYSBMb2NrIFNoaWZ0IDAgKExT
MSkuCiAqCiAqIEludm9rZSBHMSBjaGFy
YWN0ZXIgc2V0IGluIEdMLgogKi8KaHRl
cm0uVlQuQ0MxWydceDBlJ10gPSBmdW5j
dGlvbigpIHsKICB0aGlzLkdMID0gJ0cx
JzsKfTsKCi8qKgogKiBTaGlmdCBJbiAo
U0kpLCBha2EgTG9jayBTaGlmdCAwIChM
UzApLgogKgogKiBJbnZva2UgRzAgY2hh
cmFjdGVyIHNldCBpbiBHTC4KICovCmh0
ZXJtLlZULkNDMVsnXHgwZiddID0gZnVu
Y3Rpb24oKSB7CiAgdGhpcy5HTCA9ICdH
MCc7Cn07CgovKioKICogVHJhbnNtaXQg
T24gKFhPTikuCiAqCiAqIE5vdCBjdXJy
ZW50bHkgaW1wbGVtZW50ZWQuCiAqCiAq
IFRPRE8ocmdpbmRhKTogSW1wbGVtZW50
PwogKi8KaHRlcm0uVlQuQ0MxWydceDEx
J10gPSBodGVybS5WVC5pZ25vcmU7Cgov
KioKICogVHJhbnNtaXQgT2ZmIChYT0ZG
KS4KICoKICogTm90IGN1cnJlbnRseSBp
bXBsZW1lbnRlZC4KICoKICogVE9ETyhy
Z2luZGEpOiBJbXBsZW1lbnQ/CiAqLwpo
dGVybS5WVC5DQzFbJ1x4MTMnXSA9IGh0
ZXJtLlZULmlnbm9yZTsKCi8qKgogKiBD
YW5jZWwgKENBTikuCiAqCiAqIElmIHNl
bnQgZHVyaW5nIGEgY29udHJvbCBzZXF1
ZW5jZSwgdGhlIHNlcXVlbmNlIGlzIGlt
bWVkaWF0ZWx5IHRlcm1pbmF0ZWQKICog
YW5kIG5vdCBleGVjdXRlZC4KICoKICog
SXQgYWxzbyBjYXVzZXMgdGhlIGVycm9y
IGNoYXJhY3RlciB0byBiZSBkaXNwbGF5
ZWQuCiAqLwpodGVybS5WVC5DQzFbJ1x4
MTgnXSA9IGZ1bmN0aW9uKHBhcnNlU3Rh
dGUpIHsKICBwYXJzZVN0YXRlLnJlc2V0
UGFyc2VGdW5jdGlvbigpOwogIHRoaXMu
dGVybWluYWwucHJpbnQoJz8nKTsKfTsK
Ci8qKgogKiBTdWJzdGl0dXRlIChTVUIp
LgogKgogKiBJbnRlcnByZXRlZCBhcyBD
QU4uCiAqLwpodGVybS5WVC5DQzFbJ1x4
MWEnXSA9IGh0ZXJtLlZULkNDMVsnXHgx
OCddOwoKLyoqCiAqIEVzY2FwZSAoRVND
KS4KICovCmh0ZXJtLlZULkNDMVsnXHgx
YiddID0gZnVuY3Rpb24ocGFyc2VTdGF0
ZSkgewogIGZ1bmN0aW9uIHBhcnNlRVND
KHBhcnNlU3RhdGUpIHsKICAgIHZhciBj
aCA9IHBhcnNlU3RhdGUuY29uc3VtZUNo
YXIoKTsKCiAgICBpZiAoY2ggPT0gJ1x4
MWInKQogICAgICByZXR1cm47CgogICAg
dGhpcy5kaXNwYXRjaCgnRVNDJywgY2gs
IHBhcnNlU3RhdGUpOwoKICAgIGlmIChw
YXJzZVN0YXRlLmZ1bmMgPT0gcGFyc2VF
U0MpCiAgICAgIHBhcnNlU3RhdGUucmVz
ZXRQYXJzZUZ1bmN0aW9uKCk7CiAgfTsK
CiAgcGFyc2VTdGF0ZS5mdW5jID0gcGFy
c2VFU0M7Cn07CgovKioKICogRGVsZXRl
IChERUwpLgogKi8KaHRlcm0uVlQuQ0Mx
WydceDdmJ10gPSBodGVybS5WVC5pZ25v
cmU7CgovLyA4IGJpdCBjb250cm9sIGNo
YXJhY3RlcnMgYW5kIHRoZWlyIHR3byBi
eXRlIGVxdWl2YWxlbnRzLCBiZWxvdy4u
LgoKLyoqCiAqIEluZGV4IChJTkQpLgog
KgogKiBMaWtlIG5ld2xpbmUsIG9ubHkg
a2VlcCB0aGUgWCBwb3NpdGlvbgogKi8K
aHRlcm0uVlQuQ0MxWydceDg0J10gPQpo
dGVybS5WVC5FU0NbJ0QnXSA9IGZ1bmN0
aW9uKCkgewogIHRoaXMudGVybWluYWwu
bGluZUZlZWQoKTsKfTsKCi8qKgogKiBO
ZXh0IExpbmUgKE5FTCkuCiAqCiAqIExp
a2UgbmV3bGluZSwgYnV0IGRvZXNuJ3Qg
YWRkIGxpbmVzLgogKi8KaHRlcm0uVlQu
Q0MxWydceDg1J10gPQpodGVybS5WVC5F
U0NbJ0UnXSA9IGZ1bmN0aW9uKCkgewog
IHRoaXMudGVybWluYWwuc2V0Q3Vyc29y
Q29sdW1uKDApOwogIHRoaXMudGVybWlu
YWwuY3Vyc29yRG93bigxKTsKfTsKCi8q
KgogKiBIb3Jpem9udGFsIFRhYnVsYXRp
b24gU2V0IChIVFMpLgogKi8KaHRlcm0u
VlQuQ0MxWydceDg4J10gPQpodGVybS5W
VC5FU0NbJ0gnXSA9IGZ1bmN0aW9uKCkg
ewogIHRoaXMudGVybWluYWwuc2V0VGFi
U3RvcCh0aGlzLnRlcm1pbmFsLmdldEN1
cnNvckNvbHVtbigpKTsKfTsKCi8qKgog
KiBSZXZlcnNlIEluZGV4IChSSSkuCiAq
CiAqIE1vdmUgdXAgb25lIGxpbmUuCiAq
LwpodGVybS5WVC5DQzFbJ1x4OGQnXSA9
Cmh0ZXJtLlZULkVTQ1snTSddID0gZnVu
Y3Rpb24oKSB7CiAgdGhpcy50ZXJtaW5h
bC5yZXZlcnNlTGluZUZlZWQoKTsKfTsK
Ci8qKgogKiBTaW5nbGUgU2hpZnQgMiAo
U1MyKS4KICoKICogU2VsZWN0IG9mIEcy
IENoYXJhY3RlciBTZXQgZm9yIHRoZSBu
ZXh0IGNoYXJhY3RlciBvbmx5LgogKgog
KiBOb3QgY3VycmVudGx5IGltcGxlbWVu
dGVkLgogKi8KaHRlcm0uVlQuQ0MxWydc
eDhlJ10gPQpodGVybS5WVC5FU0NbJ04n
XSA9IGh0ZXJtLlZULmlnbm9yZTsKCi8q
KgogKiBTaW5nbGUgU2hpZnQgMyAoU1Mz
KS4KICoKICogU2VsZWN0IG9mIEczIENo
YXJhY3RlciBTZXQgZm9yIHRoZSBuZXh0
IGNoYXJhY3RlciBvbmx5LgogKgogKiBO
b3QgY3VycmVudGx5IGltcGxlbWVudGVk
LgogKi8KaHRlcm0uVlQuQ0MxWydceDhm
J10gPQpodGVybS5WVC5FU0NbJ08nXSA9
IGh0ZXJtLlZULmlnbm9yZTsKCi8qKgog
KiBEZXZpY2UgQ29udHJvbCBTdHJpbmcg
KERDUykuCiAqCiAqIEluZGljYXRlIGEg
RENTIHNlcXVlbmNlLiAgU2VlIERldmlj
ZS1Db250cm9sIGZ1bmN0aW9ucyBpbiBb
WFRFUk1dLgogKiBOb3QgY3VycmVudGx5
IGltcGxlbWVudGVkLgogKgogKiBUT0RP
KHJnaW5kYSk6IENvbnNpZGVyIGltcGxl
bWVudGluZyBERUNSUVNTLCB0aGUgcmVz
dCBkb24ndCBzZWVtIGFwcGxpY2FibGUu
CiAqLwpodGVybS5WVC5DQzFbJ1x4OTAn
XSA9Cmh0ZXJtLlZULkVTQ1snUCddID0g
ZnVuY3Rpb24ocGFyc2VTdGF0ZSkgewog
IHBhcnNlU3RhdGUucmVzZXRBcmd1bWVu
dHMoKTsKICBwYXJzZVN0YXRlLmZ1bmMg
PSB0aGlzLnBhcnNlVW50aWxTdHJpbmdU
ZXJtaW5hdG9yXzsKfTsKCi8qKgogKiBT
dGFydCBvZiBQcm90ZWN0ZWQgQXJlYSAo
U1BBKS4KICoKICogV2lsbCBub3QgaW1w
bGVtZW50LgogKi8KaHRlcm0uVlQuQ0Mx
WydceDk2J10gPQpodGVybS5WVC5FU0Nb
J1YnXSA9IGh0ZXJtLlZULmlnbm9yZTsK
Ci8qKgogKiBFbmQgb2YgUHJvdGVjdGVk
IEFyZWEgKEVQQSkuCiAqCiAqIFdpbGwg
bm90IGltcGxlbWVudC4KICovCmh0ZXJt
LlZULkNDMVsnXHg5NyddID0KaHRlcm0u
VlQuRVNDWydXJ10gPSBodGVybS5WVC5p
Z25vcmU7CgovKioKICogU3RhcnQgb2Yg
U3RyaW5nIChTT1MpLgogKgogKiBXaWxs
IG5vdCBpbXBsZW1lbnQuCiAqLwpodGVy
bS5WVC5DQzFbJ1x4OTgnXSA9Cmh0ZXJt
LlZULkVTQ1snWCddID0gaHRlcm0uVlQu
aWdub3JlOwoKLyoqCiAqIFNpbmdsZSBD
aGFyYWN0ZXIgSW50cm9kdWNlciAoU0NJ
LCBhbHNvIERFQ0lEKS4KICoKICogUmV0
dXJuIFRlcm1pbmFsIElELiAgT2Jzb2xl
dGUgZm9ybSBvZiAnRVNDIFsgYycgKERB
KS4KICovCmh0ZXJtLlZULkNDMVsnXHg5
YSddID0KaHRlcm0uVlQuRVNDWydaJ10g
PSBmdW5jdGlvbigpIHsKICB0aGlzLnRl
cm1pbmFsLmlvLnNlbmRTdHJpbmcoJ1x4
MWJbPzE7MmMnKTsKfTsKCi8qKgogKiBD
b250cm9sIFNlcXVlbmNlIEludHJvZHVj
ZXIgKENTSSkuCiAqCiAqIFRoZSBsZWFk
IGludG8gbW9zdCBlc2NhcGUgc2VxdWVu
Y2VzLiAgU2VlIFtDU0ldLgogKi8KaHRl
cm0uVlQuQ0MxWydceDliJ10gPQpodGVy
bS5WVC5FU0NbJ1snXSA9IGZ1bmN0aW9u
KHBhcnNlU3RhdGUpIHsKICBwYXJzZVN0
YXRlLnJlc2V0QXJndW1lbnRzKCk7CiAg
dGhpcy5sZWFkaW5nTW9kaWZpZXJfID0g
Jyc7CiAgdGhpcy50cmFpbGluZ01vZGlm
aWVyXyA9ICcnOwogIHBhcnNlU3RhdGUu
ZnVuYyA9IHRoaXMucGFyc2VDU0lfOwp9
OwoKLyoqCiAqIFN0cmluZyBUZXJtaW5h
dG9yIChTVCkuCiAqCiAqIFVzZWQgdG8g
dGVybWluYXRlIERDUy9PU0MvUE0vQVBD
IGNvbW1hbmRzIHdoaWNoIG1heSB0YWtl
IHN0cmluZyBhcmd1bWVudHMuCiAqCiAq
IFdlIGRvbid0IGRpcmVjdGx5IGhhbmRs
ZSBpdCBoZXJlLCBhcyBpdCdzIG9ubHkg
dXNlZCB0byB0ZXJtaW5hdGUgb3RoZXIK
ICogc2VxdWVuY2VzLiAgU2VlIHRoZSAn
cGFyc2VVbnRpbFN0cmluZ1Rlcm1pbmF0
b3JfJyBtZXRob2QuCiAqLwpodGVybS5W
VC5DQzFbJ1x4OWMnXSA9Cmh0ZXJtLlZU
LkVTQ1snXFwnXSA9IGh0ZXJtLlZULmln
bm9yZTsKCi8qKgogKiBPcGVyYXRpbmcg
U3lzdGVtIENvbW1hbmQgKE9TQykuCiAq
CiAqIENvbW1hbmRzIHJlbGF0aW5nIHRv
IHRoZSBvcGVyYXRpbmcgc3lzdGVtLgog
Ki8KaHRlcm0uVlQuQ0MxWydceDlkJ10g
PQpodGVybS5WVC5FU0NbJ10nXSA9IGZ1
bmN0aW9uKHBhcnNlU3RhdGUpIHsKICBw
YXJzZVN0YXRlLnJlc2V0QXJndW1lbnRz
KCk7CgogIGZ1bmN0aW9uIHBhcnNlT1ND
KHBhcnNlU3RhdGUpIHsKICAgIGlmICgh
dGhpcy5wYXJzZVVudGlsU3RyaW5nVGVy
bWluYXRvcl8ocGFyc2VTdGF0ZSkpIHsK
ICAgICAgLy8gVGhlIHN0cmluZyBzZXF1
ZW5jZSB3YXMgdG9vIGxvbmcuCiAgICAg
IHJldHVybjsKICAgIH0KCiAgICBpZiAo
cGFyc2VTdGF0ZS5mdW5jID09IHBhcnNl
T1NDKSB7CiAgICAgIC8vIFdlJ3JlIG5v
dCBkb25lIHBhcnNpbmcgdGhlIHN0cmlu
ZyB5ZXQuCiAgICAgIHJldHVybjsKICAg
IH0KCiAgICAvLyBXZSdyZSBkb25lLgog
ICAgdmFyIGFyeSA9IHBhcnNlU3RhdGUu
YXJnc1swXS5tYXRjaCgvXihcZCspOygu
KikkLyk7CiAgICBpZiAoYXJ5KSB7CiAg
ICAgIHBhcnNlU3RhdGUuYXJnc1swXSA9
IGFyeVsyXTsKICAgICAgdGhpcy5kaXNw
YXRjaCgnT1NDJywgYXJ5WzFdLCBwYXJz
ZVN0YXRlKTsKICAgIH0gZWxzZSB7CiAg
ICAgIGNvbnNvbGUud2FybignSW52YWxp
ZCBPU0M6ICcgKyBKU09OLnN0cmluZ2lm
eShwYXJzZVN0YXRlLmFyZ3NbMF0pKTsK
ICAgIH0KICB9OwoKICBwYXJzZVN0YXRl
LmZ1bmMgPSBwYXJzZU9TQzsKfTsKCi8q
KgogKiBQcml2YWN5IE1lc3NhZ2UgKFBN
KS4KICoKICogV2lsbCBub3QgaW1wbGVt
ZW50LgogKi8KaHRlcm0uVlQuQ0MxWydc
eDllJ10gPQpodGVybS5WVC5FU0NbJ14n
XSA9IGZ1bmN0aW9uKHBhcnNlU3RhdGUp
IHsKICBwYXJzZVN0YXRlLnJlc2V0QXJn
dW1lbnRzKCk7CiAgcGFyc2VTdGF0ZS5m
dW5jID0gdGhpcy5wYXJzZVVudGlsU3Ry
aW5nVGVybWluYXRvcl87Cn07CgovKioK
ICogQXBwbGljYXRpb24gUHJvZ3JhbSBD
b250cm9sIChBUEMpLgogKgogKiBXaWxs
IG5vdCBpbXBsZW1lbnQuCiAqLwpodGVy
bS5WVC5DQzFbJ1x4OWYnXSA9Cmh0ZXJt
LlZULkVTQ1snXyddID0gZnVuY3Rpb24o
cGFyc2VTdGF0ZSkgewogIHBhcnNlU3Rh
dGUucmVzZXRBcmd1bWVudHMoKTsKICBw
YXJzZVN0YXRlLmZ1bmMgPSB0aGlzLnBh
cnNlVW50aWxTdHJpbmdUZXJtaW5hdG9y
XzsKfTsKCi8qKgogKiBFU0MgXHgyMCAt
IFVuY2xlYXIgdG8gbWUgd2hlcmUgdGhl
c2Ugb3JpZ2luYXRlZCwgcG9zc2libHkg
aW4geHRlcm0uCiAqCiAqIE5vdCBjdXJy
ZW50bHkgaW1wbGVtZW50ZWQ6CiAqICAg
RVNDIFx4MjAgRiAtIFNlbGVjdCA3IGJp
dCBlc2NhcGUgY29kZXMgaW4gcmVzcG9u
c2VzIChTN0MxVCkuCiAqICAgRVNDIFx4
MjAgRyAtIFNlbGVjdCA4IGJpdCBlc2Nh
cGUgY29kZXMgaW4gcmVzcG9uc2VzIChT
OEMxVCkuCiAqICAgICAgICAgICAgICAg
IE5COiBXZSBjdXJyZW50bHkgYXNzdW1l
IFM3QzFUIGFsd2F5cy4KICoKICogV2ls
bCBub3QgaW1wbGVtZW50OgogKiAgIEVT
QyBceDIwIEwgLSBTZXQgQU5TSSBjb25m
b3JtYW5jZSBsZXZlbCAxLgogKiAgIEVT
QyBceDIwIE0gLSBTZXQgQU5TSSBjb25m
b3JtYW5jZSBsZXZlbCAyLgogKiAgIEVT
QyBceDIwIE4gLSBTZXQgQU5TSSBjb25m
b3JtYW5jZSBsZXZlbCAzLgogKi8KaHRl
cm0uVlQuRVNDWydceDIwJ10gPSBmdW5j
dGlvbihwYXJzZVN0YXRlKSB7CiAgcGFy
c2VTdGF0ZS5mdW5jID0gZnVuY3Rpb24o
cGFyc2VTdGF0ZSkgewogICAgdmFyIGNo
ID0gcGFyc2VTdGF0ZS5jb25zdW1lQ2hh
cigpOwogICAgaWYgKHRoaXMud2FyblVu
aW1wbGVtZW50ZWQpCiAgICAgIGNvbnNv
bGUud2FybignVW5pbXBsZW1lbnRlZCBz
ZXF1ZW5jZTogRVNDIDB4MjAgJyArIGNo
KTsKICAgIHBhcnNlU3RhdGUucmVzZXRQ
YXJzZUZ1bmN0aW9uKCk7CiAgfTsKfTsK
Ci8qKgogKiBERUMgJ0VTQyAjJyBzZXF1
ZW5jZXMuCiAqCiAqIEhhbmRsZWQ6CiAq
ICAgRVNDICMgOCAtIERFQyBTY3JlZW4g
QWxpZ25tZW50IFRlc3QgKERFQ0FMTiku
CiAqICAgICAgICAgICAgIEZpbGxzIHRo
ZSB0ZXJtaW5hbCB3aXRoICdFJ3MuICBV
c2VkIGxpYmVyYWxseSBieSB2dHRlc3Qu
CiAqCiAqIElnbm9yZWQ6CiAqICAgRVND
ICMgMyAtIERFQyBkb3VibGUtaGVpZ2h0
IGxpbmUsIHRvcCBoYWxmIChERUNESEwp
LgogKiAgIEVTQyAjIDQgLSBERUMgZG91
YmxlLWhlaWdodCBsaW5lLCBib3R0b20g
aGFsZiAoREVDREhMKS4KICogICBFU0Mg
IyA1IC0gREVDIHNpbmdsZS13aWR0aCBs
aW5lIChERUNTV0wpLgogKiAgIEVTQyAj
IDYgLSBERUMgZG91YmxlLXdpZHRoIGxp
bmUgKERFQ0RXTCkuCiAqLwpodGVybS5W
VC5FU0NbJyMnXSA9IGZ1bmN0aW9uKHBh
cnNlU3RhdGUpIHsKICBwYXJzZVN0YXRl
LmZ1bmMgPSBmdW5jdGlvbihwYXJzZVN0
YXRlKSB7CiAgICB2YXIgY2ggPSBwYXJz
ZVN0YXRlLmNvbnN1bWVDaGFyKCk7CiAg
ICBpZiAoY2ggPT0gJzgnKQogICAgICB0
aGlzLnRlcm1pbmFsLmZpbGwoJ0UnKTsK
CiAgICBwYXJzZVN0YXRlLnJlc2V0UGFy
c2VGdW5jdGlvbigpOwogIH07Cn07Cgov
KioKICogJ0VTQyAlJyBzZXF1ZW5jZXMs
IGNoYXJhY3RlciBzZXQgY29udHJvbC4g
IE5vdCBjdXJyZW50bHkgaW1wbGVtZW50
ZWQuCiAqCiAqIFRvIGJlIGltcGxlbWVu
dGVkIChjdXJyZW50bHkgaWdub3JlZCk6
CiAqICAgRVNDICUgQCAtIFNldCBJU08g
ODg1OS0xIGNoYXJhY3RlciBzZXQuCiAq
ICAgRVNDICUgRyAtIFNldCBVVEYtOCBj
aGFyYWN0ZXIgc2V0LgogKgogKiBBbGwg
b3RoZXIgRVNDICMgc2VxdWVuY2VzIGFy
ZSBlY2hvZWQgdG8gdGhlIHRlcm1pbmFs
LgogKgogKiBUT0RPKHJnaW5kYSk6IElt
cGxlbWVudC4KICovCmh0ZXJtLlZULkVT
Q1snJSddID0gZnVuY3Rpb24ocGFyc2VT
dGF0ZSkgewogIHBhcnNlU3RhdGUuZnVu
YyA9IGZ1bmN0aW9uKHBhcnNlU3RhdGUp
IHsKICAgIHZhciBjaCA9IHBhcnNlU3Rh
dGUuY29uc3VtZUNoYXIoKTsKICAgIGlm
IChjaCAhPSAnQCcgJiYgY2ggIT0gJ0cn
ICYmIHRoaXMud2FyblVuaW1wbGVtZW50
ZWQpCiAgICAgIGNvbnNvbGUud2Fybign
VW5rbm93biBFU0MgJSBhcmd1bWVudDog
JyArIEpTT04uc3RyaW5naWZ5KGNoKSk7
CiAgICBwYXJzZVN0YXRlLnJlc2V0UGFy
c2VGdW5jdGlvbigpOwogIH07Cn07Cgov
KioKICogQ2hhcmFjdGVyIFNldCBTZWxl
Y3Rpb24gKFNDUykuCiAqCiAqICAgRVND
ICggUHMgLSBTZXQgRzAgY2hhcmFjdGVy
IHNldCAoVlQxMDApLgogKiAgIEVTQyAp
IFBzIC0gU2V0IEcxIGNoYXJhY3RlciBz
ZXQgKFZUMjIwKS4KICogICBFU0MgKiBQ
cyAtIFNldCBHMiBjaGFyYWN0ZXIgc2V0
IChWVDIyMCkuCiAqICAgRVNDICsgUHMg
LSBTZXQgRzMgY2hhcmFjdGVyIHNldCAo
VlQyMjApLgogKiAgIEVTQyAtIFBzIC0g
U2V0IEcxIGNoYXJhY3RlciBzZXQgKFZU
MzAwKS4KICogICBFU0MgLiBQcyAtIFNl
dCBHMiBjaGFyYWN0ZXIgc2V0IChWVDMw
MCkuCiAqICAgRVNDIC8gUHMgLSBTZXQg
RzMgY2hhcmFjdGVyIHNldCAoVlQzMDAp
LgogKgogKiBWYWx1ZXMgZm9yIFBzIGFy
ZToKICogICAwIC0gREVDIFNwZWNpYWwg
Q2hhcmFjdGVyIGFuZCBMaW5lIERyYXdp
bmcgU2V0LgogKiAgIEEgLSBVbml0ZWQg
S2luZ2RvbSAoVUspLgogKiAgIEIgLSBV
bml0ZWQgU3RhdGVzIChVU0FTQ0lJKS4K
ICogICA0IC0gRHV0Y2guCiAqICAgQyBv
ciA1IC0gRmlubmlzaC4KICogICBSIC0g
RnJlbmNoLgogKiAgIFEgLSBGcmVuY2gg
Q2FuYWRpYW4uCiAqICAgSyAtIEdlcm1h
bi4KICogICBZIC0gSXRhbGlhbi4KICog
ICBFIG9yIDYgLSBOb3J3ZWdpYW4vRGFu
aXNoLgogKiAgIFogLSBTcGFuaXNoLgog
KiAgIEggb3IgNyAtIFN3ZWRpc2guCiAq
ICAgPSAtIFN3aXNzLgogKgogKiBBbGwg
b3RoZXIgc2VxdWVuY2VzIGFyZSBlY2hv
ZWQgdG8gdGhlIHRlcm1pbmFsLgogKgog
KiBUT0RPKHJnaW5kYSk6IEltcGxlbWVu
dC4KICovCmh0ZXJtLlZULkVTQ1snKCdd
ID0KaHRlcm0uVlQuRVNDWycpJ10gPQpo
dGVybS5WVC5FU0NbJyonXSA9Cmh0ZXJt
LlZULkVTQ1snKyddID0KaHRlcm0uVlQu
RVNDWyctJ10gPQpodGVybS5WVC5FU0Nb
Jy4nXSA9Cmh0ZXJtLlZULkVTQ1snLydd
ID0gZnVuY3Rpb24ocGFyc2VTdGF0ZSwg
Y29kZSkgewogIHBhcnNlU3RhdGUuZnVu
YyA9IGZ1bmN0aW9uKHBhcnNlU3RhdGUp
IHsKICAgIHZhciBjaCA9IHBhcnNlU3Rh
dGUuY29uc3VtZUNoYXIoKTsKICAgIGlm
IChjaCA9PSAnXHgxYicpIHsKICAgICAg
cGFyc2VTdGF0ZS5yZXNldFBhcnNlRnVu
Y3Rpb24oKTsKICAgICAgcGFyc2VTdGF0
ZS5mdW5jKCk7CiAgICAgIHJldHVybjsK
ICAgIH0KCiAgICBpZiAoY2ggaW4gaHRl
cm0uVlQuQ2hhcmFjdGVyTWFwLm1hcHMp
IHsKICAgICAgaWYgKGNvZGUgPT0gJygn
KSB7CiAgICAgICAgdGhpcy5HMCA9IGh0
ZXJtLlZULkNoYXJhY3Rlck1hcC5tYXBz
W2NoXTsKICAgICAgfSBlbHNlIGlmIChj
b2RlID09ICcpJyB8fCBjb2RlID09ICct
JykgewogICAgICAgIHRoaXMuRzEgPSBo
dGVybS5WVC5DaGFyYWN0ZXJNYXAubWFw
c1tjaF07CiAgICAgIH0gZWxzZSBpZiAo
Y29kZSA9PSAnKicgfHwgY29kZSA9PSAn
LicpIHsKICAgICAgICB0aGlzLkcyID0g
aHRlcm0uVlQuQ2hhcmFjdGVyTWFwLm1h
cHNbY2hdOwogICAgICB9IGVsc2UgaWYg
KGNvZGUgPT0gJysnIHx8IGNvZGUgPT0g
Jy8nKSB7CiAgICAgICAgdGhpcy5HMyA9
IGh0ZXJtLlZULkNoYXJhY3Rlck1hcC5t
YXBzW2NoXTsKICAgICAgfQogICAgfSBl
bHNlIGlmICh0aGlzLndhcm5VbmltcGxl
bWVudGVkKSB7CiAgICAgIGNvbnNvbGUu
bG9nKCdJbnZhbGlkIGNoYXJhY3RlciBz
ZXQgZm9yICInICsgY29kZSArICciOiAn
ICsgY2gpOwogICAgfQoKICAgIHBhcnNl
U3RhdGUucmVzZXRQYXJzZUZ1bmN0aW9u
KCk7CiAgfTsKfTsKCi8qKgogKiBCYWNr
IEluZGV4IChERUNCSSkuCiAqCiAqIFZU
NDIwIGFuZCB1cC4gIE5vdCBjdXJyZW50
bHkgaW1wbGVtZW50ZWQuCiAqLwpodGVy
bS5WVC5FU0NbJzYnXSA9IGh0ZXJtLlZU
Lmlnbm9yZTsKCi8qKgogKiBTYXZlIEN1
cnNvciAoREVDU0MpLgogKi8KaHRlcm0u
VlQuRVNDWyc3J10gPSBmdW5jdGlvbigp
IHsKICB0aGlzLnNhdmVkU3RhdGVfLnNh
dmUoKTsKfTsKCi8qKgogKiBSZXN0b3Jl
IEN1cnNvciAoREVDU0MpLgogKi8KaHRl
cm0uVlQuRVNDWyc4J10gPSBmdW5jdGlv
bigpIHsKICB0aGlzLnNhdmVkU3RhdGVf
LnJlc3RvcmUoKTsKfTsKCi8qKgogKiBG
b3J3YXJkIEluZGV4IChERUNGSSkuCiAq
CiAqIFZUMjEwIGFuZCB1cC4gIE5vdCBj
dXJyZW50bHkgaW1wbGVtZW50ZWQuCiAq
LwpodGVybS5WVC5FU0NbJzknXSA9IGh0
ZXJtLlZULmlnbm9yZTsKCi8qKgogKiBB
cHBsaWNhdGlvbiBrZXlwYWQgKERFQ1BB
TSkuCiAqLwpodGVybS5WVC5FU0NbJz0n
XSA9IGZ1bmN0aW9uKCkgewogIHRoaXMu
dGVybWluYWwua2V5Ym9hcmQuYXBwbGlj
YXRpb25LZXlwYWQgPSB0cnVlOwp9OwoK
LyoqCiAqIE5vcm1hbCBrZXlwYWQgKERF
Q1BOTSkuCiAqLwpodGVybS5WVC5FU0Nb
Jz4nXSA9IGZ1bmN0aW9uKCkgewogIHRo
aXMudGVybWluYWwua2V5Ym9hcmQuYXBw
bGljYXRpb25LZXlwYWQgPSBmYWxzZTsK
fTsKCi8qKgogKiBDdXJzb3IgdG8gbG93
ZXIgbGVmdCBjb3JuZXIgb2Ygc2NyZWVu
LgogKgogKiBXaWxsIG5vdCBpbXBsZW1l
bnQuCiAqCiAqIFRoaXMgaXMgb25seSBy
ZWNvZ25pemVkIGJ5IHh0ZXJtIHdoZW4g
dGhlIGhwTG93ZXJsZWZ0QnVnQ29tcGF0
IHJlc291cmNlIGlzCiAqIHNldC4KICov
Cmh0ZXJtLlZULkVTQ1snRiddID0gaHRl
cm0uVlQuaWdub3JlOwoKLyoqCiAqIEZ1
bGwgUmVzZXQgKFJJUykuCiAqLwpodGVy
bS5WVC5FU0NbJ2MnXSA9IGZ1bmN0aW9u
KCkgewogIHRoaXMucmVzZXQoKTsKICB0
aGlzLnRlcm1pbmFsLnJlc2V0KCk7Cn07
CgovKioKICogTWVtb3J5IGxvY2svdW5s
b2NrLgogKgogKiBXaWxsIG5vdCBpbXBs
ZW1lbnQuCiAqLwpodGVybS5WVC5FU0Nb
J2wnXSA9Cmh0ZXJtLlZULkVTQ1snbSdd
ID0gaHRlcm0uVlQuaWdub3JlOwoKLyoq
CiAqIExvY2sgU2hpZnQgMiAoTFMyKQog
KgogKiBJbnZva2UgdGhlIEcyIENoYXJh
Y3RlciBTZXQgYXMgR0wuCiAqLwpodGVy
bS5WVC5FU0NbJ24nXSA9IGZ1bmN0aW9u
KCkgewogIHRoaXMuR0wgPSAnRzInOwp9
OwoKLyoqCiAqIExvY2sgU2hpZnQgMyAo
TFMzKQogKgogKiBJbnZva2UgdGhlIEcz
IENoYXJhY3RlciBTZXQgYXMgR0wuCiAq
LwpodGVybS5WVC5FU0NbJ28nXSA9IGZ1
bmN0aW9uKCkgewogIHRoaXMuR0wgPSAn
RzMnOwp9OwoKLyoqCiAqIExvY2sgU2hp
ZnQgMiwgUmlnaHQgKExTM1IpCiAqCiAq
IEludm9rZSB0aGUgRzMgQ2hhcmFjdGVy
IFNldCBhcyBHUi4KICovCmh0ZXJtLlZU
LkVTQ1snfCddID0gZnVuY3Rpb24oKSB7
CiAgdGhpcy5HUiA9ICdHMyc7Cn07Cgov
KioKICogTG9jayBTaGlmdCAyLCBSaWdo
dCAoTFMyUikKICoKICogSW52b2tlIHRo
ZSBHMiBDaGFyYWN0ZXIgU2V0IGFzIEdS
LgogKi8KaHRlcm0uVlQuRVNDWyd9J10g
PSBmdW5jdGlvbigpIHsKICB0aGlzLkdS
ID0gJ0cyJzsKfTsKCi8qKgogKiBMb2Nr
IFNoaWZ0IDEsIFJpZ2h0IChMUzFSKQog
KgogKiBJbnZva2UgdGhlIEcxIENoYXJh
Y3RlciBTZXQgYXMgR1IuCiAqLwpodGVy
bS5WVC5FU0NbJ34nXSA9IGZ1bmN0aW9u
KCkgewogIHRoaXMuR1IgPSAnRzEnOwp9
OwoKLyoqCiAqIENoYW5nZSBpY29uIG5h
bWUgYW5kIHdpbmRvdyB0aXRsZS4KICoK
ICogV2Ugb25seSBjaGFuZ2UgdGhlIHdp
bmRvdyB0aXRsZS4KICovCmh0ZXJtLlZU
Lk9TQ1snMCddID0gZnVuY3Rpb24ocGFy
c2VTdGF0ZSkgewogIHRoaXMudGVybWlu
YWwuc2V0V2luZG93VGl0bGUocGFyc2VT
dGF0ZS5hcmdzWzBdKTsKfTsKCi8qKgog
KiBDaGFuZ2Ugd2luZG93IHRpdGxlLgog
Ki8KaHRlcm0uVlQuT1NDWycyJ10gPSBo
dGVybS5WVC5PU0NbJzAnXTsKCi8qKgog
KiBTZXQvcmVhZCBjb2xvciBwYWxldHRl
LgogKi8KaHRlcm0uVlQuT1NDWyc0J10g
PSBmdW5jdGlvbihwYXJzZVN0YXRlKSB7
CiAgLy8gQXJncyBjb21lIGluIGFzIGEg
c2luZ2xlICdpbmRleDE7cmdiMSAuLi4g
O2luZGV4TjtyZ2JOJyBzdHJpbmcuCiAg
Ly8gV2Ugc3BsaXQgb24gdGhlIHNlbWlj
b2xvbiBhbmQgaXRlcmF0ZSB0aHJvdWdo
IHRoZSBwYWlycy4KICB2YXIgYXJncyA9
IHBhcnNlU3RhdGUuYXJnc1swXS5zcGxp
dCgnOycpOwoKICB2YXIgcGFpckNvdW50
ID0gcGFyc2VJbnQoYXJncy5sZW5ndGgg
LyAyKTsKICB2YXIgY29sb3JQYWxldHRl
ID0gdGhpcy50ZXJtaW5hbC5nZXRUZXh0
QXR0cmlidXRlcygpLmNvbG9yUGFsZXR0
ZTsKICB2YXIgcmVzcG9uc2VBcnJheSA9
IFtdOwoKICBmb3IgKHZhciBwYWlyTnVt
YmVyID0gMDsgcGFpck51bWJlciA8IHBh
aXJDb3VudDsgKytwYWlyTnVtYmVyKSB7
CiAgICB2YXIgY29sb3JJbmRleCA9IHBh
cnNlSW50KGFyZ3NbcGFpck51bWJlciAq
IDJdKTsKICAgIHZhciBjb2xvclZhbHVl
ID0gYXJnc1twYWlyTnVtYmVyICogMiAr
IDFdOwoKICAgIGlmIChjb2xvckluZGV4
ID49IGNvbG9yUGFsZXR0ZS5sZW5ndGgp
CiAgICAgIGNvbnRpbnVlOwoKICAgIGlm
IChjb2xvclZhbHVlID09ICc/Jykgewog
ICAgICAvLyAnPycgbWVhbnMgd2Ugc2hv
dWxkIHJlcG9ydCBiYWNrIHRoZSBjdXJy
ZW50IGNvbG9yIHZhbHVlLgogICAgICBj
b2xvclZhbHVlID0gbGliLmNvbG9ycy5y
Z2JUb1gxMShjb2xvclBhbGV0dGVbY29s
b3JJbmRleF0pOwogICAgICBpZiAoY29s
b3JWYWx1ZSkKICAgICAgICByZXNwb25z
ZUFycmF5LnB1c2goY29sb3JJbmRleCAr
ICc7JyArIGNvbG9yVmFsdWUpOwoKICAg
ICAgY29udGludWU7CiAgICB9CgogICAg
Y29sb3JWYWx1ZSA9IGxpYi5jb2xvcnMu
eDExVG9DU1MoY29sb3JWYWx1ZSk7CiAg
ICBpZiAoY29sb3JWYWx1ZSkKICAgICAg
Y29sb3JQYWxldHRlW2NvbG9ySW5kZXhd
ID0gY29sb3JWYWx1ZTsKICB9CgogIGlm
IChyZXNwb25zZUFycmF5Lmxlbmd0aCkK
ICAgIHRoaXMudGVybWluYWwuaW8uc2Vu
ZFN0cmluZygnXHgxYl00OycgKyByZXNw
b25zZUFycmF5LmpvaW4oJzsnKSArICdc
eDA3Jyk7Cn07CgovKioKICogU2V0IHRo
ZSBjdXJzb3Igc2hhcGUuCiAqCiAqIFBh
cmFtZXRlciBpcyBleHBlY3RlZCB0byBi
ZSBpbiB0aGUgZm9ybSAiQ3Vyc29yU2hh
cGU9bnVtYmVyIiwgd2hlcmUgbnVtYmVy
IGlzCiAqIG9uZSBvZjoKICoKICogICAw
IC0gQmxvY2sKICogICAxIC0gSS1CZWFt
CiAqICAgMiAtIFVuZGVybGluZQogKgog
KiBUaGlzIGlzIGEgYml0IG9mIGEgZGUt
ZmFjdG8gc3RhbmRhcmQgc3VwcG9ydGVk
IGJ5IGlUZXJtIDIgYW5kIEtvbnNvbGUu
ICBTZWUKICogYWxzbzogREVDU0NVU1Iu
CiAqCiAqIEludmFsaWQgbnVtYmVycyB3
aWxsIHJlc3RvcmUgdGhlIGN1cnNvciB0
byB0aGUgYmxvY2sgc2hhcGUuCiAqLwpo
dGVybS5WVC5PU0NbJzUwJ10gPSBmdW5j
dGlvbihwYXJzZVN0YXRlKSB7CiAgdmFy
IGFyZ3MgPSBwYXJzZVN0YXRlLmFyZ3Nb
MF0ubWF0Y2goL0N1cnNvclNoYXBlPSgu
KS9pKTsKICBpZiAoIWFyZ3MpIHsKICAg
IGNvbnNvbGUud2FybignQ291bGQgbm90
IHBhcnNlIE9TQyA1MCBhcmdzOiAnICsg
cGFyc2VTdGF0ZS5hcmdzWzBdKTsKICAg
IHJldHVybjsKICB9CgogIHN3aXRjaCAo
YXJnc1sxXSkgewogICAgY2FzZSAnMSc6
CiAgICAgIHRoaXMudGVybWluYWwuc2V0
Q3Vyc29yU2hhcGUoaHRlcm0uVGVybWlu
YWwuY3Vyc29yU2hhcGUuQkVBTSk7CiAg
ICAgIGJyZWFrOwoKICAgIGNhc2UgJzIn
OgogICAgICB0aGlzLnRlcm1pbmFsLnNl
dEN1cnNvclNoYXBlKGh0ZXJtLlRlcm1p
bmFsLmN1cnNvclNoYXBlLlVOREVSTElO
RSk7CiAgICAgIGJyZWFrOwoKICAgIGRl
ZmF1bHQ6CiAgICAgIHRoaXMudGVybWlu
YWwuc2V0Q3Vyc29yU2hhcGUoaHRlcm0u
VGVybWluYWwuY3Vyc29yU2hhcGUuQkxP
Q0spOwogIH0KfTsKCi8qKgogKiBTZXQv
cmVhZCBzeXN0ZW0gY2xpcGJvYXJkLgog
KgogKiBSZWFkIGlzIG5vdCBpbXBsZW1l
bnRlZCBkdWUgdG8gc2VjdXJpdHkgY29u
c2lkZXJhdGlvbnMuICBBIHJlbW90ZSBh
cHAKICogdGhhdCBpcyBhYmxlIHRvIGJv
dGggd3JpdGUgYW5kIHJlYWQgdG8gdGhl
IGNsaXBib2FyZCBjb3VsZCBlc3NlbnRp
YWxseQogKiB0YWtlIG92ZXIgeW91ciBz
ZXNzaW9uLgogKgogKiBUaGUgY2xpcGJv
YXJkIGRhdGEgd2lsbCBiZSBkZWNvZGVk
IGFjY29yZGluZyB0byB0aGUgJ3JlY2Vp
dmUtZW5jb2RpbmcnCiAqIHByZWZlcmVu
Y2UuCiAqLwpodGVybS5WVC5PU0NbJzUy
J10gPSBmdW5jdGlvbihwYXJzZVN0YXRl
KSB7CiAgLy8gQXJncyBjb21lIGluIGFz
IGEgc2luZ2xlICdjbGlwYm9hcmQ7YjY0
LWRhdGEnIHN0cmluZy4gIFRoZSBjbGlw
Ym9hcmQKICAvLyBwYXJhbWV0ZXIgaXMg
dXNlZCB0byBzZWxlY3Qgd2hpY2ggb2Yg
dGhlIFggY2xpcGJvYXJkcyB0byBhZGRy
ZXNzLiAgU2luY2UKICAvLyB3ZSdyZSBu
b3QgaW50ZWdyYXRpbmcgd2l0aCBYLCB3
ZSB0cmVhdCB0aGVtIGFsbCB0aGUgc2Ft
ZS4KICB2YXIgYXJncyA9IHBhcnNlU3Rh
dGUuYXJnc1swXS5tYXRjaCgvXltjcHMw
MTIzNDU2N10qOyguKikvKTsKICBpZiAo
IWFyZ3MpCiAgICByZXR1cm47CgogIHZh
ciBkYXRhID0gd2luZG93LmF0b2IoYXJn
c1sxXSk7CiAgaWYgKGRhdGEpCiAgICB0
aGlzLnRlcm1pbmFsLmNvcHlTdHJpbmdU
b0NsaXBib2FyZCh0aGlzLmRlY29kZShk
YXRhKSk7Cn07CgovKioKICogSW5zZXJ0
IChibGFuaykgY2hhcmFjdGVycyAoSUNI
KS4KICovCmh0ZXJtLlZULkNTSVsnQCdd
ID0gZnVuY3Rpb24ocGFyc2VTdGF0ZSkg
ewogIHRoaXMudGVybWluYWwuaW5zZXJ0
U3BhY2UocGFyc2VTdGF0ZS5pYXJnKDAs
IDEpKTsKfTsKCi8qKgogKiBDdXJzb3Ig
VXAgKENVVSkuCiAqLwpodGVybS5WVC5D
U0lbJ0EnXSA9IGZ1bmN0aW9uKHBhcnNl
U3RhdGUpIHsKICB0aGlzLnRlcm1pbmFs
LmN1cnNvclVwKHBhcnNlU3RhdGUuaWFy
ZygwLCAxKSk7Cn07CgovKioKICogQ3Vy
c29yIERvd24gKENVRCkuCiAqLwpodGVy
bS5WVC5DU0lbJ0InXSA9IGZ1bmN0aW9u
KHBhcnNlU3RhdGUpIHsKICB0aGlzLnRl
cm1pbmFsLmN1cnNvckRvd24ocGFyc2VT
dGF0ZS5pYXJnKDAsIDEpKTsKfTsKCi8q
KgogKiBDdXJzb3IgRm9yd2FyZCAoQ1VG
KS4KICovCmh0ZXJtLlZULkNTSVsnQydd
ID0gZnVuY3Rpb24ocGFyc2VTdGF0ZSkg
ewogIHRoaXMudGVybWluYWwuY3Vyc29y
UmlnaHQocGFyc2VTdGF0ZS5pYXJnKDAs
IDEpKTsKfTsKCi8qKgogKiBDdXJzb3Ig
QmFja3dhcmQgKENVQikuCiAqLwpodGVy
bS5WVC5DU0lbJ0QnXSA9IGZ1bmN0aW9u
KHBhcnNlU3RhdGUpIHsKICB0aGlzLnRl
cm1pbmFsLmN1cnNvckxlZnQocGFyc2VT
dGF0ZS5pYXJnKDAsIDEpKTsKfTsKCi8q
KgogKiBDdXJzb3IgTmV4dCBMaW5lIChD
TkwpLgogKgogKiBUaGlzIGlzIGxpa2Ug
Q3Vyc29yIERvd24sIGV4Y2VwdCB0aGUg
Y3Vyc29yIG1vdmVzIHRvIHRoZSBiZWdp
bm5pbmcgb2YgdGhlCiAqIGxpbmUgYXMg
d2VsbC4KICovCmh0ZXJtLlZULkNTSVsn
RSddID0gZnVuY3Rpb24ocGFyc2VTdGF0
ZSkgewogIHRoaXMudGVybWluYWwuY3Vy
c29yRG93bihwYXJzZVN0YXRlLmlhcmco
MCwgMSkpOwogIHRoaXMudGVybWluYWwu
c2V0Q3Vyc29yQ29sdW1uKDApOwp9OwoK
LyoqCiAqIEN1cnNvciBQcmVjZWRpbmcg
TGluZSAoQ1BMKS4KICoKICogVGhpcyBp
cyBsaWtlIEN1cnNvciBVcCwgZXhjZXB0
IHRoZSBjdXJzb3IgbW92ZXMgdG8gdGhl
IGJlZ2lubmluZyBvZiB0aGUKICogbGlu
ZSBhcyB3ZWxsLgogKi8KaHRlcm0uVlQu
Q1NJWydGJ10gPSBmdW5jdGlvbihwYXJz
ZVN0YXRlKSB7CiAgdGhpcy50ZXJtaW5h
bC5jdXJzb3JVcChwYXJzZVN0YXRlLmlh
cmcoMCwgMSkpOwogIHRoaXMudGVybWlu
YWwuc2V0Q3Vyc29yQ29sdW1uKDApOwp9
OwoKLyoqCiAqIEN1cnNvciBDaGFyYWN0
ZXIgQWJzb2x1dGUgKENIQSkuCiAqLwpo
dGVybS5WVC5DU0lbJ0cnXSA9IGZ1bmN0
aW9uKHBhcnNlU3RhdGUpIHsKICB0aGlz
LnRlcm1pbmFsLnNldEN1cnNvckNvbHVt
bihwYXJzZVN0YXRlLmlhcmcoMCwgMSkg
LSAxKTsKfTsKCi8qKgogKiBDdXJzb3Ig
UG9zaXRpb24gKENVUCkuCiAqLwpodGVy
bS5WVC5DU0lbJ0gnXSA9IGZ1bmN0aW9u
KHBhcnNlU3RhdGUpIHsKICB0aGlzLnRl
cm1pbmFsLnNldEN1cnNvclBvc2l0aW9u
KHBhcnNlU3RhdGUuaWFyZygwLCAxKSAt
IDEsCiAgICAgICAgICAgICAgICAgICAg
ICAgICAgICAgICAgICBwYXJzZVN0YXRl
LmlhcmcoMSwgMSkgLSAxKTsKfTsKCi8q
KgogKiBDdXJzb3IgRm9yd2FyZCBUYWJ1
bGF0aW9uIChDSFQpLgogKi8KaHRlcm0u
VlQuQ1NJWydJJ10gPSBmdW5jdGlvbihw
YXJzZVN0YXRlKSB7CiAgdmFyIGNvdW50
ID0gcGFyc2VTdGF0ZS5pYXJnKDAsIDEp
OwogIGNvdW50ID0gbGliLmYuY2xhbXAo
Y291bnQsIDEsIHRoaXMudGVybWluYWwu
c2NyZWVuU2l6ZS53aWR0aCk7CiAgZm9y
ICh2YXIgaSA9IDA7IGkgPCBjb3VudDsg
aSsrKSB7CiAgICB0aGlzLnRlcm1pbmFs
LmZvcndhcmRUYWJTdG9wKCk7CiAgfQp9
OwoKLyoqCiAqIEVyYXNlIGluIERpc3Bs
YXkgKEVELCBERUNTRUQpLgogKi8KaHRl
cm0uVlQuQ1NJWydKJ10gPQpodGVybS5W
VC5DU0lbJz9KJ10gPSBmdW5jdGlvbihw
YXJzZVN0YXRlLCBjb2RlKSB7CiAgdmFy
IGFyZyA9IHBhcnNlU3RhdGUuYXJnc1sw
XTsKCiAgaWYgKCFhcmcgfHwgYXJnID09
ICcwJykgewogICAgICB0aGlzLnRlcm1p
bmFsLmVyYXNlQmVsb3coKTsKICB9IGVs
c2UgaWYgKGFyZyA9PSAnMScpIHsKICAg
IHRoaXMudGVybWluYWwuZXJhc2VBYm92
ZSgpOwogIH0gZWxzZSBpZiAoYXJnID09
ICcyJykgewogICAgdGhpcy50ZXJtaW5h
bC5jbGVhcigpOwogIH0gZWxzZSBpZiAo
YXJnID09ICczJykgewogICAgLy8gVGhl
IHh0ZXJtIGRvY3Mgc2F5IHRoaXMgbWVh
bnMgIkVyYXNlIHNhdmVkIGxpbmVzIiwg
YnV0IHdlJ2xsIGp1c3QgY2xlYXIKICAg
IC8vIHRoZSBkaXNwbGF5IHNpbmNlIGtp
bGxpbmcgdGhlIHNjcm9sbGJhY2sgc2Vl
bXMgcnVkZS4KICAgIHRoaXMudGVybWlu
YWwuY2xlYXIoKTsKICB9Cn07CgovKioK
ICogRXJhc2UgaW4gbGluZSAoRUwsIERF
Q1NFTCkuCiAqLwpodGVybS5WVC5DU0lb
J0snXSA9Cmh0ZXJtLlZULkNTSVsnP0sn
XSA9IGZ1bmN0aW9uKHBhcnNlU3RhdGUs
IGNvZGUpIHsKICB2YXIgYXJnID0gcGFy
c2VTdGF0ZS5hcmdzWzBdOwoKICBpZiAo
IWFyZyB8fCBhcmcgPT0gJzAnKSB7CiAg
ICB0aGlzLnRlcm1pbmFsLmVyYXNlVG9S
aWdodCgpOwogIH0gZWxzZSBpZiAoYXJn
ID09ICcxJyl7CiAgICB0aGlzLnRlcm1p
bmFsLmVyYXNlVG9MZWZ0KCk7CiAgfSBl
bHNlIGlmIChhcmcgPT0gJzInKSB7CiAg
ICB0aGlzLnRlcm1pbmFsLmVyYXNlTGlu
ZSgpOwogIH0KfTsKCi8qKgogKiBJbnNl
cnQgTGluZXMgKElMKS4KICovCmh0ZXJt
LlZULkNTSVsnTCddID0gZnVuY3Rpb24o
cGFyc2VTdGF0ZSkgewogIHRoaXMudGVy
bWluYWwuaW5zZXJ0TGluZXMocGFyc2VT
dGF0ZS5pYXJnKDAsIDEpKTsKfTsKCi8q
KgogKiBEZWxldGUgTGluZXMgKERMKS4K
ICovCmh0ZXJtLlZULkNTSVsnTSddID0g
ZnVuY3Rpb24ocGFyc2VTdGF0ZSkgewog
IHRoaXMudGVybWluYWwuZGVsZXRlTGlu
ZXMocGFyc2VTdGF0ZS5pYXJnKDAsIDEp
KTsKfTsKCi8qKgogKiBEZWxldGUgQ2hh
cmFjdGVycyAoRENIKS4KICoKICogVGhp
cyBjb21tYW5kIHNoaWZ0cyB0aGUgbGlu
ZSBjb250ZW50cyBsZWZ0LCBzdGFydGlu
ZyBhdCB0aGUgY3Vyc29yIHBvc2l0aW9u
LgogKi8KaHRlcm0uVlQuQ1NJWydQJ10g
PSBmdW5jdGlvbihwYXJzZVN0YXRlKSB7
CiAgdGhpcy50ZXJtaW5hbC5kZWxldGVD
aGFycyhwYXJzZVN0YXRlLmlhcmcoMCwg
MSkpOwp9OwoKLyoqCiAqIFNjcm9sbCBV
cCAoU1UpLgogKi8KaHRlcm0uVlQuQ1NJ
WydTJ10gPSBmdW5jdGlvbihwYXJzZVN0
YXRlKSB7CiAgdGhpcy50ZXJtaW5hbC52
dFNjcm9sbFVwKHBhcnNlU3RhdGUuaWFy
ZygwLCAxKSk7Cn07CgovKioKICogU2Ny
b2xsIERvd24gKFNEKS4KICogQWxzbyAn
SW5pdGlhdGUgaGlnaGxpZ2h0IG1vdXNl
IHRyYWNraW5nJy4gIFdpbGwgbm90IGlt
cGxlbWVudCB0aGlzIHBhcnQuCiAqLwpo
dGVybS5WVC5DU0lbJ1QnXSA9IGZ1bmN0
aW9uKHBhcnNlU3RhdGUpIHsKICBpZiAo
cGFyc2VTdGF0ZS5hcmdzLmxlbmd0aCA8
PSAxKQogICAgdGhpcy50ZXJtaW5hbC52
dFNjcm9sbERvd24ocGFyc2VTdGF0ZS5p
YXJnKDAsIDEpKTsKfTsKCi8qKgogKiBS
ZXNldCBvbmUgb3IgbW9yZSBmZWF0dXJl
cyBvZiB0aGUgdGl0bGUgbW9kZXMgdG8g
dGhlIGRlZmF1bHQgdmFsdWUuCiAqCiAq
ICAgRVNDIFsgPiBQcyBUCiAqCiAqIE5v
cm1hbGx5LCAicmVzZXQiIGRpc2FibGVz
IHRoZSBmZWF0dXJlLiBJdCBpcyBwb3Nz
aWJsZSB0byBkaXNhYmxlIHRoZQogKiBh
YmlsaXR5IHRvIHJlc2V0IGZlYXR1cmVz
IGJ5IGNvbXBpbGluZyBhIGRpZmZlcmVu
dCBkZWZhdWx0IGZvciB0aGUgdGl0bGUK
ICogbW9kZXMgaW50byB4dGVybS4KICoK
ICogUHMgdmFsdWVzOgogKiAgIDAgLSBE
byBub3Qgc2V0IHdpbmRvdy9pY29uIGxh
YmVscyB1c2luZyBoZXhhZGVjaW1hbC4K
ICogICAxIC0gRG8gbm90IHF1ZXJ5IHdp
bmRvdy9pY29uIGxhYmVscyB1c2luZyBo
ZXhhZGVjaW1hbC4KICogICAyIC0gRG8g
bm90IHNldCB3aW5kb3cvaWNvbiBsYWJl
bHMgdXNpbmcgVVRGLTguCiAqICAgMyAt
IERvIG5vdCBxdWVyeSB3aW5kb3cvaWNv
biBsYWJlbHMgdXNpbmcgVVRGLTguCiAq
CiAqIFdpbGwgbm90IGltcGxlbWVudC4K
ICovCmh0ZXJtLlZULkNTSVsnPlQnXSA9
IGh0ZXJtLlZULmlnbm9yZTsKCi8qKgog
KiBFcmFzZSBDaGFyYWN0ZXJzIChFQ0gp
LgogKi8KaHRlcm0uVlQuQ1NJWydYJ10g
PSBmdW5jdGlvbihwYXJzZVN0YXRlKSB7
CiAgdGhpcy50ZXJtaW5hbC5lcmFzZVRv
UmlnaHQocGFyc2VTdGF0ZS5pYXJnKDAs
IDEpKTsKfTsKCi8qKgogKiBDdXJzb3Ig
QmFja3dhcmQgVGFidWxhdGlvbiAoQ0JU
KS4KICovCmh0ZXJtLlZULkNTSVsnWidd
ID0gZnVuY3Rpb24ocGFyc2VTdGF0ZSkg
ewogIHZhciBjb3VudCA9IHBhcnNlU3Rh
dGUuaWFyZygwLCAxKTsKICBjb3VudCA9
IGxpYi5mLmNsYW1wKGNvdW50LCAxLCB0
aGlzLnRlcm1pbmFsLnNjcmVlblNpemUu
d2lkdGgpOwogIGZvciAodmFyIGkgPSAw
OyBpIDwgY291bnQ7IGkrKykgewogICAg
dGhpcy50ZXJtaW5hbC5iYWNrd2FyZFRh
YlN0b3AoKTsKICB9Cn07CgovKioKICog
Q2hhcmFjdGVyIFBvc2l0aW9uIEFic29s
dXRlIChIUEEpLgogKi8KaHRlcm0uVlQu
Q1NJWydgJ10gPSBmdW5jdGlvbihwYXJz
ZVN0YXRlKSB7CiAgdGhpcy50ZXJtaW5h
bC5zZXRDdXJzb3JDb2x1bW4ocGFyc2VT
dGF0ZS5pYXJnKDAsIDEpIC0gMSk7Cn07
CgovKioKICogUmVwZWF0IHRoZSBwcmVj
ZWRpbmcgZ3JhcGhpYyBjaGFyYWN0ZXIu
CiAqCiAqIE5vdCBjdXJyZW50bHkgaW1w
bGVtZW50ZWQuCiAqLwpodGVybS5WVC5D
U0lbJ2InXSA9IGh0ZXJtLlZULmlnbm9y
ZTsKCi8qKgogKiBTZW5kIERldmljZSBB
dHRyaWJ1dGVzIChQcmltYXJ5IERBKS4K
ICoKICogVE9ETyhyZ2luZGEpOiBUaGlz
IGlzIGhhcmRjb2RlZCB0byBzZW5kIGJh
Y2sgJ1ZUMTAwIHdpdGggQWR2YW5jZWQg
VmlkZW8KICogT3B0aW9uJywgYnV0IGl0
IG1heSBiZSBtb3JlIGNvcnJlY3QgdG8g
c2VuZCBhIFZUMjIwIHJlc3BvbnNlIG9u
Y2UKICogd2UgZmlsbCBvdXQgdGhlICdO
b3QgY3VycmVudGx5IGltcGxlbWVudGVk
JyBwYXJ0cy4KICovCmh0ZXJtLlZULkNT
SVsnYyddID0gZnVuY3Rpb24ocGFyc2VT
dGF0ZSkgewogIGlmICghcGFyc2VTdGF0
ZS5hcmdzWzBdIHx8IHBhcnNlU3RhdGUu
YXJnc1swXSA9PSAnMCcpIHsKICAgIHRo
aXMudGVybWluYWwuaW8uc2VuZFN0cmlu
ZygnXHgxYls/MTsyYycpOwogIH0KfTsK
Ci8qKgogKiBTZW5kIERldmljZSBBdHRy
aWJ1dGVzIChTZWNvbmRhcnkgREEpLgog
KgogKiBUT0RPKHJnaW5kYSk6IFRoaXMg
aXMgaGFyZGNvZGVkIHRvIHNlbmQgYmFj
ayAnVlQxMDAnIGJ1dCBpdCBtYXkgYmUg
bW9yZQogKiBjb3JyZWN0IHRvIHNlbmQg
YSBWVDIyMCByZXNwb25zZSBvbmNlIHdl
IGZpbGwgb3V0IG1vcmUgJ05vdCBjdXJy
ZW50bHkKICogaW1wbGVtZW50ZWQnIHBh
cnRzLgogKi8KaHRlcm0uVlQuQ1NJWyc+
YyddID0gZnVuY3Rpb24ocGFyc2VTdGF0
ZSkgewogIHRoaXMudGVybWluYWwuaW8u
c2VuZFN0cmluZygnXHgxYls+MDsyNTY7
MGMnKTsKfTsKCi8qKgogKiBMaW5lIFBv
c2l0aW9uIEFic29sdXRlIChWUEEpLgog
Ki8KaHRlcm0uVlQuQ1NJWydkJ10gPSBm
dW5jdGlvbihwYXJzZVN0YXRlKSB7CiAg
dGhpcy50ZXJtaW5hbC5zZXRBYnNvbHV0
ZUN1cnNvclJvdyhwYXJzZVN0YXRlLmlh
cmcoMCwgMSkgLSAxKTsKfTsKCi8qKgog
KiBIb3Jpem9udGFsIGFuZCBWZXJ0aWNh
bCBQb3NpdGlvbiAoSFZQKS4KICoKICog
U2FtZSBhcyBDdXJzb3IgUG9zaXRpb24g
KENVUCkuCiAqLwpodGVybS5WVC5DU0lb
J2YnXSA9IGh0ZXJtLlZULkNTSVsnSCdd
OwoKLyoqCiAqIFRhYiBDbGVhciAoVEJD
KS4KICovCmh0ZXJtLlZULkNTSVsnZydd
ID0gZnVuY3Rpb24ocGFyc2VTdGF0ZSkg
ewogIGlmICghcGFyc2VTdGF0ZS5hcmdz
WzBdIHx8IHBhcnNlU3RhdGUuYXJnc1sw
XSA9PSAnMCcpIHsKICAgIC8vIENsZWFy
IHRhYiBzdG9wIGF0IGN1cnNvci4KICAg
IHRoaXMudGVybWluYWwuY2xlYXJUYWJT
dG9wQXRDdXJzb3IoZmFsc2UpOwogIH0g
ZWxzZSBpZiAocGFyc2VTdGF0ZS5hcmdz
WzBdID09ICczJykgewogICAgLy8gQ2xl
YXIgYWxsIHRhYiBzdG9wcy4KICAgIHRo
aXMudGVybWluYWwuY2xlYXJBbGxUYWJT
dG9wcygpOwogIH0KfTsKCi8qKgogKiBT
ZXQgTW9kZSAoU00pLgogKi8KaHRlcm0u
VlQuQ1NJWydoJ10gPSBmdW5jdGlvbihw
YXJzZVN0YXRlKSB7CiAgZm9yICh2YXIg
aSA9IDA7IGkgPCBwYXJzZVN0YXRlLmFy
Z3MubGVuZ3RoOyBpKyspIHsKICAgIHRo
aXMuc2V0QU5TSU1vZGUocGFyc2VTdGF0
ZS5hcmdzW2ldLCB0cnVlKTsKICB9Cn07
CgovKioKICogREVDIFByaXZhdGUgTW9k
ZSBTZXQgKERFQ1NFVCkuCiAqLwpodGVy
bS5WVC5DU0lbJz9oJ10gPSBmdW5jdGlv
bihwYXJzZVN0YXRlKSB7CiAgZm9yICh2
YXIgaSA9IDA7IGkgPCBwYXJzZVN0YXRl
LmFyZ3MubGVuZ3RoOyBpKyspIHsKICAg
IHRoaXMuc2V0REVDTW9kZShwYXJzZVN0
YXRlLmFyZ3NbaV0sIHRydWUpOwogIH0K
fTsKCi8qKgogKiBNZWRpYSBDb3B5IChN
QykuCiAqIE1lZGlhIENvcHkgKE1DLCBE
RUMgU3BlY2lmaWMpLgogKgogKiBUaGVz
ZSBjb21tYW5kcyBjb250cm9sIHRoZSBw
cmludGVyLiAgV2lsbCBub3QgaW1wbGVt
ZW50LgogKi8KaHRlcm0uVlQuQ1NJWydp
J10gPQpodGVybS5WVC5DU0lbJz9pJ10g
PSBodGVybS5WVC5pZ25vcmU7CgovKioK
ICogUmVzZXQgTW9kZSAoUk0pLgogKi8K
aHRlcm0uVlQuQ1NJWydsJ10gPSBmdW5j
dGlvbihwYXJzZVN0YXRlKSB7CiAgZm9y
ICh2YXIgaSA9IDA7IGkgPCBwYXJzZVN0
YXRlLmFyZ3MubGVuZ3RoOyBpKyspIHsK
ICAgIHRoaXMuc2V0QU5TSU1vZGUocGFy
c2VTdGF0ZS5hcmdzW2ldLCBmYWxzZSk7
CiAgfQp9OwoKLyoqCiAqIERFQyBQcml2
YXRlIE1vZGUgUmVzZXQgKERFQ1JTVCku
CiAqLwpodGVybS5WVC5DU0lbJz9sJ10g
PSBmdW5jdGlvbihwYXJzZVN0YXRlKSB7
CiAgZm9yICh2YXIgaSA9IDA7IGkgPCBw
YXJzZVN0YXRlLmFyZ3MubGVuZ3RoOyBp
KyspIHsKICAgIHRoaXMuc2V0REVDTW9k
ZShwYXJzZVN0YXRlLmFyZ3NbaV0sIGZh
bHNlKTsKICB9Cn07CgovKioKICogQ2hh
cmFjdGVyIEF0dHJpYnV0ZXMgKFNHUiku
CiAqCiAqIEl0ZXJhdGUgdGhyb3VnaCB0
aGUgbGlzdCBvZiBhcmd1bWVudHMsIGFw
cGx5aW5nIHRoZSBmb2xsb3dpbmcgYXR0
cmlidXRlCiAqIGNoYW5nZXMgYmFzZWQg
b24gdGhlIGFyZ3VtZW50IHZhbHVlLi4u
CiAqCiAqICAgIDAgTm9ybWFsIChkZWZh
dWx0KS4KICogICAgMSBCb2xkLgogKiAg
ICAyIEZhaW50LgogKiAgICAzIEl0YWxp
YyAobm9uLXh0ZXJtKS4KICogICAgNCBV
bmRlcmxpbmVkLgogKiAgICA1IEJsaW5r
IChhcHBlYXJzIGFzIEJvbGQpLgogKiAg
ICA3IEludmVyc2UuCiAqICAgIDggSW52
aXNpYmxlLCBpLmUuLCBoaWRkZW4gKFZU
MzAwKS4KICogICAgOSBDcm9zc2VkIG91
dCAoRUNNQS00OCkuCiAqICAgMjIgTm9y
bWFsIChuZWl0aGVyIGJvbGQgbm9yIGZh
aW50KS4KICogICAyMyBOb3QgaXRhbGlj
IChub24teHRlcm0pLgogKiAgIDI0IE5v
dCB1bmRlcmxpbmVkLgogKiAgIDI1IFN0
ZWFkeSAobm90IGJsaW5raW5nKS4KICog
ICAyNyBQb3NpdGl2ZSAobm90IGludmVy
c2UpLgogKiAgIDI4IFZpc2libGUsIGku
ZS4sIG5vdCBoaWRkZW4gKFZUMzAwKS4K
ICogICAyOSBOb3QgY3Jvc3NlZCBvdXQg
KEVDTUEtNDgpLgogKiAgIDMwIFNldCBm
b3JlZ3JvdW5kIGNvbG9yIHRvIEJsYWNr
LgogKiAgIDMxIFNldCBmb3JlZ3JvdW5k
IGNvbG9yIHRvIFJlZC4KICogICAzMiBT
ZXQgZm9yZWdyb3VuZCBjb2xvciB0byBH
cmVlbi4KICogICAzMyBTZXQgZm9yZWdy
b3VuZCBjb2xvciB0byBZZWxsb3cuCiAq
ICAgMzQgU2V0IGZvcmVncm91bmQgY29s
b3IgdG8gQmx1ZS4KICogICAzNSBTZXQg
Zm9yZWdyb3VuZCBjb2xvciB0byBNYWdl
bnRhLgogKiAgIDM2IFNldCBmb3JlZ3Jv
dW5kIGNvbG9yIHRvIEN5YW4uCiAqICAg
MzcgU2V0IGZvcmVncm91bmQgY29sb3Ig
dG8gV2hpdGUuCiAqICAgMzkgU2V0IGZv
cmVncm91bmQgY29sb3IgdG8gZGVmYXVs
dCAob3JpZ2luYWwpLgogKiAgIDQwIFNl
dCBiYWNrZ3JvdW5kIGNvbG9yIHRvIEJs
YWNrLgogKiAgIDQxIFNldCBiYWNrZ3Jv
dW5kIGNvbG9yIHRvIFJlZC4KICogICA0
MiBTZXQgYmFja2dyb3VuZCBjb2xvciB0
byBHcmVlbi4KICogICA0MyBTZXQgYmFj
a2dyb3VuZCBjb2xvciB0byBZZWxsb3cu
CiAqICAgNDQgU2V0IGJhY2tncm91bmQg
Y29sb3IgdG8gQmx1ZS4KICogICA0NSBT
ZXQgYmFja2dyb3VuZCBjb2xvciB0byBN
YWdlbnRhLgogKiAgIDQ2IFNldCBiYWNr
Z3JvdW5kIGNvbG9yIHRvIEN5YW4uCiAq
ICAgNDcgU2V0IGJhY2tncm91bmQgY29s
b3IgdG8gV2hpdGUuCiAqICAgNDkgU2V0
IGJhY2tncm91bmQgY29sb3IgdG8gZGVm
YXVsdCAob3JpZ2luYWwpCiAqCiAqIE5v
bi14dGVybSAoaXRhbGljKSBjb2RlcyBo
YXZlIG1peGVkIHN1cHBvcnQsIGJ1dCBh
cmUgc3VwcG9ydGVkIGJ5IGJvdGgKICog
Z25vbWUtdGVybWluYWwgYW5kIHJ4dnQg
YW5kIGFyZSByZWNvZ25pemVkIGFzIENT
SSBjb2RlcyBvbiBXaWtpcGVkaWEKICog
KGh0dHA6Ly9lbi53aWtpcGVkaWEub3Jn
L3dpa2kvQU5TSV9lc2NhcGVfY29kZSku
CiAqCiAqIEZvciAxNi1jb2xvciBzdXBw
b3J0LCB0aGUgZm9sbG93aW5nIGFwcGx5
LgogKgogKiAgIDkwIFNldCBmb3JlZ3Jv
dW5kIGNvbG9yIHRvIEJyaWdodCBCbGFj
ay4KICogICA5MSBTZXQgZm9yZWdyb3Vu
ZCBjb2xvciB0byBCcmlnaHQgUmVkLgog
KiAgIDkyIFNldCBmb3JlZ3JvdW5kIGNv
bG9yIHRvIEJyaWdodCBHcmVlbi4KICog
ICA5MyBTZXQgZm9yZWdyb3VuZCBjb2xv
ciB0byBCcmlnaHQgWWVsbG93LgogKiAg
IDk0IFNldCBmb3JlZ3JvdW5kIGNvbG9y
IHRvIEJyaWdodCBCbHVlLgogKiAgIDk1
IFNldCBmb3JlZ3JvdW5kIGNvbG9yIHRv
IEJyaWdodCBNYWdlbnRhLgogKiAgIDk2
IFNldCBmb3JlZ3JvdW5kIGNvbG9yIHRv
IEJyaWdodCBDeWFuLgogKiAgIDk3IFNl
dCBmb3JlZ3JvdW5kIGNvbG9yIHRvIEJy
aWdodCBXaGl0ZS4KICogIDEwMCBTZXQg
YmFja2dyb3VuZCBjb2xvciB0byBCcmln
aHQgQmxhY2suCiAqICAxMDEgU2V0IGJh
Y2tncm91bmQgY29sb3IgdG8gQnJpZ2h0
IFJlZC4KICogIDEwMiBTZXQgYmFja2dy
b3VuZCBjb2xvciB0byBCcmlnaHQgR3Jl
ZW4uCiAqICAxMDMgU2V0IGJhY2tncm91
bmQgY29sb3IgdG8gQnJpZ2h0IFllbGxv
dy4KICogIDEwNCBTZXQgYmFja2dyb3Vu
ZCBjb2xvciB0byBCcmlnaHQgQmx1ZS4K
ICogIDEwNSBTZXQgYmFja2dyb3VuZCBj
b2xvciB0byBCcmlnaHQgTWFnZW50YS4K
ICogIDEwNiBTZXQgYmFja2dyb3VuZCBj
b2xvciB0byBCcmlnaHQgQ3lhbi4KICog
IDEwNyBTZXQgYmFja2dyb3VuZCBjb2xv
ciB0byBCcmlnaHQgV2hpdGUuCiAqCiAq
IEZvciA4OC0gb3IgMjU2LWNvbG9yIHN1
cHBvcnQsIHRoZSBmb2xsb3dpbmcgYXBw
bHkuCiAqICAzOCA7IDUgOyBQIFNldCBm
b3JlZ3JvdW5kIGNvbG9yIHRvIFAuCiAq
ICA0OCA7IDUgOyBQIFNldCBiYWNrZ3Jv
dW5kIGNvbG9yIHRvIFAuCiAqCiAqICBG
b3IgdHJ1ZSBjb2xvciAoMjQtYml0KSBz
dXBwb3J0LCB0aGUgZm9sbG93aW5nIGFw
cGx5LgogKiAgMzggOyAyIDsgUiA7IEcg
OyBCIFNldCBmb3JlZ3JvdW5kIGNvbG9y
IHRvIHJnYihSLCBHLCBCKQogKiAgNDgg
OyAyIDsgUiA7IEcgOyBCIFNldCBiYWNr
Z3JvdW5kIGNvbG9yIHRvIHJnYihSLCBH
LCBCKQogKgogKiBOb3RlIHRoYXQgbW9z
dCB0ZXJtaW5hbHMgY29uc2lkZXIgImJv
bGQiIHRvIGJlICJib2xkIGFuZCBicmln
aHQiLiAgSW4KICogc29tZSBkb2N1bWVu
dHMgdGhlIGJvbGQgc3RhdGUgaXMgZXZl
biByZWZlcnJlZCB0byBhcyBicmlnaHQu
ICBXZSBpbnRlcnByZXQKICogYm9sZCBh
cyBib2xkLWJyaWdodCBoZXJlIHRvbywg
YnV0IG9ubHkgd2hlbiB0aGUgImJvbGQi
IHNldHRpbmcgY29tZXMgYmVmb3JlCiAq
IHRoZSBjb2xvciBzZWxlY3Rpb24uCiAq
LwpodGVybS5WVC5DU0lbJ20nXSA9IGZ1
bmN0aW9uKHBhcnNlU3RhdGUpIHsKICBm
dW5jdGlvbiBnZXQyNTYoaSkgewogICAg
aWYgKHBhcnNlU3RhdGUuYXJncy5sZW5n
dGggPCBpICsgMiB8fCBwYXJzZVN0YXRl
LmFyZ3NbaSArIDFdICE9ICc1JykKICAg
ICAgcmV0dXJuIG51bGw7CgogICAgcmV0
dXJuIHBhcnNlU3RhdGUuaWFyZyhpICsg
MiwgMCk7CiAgfQoKICBmdW5jdGlvbiBn
ZXRUcnVlQ29sb3IoaSkgewogICAgaWYg
KHBhcnNlU3RhdGUuYXJncy5sZW5ndGgg
PCBpICsgNSB8fCBwYXJzZVN0YXRlLmFy
Z3NbaSArIDFdICE9ICcyJykKICAgICAg
cmV0dXJuIG51bGw7CiAgICB2YXIgciA9
IHBhcnNlU3RhdGUuaWFyZyhpICsgMiwg
MCk7CiAgICB2YXIgZyA9IHBhcnNlU3Rh
dGUuaWFyZyhpICsgMywgMCk7CiAgICB2
YXIgYiA9IHBhcnNlU3RhdGUuaWFyZyhp
ICsgNCwgMCk7CgogICAgcmV0dXJuICdy
Z2IoJyArIHIgKyAnICwnICsgZyArICcg
LCcgKyBiICsgJyknOwogIH0KCiAgdmFy
IGF0dHJzID0gdGhpcy50ZXJtaW5hbC5n
ZXRUZXh0QXR0cmlidXRlcygpOwoKICBp
ZiAoIXBhcnNlU3RhdGUuYXJncy5sZW5n
dGgpIHsKICAgIGF0dHJzLnJlc2V0KCk7
CiAgICByZXR1cm47CiAgfQoKICBmb3Ig
KHZhciBpID0gMDsgaSA8IHBhcnNlU3Rh
dGUuYXJncy5sZW5ndGg7IGkrKykgewog
ICAgdmFyIGFyZyA9IHBhcnNlU3RhdGUu
aWFyZyhpLCAwKTsKCiAgICBpZiAoYXJn
IDwgMzApIHsKICAgICAgaWYgKGFyZyA9
PSAwKSB7CiAgICAgICAgYXR0cnMucmVz
ZXQoKTsKICAgICAgfSBlbHNlIGlmIChh
cmcgPT0gMSkgewogICAgICAgIGF0dHJz
LmJvbGQgPSB0cnVlOwogICAgICB9IGVs
c2UgaWYgKGFyZyA9PSAyKSB7CiAgICAg
ICAgYXR0cnMuZmFpbnQgPSB0cnVlOwog
ICAgICB9IGVsc2UgaWYgKGFyZyA9PSAz
KSB7CiAgICAgICAgYXR0cnMuaXRhbGlj
ID0gdHJ1ZTsKICAgICAgfSBlbHNlIGlm
IChhcmcgPT0gNCkgewogICAgICAgIGF0
dHJzLnVuZGVybGluZSA9IHRydWU7CiAg
ICAgIH0gZWxzZSBpZiAoYXJnID09IDUp
IHsKICAgICAgICBhdHRycy5ibGluayA9
IHRydWU7CiAgICAgIH0gZWxzZSBpZiAo
YXJnID09IDcpIHsgIC8vIEludmVyc2Uu
CiAgICAgICAgYXR0cnMuaW52ZXJzZSA9
IHRydWU7CiAgICAgIH0gZWxzZSBpZiAo
YXJnID09IDgpIHsgIC8vIEludmlzaWJs
ZS4KICAgICAgICBhdHRycy5pbnZpc2li
bGUgPSB0cnVlOwogICAgICB9IGVsc2Ug
aWYgKGFyZyA9PSA5KSB7CiAgICAgICAg
YXR0cnMuc3RyaWtldGhyb3VnaCA9IHRy
dWU7CiAgICAgIH0gZWxzZSBpZiAoYXJn
ID09IDIyKSB7CiAgICAgICAgYXR0cnMu
Ym9sZCA9IGZhbHNlOwogICAgICAgIGF0
dHJzLmZhaW50ID0gZmFsc2U7CiAgICAg
IH0gZWxzZSBpZiAoYXJnID09IDIzKSB7
CiAgICAgICAgYXR0cnMuaXRhbGljID0g
ZmFsc2U7CiAgICAgIH0gZWxzZSBpZiAo
YXJnID09IDI0KSB7CiAgICAgICAgYXR0
cnMudW5kZXJsaW5lID0gZmFsc2U7CiAg
ICAgIH0gZWxzZSBpZiAoYXJnID09IDI1
KSB7CiAgICAgICAgYXR0cnMuYmxpbmsg
PSBmYWxzZTsKICAgICAgfSBlbHNlIGlm
IChhcmcgPT0gMjcpIHsKICAgICAgICBh
dHRycy5pbnZlcnNlID0gZmFsc2U7CiAg
ICAgIH0gZWxzZSBpZiAoYXJnID09IDI4
KSB7CiAgICAgICAgYXR0cnMuaW52aXNp
YmxlID0gZmFsc2U7CiAgICAgIH0gZWxz
ZSBpZiAoYXJnID09IDI5KSB7CiAgICAg
ICAgYXR0cnMuc3RyaWtldGhyb3VnaCA9
IGZhbHNlOwogICAgICB9CgogICAgfSBl
bHNlIGlmIChhcmcgPCA1MCkgewogICAg
ICAvLyBTZWxlY3QgZm9yZS9iYWNrZ3Jv
dW5kIGNvbG9yIGZyb20gYm90dG9tIGhh
bGYgb2YgMTYgY29sb3IgcGFsZXR0ZQog
ICAgICAvLyBvciBmcm9tIHRoZSAyNTYg
Y29sb3IgcGFsZXR0ZSBvciBhbHRlcm5h
dGl2ZSBzcGVjaWZ5IGNvbG9yIGluIGZ1
bGx5CiAgICAgIC8vIHF1YWxpZmllZCBy
Z2IociwgZywgYikgZm9ybS4KICAgICAg
aWYgKGFyZyA8IDM4KSB7CiAgICAgICAg
YXR0cnMuZm9yZWdyb3VuZFNvdXJjZSA9
IGFyZyAtIDMwOwoKICAgICAgfSBlbHNl
IGlmIChhcmcgPT0gMzgpIHsKICAgICAg
ICAvLyBGaXJzdCBjaGVjayBmb3IgdHJ1
ZSBjb2xvciBkZWZpbml0aW9uCiAgICAg
ICAgdmFyIHRydWVDb2xvciA9IGdldFRy
dWVDb2xvcihpKTsKICAgICAgICBpZiAo
dHJ1ZUNvbG9yICE9IG51bGwpIHsKICAg
ICAgICAgIGF0dHJzLmZvcmVncm91bmRT
b3VyY2UgPSBhdHRycy5TUkNfUkdCOwog
ICAgICAgICAgYXR0cnMuZm9yZWdyb3Vu
ZCA9IHRydWVDb2xvcjsKCiAgICAgICAg
ICBpICs9IDU7CiAgICAgICAgfSBlbHNl
IHsKICAgICAgICAgIC8vIENoZWNrIGZv
ciAyNTYgY29sb3IKICAgICAgICAgIHZh
ciBjID0gZ2V0MjU2KGkpOwogICAgICAg
ICAgaWYgKGMgPT0gbnVsbCkKICAgICAg
ICAgICAgYnJlYWs7CgogICAgICAgICAg
aSArPSAyOwoKICAgICAgICAgIGlmIChj
ID49IGF0dHJzLmNvbG9yUGFsZXR0ZS5s
ZW5ndGgpCiAgICAgICAgICAgIGNvbnRp
bnVlOwoKICAgICAgICAgIGF0dHJzLmZv
cmVncm91bmRTb3VyY2UgPSBjOwogICAg
ICAgIH0KCiAgICAgIH0gZWxzZSBpZiAo
YXJnID09IDM5KSB7CiAgICAgICAgYXR0
cnMuZm9yZWdyb3VuZFNvdXJjZSA9IGF0
dHJzLlNSQ19ERUZBVUxUOwoKICAgICAg
fSBlbHNlIGlmIChhcmcgPCA0OCkgewog
ICAgICAgIGF0dHJzLmJhY2tncm91bmRT
b3VyY2UgPSBhcmcgLSA0MDsKCiAgICAg
IH0gZWxzZSBpZiAoYXJnID09IDQ4KSB7
CiAgICAgICAgLy8gRmlyc3QgY2hlY2sg
Zm9yIHRydWUgY29sb3IgZGVmaW5pdGlv
bgogICAgICAgIHZhciB0cnVlQ29sb3Ig
PSBnZXRUcnVlQ29sb3IoaSk7CiAgICAg
ICAgaWYgKHRydWVDb2xvciAhPSBudWxs
KSB7CiAgICAgICAgICBhdHRycy5iYWNr
Z3JvdW5kU291cmNlID0gYXR0cnMuU1JD
X1JHQjsKICAgICAgICAgIGF0dHJzLmJh
Y2tncm91bmQgPSB0cnVlQ29sb3I7Cgog
ICAgICAgICAgaSArPSA1OwogICAgICAg
IH0gZWxzZSB7CiAgICAgICAgICAvLyBD
aGVjayBmb3IgMjU2IGNvbG9yCiAgICAg
ICAgICB2YXIgYyA9IGdldDI1NihpKTsK
ICAgICAgICAgIGlmIChjID09IG51bGwp
CiAgICAgICAgICAgIGJyZWFrOwoKICAg
ICAgICAgIGkgKz0gMjsKCiAgICAgICAg
ICBpZiAoYyA+PSBhdHRycy5jb2xvclBh
bGV0dGUubGVuZ3RoKQogICAgICAgICAg
ICBjb250aW51ZTsKCiAgICAgICAgICBh
dHRycy5iYWNrZ3JvdW5kU291cmNlID0g
YzsKICAgICAgICB9CiAgICAgIH0gZWxz
ZSB7CiAgICAgICAgYXR0cnMuYmFja2dy
b3VuZFNvdXJjZSA9IGF0dHJzLlNSQ19E
RUZBVUxUOwogICAgICB9CgogICAgfSBl
bHNlIGlmIChhcmcgPj0gOTAgJiYgYXJn
IDw9IDk3KSB7CiAgICAgIGF0dHJzLmZv
cmVncm91bmRTb3VyY2UgPSBhcmcgLSA5
MCArIDg7CgogICAgfSBlbHNlIGlmIChh
cmcgPj0gMTAwICYmIGFyZyA8PSAxMDcp
IHsKICAgICAgYXR0cnMuYmFja2dyb3Vu
ZFNvdXJjZSA9IGFyZyAtIDEwMCArIDg7
CiAgICB9CiAgfQoKICBhdHRycy5zZXRE
ZWZhdWx0cyh0aGlzLnRlcm1pbmFsLmdl
dEZvcmVncm91bmRDb2xvcigpLAogICAg
ICAgICAgICAgICAgICAgIHRoaXMudGVy
bWluYWwuZ2V0QmFja2dyb3VuZENvbG9y
KCkpOwp9OwoKLyoqCiAqIFNldCB4dGVy
bS1zcGVjaWZpYyBrZXlib2FyZCBtb2Rl
cy4KICoKICogV2lsbCBub3QgaW1wbGVt
ZW50LgogKi8KaHRlcm0uVlQuQ1NJWyc+
bSddID0gaHRlcm0uVlQuaWdub3JlOwoK
LyoqCiAqIERldmljZSBTdGF0dXMgUmVw
b3J0IChEU1IsIERFQyBTcGVjaWZpYyku
CiAqCiAqIDUgLSBTdGF0dXMgUmVwb3J0
LiBSZXN1bHQgKE9LKSBpcyBDU0kgMCBu
CiAqIDYgLSBSZXBvcnQgQ3Vyc29yIFBv
c2l0aW9uIChDUFIpIFtyb3c7Y29sdW1u
XS4gUmVzdWx0IGlzIENTSSByIDsgYyBS
CiAqLwpodGVybS5WVC5DU0lbJ24nXSA9
IGZ1bmN0aW9uKHBhcnNlU3RhdGUpIHsK
ICBpZiAocGFyc2VTdGF0ZS5hcmdzWzBd
ID09ICc1JykgewogICAgdGhpcy50ZXJt
aW5hbC5pby5zZW5kU3RyaW5nKCdceDFi
MG4nKTsKICB9IGVsc2UgaWYgKHBhcnNl
U3RhdGUuYXJnc1swXSA9PSAnNicpIHsK
ICAgIHZhciByb3cgPSB0aGlzLnRlcm1p
bmFsLmdldEN1cnNvclJvdygpICsgMTsK
ICAgIHZhciBjb2wgPSB0aGlzLnRlcm1p
bmFsLmdldEN1cnNvckNvbHVtbigpICsg
MTsKICAgIHRoaXMudGVybWluYWwuaW8u
c2VuZFN0cmluZygnXHgxYlsnICsgcm93
ICsgJzsnICsgY29sICsgJ1InKTsKICB9
Cn07CgovKioKICogRGlzYWJsZSBtb2Rp
ZmllcnMgd2hpY2ggbWF5IGJlIGVuYWJs
ZWQgdmlhIENTSVsnPm0nXS4KICoKICog
V2lsbCBub3QgaW1wbGVtZW50LgogKi8K
aHRlcm0uVlQuQ1NJWyc+biddID0gaHRl
cm0uVlQuaWdub3JlOwoKLyoqCiAqIERl
dmljZSBTdGF0dXMgUmVwb3J0IChEU1Is
IERFQyBTcGVjaWZpYykuCiAqCiAqIDYg
IC0gUmVwb3J0IEN1cnNvciBQb3NpdGlv
biAoQ1BSKSBbcm93O2NvbHVtbl0gYXMg
Q1NJID8gciA7IGMgUgogKiAxNSAtIFJl
cG9ydCBQcmludGVyIHN0YXR1cyBhcyBD
U0kgPyAxIDAgbiAocmVhZHkpIG9yCiAq
ICAgICAgQ1NJID8gMSAxIG4gKG5vdCBy
ZWFkeSkuCiAqIDI1IC0gUmVwb3J0IFVE
SyBzdGF0dXMgYXMgQ1NJID8gMiAwIG4g
KHVubG9ja2VkKSBvciBDU0kgPyAyIDEg
biAobG9ja2VkKS4KICogMjYgLSBSZXBv
cnQgS2V5Ym9hcmQgc3RhdHVzIGFzIENT
SSA/IDIgNyA7IDEgOyAwIDsgMCBuIChO
b3J0aCBBbWVyaWNhbikuCiAqICAgICAg
VGhlIGxhc3QgdHdvIHBhcmFtZXRlcnMg
YXBwbHkgdG8gVlQ0MDAgJiB1cCwgYW5k
IGRlbm90ZSBrZXlib2FyZCByZWFkeQog
KiAgICAgIGFuZCBMSzAxIHJlc3BlY3Rp
dmVseS4KICogNTMgLSBSZXBvcnQgTG9j
YXRvciBzdGF0dXMgYXMgQ1NJID8gNSAz
IG4gTG9jYXRvciBhdmFpbGFibGUsIGlm
IGNvbXBpbGVkLWluLAogKiAgICAgIG9y
IENTSSA/IDUgMCBuIE5vIExvY2F0b3Is
IGlmIG5vdC4KICovCmh0ZXJtLlZULkNT
SVsnP24nXSA9IGZ1bmN0aW9uKHBhcnNl
U3RhdGUpIHsKICBpZiAocGFyc2VTdGF0
ZS5hcmdzWzBdID09ICc2JykgewogICAg
dmFyIHJvdyA9IHRoaXMudGVybWluYWwu
Z2V0Q3Vyc29yUm93KCkgKyAxOwogICAg
dmFyIGNvbCA9IHRoaXMudGVybWluYWwu
Z2V0Q3Vyc29yQ29sdW1uKCkgKyAxOwog
ICAgdGhpcy50ZXJtaW5hbC5pby5zZW5k
U3RyaW5nKCdceDFiWycgKyByb3cgKyAn
OycgKyBjb2wgKyAnUicpOwogIH0gZWxz
ZSBpZiAocGFyc2VTdGF0ZS5hcmdzWzBd
ID09ICcxNScpIHsKICAgIHRoaXMudGVy
bWluYWwuaW8uc2VuZFN0cmluZygnXHgx
Yls/MTFuJyk7CiAgfSBlbHNlIGlmIChw
YXJzZVN0YXRlLmFyZ3NbMF0gPT0gJzI1
JykgewogICAgdGhpcy50ZXJtaW5hbC5p
by5zZW5kU3RyaW5nKCdceDFiWz8yMW4n
KTsKICB9IGVsc2UgaWYgKHBhcnNlU3Rh
dGUuYXJnc1swXSA9PSAnMjYnKSB7CiAg
ICB0aGlzLnRlcm1pbmFsLmlvLnNlbmRT
dHJpbmcoJ1x4MWJbPzEyOzE7MDswbicp
OwogIH0gZWxzZSBpZiAocGFyc2VTdGF0
ZS5hcmdzWzBdID09ICc1MycpIHsKICAg
IHRoaXMudGVybWluYWwuaW8uc2VuZFN0
cmluZygnXHgxYls/NTBuJyk7CiAgfQp9
OwoKLyoqCiAqIFRoaXMgaXMgdXNlZCBi
eSB4dGVybSB0byBkZWNpZGUgd2hldGhl
ciB0byBoaWRlIHRoZSBwb2ludGVyIGN1
cnNvciBhcyB0aGUKICogdXNlciB0eXBl
cy4KICoKICogVmFsaWQgdmFsdWVzIGZv
ciB0aGUgcGFyYW1ldGVyOgogKiAgIDAg
LSBOZXZlciBoaWRlIHRoZSBwb2ludGVy
LgogKiAgIDEgLSBIaWRlIGlmIHRoZSBt
b3VzZSB0cmFja2luZyBtb2RlIGlzIG5v
dCBlbmFibGVkLgogKiAgIDIgLSBBbHdh
eXMgaGlkZSB0aGUgcG9pbnRlci4KICoK
ICogSWYgbm8gcGFyYW1ldGVyIGlzIGdp
dmVuLCB4dGVybSB1c2VzIHRoZSBkZWZh
dWx0LCB3aGljaCBpcyAxLgogKgogKiBO
b3QgY3VycmVudGx5IGltcGxlbWVudGVk
LgogKi8KaHRlcm0uVlQuQ1NJWyc+cCdd
ID0gaHRlcm0uVlQuaWdub3JlOwoKLyoq
CiAqIFNvZnQgdGVybWluYWwgcmVzZXQg
KERFQ1NUUikuCiAqLwpodGVybS5WVC5D
U0lbJyFwJ10gPSBmdW5jdGlvbigpIHsK
ICB0aGlzLnJlc2V0KCk7CiAgdGhpcy50
ZXJtaW5hbC5zb2Z0UmVzZXQoKTsKfTsK
Ci8qKgogKiBSZXF1ZXN0IEFOU0kgTW9k
ZSAoREVDUlFNKS4KICoKICogTm90IGN1
cnJlbnRseSBpbXBsZW1lbnRlZC4KICov
Cmh0ZXJtLlZULkNTSVsnJHAnXSA9IGh0
ZXJtLlZULmlnbm9yZTsKaHRlcm0uVlQu
Q1NJWyc/JHAnXSA9IGh0ZXJtLlZULmln
bm9yZTsKCi8qKgogKiBTZXQgY29uZm9y
bWFuY2UgbGV2ZWwgKERFQ1NDTCkuCiAq
CiAqIE5vdCBjdXJyZW50bHkgaW1wbGVt
ZW50ZWQuCiAqLwpodGVybS5WVC5DU0lb
JyJwJ10gPSBodGVybS5WVC5pZ25vcmU7
CgovKioKICogTG9hZCBMRURzIChERUNM
TCkuCiAqCiAqIE5vdCBjdXJyZW50bHkg
aW1wbGVtZW50ZWQuICBDb3VsZCBiZSBp
bXBsZW1lbnRlZCBhcyB2aXJ0dWFsIExF
RHMgb3ZlcmxheWluZwogKiB0aGUgdGVy
bWluYWwgaWYgYW55b25lIGNhcmVzLgog
Ki8KaHRlcm0uVlQuQ1NJWydxJ10gPSBo
dGVybS5WVC5pZ25vcmU7CgovKioKICog
U2V0IGN1cnNvciBzdHlsZSAoREVDU0NV
U1IsIFZUNTIwKS4KICoKICogICAwIC0g
QmxpbmtpbmcgYmxvY2suCiAqICAgMSAt
IEJsaW5raW5nIGJsb2NrIChkZWZhdWx0
KS4KICogICAyIC0gU3RlYWR5IGJsb2Nr
LgogKiAgIDMgLSBCbGlua2luZyB1bmRl
cmxpbmUuCiAqICAgNCAtIFN0ZWFkeSB1
bmRlcmxpbmUuCiAqLwpodGVybS5WVC5D
U0lbJyBxJ10gPSBmdW5jdGlvbihwYXJz
ZVN0YXRlKSB7CiAgdmFyIGFyZyA9IHBh
cnNlU3RhdGUuYXJnc1swXTsKCiAgaWYg
KGFyZyA9PSAnMCcgfHwgYXJnID09ICcx
JykgewogICAgdGhpcy50ZXJtaW5hbC5z
ZXRDdXJzb3JTaGFwZShodGVybS5UZXJt
aW5hbC5jdXJzb3JTaGFwZS5CTE9DSyk7
CiAgICB0aGlzLnRlcm1pbmFsLnNldEN1
cnNvckJsaW5rKHRydWUpOwogIH0gZWxz
ZSBpZiAoYXJnID09ICcyJykgewogICAg
dGhpcy50ZXJtaW5hbC5zZXRDdXJzb3JT
aGFwZShodGVybS5UZXJtaW5hbC5jdXJz
b3JTaGFwZS5CTE9DSyk7CiAgICB0aGlz
LnRlcm1pbmFsLnNldEN1cnNvckJsaW5r
KGZhbHNlKTsKICB9IGVsc2UgaWYgKGFy
ZyA9PSAnMycpIHsKICAgIHRoaXMudGVy
bWluYWwuc2V0Q3Vyc29yU2hhcGUoaHRl
cm0uVGVybWluYWwuY3Vyc29yU2hhcGUu
VU5ERVJMSU5FKTsKICAgIHRoaXMudGVy
bWluYWwuc2V0Q3Vyc29yQmxpbmsodHJ1
ZSk7CiAgfSBlbHNlIGlmIChhcmcgPT0g
JzQnKSB7CiAgICB0aGlzLnRlcm1pbmFs
LnNldEN1cnNvclNoYXBlKGh0ZXJtLlRl
cm1pbmFsLmN1cnNvclNoYXBlLlVOREVS
TElORSk7CiAgICB0aGlzLnRlcm1pbmFs
LnNldEN1cnNvckJsaW5rKGZhbHNlKTsK
ICB9IGVsc2UgewogICAgY29uc29sZS53
YXJuKCdVbmtub3duIGN1cnNvciBzdHls
ZTogJyArIGFyZyk7CiAgfQp9OwoKLyoq
CiAqIFNlbGVjdCBjaGFyYWN0ZXIgcHJv
dGVjdGlvbiBhdHRyaWJ1dGUgKERFQ1ND
QSkuCiAqCiAqIFdpbGwgbm90IGltcGxl
bWVudC4KICovCmh0ZXJtLlZULkNTSVsn
InEnXSA9IGh0ZXJtLlZULmlnbm9yZTsK
Ci8qKgogKiBTZXQgU2Nyb2xsaW5nIFJl
Z2lvbiAoREVDU1RCTSkuCiAqLwpodGVy
bS5WVC5DU0lbJ3InXSA9IGZ1bmN0aW9u
KHBhcnNlU3RhdGUpIHsKICB2YXIgYXJn
cyA9IHBhcnNlU3RhdGUuYXJnczsKICB2
YXIgc2Nyb2xsVG9wID0gYXJnc1swXSA/
IHBhcnNlSW50KGFyZ3NbMF0sIDEwKSAt
MSA6IG51bGw7CiAgdmFyIHNjcm9sbEJv
dHRvbSA9IGFyZ3NbMV0gPyBwYXJzZUlu
dChhcmdzWzFdLCAxMCkgLSAxIDogbnVs
bDsKICB0aGlzLnRlcm1pbmFsLnNldFZU
U2Nyb2xsUmVnaW9uKHNjcm9sbFRvcCwg
c2Nyb2xsQm90dG9tKTsKICB0aGlzLnRl
cm1pbmFsLnNldEN1cnNvclBvc2l0aW9u
KDAsIDApOwp9OwoKLyoqCiAqIFJlc3Rv
cmUgREVDIFByaXZhdGUgTW9kZSBWYWx1
ZXMuCiAqCiAqIFdpbGwgbm90IGltcGxl
bWVudC4KICovCmh0ZXJtLlZULkNTSVsn
P3InXSA9IGh0ZXJtLlZULmlnbm9yZTsK
Ci8qKgogKiBDaGFuZ2UgQXR0cmlidXRl
cyBpbiBSZWN0YW5ndWxhciBBcmVhIChE
RUNDQVJBKQogKgogKiBXaWxsIG5vdCBp
bXBsZW1lbnQuCiAqLwpodGVybS5WVC5D
U0lbJyRyJ10gPSBodGVybS5WVC5pZ25v
cmU7CgovKioKICogU2F2ZSBjdXJzb3Ig
KEFOU0kuU1lTKQogKi8KaHRlcm0uVlQu
Q1NJWydzJ10gPSBmdW5jdGlvbigpIHsK
ICB0aGlzLnNhdmVkU3RhdGVfLnNhdmUo
KTsKfTsKCi8qKgogKiBTYXZlIERFQyBQ
cml2YXRlIE1vZGUgVmFsdWVzLgogKgog
KiBXaWxsIG5vdCBpbXBsZW1lbnQuCiAq
LwpodGVybS5WVC5DU0lbJz9zJ10gPSBo
dGVybS5WVC5pZ25vcmU7CgovKioKICog
V2luZG93IG1hbmlwdWxhdGlvbiAoZnJv
bSBkdHRlcm0sIGFzIHdlbGwgYXMgZXh0
ZW5zaW9ucykuCiAqCiAqIFdpbGwgbm90
IGltcGxlbWVudC4KICovCmh0ZXJtLlZU
LkNTSVsndCddID0gaHRlcm0uVlQuaWdu
b3JlOwoKLyoqCiAqIFJldmVyc2UgQXR0
cmlidXRlcyBpbiBSZWN0YW5ndWxhciBB
cmVhIChERUNSQVJBKS4KICoKICogV2ls
bCBub3QgaW1wbGVtZW50LgogKi8KaHRl
cm0uVlQuQ1NJWyckdCddID0gaHRlcm0u
VlQuaWdub3JlOwoKLyoqCiAqIFNldCBv
bmUgb3IgbW9yZSBmZWF0dXJlcyBvZiB0
aGUgdGl0bGUgbW9kZXMuCiAqCiAqIFdp
bGwgbm90IGltcGxlbWVudC4KICovCmh0
ZXJtLlZULkNTSVsnPnQnXSA9IGh0ZXJt
LlZULmlnbm9yZTsKCi8qKgogKiBTZXQg
d2FybmluZy1iZWxsIHZvbHVtZSAoREVD
U1dCViwgVlQ1MjApLgogKgogKiBXaWxs
IG5vdCBpbXBsZW1lbnQuCiAqLwpodGVy
bS5WVC5DU0lbJyB0J10gPSBodGVybS5W
VC5pZ25vcmU7CgovKioKICogUmVzdG9y
ZSBjdXJzb3IgKEFOU0kuU1lTKS4KICov
Cmh0ZXJtLlZULkNTSVsndSddID0gZnVu
Y3Rpb24oKSB7CiAgdGhpcy5zYXZlZFN0
YXRlXy5yZXN0b3JlKCk7Cn07CgovKioK
ICogU2V0IG1hcmdpbi1iZWxsIHZvbHVt
ZSAoREVDU01CViwgVlQ1MjApLgogKgog
KiBXaWxsIG5vdCBpbXBsZW1lbnQuCiAq
LwpodGVybS5WVC5DU0lbJyB1J10gPSBo
dGVybS5WVC5pZ25vcmU7CgovKioKICog
Q29weSBSZWN0YW5ndWxhciBBcmVhIChE
RUNDUkEsIFZUNDAwIGFuZCB1cCkuCiAq
CiAqIFdpbGwgbm90IGltcGxlbWVudC4K
ICovCmh0ZXJtLlZULkNTSVsnJHYnXSA9
IGh0ZXJtLlZULmlnbm9yZTsKCi8qKgog
KiBFbmFibGUgRmlsdGVyIFJlY3Rhbmds
ZSAoREVDRUZSKS4KICoKICogV2lsbCBu
b3QgaW1wbGVtZW50LgogKi8KaHRlcm0u
VlQuQ1NJWydcJ3cnXSA9IGh0ZXJtLlZU
Lmlnbm9yZTsKCi8qKgogKiBSZXF1ZXN0
IFRlcm1pbmFsIFBhcmFtZXRlcnMgKERF
Q1JFUVRQQVJNKS4KICoKICogTm90IGN1
cnJlbnRseSBpbXBsZW1lbnRlZC4KICov
Cmh0ZXJtLlZULkNTSVsneCddID0gaHRl
cm0uVlQuaWdub3JlOwoKLyoqCiAqIFNl
bGVjdCBBdHRyaWJ1dGUgQ2hhbmdlIEV4
dGVudCAoREVDU0FDRSkuCiAqCiAqIFdp
bGwgbm90IGltcGxlbWVudC4KICovCmh0
ZXJtLlZULkNTSVsnKngnXSA9IGh0ZXJt
LlZULmlnbm9yZTsKCi8qKgogKiBGaWxs
IFJlY3Rhbmd1bGFyIEFyZWEgKERFQ0ZS
QSksIFZUNDIwIGFuZCB1cC4KICoKICog
V2lsbCBub3QgaW1wbGVtZW50LgogKi8K
aHRlcm0uVlQuQ1NJWyckeCddID0gaHRl
cm0uVlQuaWdub3JlOwoKLyoqCiAqIHZ0
X3RpbGVkYXRhIChhcyB1c2VkIGJ5IE5B
T2hhY2sgYW5kIFVuTmV0SGFjaykKICog
KHNlZSBodHRwOi8vbmV0aGFja3dpa2ku
Y29tL3dpa2kvVnRfdGlsZWRhdGEgZm9y
IG1vcmUgaW5mbykKICoKICogSW1wbGVt
ZW50ZWQgYXMgZmFyIGFzIHdlIGNhcmUg
KHN0YXJ0IGEgZ2x5cGggYW5kIGVuZCBh
IGdseXBoKS4KICovCmh0ZXJtLlZULkNT
SVsneiddID0gZnVuY3Rpb24ocGFyc2VT
dGF0ZSkgewogIGlmIChwYXJzZVN0YXRl
LmFyZ3MubGVuZ3RoIDwgMSkKICAgIHJl
dHVybjsKICB2YXIgYXJnID0gcGFyc2VT
dGF0ZS5hcmdzWzBdOwogIGlmIChhcmcg
PT0gJzAnKSB7CiAgICAvLyBTdGFydCBh
IGdseXBoIChvbmUgcGFyYW1ldGVyLCB0
aGUgZ2x5cGggbnVtYmVyKS4KICAgIGlm
IChwYXJzZVN0YXRlLmFyZ3MubGVuZ3Ro
IDwgMikKICAgICAgcmV0dXJuOwogICAg
dGhpcy50ZXJtaW5hbC5nZXRUZXh0QXR0
cmlidXRlcygpLnRpbGVEYXRhID0gcGFy
c2VTdGF0ZS5hcmdzWzFdOwogIH0gZWxz
ZSBpZiAoYXJnID09ICcxJykgewogICAg
Ly8gRW5kIGEgZ2x5cGguCiAgICB0aGlz
LnRlcm1pbmFsLmdldFRleHRBdHRyaWJ1
dGVzKCkudGlsZURhdGEgPSBudWxsOwog
IH0KfTsKCi8qKgogKiBFbmFibGUgTG9j
YXRvciBSZXBvcnRpbmcgKERFQ0VMUiku
CiAqCiAqIE5vdCBjdXJyZW50bHkgaW1w
bGVtZW50ZWQuCiAqLwpodGVybS5WVC5D
U0lbJ1wneiddID0gaHRlcm0uVlQuaWdu
b3JlOwoKLyoqCiAqIEVyYXNlIFJlY3Rh
bmd1bGFyIEFyZWEgKERFQ0VSQSksIFZU
NDAwIGFuZCB1cC4KICoKICogV2lsbCBu
b3QgaW1wbGVtZW50LgogKi8KaHRlcm0u
VlQuQ1NJWyckeiddID0gaHRlcm0uVlQu
aWdub3JlOwoKLyoqCiAqIFNlbGVjdCBM
b2NhdG9yIEV2ZW50cyAoREVDU0xFKS4K
ICoKICogTm90IGN1cnJlbnRseSBpbXBs
ZW1lbnRlZC4KICovCmh0ZXJtLlZULkNT
SVsnXCd7J10gPSBodGVybS5WVC5pZ25v
cmU7CgovKioKICogUmVxdWVzdCBMb2Nh
dG9yIFBvc2l0aW9uIChERUNSUUxQKS4K
ICoKICogTm90IGN1cnJlbnRseSBpbXBs
ZW1lbnRlZC4KICovCmh0ZXJtLlZULkNT
SVsnXCd8J10gPSBodGVybS5WVC5pZ25v
cmU7CgovKioKICogSW5zZXJ0IENvbHVt
bnMgKERFQ0lDKSwgVlQ0MjAgYW5kIHVw
LgogKgogKiBXaWxsIG5vdCBpbXBsZW1l
bnQuCiAqLwpodGVybS5WVC5DU0lbJyB9
J10gPSBodGVybS5WVC5pZ25vcmU7Cgov
KioKICogRGVsZXRlIFAgcyBDb2x1bW5z
IChERUNEQyksIFZUNDIwIGFuZCB1cC4K
ICoKICogV2lsbCBub3QgaW1wbGVtZW50
LgogKi8KaHRlcm0uVlQuQ1NJWycgfidd
ID0gaHRlcm0uVlQuaWdub3JlOwovLyBT
T1VSQ0UgRklMRTogaHRlcm0vanMvaHRl
cm1fdnRfY2hhcmFjdGVyX21hcC5qcwov
LyBDb3B5cmlnaHQgKGMpIDIwMTIgVGhl
IENocm9taXVtIE9TIEF1dGhvcnMuIEFs
bCByaWdodHMgcmVzZXJ2ZWQuCi8vIFVz
ZSBvZiB0aGlzIHNvdXJjZSBjb2RlIGlz
IGdvdmVybmVkIGJ5IGEgQlNELXN0eWxl
IGxpY2Vuc2UgdGhhdCBjYW4gYmUKLy8g
Zm91bmQgaW4gdGhlIExJQ0VOU0UgZmls
ZS4KCid1c2Ugc3RyaWN0JzsKCmxpYi5y
dGRlcCgnbGliLmYnKTsKCi8qKgogKiBD
aGFyYWN0ZXIgbWFwIG9iamVjdC4KICoK
ICogQHBhcmFtIHtvYmplY3R9IFRoZSBH
TCBtYXBwaW5nIGZyb20gaW5wdXQgY2hh
cmFjdGVycyB0byBvdXRwdXQgY2hhcmFj
dGVycy4KICogICAgIFRoZSBHUiBtYXBw
aW5nIHdpbGwgYmUgYXV0b21hdGljYWxs
eSBjcmVhdGVkLgogKi8KaHRlcm0uVlQu
Q2hhcmFjdGVyTWFwID0gZnVuY3Rpb24o
bmFtZSwgZ2xtYXApIHsKICAvKioKICAg
KiBTaG9ydCBuYW1lIGZvciB0aGlzIGNo
YXJhY3RlciBzZXQsIHVzZWZ1bCBmb3Ig
ZGVidWdnaW5nLgogICAqLwogIHRoaXMu
bmFtZSA9IG5hbWU7CgogIC8qKgogICAq
IFRoZSBmdW5jdGlvbiB0byBjYWxsIHRv
IHdoZW4gdGhpcyBtYXAgaXMgaW5zdGFs
bGVkIGluIEdMLgogICAqLwogIHRoaXMu
R0wgPSBudWxsOwoKICAvKioKICAgKiBU
aGUgZnVuY3Rpb24gdG8gY2FsbCB0byB3
aGVuIHRoaXMgbWFwIGlzIGluc3RhbGxl
ZCBpbiBHUi4KICAgKi8KICB0aGlzLkdS
ID0gbnVsbDsKCiAgaWYgKGdsbWFwKQog
ICAgdGhpcy5yZXNldChnbG1hcCk7Cn07
CgovKioKICogQHBhcmFtIHtvYmplY3R9
IFRoZSBHTCBtYXBwaW5nIGZyb20gaW5w
dXQgY2hhcmFjdGVycyB0byBvdXRwdXQg
Y2hhcmFjdGVycy4KICogICAgIFRoZSBH
UiBtYXBwaW5nIHdpbGwgYmUgYXV0b21h
dGljYWxseSBjcmVhdGVkLgogKi8KaHRl
cm0uVlQuQ2hhcmFjdGVyTWFwLnByb3Rv
dHlwZS5yZXNldCA9IGZ1bmN0aW9uKGds
bWFwKSB7CiAgLy8gU2V0IHRoZSB0aGUg
R0wgbWFwcGluZy4KICB0aGlzLmdsbWFw
ID0gZ2xtYXA7CgogIHZhciBnbGtleXMg
PSBPYmplY3Qua2V5cyh0aGlzLmdsbWFw
KS5tYXAoZnVuY3Rpb24oa2V5KSB7CiAg
ICAgIHJldHVybiAnXFx4JyArIGxpYi5m
LnpwYWQoa2V5LmNoYXJDb2RlQXQoMCku
dG9TdHJpbmcoMTYpKTsKICAgIH0pOwoK
ICB0aGlzLmdscmUgPSBuZXcgUmVnRXhw
KCdbJyArIGdsa2V5cy5qb2luKCcnKSAr
ICddJywgJ2cnKTsKCiAgLy8gQ29tcHV0
ZSB0aGUgR1IgbWFwcGluZy4KICAvLyBU
aGlzIGlzIHRoZSBzYW1lIGFzIEdMIGV4
Y2VwdCBhbGwga2V5cyBoYXZlIHRoZWly
IE1TQiBzZXQuCiAgdGhpcy5ncm1hcCA9
IHt9OwoKICBnbGtleXMuZm9yRWFjaChm
dW5jdGlvbihnbGtleSkgewogICAgICB2
YXIgZ3JrZXkgPSBTdHJpbmcuZnJvbUNo
YXJDb2RlKGdsa2V5LmNoYXJDb2RlQXQo
MCkgJiAweDgwKTsKICAgICAgdGhpcy5n
cm1hcFtncmtleV0gPSB0aGlzLmdsbWFw
W2dsa2V5XTsKICAgIH0uYmluZCh0aGlz
KSk7CgogIHZhciBncmtleXMgPSBPYmpl
Y3Qua2V5cyh0aGlzLmdybWFwKS5tYXAo
ZnVuY3Rpb24oa2V5KSB7CiAgICAgIHJl
dHVybiAnXFx4JyArIGxpYi5mLnpwYWQo
a2V5LmNoYXJDb2RlQXQoMCkudG9TdHJp
bmcoMTYpLCAyKTsKICAgIH0pOwoKICB0
aGlzLmdycmUgPSBuZXcgUmVnRXhwKCdb
JyArIGdya2V5cy5qb2luKCcnKSArICdd
JywgJ2cnKTsKCiAgdGhpcy5HTCA9IGZ1
bmN0aW9uKHN0cikgewogICAgcmV0dXJu
IHN0ci5yZXBsYWNlKHRoaXMuZ2xyZSwK
ICAgICAgICAgICAgICAgICAgICAgICBm
dW5jdGlvbihjaCkgeyByZXR1cm4gdGhp
cy5nbG1hcFtjaF0gfS5iaW5kKHRoaXMp
KTsKICB9LmJpbmQodGhpcyk7CgogIHRo
aXMuR1IgPSBmdW5jdGlvbihzdHIpIHsK
ICAgIHJldHVybiBzdHIucmVwbGFjZSh0
aGlzLmdycmUsCiAgICAgICAgICAgICAg
ICAgICAgICAgZnVuY3Rpb24oY2gpIHsg
cmV0dXJuIHRoaXMuZ3JtYXBbY2hdIH0u
YmluZCh0aGlzKSk7CiAgfS5iaW5kKHRo
aXMpOwp9OwoKLyoqCiAqIE1hcHBpbmcg
ZnJvbSByZWNlaXZlZCB0byBkaXNwbGF5
IGNoYXJhY3RlciwgdXNlZCBkZXBlbmRp
bmcgb24gdGhlIGFjdGl2ZQogKiBWVCBj
aGFyYWN0ZXIgc2V0LgogKi8KaHRlcm0u
VlQuQ2hhcmFjdGVyTWFwLm1hcHMgPSB7
fTsKCi8qKgogKiBWVDEwMCBHcmFwaGlj
IGNoYXJhY3RlciBtYXAuCiAqIGh0dHA6
Ly92dDEwMC5uZXQvZG9jcy92dDIyMC1y
bS90YWJsZTItNC5odG1sCiAqLwpodGVy
bS5WVC5DaGFyYWN0ZXJNYXAubWFwc1sn
MCddID0gbmV3IGh0ZXJtLlZULkNoYXJh
Y3Rlck1hcCgKICAgICdncmFwaGljJywg
ewogICAgICAnXHg2MCc6J1x1MjVjNics
ICAvLyBgIC0+IGRpYW1vbmQKICAgICAg
J1x4NjEnOidcdTI1OTInLCAgLy8gYSAt
PiBncmV5LWJveAogICAgICAnXHg2Mic6
J1x1MjQwOScsICAvLyBiIC0+IGgvdAog
ICAgICAnXHg2Myc6J1x1MjQwYycsICAv
LyBjIC0+IGYvZgogICAgICAnXHg2NCc6
J1x1MjQwZCcsICAvLyBkIC0+IGMvcgog
ICAgICAnXHg2NSc6J1x1MjQwYScsICAv
LyBlIC0+IGwvZgogICAgICAnXHg2Nic6
J1x1MDBiMCcsICAvLyBmIC0+IGRlZ3Jl
ZQogICAgICAnXHg2Nyc6J1x1MDBiMScs
ICAvLyBnIC0+ICsvLQogICAgICAnXHg2
OCc6J1x1MjQyNCcsICAvLyBoIC0+IG4v
bAogICAgICAnXHg2OSc6J1x1MjQwYics
ICAvLyBpIC0+IHYvdAogICAgICAnXHg2
YSc6J1x1MjUxOCcsICAvLyBqIC0+IGJv
dHRvbS1yaWdodAogICAgICAnXHg2Yic6
J1x1MjUxMCcsICAvLyBrIC0+IHRvcC1y
aWdodAogICAgICAnXHg2Yyc6J1x1MjUw
YycsICAvLyBsIC0+IHRvcC1sZWZ0CiAg
ICAgICdceDZkJzonXHUyNTE0JywgIC8v
IG0gLT4gYm90dG9tLWxlZnQKICAgICAg
J1x4NmUnOidcdTI1M2MnLCAgLy8gbiAt
PiBsaW5lLWNyb3NzCiAgICAgICdceDZm
JzonXHUyM2JhJywgIC8vIG8gLT4gc2Nh
bjEKICAgICAgJ1x4NzAnOidcdTIzYmIn
LCAgLy8gcCAtPiBzY2FuMwogICAgICAn
XHg3MSc6J1x1MjUwMCcsICAvLyBxIC0+
IHNjYW41CiAgICAgICdceDcyJzonXHUy
M2JjJywgIC8vIHIgLT4gc2NhbjcKICAg
ICAgJ1x4NzMnOidcdTIzYmQnLCAgLy8g
cyAtPiBzY2FuOQogICAgICAnXHg3NCc6
J1x1MjUxYycsICAvLyB0IC0+IGxlZnQt
dGVlCiAgICAgICdceDc1JzonXHUyNTI0
JywgIC8vIHUgLT4gcmlnaHQtdGVlCiAg
ICAgICdceDc2JzonXHUyNTM0JywgIC8v
IHYgLT4gYm90dG9tLXRlZQogICAgICAn
XHg3Nyc6J1x1MjUyYycsICAvLyB3IC0+
IHRvcC10ZWUKICAgICAgJ1x4NzgnOidc
dTI1MDInLCAgLy8geCAtPiB2ZXJ0aWNh
bC1saW5lCiAgICAgICdceDc5JzonXHUy
MjY0JywgIC8vIHkgLT4gbGVzcy1lcXVh
bAogICAgICAnXHg3YSc6J1x1MjI2NScs
ICAvLyB6IC0+IGdyZWF0ZXItZXF1YWwK
ICAgICAgJ1x4N2InOidcdTAzYzAnLCAg
Ly8geyAtPiBwaQogICAgICAnXHg3Yyc6
J1x1MjI2MCcsICAvLyB8IC0+IG5vdC1l
cXVhbAogICAgICAnXHg3ZCc6J1x1MDBh
MycsICAvLyB9IC0+IGJyaXRpc2gtcG91
bmQKICAgICAgJ1x4N2UnOidcdTAwYjcn
LCAgLy8gfiAtPiBkb3QKICAgIH0pOwoK
LyoqCiAqIEJyaXRpc2ggY2hhcmFjdGVy
IG1hcC4KICogaHR0cDovL3Z0MTAwLm5l
dC9kb2NzL3Z0MjIwLXJtL3RhYmxlMi01
Lmh0bWwKICovCmh0ZXJtLlZULkNoYXJh
Y3Rlck1hcC5tYXBzWydBJ10gPSBuZXcg
aHRlcm0uVlQuQ2hhcmFjdGVyTWFwKAog
ICAgJ2JyaXRpc2gnLCB7CiAgICAgICdc
eDIzJzogJ1x1MDBhMycsICAvLyAjIC0+
IGJyaXRpc2gtcG91bmQKICAgIH0pOwoK
LyoqCiAqIFVTIEFTQ0lJIG1hcCwgbm8g
Y2hhbmdlcy4KICovCmh0ZXJtLlZULkNo
YXJhY3Rlck1hcC5tYXBzWydCJ10gPSBu
ZXcgaHRlcm0uVlQuQ2hhcmFjdGVyTWFw
KAogICAgJ3VzJywgbnVsbCk7CgovKioK
ICogRHV0Y2ggY2hhcmFjdGVyIG1hcC4K
ICogaHR0cDovL3Z0MTAwLm5ldC9kb2Nz
L3Z0MjIwLXJtL3RhYmxlMi02Lmh0bWwK
ICovCmh0ZXJtLlZULkNoYXJhY3Rlck1h
cC5tYXBzWyc0J10gPSBuZXcgaHRlcm0u
VlQuQ2hhcmFjdGVyTWFwKAogICAgJ2R1
dGNoJywgewogICAgICAnXHgyMyc6ICdc
dTAwYTMnLCAgLy8gIyAtPiBicml0aXNo
LXBvdW5kCgogICAgICAnXHg0MCc6ICdc
dTAwYmUnLCAgLy8gQCAtPiAzLzQKCiAg
ICAgICdceDViJzogJ1x1MDEzMicsICAv
LyBbIC0+ICdpaicgbGlnYXR1cmUgKHh0
ZXJtIGdvZXMgd2l0aCBcdTAwZmY/KQog
ICAgICAnXHg1Yyc6ICdcdTAwYmQnLCAg
Ly8gXCAtPiAxLzIKICAgICAgJ1x4NWQn
OiAnXHUwMDdjJywgIC8vIF0gLT4gdmVy
dGljYWwgYmFyCgogICAgICAnXHg3Yic6
ICdcdTAwYTgnLCAgLy8geyAtPiB0d28g
ZG90cwogICAgICAnXHg3Yyc6ICdcdTAw
NjYnLCAgLy8gfCAtPiBmCiAgICAgICdc
eDdkJzogJ1x1MDBiYycsICAvLyB9IC0+
IDEvNAogICAgICAnXHg3ZSc6ICdcdTAw
YjQnLCAgLy8gfiAtPiBhY3V0ZQogICAg
fSk7CgovKioKICogRmlubmlzaCBjaGFy
YWN0ZXIgbWFwLgogKiBodHRwOi8vdnQx
MDAubmV0L2RvY3MvdnQyMjAtcm0vdGFi
bGUyLTcuaHRtbAogKi8KaHRlcm0uVlQu
Q2hhcmFjdGVyTWFwLm1hcHNbJ0MnXSA9
Cmh0ZXJtLlZULkNoYXJhY3Rlck1hcC5t
YXBzWyc1J10gPSBuZXcgaHRlcm0uVlQu
Q2hhcmFjdGVyTWFwKAogICAgJ2Zpbm5p
c2gnLCB7CiAgICAgICdceDViJzogJ1x1
MDBjNCcsICAvLyBbIC0+ICdBJyB1bWxh
dXQKICAgICAgJ1x4NWMnOiAnXHUwMGQ2
JywgIC8vIFwgLT4gJ08nIHVtbGF1dAog
ICAgICAnXHg1ZCc6ICdcdTAwYzUnLCAg
Ly8gXSAtPiAnQScgcmluZwogICAgICAn
XHg1ZSc6ICdcdTAwZGMnLCAgLy8gfiAt
PiAndScgdW1sYXV0CgogICAgICAnXHg2
MCc6ICdcdTAwZTknLCAgLy8gYCAtPiAn
ZScgYWN1dGUKCiAgICAgICdceDdiJzog
J1x1MDBlNCcsICAvLyB7IC0+ICdhJyB1
bWxhdXQKICAgICAgJ1x4N2MnOiAnXHUw
MGY2JywgIC8vIHwgLT4gJ28nIHVtbGF1
dAogICAgICAnXHg3ZCc6ICdcdTAwZTUn
LCAgLy8gfSAtPiAnYScgcmluZwogICAg
ICAnXHg3ZSc6ICdcdTAwZmMnLCAgLy8g
fiAtPiAndScgdW1sYXV0CiAgICB9KTsK
Ci8qKgogKiBGcmVuY2ggY2hhcmFjdGVy
IG1hcC4KICogaHR0cDovL3Z0MTAwLm5l
dC9kb2NzL3Z0MjIwLXJtL3RhYmxlMi04
Lmh0bWwKICovCmh0ZXJtLlZULkNoYXJh
Y3Rlck1hcC5tYXBzWydSJ10gPSBuZXcg
aHRlcm0uVlQuQ2hhcmFjdGVyTWFwKAog
ICAgJ2ZyZW5jaCcsIHsKICAgICAgJ1x4
MjMnOiAnXHUwMGEzJywgIC8vICMgLT4g
YnJpdGlzaC1wb3VuZAoKICAgICAgJ1x4
NDAnOiAnXHUwMGUwJywgIC8vIEAgLT4g
J2EnIGdyYXZlCgogICAgICAnXHg1Yic6
ICdcdTAwYjAnLCAgLy8gWyAtPiByaW5n
CiAgICAgICdceDVjJzogJ1x1MDBlNycs
ICAvLyBcIC0+ICdjJyBjZWRpbGxhCiAg
ICAgICdceDVkJzogJ1x1MDBhNycsICAv
LyBdIC0+IHNlY3Rpb24gc3ltYm9sIChk
b3VibGUgcykKCiAgICAgICdceDdiJzog
J1x1MDBlOScsICAvLyB7IC0+ICdlJyBh
Y3V0ZQogICAgICAnXHg3Yyc6ICdcdTAw
ZjknLCAgLy8gfCAtPiAndScgZ3JhdmUK
ICAgICAgJ1x4N2QnOiAnXHUwMGU4Jywg
IC8vIH0gLT4gJ2UnIGdyYXZlCiAgICAg
ICdceDdlJzogJ1x1MDBhOCcsICAvLyB+
IC0+IHVtbGF1dAogICAgfSk7CgovKioK
ICogRnJlbmNoIENhbmFkaWFuIGNoYXJh
Y3RlciBtYXAuCiAqIGh0dHA6Ly92dDEw
MC5uZXQvZG9jcy92dDIyMC1ybS90YWJs
ZTItOS5odG1sCiAqLwpodGVybS5WVC5D
aGFyYWN0ZXJNYXAubWFwc1snUSddID0g
bmV3IGh0ZXJtLlZULkNoYXJhY3Rlck1h
cCgKICAgICdmcmVuY2ggY2FuYWRpYW4n
LCB7CiAgICAgICdceDQwJzogJ1x1MDBl
MCcsICAvLyBAIC0+ICdhJyBncmF2ZQoK
ICAgICAgJ1x4NWInOiAnXHUwMGUyJywg
IC8vIFsgLT4gJ2EnIGNpcmN1bWZsZXgK
ICAgICAgJ1x4NWMnOiAnXHUwMGU3Jywg
IC8vIFwgLT4gJ2MnIGNlZGlsbGEKICAg
ICAgJ1x4NWQnOiAnXHUwMGVhJywgIC8v
IF0gLT4gJ2UnIGNpcmN1bWZsZXgKICAg
ICAgJ1x4NWUnOiAnXHUwMGVlJywgIC8v
IF4gLT4gJ2knIGNpcmN1bWZsZXgKCiAg
ICAgICdceDYwJzogJ1x1MDBmNCcsICAv
LyBgIC0+ICdvJyBjaXJjdW1mbGV4Cgog
ICAgICAnXHg3Yic6ICdcdTAwZTknLCAg
Ly8geyAtPiAnZScgYWN1dGUKICAgICAg
J1x4N2MnOiAnXHUwMGY5JywgIC8vIHwg
LT4gJ3UnIGdyYXZlCiAgICAgICdceDdk
JzogJ1x1MDBlOCcsICAvLyB9IC0+ICdl
JyBncmF2ZQogICAgICAnXHg3ZSc6ICdc
dTAwZmInLCAgLy8gfiAtPiAndScgY2ly
Y3VtZmxleAogICAgfSk7CgovKioKICog
R2VybWFuIGNoYXJhY3RlciBtYXAuCiAq
IGh0dHA6Ly92dDEwMC5uZXQvZG9jcy92
dDIyMC1ybS90YWJsZTItMTAuaHRtbAog
Ki8KaHRlcm0uVlQuQ2hhcmFjdGVyTWFw
Lm1hcHNbJ0snXSA9IG5ldyBodGVybS5W
VC5DaGFyYWN0ZXJNYXAoCiAgICAnZ2Vy
bWFuJywgewogICAgICAnXHg0MCc6ICdc
dTAwYTcnLCAgLy8gQCAtPiBzZWN0aW9u
IHN5bWJvbCAoZG91YmxlIHMpCgogICAg
ICAnXHg1Yic6ICdcdTAwYzQnLCAgLy8g
WyAtPiAnQScgdW1sYXV0CiAgICAgICdc
eDVjJzogJ1x1MDBkNicsICAvLyBcIC0+
ICdPJyB1bWxhdXQKICAgICAgJ1x4NWQn
OiAnXHUwMGRjJywgIC8vIF0gLT4gJ1Un
IHVtbGF1dAoKICAgICAgJ1x4N2InOiAn
XHUwMGU0JywgIC8vIHsgLT4gJ2EnIHVt
bGF1dAogICAgICAnXHg3Yyc6ICdcdTAw
ZjYnLCAgLy8gfCAtPiAnbycgdW1sYXV0
CiAgICAgICdceDdkJzogJ1x1MDBmYycs
ICAvLyB9IC0+ICd1JyB1bWxhdXQKICAg
ICAgJ1x4N2UnOiAnXHUwMGRmJywgIC8v
IH4gLT4gZXN6ZXR0CiAgICB9KTsKCi8q
KgogKiBJdGFsaWFuIGNoYXJhY3RlciBt
YXAuCiAqIGh0dHA6Ly92dDEwMC5uZXQv
ZG9jcy92dDIyMC1ybS90YWJsZTItMTEu
aHRtbAogKi8KaHRlcm0uVlQuQ2hhcmFj
dGVyTWFwLm1hcHNbJ1knXSA9IG5ldyBo
dGVybS5WVC5DaGFyYWN0ZXJNYXAoCiAg
ICAnaXRhbGlhbicsIHsKICAgICAgJ1x4
MjMnOiAnXHUwMGEzJywgIC8vICMgLT4g
YnJpdGlzaC1wb3VuZAoKICAgICAgJ1x4
NDAnOiAnXHUwMGE3JywgIC8vIEAgLT4g
c2VjdGlvbiBzeW1ib2wgKGRvdWJsZSBz
KQoKICAgICAgJ1x4NWInOiAnXHUwMGIw
JywgIC8vIFsgLT4gcmluZwogICAgICAn
XHg1Yyc6ICdcdTAwZTcnLCAgLy8gXCAt
PiAnYycgY2VkaWxsYQogICAgICAnXHg1
ZCc6ICdcdTAwZTknLCAgLy8gXSAtPiAn
ZScgYWN1dGUKCiAgICAgICdceDYwJzog
J1x1MDBmOScsICAvLyBgIC0+ICd1JyBn
cmF2ZQoKICAgICAgJ1x4N2InOiAnXHUw
MGUwJywgIC8vIHsgLT4gJ2EnIGdyYXZl
CiAgICAgICdceDdjJzogJ1x1MDBmMics
ICAvLyB8IC0+ICdvJyBncmF2ZQogICAg
ICAnXHg3ZCc6ICdcdTAwZTgnLCAgLy8g
fSAtPiAnZScgZ3JhdmUKICAgICAgJ1x4
N2UnOiAnXHUwMGVjJywgIC8vIH4gLT4g
J2knIGdyYXZlCiAgICB9KTsKCi8qKgog
KiBOb3J3ZWdpYW4vRGFuaXNoIGNoYXJh
Y3RlciBtYXAuCiAqIGh0dHA6Ly92dDEw
MC5uZXQvZG9jcy92dDIyMC1ybS90YWJs
ZTItMTIuaHRtbAogKi8KaHRlcm0uVlQu
Q2hhcmFjdGVyTWFwLm1hcHNbJ0UnXSA9
Cmh0ZXJtLlZULkNoYXJhY3Rlck1hcC5t
YXBzWyc2J10gPSBuZXcgaHRlcm0uVlQu
Q2hhcmFjdGVyTWFwKAogICAgJ25vcndl
Z2lhbi9kYW5pc2gnLCB7CiAgICAgICdc
eDQwJzogJ1x1MDBjNCcsICAvLyBAIC0+
ICdBJyB1bWxhdXQKCiAgICAgICdceDVi
JzogJ1x1MDBjNicsICAvLyBbIC0+ICdB
RScgbGlnYXR1cmUKICAgICAgJ1x4NWMn
OiAnXHUwMGQ4JywgIC8vIFwgLT4gJ08n
IHN0cm9rZQogICAgICAnXHg1ZCc6ICdc
dTAwYzUnLCAgLy8gXSAtPiAnQScgcmlu
ZwogICAgICAnXHg1ZSc6ICdcdTAwZGMn
LCAgLy8gXiAtPiAnVScgdW1sYXV0Cgog
ICAgICAnXHg2MCc6ICdcdTAwZTQnLCAg
Ly8gYCAtPiAnYScgdW1sYXV0CgogICAg
ICAnXHg3Yic6ICdcdTAwZTYnLCAgLy8g
eyAtPiAnYWUnIGxpZ2F0dXJlCiAgICAg
ICdceDdjJzogJ1x1MDBmOCcsICAvLyB8
IC0+ICdvJyBzdHJva2UKICAgICAgJ1x4
N2QnOiAnXHUwMGU1JywgIC8vIH0gLT4g
J2EnIHJpbmcKICAgICAgJ1x4N2UnOiAn
XHUwMGZjJywgIC8vIH4gLT4gJ3UnIHVt
bGF1dAogICAgfSk7CgovKioKICogU3Bh
bmlzaCBjaGFyYWN0ZXIgbWFwLgogKiBo
dHRwOi8vdnQxMDAubmV0L2RvY3MvdnQy
MjAtcm0vdGFibGUyLTEzLmh0bWwKICov
Cmh0ZXJtLlZULkNoYXJhY3Rlck1hcC5t
YXBzWydaJ10gPSBuZXcgaHRlcm0uVlQu
Q2hhcmFjdGVyTWFwKAogICAgJ3NwYW5p
c2gnLCB7CiAgICAgICdceDIzJzogJ1x1
MDBhMycsICAvLyAjIC0+IGJyaXRpc2gt
cG91bmQKCiAgICAgICdceDQwJzogJ1x1
MDBhNycsICAvLyBAIC0+IHNlY3Rpb24g
c3ltYm9sIChkb3VibGUgcykKCiAgICAg
ICdceDViJzogJ1x1MDBhMScsICAvLyBb
IC0+ICchJyBpbnZlcnRlZAogICAgICAn
XHg1Yyc6ICdcdTAwZDEnLCAgLy8gXCAt
PiAnTicgdGlsZGUKICAgICAgJ1x4NWQn
OiAnXHUwMGJmJywgIC8vIF0gLT4gJz8n
IGludmVydGVkCgogICAgICAnXHg3Yic6
ICdcdTAwYjAnLCAgLy8geyAtPiByaW5n
CiAgICAgICdceDdjJzogJ1x1MDBmMScs
ICAvLyB8IC0+ICduJyB0aWxkZQogICAg
ICAnXHg3ZCc6ICdcdTAwZTcnLCAgLy8g
fSAtPiAnYycgY2VkaWxsYQogICAgfSk7
CgovKioKICogU3dlZGlzaCBjaGFyYWN0
ZXIgbWFwLgogKiBodHRwOi8vdnQxMDAu
bmV0L2RvY3MvdnQyMjAtcm0vdGFibGUy
LTE0Lmh0bWwKICovCmh0ZXJtLlZULkNo
YXJhY3Rlck1hcC5tYXBzWyc3J10gPQpo
dGVybS5WVC5DaGFyYWN0ZXJNYXAubWFw
c1snSCddID0gbmV3IGh0ZXJtLlZULkNo
YXJhY3Rlck1hcCgKICAgICdzd2VkaXNo
JywgewogICAgICAnXHg0MCc6ICdcdTAw
YzknLCAgLy8gQCAtPiAnRScgYWN1dGUK
CiAgICAgICdceDViJzogJ1x1MDBjNCcs
ICAvLyBbIC0+ICdBJyB1bWxhdXQKICAg
ICAgJ1x4NWMnOiAnXHUwMGQ2JywgIC8v
IFwgLT4gJ08nIHVtbGF1dAogICAgICAn
XHg1ZCc6ICdcdTAwYzUnLCAgLy8gXSAt
PiAnQScgcmluZwogICAgICAnXHg1ZSc6
ICdcdTAwZGMnLCAgLy8gXiAtPiAnVScg
dW1sYXV0CgogICAgICAnXHg2MCc6ICdc
dTAwZTknLCAgLy8gYCAtPiAnZScgYWN1
dGUKCiAgICAgICdceDdiJzogJ1x1MDBl
NCcsICAvLyB7IC0+ICdhJyB1bWxhdXQK
ICAgICAgJ1x4N2MnOiAnXHUwMGY2Jywg
IC8vIHwgLT4gJ28nIHVtbGF1dAogICAg
ICAnXHg3ZCc6ICdcdTAwZTUnLCAgLy8g
fSAtPiAnYScgcmluZwogICAgICAnXHg3
ZSc6ICdcdTAwZmMnLCAgLy8gfiAtPiAn
dScgdW1sYXV0CiAgICB9KTsKCi8qKgog
KiBTd2lzcyBjaGFyYWN0ZXIgbWFwLgog
KiBodHRwOi8vdnQxMDAubmV0L2RvY3Mv
dnQyMjAtcm0vdGFibGUyLTE1Lmh0bWwK
ICovCmh0ZXJtLlZULkNoYXJhY3Rlck1h
cC5tYXBzWyc9J10gPSBuZXcgaHRlcm0u
VlQuQ2hhcmFjdGVyTWFwKAogICAgJ3N3
aXNzJywgewogICAgICAnXHgyMyc6ICdc
dTAwZjknLCAgLy8gIyAtPiAndScgZ3Jh
dmUKCiAgICAgICdceDQwJzogJ1x1MDBl
MCcsICAvLyBAIC0+ICdhJyBncmF2ZQoK
ICAgICAgJ1x4NWInOiAnXHUwMGU5Jywg
IC8vIFsgLT4gJ2UnIGFjdXRlCiAgICAg
ICdceDVjJzogJ1x1MDBlNycsICAvLyBc
IC0+ICdjJyBjZWRpbGxhCiAgICAgICdc
eDVkJzogJ1x1MDBlYScsICAvLyBdIC0+
ICdlJyBjaXJjdW1mbGV4CiAgICAgICdc
eDVlJzogJ1x1MDBlZScsICAvLyBeIC0+
ICdpJyBjaXJjdW1mbGV4CiAgICAgICdc
eDVmJzogJ1x1MDBlOCcsICAvLyBfIC0+
ICdlJyBncmF2ZQoKICAgICAgJ1x4NjAn
OiAnXHUwMGY0JywgIC8vIGAgLT4gJ28n
IGNpcmN1bWZsZXgKCiAgICAgICdceDdi
JzogJ1x1MDBlNCcsICAvLyB7IC0+ICdh
JyB1bWxhdXQKICAgICAgJ1x4N2MnOiAn
XHUwMGY2JywgIC8vIHwgLT4gJ28nIHVt
bGF1dAogICAgICAnXHg3ZCc6ICdcdTAw
ZmMnLCAgLy8gfSAtPiAndScgdW1sYXV0
CiAgICAgICdceDdlJzogJ1x1MDBmYics
ICAvLyB+IC0+ICd1JyBjaXJjdW1mbGV4
CiAgICB9KTsKbGliLnJlc291cmNlLmFk
ZCgnaHRlcm0vYXVkaW8vYmVsbCcsICdh
dWRpby9vZ2c7YmFzZTY0JywKJ1QyZG5V
d0FDQUFBQUFBQUFBQURocVc1S0FBQUFB
TUZ2RWpZQkhnRjJiM0ppYVhNQUFBQUFB
WUM3QUFBQUFBQUFBSGNCQUFBQUFBQzQn
ICsKJ0FVOW5aMU1BQUFBQUFBQUFBQUFB
NGFsdVNnRUFBQUFBZXNJM0VDMy8vLy8v
Ly8vLy8vLy8vLy8vLzhrRGRtOXlZbWx6
SFFBQUFGaHAnICsKJ2NHZ3VUM0puSUd4
cFlsWnZjbUpwY3lCSklESXdNRGt3TnpB
NUFBQUFBQUVGZG05eVltbHpLVUpEVmdF
QUNBQUFBREZNSU1XQTBKQlYnICsKJ0FB
QVFBQUJnSkNrT2syWkpLYVdVb1NoNW1K
UklTU21sbE1Vd2laaVVpY1VZWTR3eHho
aGpqREhHR0dPTUlEUmtGUUFBQkFDQUtB
bU8nICsKJ28rWkphczQ1WnhnbmpuS2dP
V2xPT0tjZ0I0cFI0RGtKd3ZVbVkyNm10
S1pyYnM0cEpRZ05XUVVBQUFJQVFFZ2ho
UlJTU0NHRkZHS0knICsKJ0lZWVlZb2do
aHh4eXlDR25uSElLS3FpZ2dnb3l5Q0NE
VERMcHBKTk9PdW1vbzQ0NjZpaTAwRUlM
TGJUU1Nrd3gxVlpqcnIwR1hYeHonICsK
J3pqbm5uSFBPT2VlY2M4NEpRa05XQVFB
Z0FBQUVRZ1laWkJCQ0NDR0ZGRktJS2Fh
WWNnb3l5SURRa0ZVQUFDQUFnQUFBQUFC
SGtSUkonICsKJ3NSVExzUnpOMFNSUDhp
eFJFelhSTTBWVFZFMVZWVlZWZFYxWGRt
WFhkblhYZG4xWm1JVmJ1SDFadUlWYjJJ
VmQ5NFZoR0laaEdJWmgnICsKJ0dJWmgr
SDNmOTMzZjkzMGdOR1FWQUNBQkFLQWpP
WmJqS2FJaUdxTGlPYUlEaElhc0FnQmtB
QUFFQUNBSmtpSXBrcU5KcG1acXJtbWIn
ICsKJ3RtaXJ0bTNMc2l6THNneUVocXdD
QUFBQkFBUUFBQUFBQUtCcG1xWnBtcVpw
bXFacG1xWnBtcVpwbXFacG1tWlpsbVZa
bG1WWmxtVlonICsKJ2xtVlpsbVZabG1W
WmxtVlpsbVZabG1WWmxtVlpsbVZabG1W
WlFHaklLZ0JBQWdCQXgzRWN4M0VrUlZJ
a3gzSXNCd2dOV1FVQXlBQUEnICsKJ0NB
QkFVaXpGY2pSSGN6VEhjenpIY3p4SGRF
VEpsRXpOOUV3UENBMVpCUUFBQWdBSUFB
QUFBQUJBTVJ6RmNSekowU1JQVWkzVGNq
VlgnICsKJ2N6M1hjMDNYZFYxWFZWVlZW
VlZWVlZWVlZWVlZWVlZWVlZWVlZWVlZW
VlZWVlZWVlZWVlZWVlZWVllIUWtGVUFB
QVFBQUNHZFpwWnEnICsKJ2dBZ3prR0Vn
TkdRVkFJQUFBQUFZb1FoRERBZ05XUVVB
QUFRQUFJaWg1Q0NhMEpyenpUa09tdVdn
cVJTYjA4R0pWSnNudWFtWW0zUE8nICsK
J09lZWNiTTRaNDV4enppbkttY1dnbWRD
YWM4NUpESnFsb0puUW1uUE9lUktiQjYy
cDBwcHp6aG5ubkE3R0dXR2NjODVwMHBv
SHFkbFknICsKJ20zUE9XZENhNXFpNUZK
dHp6b21VbXllMXVWU2JjODQ1NTV4enpq
bm5uSFBPcVY2Y3pzRTU0Wnh6em9uYW0y
dTVDVjJjYzg3NVpKenUnICsKJ3pRbmhu
SFBPT2VlY2M4NDU1NXh6emdsQ1ExWUJB
RUFBQUFSaDJCakduWUlnZlk0R1loUWhw
aUdUSG5TUERwT2dNY2dwcEI2TmprWksn
ICsKJ3FZTlFVaGtucFhTQzBKQlZBQUFn
QUFDRUVGSklJWVVVVWtnaGhSUlNTQ0dH
R0dLSUlhZWNjZ29xcUtTU2lpcktLTFBN
TXNzc3M4d3knICsKJ3k2ekR6anJyc01N
UVF3d3h0TkpLTERYVlZtT050ZWFlYzY0
NVNHdWx0ZFphSzZXVVVrb3BwU0EwWkJV
QUFBSUFRQ0Jra0VFR0dZVVUnICsKJ1Vr
Z2hocGh5eWltbm9JSUtDQTFaQlFBQUFn
QUlBQUFBOENUUEVSM1JFUjNSRVIzUkVS
M1JFUjNQOFJ4UkVpVlJFaVhSTWkxVE16
MVYnICsKJ1ZGVlhkbTFabDNYYnQ0VmQy
SFhmMTMzZjE0MWZGNFpsV1pabFdaWmxX
WlpsV1pabFdaWmxDVUpEVmdFQUlBQUFB
RUlJSVlRVVVrZ2gnICsKJ2haUmlqREhI
bklOT1FnbUIwSkJWQUFBZ0FJQUFBQUFB
UjNFVXg1RWN5WkVrUzdJa1RkSXN6Zkkw
VC9NMDBSTkZVVFJOVXhWZDBSVjEnICsK
JzB4WmxVelpkMHpWbDAxVmwxWFpsMmJa
bFc3ZDlXYlo5My9kOTMvZDkzL2Q5My9k
OTM5ZDFJRFJrRlFBZ0FRQ2dJem1TSWlt
U0lqbU8nICsKJzQwaVNCSVNHckFJQVpB
QUFCQUNnS0k3aU9JNGpTWklrV1pJbWVa
Wm5pWnFwbVo3cHFhSUtoSWFzQWdBQUFR
QUVBQUFBQUFDZ2FJcW4nICsKJ21JcW5p
SXJuaUk0b2laWnBpWnFxdWFKc3lxN3J1
cTdydXE3cnVxN3J1cTdydXE3cnVxN3J1
cTdydXE3cnVxN3J1cTdydXE3cnVrQm8n
ICsKJ3lDb0FRQUlBUUVkeUpFZHlKRVZT
SkVWeUpBY0lEVmtGQU1nQUFBZ0F3REVj
UTFJa3g3SXNUZk0wVC9NMDBSTTkwVE05
VlhSRkZ3Z04nICsKJ1dRVUFBQUlBQ0FB
QUFBQUF3SkFNUzdFY3pkRWtVVkl0MVZJ
MTFWSXRWVlE5VlZWVlZWVlZWVlZWVlZW
VlZWVlZWVlZWVlZWVlZWVlYnICsKJ1ZW
VlZWVlZWVlZWVjFUUk4welNCMEpDVkFB
QVpBQUFqUVFZWmhCQ0tjcEJDYmoxWUNE
SG1KQVdoT1FhaHhCaUVweEF6RERrTklu
U1EnICsKJ1FTYzl1Skk1d3d6ejRGSW9G
VVJNZzQwbE40NGdEY0ttWEVubE9BaENR
MVlFQUZFQUFJQXh5REhFR0hMT1NjbWdS
TTR4Q1oyVXlEa24nICsKJ3BaUFNTU2t0
bGhnektTV21FbVBqbktQU1NjbWtsQmhM
aXAya0VtT0pyUUFBZ0FBSEFJQUFDNkhR
a0JVQlFCUUFBR0lNVWdvcGhaUlMnICsK
J3ppbm1rRkxLTWVVY1VrbzVwNXhUempr
SUhZVEtNUWFkZ3hBcHBSeFR6aW5ISElU
TVFlV2NnOUJCS0FBQUlNQUJBQ0RBUWln
MFpFVUEnICsKJ0VDY0E0SEFrejVNMFN4
UWxTeE5GenhSbDF4Tk4xNVUwelRRMVVW
UlZ5eE5WMVZSVjJ4Wk5WYllsVFJOTlRm
UlVWUk5GVlJWVjA1Wk4nICsKJ1ZiVnR6
elJsMlZSVjNSWlYxYlpsMnhaK1Y1WjEz
ek5OV1JaVjFkWk5WYlYxMTVaOVg5WnRY
WmcwelRRMVVWUlZUUlJWMVZSVjJ6WlYn
ICsKJzE3WTFVWFJWVVZWbFdWUlZXWFps
V2ZkVlY5WjlTeFJWMVZOTjJSVlZWYlpW
MmZWdFZaWjk0WFJWWFZkbDJmZFZXUlor
VzllRjRmWjknICsKJzRSaFYxZFpOMTlW
MVZaWjlZZFpsWWJkMTN5aHBtbWxxb3Fp
cW1paXFxcW1xdG0ycXJxMWJvdWlxb3Fy
S3NtZXFycXpLc3ErcnJtenInICsKJ21p
aXFycWlxc2l5cXFpeXJzcXo3cWl6cnRx
aXF1cTNLc3JDYnJxdnJ0dThMd3l6cnVu
Q3FycTZyc3V6N3FpenJ1cTNyeG5IcnVq
QjgnICsKJ3BpbkxwcXZxdXFtNnVtN3J1
bkhNdG0wY282cnF2aXJMd3JES3N1L3J1
aSswZFNGUlZYWGRsRjNqVjJWWjkyMWZk
NTViOTRXeWJUdS8nICsKJ3JmdktjZXU2
MHZnNXoyOGN1Ylp0SExOdUc3K3QrOGJ6
S3o5aE9JNmxaNXEyYmFxcXJadXFxK3V5
Yml2RHJPdENVVlY5WFpWbDN6ZGQnICsK
J1dSZHUzemVPVzllTm9xcnF1aXJMdnJE
S3NqSGN4bThjdXpBY1hkczJqbHZYbmJL
dEMzMWp5UGNKejJ2YnhuSDdPdVAyZGFP
dkRBbkgnICsKJ2p3QUFnQUVIQUlBQUU4
cEFvU0VyQW9BNEFRQUdJZWNVVXhBcXhT
QjBFRkxxSUtSVU1RWWhjMDVLeFJ5VVVF
cHFJWlRVS3NZZ1ZJNUonICsKJ3lKeVRF
a3BvS1pUU1VnZWhwVkJLYTZHVTFsSnJz
YWJVWXUwZ3BCWkthUzJVMGxwcXFjYlVX
b3dSWXhBeTU2Umt6a2tKcGJRV1Nta3Qn
ICsKJ2MwNUs1NkNrRGtKS3BhUVVTMG90
VnN4SnlhQ2owa0ZJcWFRU1UwbXB0VkJL
YTZXa0ZrdEtNYllVVzI0eDFoeEthUzJr
RWx0SktjWVUnICsKJ1UyMHR4cG9qeGlC
a3prbkpuSk1TU21rdGxOSmE1WmlVRGtK
S21ZT1NTa3F0bFpKU3pKeVQwa0ZJcVlP
T1Nra3B0cEpLVEtHVTFrcEsnICsKJ3NZ
VlNXbXd4MXB4U2JEV1UwbHBKS2NhU1Nt
d3R4bHBiVExWMUVGb0xwYlFXU21tdHRW
WnJhcTNHVUVwckphVVlTMHF4dFJacmJq
SG0nICsKJ0drcHByYVFTVzBtcHhSWmJq
aTNHbWxOck5hYldhbTR4NWhwYmJUM1dt
bk5LcmRiVVVvMHR4cHBqYmIzVm1udnZJ
S1FXU21rdGxOSmknICsKJ2FpM0cxbUt0
b1pUV1NpcXhsWkphYkRIbTJscU1PWlRT
WWttcHhaSlNqQzNHbWx0c3VhYVdhbXd4
NXBwU2k3WG0ybk5zTmZiVVdxd3QnICsK
J3hwcFRTN1hXV25PUHVmVldBQURBZ0FN
QVFJQUpaYURRa0pVQVFCUUFBRUdJVXM1
SmFSQnl6RGtxQ1VMTU9TZXBja3hDS1Ns
VnpFRUknICsKJ0piWE9PU2tweGRZNUND
V2xGa3NxTGNWV2F5a3B0UlpyTFFBQW9N
QUJBQ0RBQmsySnhRRUtEVmtKQUVRQkFD
REdJTVFZaEFZWnBSaUQnICsKJzBCaWtG
R01RSXFVWWMwNUtwUlJqemtuSkdITU9R
aW9aWTg1QktDbUVVRW9xS1lVUVNra2xw
UUlBQUFvY0FBQUNiTkNVV0J5ZzBKQVYn
ICsKJ0FVQVVBQUJnREdJTU1ZWWdkRlF5
S2hHRVRFb25xWUVRV2d1dGRkWlNhNlhG
ekZwcXJiVFlRQWl0aGRZeVN5WEcxRnBt
cmNTWVdpc0EnICsKJ0FPekFBUURzd0VJ
b05HUWxBSkFIQUVBWW94Ump6amxuRUdM
TU9lZ2NOQWd4NWh5RURpckduSU1PUWdn
Vlk4NUJDQ0dFekRrSUlZUVEnICsKJ1F1
WWNoQkJDQ0tHREVFSUlwWlRTUVFnaGhG
Sks2U0NFRUVJcHBYUVFRZ2lobEZJS0FB
QXFjQUFBQ0xCUlpIT0NrYUJDUTFZQ0FI
a0EnICsKJ0FJQXhTamtIb1pSR0tjWWds
SkpTb3hSakVFcEpxWElNUWlrcHhWWTVC
NkdVbEZyc0lKVFNXbXcxZGhCS2FTM0dX
a05LcmNWWWE2NGgnICsKJ3BkWmlyRFhY
MUZxTXRlYWFhMG90eGxwcnpia0FBTndG
QndDd0F4dEZOaWNZQ1NvMFpDVUFrQWNB
Z0NDa0ZHT01NWVlVWW9veDU1eEQnICsK
J0NDbkZtSFBPS2FZWWM4NDU1NVJpakRu
bm5IT01NZWVjYzg0NXhwaHp6am5uSEhQ
T09lZWNjNDQ1NTV4enpqbm5uSFBPT2Vl
Y2M4NDUnICsKJzU1eHp6Z2tBQUNwd0FB
QUlzRkZrYzRLUm9FSkRWZ0lBcVFBQUFC
RldZb3d4eGhnYkNESEdHR09NTVVZU1lv
d3h4aGhqYkRIR0dHT00nICsKJ01jYVlZ
b3d4eGhoampESEdHR09NTWNZWVk0d3h4
aGhqakRIR0dHT01NY1lZWTR3eHhoaGpq
REhHR0dPTU1jWVlZNHd4eGhoampESEcn
ICsKJ0dGdHJyYlhXV211dHRkWmFhNjIx
MWxwcnJRQkF2d29IQVA4SEcxWkhPQ2th
Q3l3MFpDVUFFQTRBQUJqRG1IT09PUVlk
aElZcDZLU0UnICsKJ0RrSUlvVU5LT1Nn
bGhGQktLU2x6VGtwS3BhU1VXa3FaYzFK
U0tpV2xsbExxSUtUVVdrb3R0ZFphQnlX
bDFsSnFyYlhXT2dpbHROUmEnICsKJ2E2
MjEyRUZJS2FYV1dvc3R4bEJLU3EyMTJH
S01OWVpTVW1xdHhkaGlyREdrMGxKc0xj
WVlZNnlobE5aYWF6SEdHR3N0S2JYV1lv
eTEnICsKJ3hscHJTYW0xMW1LTE5kWmFD
d0RnYm5BQWdFaXdjWWFWcExQQzBlQkNR
MVlDQUNFQkFBUkNqRG5ubkhNUVFnZ2hV
b294NTZDREVFSUknICsKJ0lVUktNZVlj
ZEJCQ0NDR0VqREhub0lNUVFnZ2hoSkF4
NWh4MEVFSUlJWVFRT3VjY2hCQkNDS0dF
VWtybkhIUVFRZ2dobEZCQzZTQ0UnICsK
J0VFSUlvWVJTU2lrZGhCQkNLS0dFVWtv
cEpZUVFRZ21sbEZKS0thV0VFRUlJb1lR
U1NpbWxsQkJDQ0tXVVVrb3BwWlFTUWdn
aGxGSksnICsKJ0thV1VVa0lJb1pSUVNp
bWxsRkpLQ0NHRVVrb3BwWlJTU2draGhG
QktLYVdVVWtvcElZUVNTaW1sbEZKS0th
VUFBSUFEQndDQUFDUG8nICsKJ0pLUEtJ
bXcwNGNJRFVHaklTZ0NBREFBQWNkaHE2
eW5XeUNERm5JU1dTNFNRY2hCaUxoRlNp
amxIc1dWSUdjVVkxWlF4cFJSVFVtdm8n
ICsKJ25HS01VVStkWTBveHc2eVVWa29v
a1lMU2NxeTFkc3dCQUFBZ0NBQXdFQ0V6
Z1VBQkZCaklBSUFEaEFRcEFLQ3d3TkF4
WEFRRTVCSXknICsKJ0Nnd0t4NFJ6MG1r
REFCQ0V5QXlSaUZnTUVoT3FnYUppT2dC
WVhHRElCNEFNalkyMGl3dm9Nc0FGWGR4
MUlJUWdCQ0dJeFFFVWtJQ0QnICsKJ0Uy
NTQ0ZzFQdU1FSk9rV2xEZ0lBQUFBQTRB
QUFIZ0FBa2cwZ0lpS2FPWTRPancrUUVK
RVJraEtURTVRQUFBQUFBTEFCZ0E4QWdD
UUYnICsKJ2lJaUlabzZqdytNREpFUmto
S1RFNUFRbEFBQUFBQUFBQUFBQUNBZ0lB
QUFBQUFBRUFBQUFDQWhQWjJkVEFBUVlP
d0FBQUFBQUFPR3AnICsKJ2Jrb0NBQUFB
bWM3NERSZ3lOak02OVRBek9Uazc0ZG5M
dWJld3NiYWdtWmlOcDRkMEtic0V4U1kv
STNYVVR3SmdrZVpkbjFIWTR6b2onICsK
JzMzL3E5REZ0djNVaTEvam14N2xDVXRQ
dDE4L3NZZjlNa2dBc0FHUkJkM2dNR1A0
c1UrcUNQWUJ5OVZyQTNZcUpvc1czVzIv
ZWYxaU8nICsKJy91M2NnOFpHLzU3alUr
cFBtYkdFSlVna2ZuYUkzOURiUHF4ZGRa
cGhiTVJtQ2M1cktsa1VNa3l4OGlJb3Vn
NWRKdjFPWUg5YTU5YysnICsKJzNHZXZx
YzdaMlhGZERqTC9xSHp0UmZqV0VXeEov
YWlHZXpqb2h1OUhzQ1pkUUJLYmlIMFZ0
VS8zbTg1bERHMlQvK3hrWmNZblgrRSsn
ICsKJ2FxenYveFRnT29URkcreDdTTnFR
NE4rb0FBQlN4dVZYdzc3SmQ1Ym1tVG11
SmFrWDc1MDlISDBrR1lLdkFSUHB3Zk9T
QVB5U1BBYzInICsKJ0VrbmVEd0IySHdB
QUpsUURZSzU1ODZONzlHSkNqeDQrcDZh
RFVkMjdYU3ZSeVhMSmtJQzVZWjFqTHY1
bHBPaFpUejBzK0RtbkYxZGknICsKJ3B0
cm5NNlVEZ0lXMTFYaDhjSFRkMC9TbWJn
T0FkeGN5V3dNQUFHSXJaM2ZOU2ZaYnpL
aVlySzQrdFBxdG5NVkxPZVdPRzJrVnZV
WSsnICsKJ3AyUEovaGtDbDVhRlJPNFRM
R1lQWmNJVTN2WU0xaG9oUzRqSEZsbnlX
LzJUNUo3a0dzU2hYV1Q4TjA1ViszQy9H
UHFKMVFkV2lzR1AnICsKJ3hFekhxWElT
QlBJaW5XRFV0N0llSnYvZjVPdHpCeHBU
elpaUStDWUVoSFhmcUc0YUFCUWxpNzJH
SmhONG9KditoWGNBcEFKU0VyQVcnICsK
JzhHMnJhQVg0TlVjQUJuVnQ3N0N6WkFC
K0xzSGNWZStRNGgrUUIxd2gvWnJKVFB4
U0JkSThtZ1RlQWRUc1FPb0ZVRW5nOUJI
Y1ZQaHgnICsKJ1NSUllrS1daSlhPRllQ
NlY0QUVyaXBKb0VqWGdBMndKUlpIU0V4
bUpEbThGMEE2Z0VYc2c1YTRac0FMSXRy
TUI3K2ZoN1VLTHZZV1MnICsKJ2R0c0R3
RmYxbXpZelMxRjgyTjFoMk95dDJlNzZC
MVFkUzBTQXNRaWdMUE1PZ0pTOUpSQzdo
RlhBNmtVc0xGTktENWNBNWNUUnZnU3En
ICsKJ1BjM0ZsOTl4VzNRVGkvTUhSOERF
bTZXbnZhVlFBVHdScVJLanl3UTlCcnJo
dWdSMkFLVHNQUWVRY2tyQU9nRE9oYlRF
U3lyWFE1MEMnICsKJ2tOcFhkdFdqVzdX
Mi8zVWplWDNVOTVnSWRhbGZSQW9BbXFV
RWl3cDUzaENkY0N3bGc0N2ZjYmZ6bG1R
TUFnYUJraDdjK2ZjRGdGK2knICsKJ2Z3
RFhmemVnTFBjTFlKc0FBSlFBclRYam5o
L3VYR3kzdjFIazNwVjYvM3Q1cnVXODFm
NnByZmJNMlEzV05WeTk4QndVdGJDd2hG
aEEnICsKJ1d1UGV2Nk9lLzRaYUZRVWNn
S3JWczRkZWZ6aDFUQURBMURFaDViM1Zs
RGFFQ3c1YitiUGZrS29zM3RJQXVlM3ZK
Wk9paDNnYTNsNk8nICsKJzNQU2ZJa3JM
djBQQVM4NlBQZEw3ZzhvYzJLdGVORktL
ektSZWhPdjJnSm9GTEJQWG1hWHZQQlFJ
TGdKb24wYmJXQnN6cllaWVl3RTcnICsK
J2psMmordlRkVTdWcGsyMUxpVTBRYWpQ
a3l3QUFIcWJVQzAvWXNZT2RiNGU2Qk9w
N0UwY0NpMDRBby9UZ0Q4WlZBTWlkNmgv
QThJZUInICsKJ05rcDYveHNBQUNaRUxF
WUlrK3l2STZRejFOTjZsSWZ0Qi82SU1X
aldKTk9xUFRNZWRBbXlhajZFczBRQmts
SnBpU1dXSG5RMkNvWWInICsKJ0dXQW10
KzBnTFFCRktDQm5wMlFVVVFaLzF0aHRa
REJKVXBGV1k4MnozNG9jb3JCNjJvWDdx
QjV5MG9QQXYvZm94SDI1d1ZtZ0lIZjIn
ICsKJ3hGT3I4bGVaY0JxMUt4M1p2Q3E5
QmdhNjM5QXh1SHVQTkwvNzFZQ0Y0RXl3
SnBxSEZBWDZYRjBzalZidUFObnZ2ZExj
cnVmWXdPTS8nICsKJ2lEYTZpQTQ2OEFZ
QUFCNm1OQk1YY2dURDhIU1JxSjR2dzhD
akFsQ0VQQUNBU2xYL0FQd1BPSktsOXhR
QUFBUG1uZXYyZVdwMzNYZ3knICsKJ3cz
RHZmejZteUdrM295UDhZVEtzQ092ekFn
QUxRaTBvMWM2TnpzMk8yUGcyaDRBQ0lK
QWdBR1AwYU5uNXgwQkRnVmZIN3UyVHR5
ZkQnICsKJ2NSSXVZQXlRaEJGL2x2U1JB
dHRnQTZUUGJXWkE5Z2FVclpXQVVFQUEr
RHg0N1EzL3I4N0h4VVVxWm1CMEJtVXVN
bG9qRmpIdDFnRHUnICsKJ25udnVYOE1J
bXNqU3E1V2t6U3pHUzYyT0VJbE91ZldX
ZXp4V3B2NkZCZ0RnSlZsdGZYRll0TkFB
bnFVMHhRb0QwWUxpWG81Y0Y1UVYnICsK
JzRDblkxdEJMQWtaQ09BQkFoYmsvQU0r
L0F3U0NDZGxXQUFBTWNGalM3b3diOEdW
RHp2ZURpWnZ6bmJ0MnRGNGJMNW9kTjFZ
S2w4OFQnICsKJ0FFQUJDWnZ1ZnE5WUNU
QnRNd1ZBUVVFQXdHdE5sdHpTYUh2QURZ
QzNUeExWanFpUkErT1pBTWh6Y3FFZ1Jj
QU93b0NndmRUeHNUSEwnICsKJ1FFRjYr
b09iMitQQUk4Y2lQUWNYZzdwT1krTGp4
UVN2MmZqbUZ1ajM0Z0d3ejMxMC9iR0s2
ejN4Z1Q4ODdlb21XVUxFYURkMDR3SGUn
ICsKJ3RZeGRqY2dWMlN4dlN3bjBWb1pY
SlJxa1JDNUFTUS9tdVZvQVVzWDdBZ0FR
TUJOYVZ3QUFsQUJSeFQvMVBtZnFMcVNS
TkRiaFhiMDcnICsKJ2JlcnBCM2I5NGpw
dVdFWmpCQ0QyT2NkWEZwQ0tFZ0NEZmNG
UE13OEFBQURVd1Q0bG5VbTUwbG13cnBN
TWhQUUlLajZ1MEU4ZnIydkcnICsKJ0Ju
Z01OZElsclpzaWdqYWhsanVkNkFGVmcr
dHpYd1VuWEwzVEpMcGFqYVdLQTRWQUFB
QU1pRmZxSmdLQVowOFhydFMzZHh0UU5Z
Y3AnICsKJ1B2WUVHOENsdnJRUkpnQmVw
aHduTldKanRHcW1wNlZFUFN2QmU3RUJp
VTNxZ0piUUF3RDRMZThMQU1ETWhIYk5B
QUFsZ0srdEZzNU8nICsKJytZeUpjOXlD
bkphM3J4TFB1bEdueHdzWFY5RnNrMms0
UGlzQ0FIQzhGa3diR0U5Z0pRQUFvTW55
a3NqMENkRk1aTExnb3o4TStGeHonICsK
J2l3WUJnSXgrekhpQ0JBS0FsQktOcEYx
c085SnBWY3lFaTlhcjE1WWxIZ3J1dDVm
UEpua2RKNnZFd1pQeUFIUUJJRURVcmxN
Y0JBQWQnICsKJzJLQVMwUXErSndSc0U0
QUpadE1uQUQ2R25PWXdZbE9JWnZ0elVO
ZGpyZUI3ZmlNa1dJMENtQkI2QUlBS2Mz
OEE5b3NFRmxUU0dFQ0InICsKJytjYmVS
REMwYVJwTEhxTlBwbGNLLzc2THhuMnJw
bXF5WHNZSldSaS9GUUFBQUtCUWs5TUNB
T2liclFCUUFEQ0RzcXBvb1B1dGQrMDUn
ICsKJ0NlOWc2aUVkaVlYZ1ZtUUFJNCs0
d3NrRUJFaUJsb05RNktpMC9LVFEwUWpX
Zmp4emkrQWV1WEtvTWpFVmZRT1p6cjB5
OTQxcUxnTTInICsKJ0FFeHZiWk9xY3ha
Nko2a3Jscmo0eTJqOUFkZ0tEeDZHbkpz
VkxoYmM0MnVxNTg0K291U2ROQnBvQ2lD
VkhyeitXelVBL0REdEQ4QVQnICsKJ2dB
M2gwbE1DQUF6Y0Z2K1MrZlNTTmtlWVds
VHBiMzRtZjJSZm1xcUplTWVrbGhIQWZ1
N1ZvQUVBQ2dBQXBLUmt0TCtLa1FEV013
WUMnICsKJ1VBQUFBSENLc3A4MHhocDkx
VWpxUUJ3M3g0NWNldHFralFFeXUzRzlC
Nk4rUjY1MFVxOE9WaWc3d09tNld1bjBl
YTRsS0RQb2FiSnMnICsKJzZhTHFnYmhQ
enB2NEtSNGlPRGlsdzg4WnBZN3ExSU9N
Y2JBU0FPQVZ0bWNDbm9iY3JrRzRLR1M3
L1puc2tWV1JORjlKMFJVSEtPbkInICsK
J3l5OVdBOER2Nkw0QUFBUk1DUVVBNEdy
aXRmVk0ybGNaZkgzUTNUL3ZaNDdKMllI
aGNtQmF6amZkeXVWMjVnTEF6cmMwY3dB
QUFBQVknICsKJ0NoNlBkd0FBQUd5V2pG
VzR5U2NqYVdhMm1HY29mSHhXeGV3S0FM
Z2xXQnBMVXZ3d2srVU9oNWVOR3lVT3Mx
L0VGK3Bacit1ZDVPem8nICsKJ0d3WWRB
QUJnMnA1MkxpU2dBWS9aVmxPbWlsRWdI
bjZHM09jd1lqekk3dk9qMXQ2eHN4NFMz
bEJZOTZFVVFCRjZBSUJBbVBZSDRQb0cn
ICsKJ1lDb0pBQURXZStPWkpaaTcveDc2
L3lIN0x6ZjlNNVh6UktuRlBtdmVNc2ls
UUh3VkFBQUFBS0IzTFFEOFBDSUFBQURn
YTBRdWpCTHknICsKJ3d6ZUo0YTZaL0VS
VkJBVWxBRURxdm9NN0JRQkF1QWd1ekZx
SUx0bWpIM0tkNHdmS29ibk9oQTN6ODVx
V29SUG05aHdvT0hvREFBbEMnICsKJ2J3
REFBNTZGSEF1WGZsSG8zZmUydHRHOVhV
RGVBOVltWUNCUTBvUHIvMVFDOEl2dUN3
QUFBcGJVQVFDSzIyTW1FM083OFZBYkhR
VDknICsKJ1BJUE5vVDl6TmMzbDJPZTdU
QVZMQU5CdWZUOE1BUUFBQUd6VDRQUzhB
UUFBb0VMR0hiMnVhQ3d3RXYxRVdoRnJp
VWtiQWFBWjI3L2YnICsKJ1ZablRaWGJX
ejNCd1dwalVhTVpLUmo3ZFowSi8vZ1Vl
VGRwVkV3QUFaT0ZzTnhLQWpRU2dBK0FC
UG9ZOEpqNXkyd2plODFqc1hjLzEnICsK
J1RPUVdURFlaQm1Ba05EaXFWd3VBMk5K
OUFRQUFFQktBdDlWcnNmcy8yTjE5TU85
MVM5cmQ4RUhUWkhuekM1TVltZlFFQUN5
L0ZCY0EnICsKJ0FBREE1YzRnaTR6OFJB
TnMvbTZGTlhWbzlEVjQ2SkcxQkJEdWtx
bHcvVmE1RzdRYnVHVlNJKzJhWmFvTFhK
cmRWajJ6bEM5WjVRRUEnICsKJ0VGei81
UXpnVlp3QUFBQUEvb1hjeHlDNldmVHUr
MDlWZS9jNzY2SjRWVEFHVUZtQTUxK1ZB
TktpL1FQb1B3WWdZQWtBNzE1T0g0UzAn
ICsKJ3M1S0RIdmo5OU1NcThUUEZjM3Jv
S1puR09vVDFibUloVmdjN1hBTUJBQUFB
QU1BVzFWYlF3M2dhcHpPcEpkK0tkMmZj
NGlTTzYyZkonICsKJ3Y5K21vdnVpMXdV
TlBBajA1OU4zT1Z4ems0Z1Y3M1BtRThG
SUEyRjVtUnEzN0V2Yzc2dkxYZkY0ckQ1
VUpKQXc0NmhXNkxaQ2I1c04nICsKJ0xk
eCtrek1DQUFCK2hmeTk1Kzk2NVpDTFA3
QjMvVmxUSEN2REVLdFFoVG00S2lDZ0FF
QWJyZmJXVFBzc0FBQUFYcGVlMXRWcm96
WVknICsKJ240MXdEMWFlWXRrS2Zzd041
L1NYUE8wSkRuaE8vNGxhVW9ydHYvczQx
MmZ5YmUvbk9OZG5jb0NIbkJWbGl1MENR
R0JXbFBZLzVLd28nICsKJ20yTC9rcnVQ
TTZRN296NHR2RFF5K2JaM0h6T2krZ05I
QTREWkVnQT0nICsKJycKKTsKCmxpYi5y
ZXNvdXJjZS5hZGQoJ2h0ZXJtL2NvbmNh
dC9kYXRlJywgJ3RleHQvcGxhaW4nLAon
RnJpLCAwMyBBcHIgMjAxNSAwOTowMjox
NSArMDAwMCcgKwonJwopOwoKbGliLnJl
c291cmNlLmFkZCgnaHRlcm0vY2hhbmdl
bG9nL3ZlcnNpb24nLCAndGV4dC9wbGFp
bicsCicxLjU0JyArCicnCik7CgpsaWIu
cmVzb3VyY2UuYWRkKCdodGVybS9jaGFu
Z2Vsb2cvZGF0ZScsICd0ZXh0L3BsYWlu
JywKJzIwMTUtMDMtMTknICsKJycKKTsK
CmxpYi5yZXNvdXJjZS5hZGQoJ2h0ZXJt
L2dpdC9IRUFEJywgJ3RleHQvcGxhaW4n
LAonNWRiNWIwY2VlZmZmOTdjZThiN2E5
N2VkZDNmNWJhNjg1N2RiNTRjZicgKwon
JwopOwoKCg==
HTERM_EOF
Base64.decode(a.gsub("\n", ""))
end
